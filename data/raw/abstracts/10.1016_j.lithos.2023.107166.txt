In the world-class Gejiu Sn district, South China, tin mineralization is related to the Gejiu granitoids, which consist of porphyritic quartz monzonite, syenogranite, and porphyritic/equigranular biotite monzogranites. Zircon UPb dating shows that these granitoids were emplaced at ca. 77.9–81.7 Ma. Close spatio-temporal associations, systematic element distribution patterns, and similar isotopic compositions, together reveal that they are consanguineous, and the porphyritic quartz monzonite represents relatively primitive magma. The occurrence of hornblende, high apatite NdN/NdN* (mostly > 1), and whole-rock evolutionary trends, collectively indicate that the Gejiu granitoids are fractionated I-type granites. Negative and fluctuant εHf(t) values (−13.3 to −3.8) reveal that their I-type affinities could be caused by a mixing source through partial melting of metasedimentary rocks with minor input of mantle-derived materials, which is supported by the presence of mafic microgranular enclaves (MMEs). Zircon and apatite elemental fingerprints, combined with Rayleigh fractional crystallization modeling, decipher a two-stage fractional crystallization of hornblende-dominated and feldspar-dominated. The negative correlation between whole-rock Fe2O3/FeO and Rb/Sr ratios suggests that the magmatic oxygen fugacity gradually decreases with fractional crystallization. High zircon saturation temperatures (∼ 835 °C) indicate that the additional heat from the mantle provided a higher melting temperature to trigger biotite breakdown reactions, which can effectively release Sn into the initial melt. Subsequently, tin in magma underwent a two-stage enrichment process under the conjunctive effect of the variation of fractionating phases and magmatic redox state. In the first stage, there is no significant Sn enrichment during hornblende, magnetite, and titanite fractionation, which is due to the compatibility of Sn with these Ti-bearing minerals under oxidized conditions. In the second stage, the dominant Sn-poor feldspar with limited Sn-sequestering biotite fractionation under more reduced conditions efficiently increases Sn concentration in the residual melt by a factor of ∼ 8, as demonstrated by systematic apatite geochemical data. The hysteretic crystallization of biotite prevents the premature sequestration of Sn and reserves adequate metals for eventual mineralization. Finally, fluid exsolution during the magmatic-hydrothermal transition loads magmatically enriched Sn into the hydrothermal system, leading to the formation of the Gejiu Sn district.