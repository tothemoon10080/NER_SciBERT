The Shihuiyao giant Rb deposit in association with Nb–Ta–Be–Sn occurs within the Southern Great Xing’an Range tin belt known for its Sn, W, Cu, Ag, and base-metal deposits. The trace element compositions of four types of cassiterites hosted in the granite, greisen, unidirectional solidification texture (UST) quartz layer, and the hydrothermal quartz vein, respectively (abbreviated as Cst-I to Cst-IV) were measured by laser ablation inductively coupled plasma mass spectrometry and electron probe microanalysis to establish chemical criteria for the application of cassiterite as a useful geological tracer mineral. In situ U–Pb dating of Cst-I, Cst-III, and Cst-IV yielded Tera–Wasserburg intercept ages of 150.3±5.2, 145.8±4.6, and 146.9±3.5 Ma, respectively. These ages are consistent with the previously published monazite and columbite U–Pb ages of 150.2–141.0 Ma for the Shihuiyao ore-bearing granites, indicating a genetic relationship between granite magmatism and Ta–Nb–Sn mineralization. The composition of the studied cassiterites within the whole magmatic–hydrothermal evolution process yields some petrographic dissimilarities and geochemical trends from xenothermal to epithermal environments, which can be used to fingerprint the fluid evolution of the Shihuiyao deposit. For example, the magmatic cassiterites (Cst-I and Cst-II) are strongly enriched in Ta and yield low Nb/Ta ratios compared to the Cst-IV cassiterites from shallow hydrothermal veins. The occurrence of wodginite-group minerals and the highest W concentrations in cassiterite from the UST quartz layers suggests that the main enrichment in W is primarily controlled by magmatic fluid exsolution during the magmatic–hydrothermal transition stage. Additionally, hydrothermal cassiterite is generally lighter in color and characterized by complex internal oscillatory zoning with alternate dark (Cst-IVa) and light (Cst-IVb) bands. Cst-IVa cassiterites have similar W, Nb, and Ta contents but much higher Ti contents compared to Cst-IIIb cassiterites related to primary magmatic fluid, whereas Cst-IVb cassiterites exhibit sharply decreasing W but elevated Ti contents, suggesting pulsed exsolution of magmatic ore‑forming fluids and the involvement of external fluid in a distal open-fluid systems during the late mineralization stage. Therefore, the chemical variations of cassiterites are not only robust tracers pointing to magmatic–hydrothermal centers but also effective in discriminating the primary source of alluvial cassiterite and evaluating its metallogenic potential during a natural heavy mineral survey, supporting the use of cassiterite as an indicator mineral for exploration targeting.