Previously, plant-wide disturbance analysis has looked into the propagation of faults through an industrial production process by investigating process measurements. However, the extent of the analysis has mostly been limited to a section of a plant. In this work, we propose a top-down approach which investigates measurements of the complete plant and identifies a section where the disturbance originates. Root cause analysis is carried out thereafter to pinpoint the faulty asset. The proposed approach has three novel elements: Using key performance indicators (KPI) as reference and starting point of the analysis, restricting measurements to a measurement type (e.g. flow) thus focusing on a section and applying the novel method of contribution plots of spectral PCA T
                     2 statistic to find the contribution of each measurement towards the disturbance observed in the KPI. The approach is described and carried out on a paper machine where a quality KPI showed an established oscillation.In the process industries – such as pulp and paper, chemicals, metals or minerals processing – the performance of the controllers is an important measure to evaluate whether the process is operating efficiently. There are many ways to assess the performance of single control loops ( Poorly performing loops fluctuate around the setpoint upsetting the process and decreasing its efficiency. Worse still, these disturbances not only affect single loops but travel through the interconnected process equipment and show up in several measurements in the process and result in what is often termed ‘plant-wide disturbances’ ( The terminology ‘plant-wide’ is debatable because a plant often comprises hundreds if not thousands of control loops while the algorithms described in the references mentioned above deal with a few dozen of loops. Methods and frameworks that are termed ‘plant-wide’ look at more than one but usually less than 50 measurements by focusing on a plant section. For the purpose of this paper we will re-label the term plant-wide approach to ‘section-wide’ to avoid confusion. A plant-wide analysis is conducted by Most of the plant-wide performance monitoring of control loops, as part of control loop monitoring, (CPM) in the process industries is conducted following standard procesdures. Many industrial production companies use CPM software packages which compile continuously, weekly or monthly reports with which action items such as tuning initiatives, control structure modifications or maintenance actions are triggered. The commonality between the different tools is that all use a bottom-up approach. That is, CPM indices are computed for all control loops in a plant. These indices rate the performance and identify loops that are performing poorly, i.e. loops that are oscillating, excessively deviate from their setpoints, or loops that are in saturation. The results of such assessments are generally presented in Top In this paper, we propose a top-down approach which focuses on key performance indicator (KPI) exhibiting degradation and then drills down to the root cause of the degradation, eventually identifying the faulty equipment. KPIs evaluate the performance of a process, not only on the control level but also on a business level reflecting the overall plant efficiency. KPIs help plant managers to assess the performance of the production at enterprise, plant or process level. A recently published standard describes KPI for manufacturing operations management ( To facilitate the top-down approach, a new method is proposed to find the ‘correlation’ between the KPI in question and a selected number of process measurements from across the entire plant. The method is based on spectral principal component analysis (PCA) and uses the contribution plots of Hotelling's The paper is organized as follows. In The procedure of control loop performance monitoring (CPM) is a bottom-up approach and we will briefly review this traditional approach. Measurements in an industrial process can be arranged according to sections. The bottom-up approach includes the computation of indices for control loop process variables across the sections and the plant. For an industrial process, this can range from a few dozens to more than 1000 measurements. In the bottom-up approach, information about which section the measurement resides in is usually not exploited. The bottom-up approach has been successfully applied in the process industry and several case studies have been reported as success stories ( The starting point of the top-down approach is to identify a key performance indicator (KPI) that highlights plant sections not performing as expected. KPIs are usually linked to a monetary value so that addressing and ‘fixing’ a KPI results in a direct economic benefit. One advantage of the top-down approach is that (a) disturbance which affects the plant efficiency are addressed and (b) the financial impact of the disturbance can be evaluated if the KPI measures the economic performance. The method is easier to interpret as well as computationally more efficient because only a fraction of all plant measurements have to be analyzed and the control expert can drill down to section and process measurements. The approach is truly plant-wide and not section-wide. The case study used to validate the proposed methodology is a three layer board machine from the pulp and paper industry. The overall process schematic is shown in      The process quality KPIs are measured online by the QCS (Quality Control System). Admissible ranges for the KPIs fluctuations varies with the produced grade and these operating ranges are only valid during steady state periods of the process operation. The present work focuses on a typical type of fault encountered in control systems, namely an oscillatory fault. In the case study, a slow oscillation occurred in the moisture measurement XM1 which is the KPI of interest for the purpose of this study. The time trend of XM1 is shown in The oscillation in the KPI was quantified using the oscillation detection method proposed by The task now is to first find the section where the disturbance originated and secondly find the measurement in the identified section closest to the root cause. For the complete board machine, more than 7000 process measurements, mainly temperature, pressure, level and flow measurements, were available of which approximately 600 were controlled variables. Because of the slow nature of the oscillation period, twenty four hours of operating data were considered. The sampling period was 10 The starting point of the top-down approach is the detected disturbance in the KPI. This may be an oscillation as described in the case study or degradation in amplitude. We now want to know what causes the disturbance. This implies that the signature of the disturbance is and the 7000 measurements in the plant can be investigated. We now follow the structured approach outlined in The volume of data means that the number of measurements has to be reduced to look for any correlation analysis. In the first step we propose to reduce the complexity of the root cause analysis by identifying the section with the measurements closely related to the KPI to reduce the complexity of the problem. Most plants are comprised of sections. Information on plant section can usually be taken from the names of the measurements. For example, every measurement name, also referred to as tag name, containing the numbers ‘MAC_04’ is part of In the following, we first propose the method and then apply it to the case study of the paper board machine. The novel method proposed here is the use of a metric denoted “Spectral PCA has been applied to industrial process data for the purpose of statistical process control for instance by Kresta et al. (1991). Application of PCA to the power spectrum of industrial process data was first proposed by Let Applying a Fourier transform to each row of the data matrix There are as many frequency channels PCA applies singular value decomposition and computes eigenvectors and eigenvalues of matrix where matrix We can now compute Hotelling's Here  We know that we are focusing on a specific frequency When implementing the contribution measure we have to keep in mind that the oscillation period changes slightly as the disturbance travels through the plant and is captured by different sensors. We therefore sum the contribution plot over a narrow frequency band centered on the frequency at which the oscillation was observed. Note that the contribution is not necessarily positive because both scores and loads can be negative. Large negative values indicate a contribution as much as large positive values (see The disturbance in the moisture KPI of oscillatory nature is the starting point of the case study. For the present analysis, the spectral dataset was build using a Fast Fourier Transform algorithm evaluated over 24 The analysis results are shown in Following the top-down approach, we focus the analysis on the spectral component The same analysis was repeated for all pressure measurements as listed in As a result of this analysis, the section-wider disturbance analysis, described in the next step of the analysis, focuses on all measurements in the dryer section. Examining the relationship between the KPI and all the flow measurements in the plant in the previous paragraphs has pin-pointed one section as the source of the potential root cause. This was done by the contribution plot of spectral PCA. Now, we can focus on the section in question and conduct the plant-wide analysis as highlighted by The procedure of section-wide disturbance analysis is shown in Oscillation detection is only suitable for oscillatory disturbances. The clustering for oscillation detection is done by finding similar oscillation periods and grouping the measurements with similar oscillation periods together. Once an oscillation is detected in several process measurements, the direction of propagation of the disturbance needs to be deduced. This is done by nonlinearity detection because faults often result in nonlinear oscillations which then become more linear as they travel through the process ( The (spectral) PCA branch addresses oscillating but also other forms of disturbances. The result of the analysis are clusters of measurements with similar power spectra. The propagation path within these clusters can be identified by two data-driven methods, one based on transfer entropy and the other on the detection of time delays. Again, the results of these two alternative methods can point towards the same root cause or different and potentially conflicting root causes. The aim of the section wide analysis is to pinpoint one or maybe two measurements that are closest to the root cause. Often, the root cause measurement is a measurement in a control loop which has an actuator such as a valve or pump which is faulty. In other cases, a process fault can occur if two inadequately tuned control loops having conflicting objectives introduce an oscillation into the process. Instead of 7000 initial measurements we now need to investigate roughly 250 measurements in the dryer section. These measurements are flow, pressure, temperature and level combined. Some of these measurements had to be disregarded at closer inspection in Step b) due to high compression. A method for detection of piecewise linear compression ( After disregarding compressed and near constant time trends manually, 112 process measurements remained. These measurements were analyzed over a longer period of 42 Oscillation detection using regularity of the zero crossings of the auto-covariance functions ( To investigate the root cause of the disturbance further, the process schematic of the dryer section is consulted. Displaying the results of the oscillation detection and nonlinearity analysis in the process schematic of As PC2 appears to be the culprit the next step is to carry out a fault diagnosis for this particular measurement. This was done using standard control loop performance monitoring (CPM) methods as described, for example, by The purpose of the study was to find the root cause of an oscillatory disturbance that affected a critical quality measure – a KPI – over a longer period of time. The plant-wide root cause analysis using the proposed spectral PCA After the analysis was conducted, the results were discussed with plant operators and control engineers at the site. During the discussion it appeared that the issue of a malfunctioning steam valve in the dryer section was previously reported by the maintenance staff. It had also been known to the operations team. However, the link between the product KPI degradation and the valve stiction had not been established. Because the impact of the valve stiction problem on the moisture content of the paper was unknown, the servicing of the steam valve was given a low priority. With the results of the analysis in mind the servicing of the valve was shifted to an earlier date. Carrying out maintenance on the valve did indeed result in the removal of the oscillation in the KPI and in other measurements. An improvement in the KPI moisture (XM1) means that the paper produced is consistently of better quality and thus translates directly into a financial benefit. Even before the results were discussed with the plant personnel, the viability of the results could be proven by interpreting the combined results of the plant-wide and section-wide analysis. The In this paper we proposed a top-down approach for control loop performance monitoring that deals with plant-wide disturbance analysis. The novel method evaluates contribution plots of the spectral PCA The advantage of the top-down works is that it focuses on relevant disturbances that affect the performance of the process in a quantifiable way. Eliminating a disturbance in a KPI can be directly translated into financial benefit, that is, the end product can be sold at higher price because it is of better quality. Interestingly, in the case study the loop in question was known to be performing poorly but the operators and control engineers alike did not link it to the impact it had on the KPI. Both top-down and bottom up approaches have their merits. The top-down approach is essentially a “symptomatic” approach. While a link between asset degradation and KPI degradation is guaranteed, a signature of the KPI degradation should be present in the analyzed dataset in order to find its root cause, leading to a “post mortem” analysis. A bottom-up approach on the other hand allows the detection of asset degradation before it significantly impacts a process KPI. However, it does not contain information about the link between these two degradations and therefore cannot estimate the economic benefit. Future work should be aimed at finding the best combination of both approaches for example, the top-down approach can be used to generate scenarios to a “learning algorithm” that progressively allows a bottom-up approach to learn possible sources of KPI degradation. Both approaches can work together and will, hopefully, highlight the same root cause. Further work needs to be done to generalize the approach for any type of disturbance. In the presented case study, the disturbance was of oscillatory nature. The spectral This research has been funded by the