Although the interaction of gas and coal has been comprehensively investigated in coalbed methane (CBM) extraction process, fewer scholars have taken the effect of temperature and groundwater into account, which brought a large deviation for CBM extraction design. In this study, a fully coupled thermal–hydraulic–mechanical model (THM) including coal deformation, gas seepage, water seepage, and thermal transport governing equations is developed and solved using the finite element (FE) method. The coal mass is simplified as a dual-porosity and single-permeability media while CBM migration is considered as a tandem process of desorption, diffusion and seepage. The dynamic evolution model of permeability serving as the coupled term for THM model is developed under the combined impact of stress, water pressure, gas pressure, gas adsorption/desorption and temperature. The proposed model is first verified by showing that the modeled gas production rate and water production rate match reasonably with the in-situ measured ones. Different coupled models for CBM extraction were comparatively analyzed by accomplishing a series of simulations. It is found that the gas production rate of models ignored water effect monotonously reduces over time; while the model considered water effect rises at beginning and then gradually reduces. The model ignored water effect will overestimate gas production, and the model ignored thermal effect will underestimate gas production, particularly coal seam contains considerable amount of water. The evolution of permeability is the competition result of two opposite effects: the matrix shrinkage effect caused by temperature reduction, the matrix swelling effect caused by gas pressure decrease and methane adsorption increase. A rising permeability resulted from the integrative action of both lower reservoir temperature and pressure during CBM extraction is observed. The impact of initial water saturation on gas production can not be ignored in the whole extraction process, especially during the water drainage period. Gas production rate of CBM well decreases with initial reservoir temperature, initial water saturation and Langmuir volume constant, while increases with the Klinkenberg factor. Permeability rate increases with initial water saturation and Klinkenberg factor, however decreases with initial reservoir temperature. As Langmuir volume constant increases, the peaking value of gas production rate increases and delays. The Klinkenberg effect promotes coalbed methane migration significantly, ignoring which will underestimate the gas production, and the impact of Klinkenberg effect gradually increases with the drop of gas pressure.Coalbed methane (CBM) as a kind of clean and unconventional natural gas, is an important source of energy ( The coal seam, characterized by a typical dual-porosity system with micro-porous matrix and macro-porous cleats/fractures containing free and adsorbed methane, is both the source and the reservoir for CBM ( As a matter of fact, coal seam contains large amounts of water coexisting with methane, due to the form of CBM reservoir needs stable hydrodynamic conditions ( In this work, we extend previous models of coalbed methane extraction by combining coal deformation (effective stress, gas-desorption-induced shrinking and thermal-induced swelling), gas seepage, water seepage (gas-water two-phase flow), and thermal transport together, namely fully coupled thermal–hydraulic–mechanical model, to accurately predict and evaluate coalbed methane well production. Furthermore, coalbed methane extraction associated with initial water saturation, initial reservoir temperature, Langmuir volume constant and Klinkenberg factor, are quantitatively investigated through numerical simulations to better understand the methane migration rules in coal seam. In the following, a set of field governing equations are defined to govern the coal deformation, the methane and water transport, the energy conduction and convection. These derivations are based on the following hypotheses ( By taking thermal expansion/contraction strain, pore and fracture pressure induced strain and methane desorption/adsorption induced shrinkage/swelling strain into consideration, the constitutive relations for non-isothermal coal seams can be expressed as ( By taking the volume average of the pressure in the mixture, fracture pressure can be defined as ( In which The absorbed gas content can be expressed as a modified Langmuir volume equation ( The strain-displacement relation, the Cauchy formula, can be expressed as: The equations of stress equilibrium relations can be defined as: Combining Eqs. Coalbed methane migration in matrix is a diffusion-dominated process. Methane in coal seam is in a dynamic equilibrium state at beginning, the gas pressure in the matrix equals to the gas pressure in fracture. While the equilibrium will be broken during CBM extraction, gas adsorption pressure is higher than the gas pressure in the fracture due to the different seepage velocity in fracture and matrix, adsorbed methane of the matrix system will diffuse into the fracture system. According to the Fick’s diffusion law, the methane mass conservation equation in matrix can be defined as ( In which Methane content in matrix consisted of absorbed methane and free methane components, is defined as: By substituting Eq. After the equilibrium is broken by CBM extraction, methane in the matrix will diffuse into the fracture, in other words, matrix system is the uniformly distributed mass source for fracture system. Mass conservation equation in fracture system can be expressed as: Water density is related to temperature, which can be defined as In which Based on generalized Darcy’s law for gas-water two-phase flow, the water and gas velocity in fracture can be defined as:  The relation between gas pressure and water pressure is as follows: By substituting Eq. Due to the assumption of thermal equilibrium between the fluid and solid phases, thermal balance over an REV can be expressed in terms of a single equation neglecting the interconvertibility of thermal and mechanical energy. The effective heat convection transfer coefficient is We assume that solid and fluid phases are always in a state of thermal equilibrium, which can be expressed as: In Eq. Porosity and permeability, characterized as the key factor for coal gas migration and CBM extraction, are sensitive to the stress state and material property. According to the previous work ( As shown in The cubic law is used to express the relationship between permeability ratio and porosity ratio in coal seams ( Substituting Eq. (23) into Eq. (24) yields: Combining Eqs. Qinshui Basin is located in the southeast of Shanxi Province. It is one of the earliest and most commercial valuable areas for CBM exploration and development in China ( Extraction of coalbed methane buried at 778 m depth is simulated using the single well method. A representative physical model of square reservoir block within 500 m × 500 m The initial gas pressure in fracture  The gas production rate of No. 1 CBM well firstly increases and then gradually decreases with time. The average gas production rate of field data during the whole monitoring period is 929.5 m To investigate changing rule of gas pressure, permeability and gas production in the process of CBM extraction under different coupled models, a total of four scenarios were considered ( Scenarios I (Zhao’ model): neglect the affect of water and temperature; merely consider the gas–solid coupling effect. Scenarios II (Zhu’ model): consider the effect of temperature on the basis of scenarios I, neglect the affect of water. A red line O–A and point B as the observation reference was drawn to analyze the variation law of permeability and gas pressure in the coal reservoir during CBM extraction with different coupled models ( Gas pressure variation of different coupled models in the reference line O-A is shown in  For the coupled model without considering thermal effect (Zhao’ model and Thararoop’ model), the porosity and permeability decreases with gas pressure dropping, for example, the permeability rate  CBM extraction is closely related to the physical factors, including coal permeability/porosity, different initial reservoir temperature, initial water saturation, Langmuir volume constant and Klinkenberg factor. There is no doubt that the influence of porosity and permeability on CBM extraction is huge, which has been widely researched and confirmed in many studies (e.g.     In this work, a fully coupled thermal-hydraulic-mechanical model with two-phase flow for coalbed methane extraction was proposed including coal deformation, gas seepage, water seepage, and thermal transport governing equations. Different coupled models and the influence of several key factors on CBM extraction process were analyzed. The following conclusions can be drawn: The gas production rate and water production rate fits very well when compared the simulation results with field data, which validates the accuracy of proposed THM coupled model. Models considered the thermal effect has a larger gas production rate than without it. The gas production rate of coupled models with no water effect consideration monotonously reduces over time, while when water effect is included, gas production rate first increases and then gradually decreases with a peak point. The model ignored water will overestimate gas production, and the model ignored thermal effect will underestimate gas production, particularly coal seam contains substantial amount of water. The evolution of permeability is the competition result of two opposite effects: the matrix shrinkage effect caused by temperature reduction, the matrix swelling effect caused by gas pressure decrease and methane adsorption increase. The reservoir permeability of models considered the thermal effect gradually rises, and a larger permeability increasing value is observed for the proposed model due to its greater heat released by extracted water. The gas production rate decreases with initial reservoir temperature, initial water saturation and Langmuir volume constant, while increases with the Klinkenberg factor. The permeability rate increases with initial water saturation and Klinkenberg factor, and decreases with initial reservoir temperature. In this study, the permeability rate decreases with the Langmuir volume constant when This work was funded by the  Buried depth Coal seam thickness shear modulus bulk modulus grain bulk modulus stiffness of fracture effective elastic modulus elastic modulus grain elastic modulus Poisson’s ratio of coal thermal expansion coefficient temperature variable initial temperature in coal seam volumetric matrix shrinkage strain induced by methane desorption Biot effective stress coefficient for matrix Biot effective stress coefficient for fracture coefficient of gas adsorption induced strain absorbed gas content mixture pressure in fracture gas pressure in matrix average length of matrix average aperture of fracture Kronecker delta with 1 for water pressure in fracture gas pressure in fracture water saturation gas saturation pressure coefficient for adsorption temperature coefficient for adsorption Langmuir volume constant Langmuir pressure constant temperature of coalbed reference temperature for adsorption test displacement in the body force in the methane content in matrix per unit volume methane molar mass gas molar constant time methane desorption time absorbed methane content density of coal skeleton standard atmospheric pressure standard temperature porosity in matrix fracture porosity velocity of water velocity of gas temperature coefficient of water water density under standard conditions water velocity gas velocity absolute permeability of coal endpoint relative permeability of gas endpoint relative permeability of water relative permeability of water relative permeability of gas dynamic viscosity of water dynamic viscosity of gas Klinkenberg factor irreducible water saturation residual gas saturation capillary pressure specific heat capacity of gas specific heat capacity of water effective heat capacity effective coefficient of isotropic thermal conductivity specific heat capacity of coal skeleton heat conductivity coefficient of coal skeleton heat conductivity coefficient of gas heat conductivity coefficient of water isosteric heat of adsorption volumetric strain of coal modified fracture stiffness  initial value of the variable matrix fracture