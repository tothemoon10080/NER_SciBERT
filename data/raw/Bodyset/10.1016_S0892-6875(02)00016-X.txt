This paper presents a dynamic flotation simulator intended for designing and testing automatic control strategies, for evaluating the transient behaviour of the flotation process, and for training purposes. The simulator is based on a non-linear dynamic model that is derived from phenomenological and empirical relationships. It incorporates a new way of representing the loading of the bubbles with the various mineral species considered. The simulator was designed for a particular flotation circuit and was fitted with plant data in order to reproduce the plant behaviour both qualitatively and quantitatively. Both identification and validation data sets were used. Model dynamics had to be tested using ARMAX type models identified with plant data, due to the highly stochastic characteristics of the process. Plant and simulator responses were compared in steady-state and in transient conditions using these models. Results indicate the simulator is adequate for the stated purposes.The normal operation of a flotation plant is affected by frequent and inevitable changes of the feed stream in terms of flowrate, grades, mineralogical composition, mineral surface condition and particle size distribution. Flotation processes are dynamic, highly non-linear, and have strong interactions between variables, including disturbances and time delays. In addition, there is a general lack of on-line instrumentation. These characteristics, together with the inherent complexity of the process itself, make automatic control of flotation circuits a difficult task. These complexities are especially relevant when it comes to building a dynamic model for a flotation simulator. Steady-state models have indeed been developed, such as those developed by The type of model adopted for any simulation is application and purpose specific. Different kinds of models are required for the design of equipment, for designing plant layouts, for designing and testing of automatic control strategies, for the development of soft-sensors, for use in model-based automatic control systems, etc. In some cases phenomenologically based models for steady-state conditions are required and these are valid for a wide range of operating points (e.g., layout design). In other cases simple empirical dynamic models that are accurate around operating points suffice, but these need to be updated as the operating points change. Such is the case of ARMAX models used in model-based control strategies and in soft-sensor design. Furthermore, models for testing automatic control strategies need to include the main features that affect the control of a plant. These include its dynamic behaviour, delays, non-linearities, interactions between variables, measured inputs and outputs, measured and unmeasured disturbances, etc. For these models, approximate quantitative accuracy should be sufficient, but the models have to be acceptable from the qualitative standpoint. There are few dynamic flotation models cited in relevant literature. Most of them are based on a work by The model developed in this paper is specifically intended for designing and testing control strategies, designing soft-sensors, evaluating process modifications and for training purposes. Modelling is derived from phenomenological and empirical relationships, whilst keeping the model structure simple enough to be calibrated with plant data using available on-line instrumentation. The simulator based on this model is designed for a particular flotation circuit and is calibrated with plant data, in order to reproduce plant behaviour both qualitatively and quantitatively.  Experimental data were collected for the circuit shown in The proposed model is of the state/state – output class and is partially phenomenological and partially empirical. The following assumptions have been made for each cell model. Only one phase is considered, the slurry phase, in order to minimise mathematical complexity and thus facilitate the fitting of the model with plant data. Since the dynamics of the froth phenomena are faster than the slurry dynamics, it is possible to incorporate most of the froth phenomenology in the behaviour of the slurry phase. Hence, in addition to particle–bubble attachment effects, the flotation rates include all the drainage and entrainment effects. Although this assumption makes a significant simplification in order to keep the model simple enough, it has proved to be adequate. The flotation process is a distributed system due to the presence of many mineralogical species in different degrees of liberation and in different associations. The different classes have been grouped into a reduced number of broader classes. There are few enough to keep the model simple, but a sufficient number to describe the flotation behaviour satisfactorily. The mineralogical classes are as follows: Partially liberated chalcocite (60% Cu partially liberated chalcopyrite (80% CuFeS poorly liberated chalcopyrite (30% CuFeS partially liberated pyrite (60% FeS pure gangue. A well-known and proven assumption, under which the concentration of each mineral class in the slurry phase is equal to its concentration in the tailings of each cell. A “water flotation” model was avoided for simplification purposes. Instead, a constant percentage of solids in the concentrate is assumed. This assumption does not produce large errors. Indeed it influences only the mass balances in the interactions with the subsequent flotation stages which are not incorporated into the simulator. A constant airflow, which is an unmeasured disturbance in this plant, is assumed, thus implying a fixed transport capacity for carrying particles to the concentrate. The state equations of the rougher flotation dynamic model represent the time variation, for each mineralogical class To calculate the flotation rate of the mineralogical class The flows Two main sub-models were used to help in the modelling of the process. The first calculates the mineralogical composition of the feed in terms of the copper and iron feed grades. The second is the bubble saturation sub-model. Given the measured copper and iron feed grades, this sub-model determines feed composition, considering various limiting conditions obtained from several mineralogical analyses of the ore treated in the flotation circuit. With respect to the copper feed grade, three cases are defined. When the copper grade is between the limits specified in When the copper feed grade is not between the above-mentioned limits, the other two cases are present. In one case, at a lower copper grade ( The flow rates ( According to the assumption of a constant airflow, which implies a limited transport capacity, the model parameter, With the proportional alternative, the transport capacity is used as if it were unlimited. This proportional option disregards the fact that some mineralogical classes are more floatable than others and that for a limited transport capacity, the more floatable (i.e. more hydrophobic) classes displace the others (i.e. the more hydrophilic). With the hierarchical option the more floatable class occupies the transport capacity first. The next floatable class will be floated only if the transport capacity has not yet been completely occupied. If this were correct it would be possible to get higher concentrate grades simply by using less airflow, neglecting entrainment and other agitation related effects, as well as other factors which constrain the bubble enrichment. A more realistic approach is to consider an intermediate case. To calculate the occupancy of the transport capacity for each cell, the bubble saturation sub-model is used. This is valid when the quantity of floatable mineral is greater than the transport capacity ( The quantity of floatable mineral ( If For each class The described model was implemented in the FLOTSIM-FL simulator, as an application of the FactoryLink ECS software, in the CML (Compiled Math and Logic) mode. FactoryLink ECS is control and industrial supervision software that allows the configuration of an application with trend graphics, historical trends, data handling and layouts. This allows the communication between FactoryLink and the model written in C++, as if it were the actual plant. The available on-line data did not allow the parameters for the whole simulator to be determined. As can be seen in The simulator parameters were adjusted using part of the plant data shown in The objective function, presented in Next, in order to carry out the dynamic tuning, those parameters less related to the dynamics of the process, and those related to unavailable dynamic data, were fixed. The rest of the parameters were varied in order to adjust the dynamic response. However, adjusting the dynamic characteristics of the phenomenological model poses important problems. On the one hand, some of the variables affecting the model behaviour, such as the copper grade and the iron grade in the feed stream, may not be varied at will to produce the sufficient excitation that may be required to bring out the dynamic characteristics associated with such variables. On the other hand, the rich concentrate grade is a very noisy variable, due to the effect of non-measured disturbances. As a result, the effects of changes in the input variables affecting this concentrate grade become obscured by its relatively large random variations. Of course, changes in the input variables that are large enough to produce an evident change in the concentrate grade, in spite of the noise, might be used. However, this is not an acceptable procedure for plant operation. The response to simple test signals, such as steps, pulses and specific random signals (e.g., filtered white noise) may be used for adjusting the dynamic characteristics of the phenomenological model. Although the response is easily obtained for the simulator, this is not so in the case of the plant, due to the noisy character of This problem was solved by identifying ARMAX ( With The residence time (time constant) of the rougher flotation first array is given by: In the model identification stage a search of all subsets was used to determine the best set of components. Several time intervals were used to identify the ARMAX model, while the remaining data in each case was used for validation. The identification criterion was the mean square error of fit, where this error is the one step error between the actual concentrate grade The final assessment of the models was made at a validation stage using data that was different from that used at the identification stage ( The best model using these criteria, named model A ( This simulation model could be used as a soft-sensor for inferring the concentrate grade  Other candidate models, which gave higher validation RMSE, were: model B, with original measured variables as components; model C, with original measured variables as components, except that 1/ The identification results for various identification intervals, and validation in the complement intervals, is given in It may be seen that the best validation performance is attained by model A, which has the phenomenological component The dynamic response of the plant to pulse test signals was now obtained using the identified ARMAX Model A (i.e., the best model). The pulses were defined by ±5% changes around the mean value of the plant variables. The same pulses were applied to the simulator. A preliminary adjustment of the parameters more related to the dynamic response (i.e., those which were not used in the steady-state fitting) was made in order to match as best as possible the dynamic response of the simulator with that of the ARMAX model. Starting with the simulator parameters obtained by the steady-state and dynamic case fitting, the final adjustment of the simulator model parameters was performed. This minimised a cost function which includes the RMSE between the simulator and the plant results for the same on-line plant input data, as well as the RMSE between the simulator and the ARMAX model responses to the pulse test signals. The constraint used in the minimisation procedure was the fact that the simulator results should remain close to the off-line historical data. Since the rich concentrate grade  The differences in response between the simulator and ARMAX model A are easily explained. The simulator must respect the constraints given by off-line historical data related to the whole rougher flotation bank, while the ARMAX model A is adjusted only with data from on-line sensors, all of which are in the flotation first array. The RMSE between the copper grade measured in the plant, Besides the constraints shown in To test the capabilities of the simulator for training and process analysis purposes, several simulations were performed.  As can be seen in A dynamic flotation simulator has been successfully developed. The model was based on a non-linear dynamic model, derived from phenomenological and empirical relationships. The simulator was designed for a particular flotation circuit and was calibrated with plant data. The available on-line time-varying plant data did not allow the parameters for the whole simulator to be adjusted. Indeed, the only on-line concentrate grade measurement was the concentrate copper grade of the first array of the rougher flotation circuit (rich concentrate). To overcome this limitation a mixed adjustment procedure was developed. First the simulator was fitted with steady-state data using the parameters best suited to this condition. Next, dynamic characteristics were incorporated using on-line measurements with the aid of an ARMAX model. The values of the simulator model parameters were determined by minimising the mean square error between the simulator model output and the actual plant measurement, under constraints given by off-line historical data related to the whole rougher flotation bank. These constraints corresponded to ranges of total copper recovery, total concentrate copper grade and tailings copper grade, obtained from maximum and minimum historical values. Because of the highly stochastic nature of the process, plant dynamic behaviour for testing inputs had to be extracted by means of ARMAX type models for the rich concentrate grade. These models were identified using the highly variable plant data that could be obtained on-line. The same test inputs were then applied to the simulator model and to the ARMAX model. In this way the dynamic behaviour of the simulator model could be assessed. The best ARMAX model turned out to be one that incorporated phenomenological knowledge. Its components were the rich concentrate grade with delays from one to four, the feed copper grade with no delay, the feed iron grade with delays one and two, the residence time (a phenomenological component) with delay one, and a constant. The dynamic behaviour of the models was tested using the highly time-varying data collected at the plant. In the case of the best ARMAX model, a root mean square error (RMSE) criterion gave values that ranged, during validation, from 0.31 to 0.42 grade percentage points. The simulator model gave an RMSE of 0.38 when compared to the real rich concentrate grade if adjusted using only the first array data, and 0.20 when compared to the ARMAX prediction of this grade. In this case the ARMAX model served to filter out the noise due to unmeasured disturbances, which obviously could not be used in the calibration of the simulator. However, if the steady-state constraints of the rest of the plant were imposed, the RMSE increased from 0.38 to 0.42. Since the simulator had to respect the constraints given by off-line historical data related to the whole rougher flotation bank, the simulator model parameters, adjusted under constraints, had to be used, even though it gave a higher RMSE. The described model was implemented in a simulator, FLOTSIM-FL, as an application of the FactoryLink ECS software, in the CML (Compiled Math and Logic) mode. This allowed the communication between FactoryLink and the model written in C++. Because of this arrangement the views from the simulator screen looked as if they were connected to a real industrial plant, except for the fact that the speed of response was much faster. To test the capabilities of the simulator for training and process analysis purposes, several simulations were performed. According to the results, the simulator reproduced the plant behaviour both qualitatively and quantitatively, and is therefore particularly well suited to training and process analysis during transient conditions. Given these characteristics, this dynamic simulator is adequate for designing and testing control strategies, as well as for designing soft-sensors. The research and development leading to this paper has been financed by CONICYT (Chilean National Science and Technology Council) through Projects FONDECYT 1000873 and FONDECYT 1000977. Our thanks to research assistant J.L. Cerda, for his help in ARMAX modelling and programming.