To improve our understanding of the factors that control a number of critical soil processes, it is important to properly identify pore space zones. Computed tomography (CT) images provide increasingly reliable information about the geometry of pores and solids in soils at very small scales and are a non-invasive technique. However, the low contrast between voids and pores and the non-bimodal greyscale value (GV) histograms observed in the CT images present a problem with respect to pore identification.
                  In this work, we propose a new segmentation method based on the local GV concentration variability when using singularity maps. We also introduce a new method for creating synthetic CT soil images based on truncated multifractals that simulate low-contrast and non-bimodal GV histograms.
                  From three different bidimensional CT soil images and one synthetic soil image, singularity maps were created to measure the GV concentration at each point by defining areas with self-similar properties that were shown as power-law relationships in Concentration-Area plots (C-A method). The C-A method together with a singularity map (the “Singularity-CA” method) was used to define thresholds that were applied to binarize the CT images. Promising results were obtained when the greyscale images were overlapped with the borders of the binarized images.
                  Once these black and white images were obtained, we compared them with commonly used segmentation methods: the Otsu, Iterative and Maximum Entropy methods. The image comparison was based on the total porosity, cumulative pore size distribution (CPSD), cumulative pore size–area distribution (CPSAD) and misclassification error (ME). We found that the Otsu and the Iterative methods overestimated the size of large pores compared to the ground-truth image, which overestimated the porosity. Conversely, the Singularity-CA method extracted medium and large pores with a good fit compared to the ground-truth image. It was observed that whereas the Otsu and Iterative methods obtained the large pores, the “Singularity-CA” method detected an aggregate of small pores, although many of these small pores were incorrectly identified. This was due to the latter's high sensitivity when detecting anomalous GV values. The Maximum Entropy method always resulted in the lowest porosity in the real CT soil samples and the greatest porosity in the synthetic soil image samples.From a structural point of view, soil may be defined as a mixture of solid and void components. The characteristics of the void components, also known as the “pore space”, significantly affect the water flow and solute transport processes ( It has become increasingly common to use X-ray computed tomography (CT) images as a source for pore space parameter extraction ( Segmentation techniques are generally used to define the air-filled pore space in CT images. When we want to distinguish between two different objects (object and background), we typically discuss binarization instead of segmentation. Binarization techniques are primarily based on thresholding methods ( When we attempt to compare different segmentation methods, it is important to know the ground-truth information of the soil samples because we will be able to make a better quality assessment. The problem is that in some cases, this information is not available. If we want to obtain the ground-truth information of a 3-D soil sample, we would have to prepare slices that would inevitably lead us to alter the sample's internal structure. An important parameter that would be possible to calculate a posteriori is the total porosity. However, this parameter by itself is insufficient for use in different segmentation methods. Currently, to address this problem, the use of simulated or synthetic soil images is common. We can find examples of 2-D and 3-D synthetic soil images in the studies by In recent years, fractal geometry has been applied to the study of soil structure ( In the field of fractal models being applied to geochemical exploration, we highlight the work by Q. Cheng concerning the mineralization processes in ore deposits ( The aim of this paper is to develop a fractal approach for considering soil structures that uses the above concepts to establish an analogy between the mineralization processes in ore deposits and the morphogenesis processes in soils. The results of this analogy represent a new segmentation method, referred to here as the “Singularity-CA” method. A comparison with traditional segmentation methods is performed to demonstrate the main differences among them; we consider the Otsu, Iterative and Maximum Entropy-based methods. We also introduce an alternative method to create synthetic soil images. This new method, which we call the “Truncated Multifractal Method” (TMM), is mainly based on enhancing the scaling nature of the pore space in the ground-truth image. An arable sandy loam soil from a field in Scotland was packed into polypropylene cylinders that had a diameter of 6 The packed soil sample was imaged using a Metris X-Tek X-ray micro-tomography system at 160 Three 2-D slices were extracted from the full set image stack (260 slices) to test the 2-D Singularity-CA method by selecting slices with different spatial patterns and greyscale histograms with non-bimodal shapes. The threshold calculation from bimodal greyscale histograms is typically easier than is a calculation from non-bimodal histograms because two objects can be clearly identified in the former. However, we selected non-bimodal shapes because we wanted to test the Singularity-CA method in the most demanding situations. To assess the new proposed segmentation method, we performed a comparison with the following traditional segmentation methods: Otsu's method ( Otsu's method assumes the existence of a bimodal histogram, i.e., two different classes of pixels (object and background). The strategy of this method is to minimize the intra-class variance The Iterative method assumes that the histogram is the sum of two Gaussian distributions: background and foreground. If we define the background distribution as The Maximum Entropy-based method does not initially assume bimodal histograms. This method maximizes the total entropy sum of two classes ( A criterion that is used to compare segmentation methods when ground-truth information is available is the misclassification error (ME) ( The aim of the TMM is to construct a ground-truth soil image that is composed of an air-filled pore space (hereinafter named pore space) and the background, which includes, as a novelty, a pebble space. The pebble space tries to simulate the pebbles or granules of high intensity that typically appear in CT soil images. Each step performed in the TMM is detailed as follows: A randomized Sierpinski multifractal is used to construct both the pore space and the pebble space. Both spaces are built by truncating a Sierpinski multifractal. Before truncating, a low-pass filter is applied to the multifractal measure, with the aim of transforming the measure into a smooth function. The pore space is created by truncating the multifractal using a threshold or level of 1 (GV We define the average GVs of the pore, the background and the pebble space. Therefore, the skeleton of the final greyscale histogram is defined at this stage. When these GVs are close to each other, unimodal and low-contrast histograms, which are characteristic of CT images, are produced. Gaussian white (GW) noise is added with the aim of simulating the variability of the soil. Different signal-to-noise ratios (SNRs) may simulate different levels of variability. At this stage of the method, we simulate a synthetic soil image with high resolution. The previous image is filtered using a simple low-pass filter. In this manner, a spatial noise correlation is induced. The effect is a reduction in the image contrast, which is characteristic of the CT images. In measurement theory, a mass distribution of a measure A singularity map is defined as the locus of the points To calculate the singularity maps, we follow  If the spatial variability of the exponent Positive singularities with Fractals and multifractals share the property of self-similarity, in which the spatial variability of the feature being studied is scale independent. Therefore, fractal models commonly result in power-law relationships between the variables of interest. The C-A method ( In the context of fractal/multifractals, concentration (ρ) is related to singularity exponents (α) through expression (11); in this case, the C-A method gives us the following expression: When the singularity distribution follows a fractal model, this power-law relation has only one exponent. The C-A method occasionally does not meet the simple fractal model because different power laws apply to the study area. In this case, we can assume that the spatial variability is multifractal instead of fractal; thus, the different slope-change values in the log-log plot can be considered a separation among different sets. The Continuous Wavelet-Transform (CWT) of a function It is often sufficient for ψ(t) to satisfy the zero-mean property and quickly decay to a wavelet. We may interpret the CWT as a mathematical microscope that is able to enhance some properties of a function. We follow the original Mallat's theory ( The WTMM method has proven to be a very effective method for determining the location of singular points in a function ( The new “Singularity-CA” method is primarily based on the existence of self-similar properties in the concentration or density variable (the average intensity of an area centred on the point of interest). When we obtain the cumulative distributions of concentration by using the C-A method, these self-similarities are reflected by linear segments (power-law relationships) in a log-log plot. Different exponents resulting from the plot reveal that there are different sets with self-similar properties in the whole set. The values of the exponents are related to the geometrical fractal dimensions and the singularity exponents ( The implementation of the new segmentation method was performed using Matlab® R2013a and is detailed below: The first step is to transform the greyscale image to an intensity concentration map. To do so, singularity maps are calculated, where the singularity exponents reflect the concentration strength of each point of the image. First, we define a measure μ over the image. The easiest definition of a measure for a square set S( We use the windows-based method ( The side, The singularity map gives information about two well-differentiated areas: the area with pixels with The second step consists of applying the C-A method. We calculate the cumulative distributions of the α values (singularity exponents). We define the area constituted by When we obtain log-log plots, linear segments (power-law relationships) appear with their respective slope-change points. At this point, we cannot accurately locate the position of these points. We solve this problem in the following step. The third step consists of locating the slope-change points using the WTMM method. We take advantage of its ability to detect singular points in a function. We use a null second-moment wavelet that is referred to as the Mexican hat. This type of wavelet detects points with a local maxima curvature. The WTMM method accurately finds all of the slope-change points that we obtained when using the C-A method. Finally, we select as the segmentation threshold the first slope-change point with a singularity exponent (horizontal axis value) > We used one synthetic soil image to test the Singularity-CA segmentation method. We also used three soil samples with different porosities corresponding to three slices from the available CT image stack. We applied the Singularity-CA method to these soil images and compared the results with the following segmentation methods: Otsu's, Iterative and Maximum Entropy. We show an example of a synthetic soil image using the TMM with a GV range from 0 to 255. A randomized Sierpinski multifractal was obtained using a multiplicative cascade process ( All selected soil samples (synthetic and real) have two common features: they do not show bimodal histograms, and they are low-contrast images (for better visualization, we improved the contrast in the figures through “Contrast Stretching” ( The top of The main statistical parameters of all singularity maps, which are the median, mean, variance, skewness and kurtosis, are shown in We calculate the threshold of the pore space by applying the C-A method to the values of the singularity exponents. First, we calculate the cumulative distributions of the singularity maps and obtain the graphics shown in We find the location of the slope-change points by using the WTMM method. In particular, we use a Mexican hat wavelet. The thresholds provided by the Singularity-CA segmentation method are marked within each graph and have values of We compared the Otsu, Iterative, Maximum Entropy and Singularity-CA segmentation methods with respect to the ground-truth soil image. In The porosity was calculated based on the binarized images shown in CPSDs and CPSADs were obtained from the binarized images of Regarding the shape of the graphs shown in The Otsu, Iterative and Maximum Entropy methods have very similar CPSDs (see the left side of The Singularity-CA method overestimates the total number of real pores particularly the number of small pores, as seen in the CPSD (see the left side of The particular behaviour of the Singularity-CA method to detect more pores and typically smaller pores is due to its sensitivity in detecting anomalous concentrations; i.e., this method is able “to see” more borders than other methods. The criterion used to assess the quality of segmentation was the ME parameter. We compared the Singularity-CA method with the traditional Otsu, Iterative and Maximum Entropy segmentation methods. In The porosity was calculated based on the binarized images shown in From the GV statistics shown in The CPSDs and CPSADs shown in In the case of samples 1 and 2, this method results in values similar to Otsu's method with respect to the smallest size values; then, Otsu's frequencies decay much more rapidly than the frequencies in the Singularity-CA method. In all samples, we can also observe how the Otsu, Iterative and Maximum entropy methods always resulted in the largest pores (see Feature extraction in CT soil images is an important factor for pore space detection because these types of images typically have low levels of contrast and because they often do not have a bimodal GV histogram, which is required for classical segmentation methods to obtain a good result. This paper proposes an alternative method to detect the air-filled pore space in CT soil images within a fractal framework and is referred to as the “Singularity-CA” method. Unlike image segmentation methods based on global thresholding, this method allows us to quantify the local scaling property of a 2-D GV map in the space domain and to determine the intensity of local singularities. This method can be used as a high-pass filtering technique to enhance the high frequency patterns that are typically considered anomalies on 2-D maps. This paper also proposes a new method for creating simulated or synthetic soil images and is referred to as the “Truncated Multifractal Method” (TMM). This method is able to replicate the scaling nature of the pore space and can simulate low-contrast images with non-bimodal histograms, which is characteristic of CT soil images. Three different bidimensional CT real images (three slices) and one synthetic soil image were selected to test the Singularity-CA method. The binarized images were compared to the original greyscale images with overlapping pore borders on the later. The fit of these images with the low grey values from the original image was excellent. Then, these images were compared with commonly used segmentation methods: Otsu, Iterative and Maximum Entropy. The image comparison was based on the total porosity, CPSD, CPSAD and ME. In the case of the synthetic soil image, the visual perception was confirmed by the analysis, i.e., the Singularity-CA method extracts medium and large pores with a good fit compared with the ground-truth image but inserts new small pores due to its ability to amplify anomalous concentrations. These new small pores did not significantly increase the total porosity, so the new method achieves a value that is similar to the real value. Regarding the ME parameter, the Singularity-CA method offers the same level of quality as the Otsu, Iterative and Maximum Entropy methods. In the case of the three CT soil slices, the Otsu and Iterative methods achieve a greater porosity than does the Singularity-CA because they obtain the biggest pores. Conversely, the Singularity-CA method results in a greater frequency of smaller sized pores and a greater number of pores. These results agree with the results obtained in the synthetic case. In all soil samples, we find that the Otsu and Iterative methods overestimate the total porosity and that the Singularity-CA method overestimates the total number of real pores, particularly the number of small pores. A great advantage of the new proposed method is that it detects medium and large pores with a good fit. However, further research is required to discriminate between real and incorrect small pores, inserted by the new method, as it could influence conductivity, diffusivity, or dispersivity of the pore network in several simulation models. Once the Singularity-CA method is improved to avoid this overestimation of small pores, its implementation to three-dimensional image analysis and the study of the air-filled and water-filled pore space will be possible with little computational effort. Authors thank to SIMBIOS team at the University of Aberday for the soil images provided for this study. We are grateful to the reviewers and the editor's comments that improved the quality of this manuscript. This research has been partially funded by the Ministerio de Economía y Competitividad (