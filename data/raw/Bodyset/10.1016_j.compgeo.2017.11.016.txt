In this study, a heterogeneous discrete element model of granite was built considering different mineral contacts, different mineral grains, and the percentages of minerals which were obtained from analysis of the gray-scale values of the rock picture. First, the contacts and grains parameters were fixed by simulating triaxial compression and fracture toughness tests. Then, the permeability of the numerical model was calibrated on constant head tests. Finally, a coupled hydro-mechanical code was used to investigate the hydraulic fracturing under different conditions, considering the influences of permeability, fluid viscosity, fluid injection rate, boundary stress, pre-existing cracks, heterogeneity and weak layer.Hydraulic fracturing is an important technology in gas/oil exploitation Numerical simulation technique is a convenient and economical method to investigate hydraulic fracturing mechanism in rocks. Several numerical methods have been developed and adopted by researchers to study the complicated hydraulic fracturing process. For continuum based numerical methods, Pogacnik et al. It is well known that the hydraulic fracturing process in rocks is significantly affected by the fluid parameters (i.e. viscosity and injection rate), the rocks parameters (i.e. strength, permeability, initial defects and heterogeneity), and the boundary conditions. Although various studies have been carried out in this area, there is still lack of systematic investigations on the effects of these parameters on hydraulic fracturing. The study in this paper presents a heterogeneous discrete element based numerical simulation approach for hydraulic fracturing analysis, considering the influences of the aforementioned parameters; thus, is the innovation of the study. The paper is organised as follows: first, constitutive models of matrix, contacts, and hydro-mechanical coupling are introduced; second, parameters for contacts and grains are calibrated by triaxial compression and fracture toughness tests; third, permeability of the numerical model is calibrated by the constant head tests; finally, considering the influence of permeability, fluid viscosity, fluid injection rate, boundary stress, pre-cracks, heterogeneity and weak layer, the hydraulic fracturing in granite is predicted based on the calibration results. A two-dimensional Universal Distinct Element Code (UDEC) was adopted to build the numerical model. Therefore, all simulations were performed in two dimensions. The grain-based DEM model (the diameter of the disc is 75 mm) in which different mineral components of biotite, quartz, and feldspar are randomly distributed is formed by about 2000 elastic and unbreakable Voronoi blocks whose equivalent diameter is about 1 mm (as shown in In the numerical model, the blocks (i.e. basic mineral grains) are assumed to be impermeable and the fluid which is assumed to be incompressible can infiltrate only through the contacts (i.e. microcracks). Therefore, hydro-mechanical analysis can be performed as follows. First, the fluid infiltrates into the contacts. Then corresponding fluid pressures are added on the contacts and affect stress and displacement fields around the contacts. Thereafter, apertures of the contacts increase with increasing fluid pressures. Once the failure conditions of the contacts are satisfied, initiation or further propagation of the microcracks will be triggered, resulting in changes of corresponding stress field, displacement field, and fluid pressures in the DEM model. A schematic diagram of the considered fluid flow through the contact, as well as the corresponding crack deformation, is shown in During the simulation, the contact network represents the possible flow network due to the assumption that only along the contacts the fluid flow is possible. In Eqs. Once flow occurs in the contact, fluid pressure will be induced inside the domain of the contact. During the period of one time step, the new domain pressure can be calculated by the following equation: If the new domain pressure calculated by Eq. In order to keep the numerical stability of the explicit fluid flow algorithm, the time step cannot exceed the following thresholds: The actual contact force and normal stress caused by fluid pressure (see The relation between hydraulic aperture of contact and contact normal stress is shown in By combining Eqs. Internal programming was employed for the calculation cycle to investigate the hydraulic process with variation of fluid pressure. In order to have sufficient calculation steps to achieve force balance during the hydraulic fracturing process, the time step was chosen according to Eq. Different mineral components in the digital image of specimen have different colors. Colors can be inverted into gray-scale values. Based on the method proposed by Chen et al. A series of mechanical tests for Kirchberg II granite were carried out in the rock mechanical laboratory of the Geotechnical Institute of TU Bergakademie Freiberg, Germany. The testing and the simulation results are listed in where Based on the triaxial compression tests simulations which were realized by authors (see The CSTBD diameter and the central crack length are 75 mm and 45.75 mm, respectively. According to the method proposed by Dong et al. The geometry of the numerical model is identical to the lab specimen. The mineral grains and contact parameters are chosen from The simulation values of fracture toughness were calculated using Eqs. The permeability of rocks was obtained by constant head tests during which the difference of the fluid pressure between the upper and lower ends of rock specimen was kept constant to enable the fluid flow. The permeability can be calculated by the following equation The contact aperture parameters have a great influence on the permeability of the DEM model according to the assumption that the fluid can only infiltrate into contacts. Therefore, the permeability of the DEM model must be calibrated before hydraulic fracturing simulation. In addition, during permeability calibration, the input mechanical parameters of the rock ( Distribution of the fluid pressure and flow rate in DEM model during a constant head test is shown in The calibration results for the permeability are shown in The flowchart shown in  Considering different permeability ( The hydraulic conductivity can be expressed by the following formula: Some simulation results for the number of failed contacts and the fluid pressure at the injection point are shown in  In order to investigate the effect of fluid injection rate, a slower injection process was simulated. During the simulation with reduced injection rate (see No. 6 in The value of the parameter In order to investigate the influence of boundary stress, pre-existing cracks, heterogeneity and weak layer on fracture patterns, a series of numerical simulations are conducted with the input parameters listed in No. 3 of With different mineral percentages, the corresponding hydraulic cracks around borehole in granite under the boundary stress of A weak layer, which is characterized by the parameters in  A heterogeneous discrete element model of granite is proposed considering the mineral composition at gain size level. The grain structure of the numerical model is set-up based on digital image analysis of granite samples. The contact and grain parameters are calibrated by triaxial compression and fracture toughness tests. Hydro-mechanical coupling is introduced to simulate hydraulic fracturing considering fluid infiltration into the contacts (microcracks). Based on the calibration results of a series of basic mechanical tests and permeability tests, hydraulic fracturing simulations under different conditions were performed considering the influence of permeability, fluid viscosity, fluid injection rate, boundary stress, pre-existing cracks, heterogeneity, and weak layer. According to the simulations, the following conclusions can be drawn: The stress-strain behaviour, the damage process and fracture pattern of granite under pure mechanical loading can be well simulated by the proposed DEM approach. When other parameters are kept constant, crack initiation and breakdown pressure decrease with increase of permeability, but increase non-linearly with increase of fluid viscosity or fluid injection rate. The difference between breakdown pressure and crack initiation pressure increases with increasing fluid viscosity or fluid injection rate, but decreases with increasing permeability. Crack initiation and breakdown pressure can be controlled by choosing suitable fluid viscosity and fluid injection rate. For the constant fluid injection rate, the time until breakdown is reached increases with increasing permeability, but decreases with increase of fluid viscosity or fluid injection rate. Fluid infiltration area in high permeable rock is larger than that in low permeable rock and the fluid infiltration area is smaller for fluids with high viscosity compared to those with low viscosity. If fluid viscosity is high, crack tip positions in granite are in advance of the penetrating fluid. The fluid infiltration area at small injection rate is larger than that at high injection rate. If the hydraulic conductivity is the same, the fluid infiltration area is almost equal in size. Primary stress field, orientation of pre-existing cracks, heterogeneity and weak layer (or fault) influence hydraulic fracture propagation. It should be noted that all simulations were performed in two dimensions. Therefore, mode-III fracturing and the complex crack surface could not be simulated. In addition, considering the distribution of different minerals, this numerical method cannot be directly applied to field scale simulation due to requirement for extremely large number of blocks and huge computational cost. However, with the development of computer hardware and parallel computing technique, the field scale application of this numerical method may be realized in the future. This work was supported by the