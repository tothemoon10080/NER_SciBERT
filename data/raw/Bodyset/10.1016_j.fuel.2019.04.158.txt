Injection of gas mixtures (CO2, N2) into coal seams is an efficient method to both reduce CO2 emissions and increase the recovery of coalbed methane. This process involves a series of complex interactions between ternary gases (CH4, CO2, and N2) co-adsorption on coals, mass transport of two-phase flow, together with heat transfer and coal deformation. We develop an improved thermo-hydro-mechanical (THM) model coupling these responses for gas mixture enhanced CBM recovery (GM-ECBM). The model is first validated, and then applied to simulate and explore the evolution of key parameters during GM-ECBM recovery. Schedules of constant- and variable-composition injection are optimized to maximize CH4 recovery and CO2 sequestration. Result shows that the injected gas mixture displaces CH4 through competitive sorption and accelerates the transport of CH4 within the coal seam. The consistency between the modelling and field results verifies the feasibility and fidelity of the THM model for effective simulation key processes in GM-ECBM. Permeability evolution is strongly influenced by the combined effects of CH4 desorption induced matrix shrinkage, CO2/N2 adsorption induced matrix swelling, thermal strains, and compaction induced by changes in effective stress. During ECBM, reservoir permeability first increases due to pressure depletion and CH4 desorption, then dramatically decreases due to matrix swelling activated by the arrival of the CO2/N2 mixture. CH4 pressure decreases rapidly at early time due to displacement by the injected gas mixture, and then deceases slowly in the later stage. The sweep of N2 accelerates CH4 desorption and subsequent transport, and hence promotes a decrease in reservoir temperatures distant from the injection well even prior to the arrival of CO2. CH4 production rate during GM-ECBM exhibits a decline-increase-decline trend and usually has an elevated but delayed CH4 production peak compared to primary recovery. A higher CO2 Langmuir strain constant reduces the critical CO2 composition in the injected mixture when reaching the threshold of well shut down. An improved balance between early threshold (N2) and large matrix swelling (CO2) can be achieved by injection beginning with low CO2 composition and following with a sequential increase of CO2 composition. In studied cases, the gas recovery ratio of the optimal variable-composition case reaches 68.4% compared to of 59.4% pure CO2 and 64.2% of optimal constant-composition cases, indicating a higher efficiency of variable-composition injection.Coalbed methane (CBM) recovered from unconventional reservoirs is an important source of energy that accounts for approximately 6–9% of the current natural gas production As an effective technology for carbon utilization, enhanced coalbed methane (ECBM) with CO Gas-mixture enhanced coalbed methane recovery (GM-ECBM) involves interactions among the ternary gases (CH Due to the low sorption capacity and low dynamic viscosity of N The following describes an improved thermo-hydro-mechanical (THM) coupling model for simulating GM-ECBM recovery, including the interactions of ternary gases non-isothermal co-adsorption, mass transport by diffusion in matrix and two-phase flow in fractures, and thermal transfer, as well as the coupling of these fields with the evolution of porosity and permeability. This model is firstly validated by history matching GM-ECBM involves injection of a ternary gas mixture (CH The following assumptions are adopted for the model The coal seam is considered as an elastic single-permeability and dual-porosity (fractures and matrix pores) material; Ternary gases (CH The free gases conform to the ideal gas law; The fractures are saturated by the ternary gases and water mixtures; and The mass transport of ternary gases in coal seam are treated as three steps in tandem: CH The mass transport process of gas and water mixture during GM-ECBM recovery is shown in In addition, change in effective stress induced by CH Porosity and permeability are key factors influencing the flow of gas and water within coal seams (relations (8), (10), (14), and (16) in By considering CH The ad/desorption of the ternary gases mixture on the coal matrix usually causes strain swelling/shrinkage. The volume strain induced by gas mixture sorption is the sum of strain induced by each gas component. The extended Langmuir-type equation is used with the gas sorption induced strain The coal seam is a dual-porosity medium which contains both coal matrix and fractures ( The volumetric strain of the REV can be expressed as Substituting Eq. The ratio The evolution of fracture porosity is dependent on the change in effective stress-induced fracture deformation: Substituting Eq. The cubic law is applied to define a relationship between fracture porosity and permeability: According to Dalton’s law, the pressure of a ternary mixture of non-reactive gases in matrix pores and coal fractures can be defined as The ideal gas law gives the relationship between gas pressure and density for the free ternary gases, for each component: The gas volume adsorbed per unit mass of the coal under variable temperature can be calculated using a modified Langmuir model Ternary gas transport in the coal matrix is a diffusion-dominated process, which is driven by the concentration gradient and obeys Fick’s law. The gas exchange rate of each component can thus be expressed as The gas content in the coal matrix consists of both free and absorbed gas components. CH The desorption time Substituting Eqs. In the coal reservoir, the pre-existing CH By considering the Klinkenberg effect within the porous medium and gas-water two-phase flow, the velocity of gas flow in the fracture can be defined by the Darcy’s law as The relative permeability curves in the porous medium are often expressed with the Corey functions Substituting Eqs. Absent a source term, the coal reservoir gradually dewaters with the progress of gas injection and production. For two-phase flow and mass conservation, the equation for water transport in the fractures is defined as Also, the velocity of water can be expressed by the Darcy’s law as: where By substituting Eqs. The deformation induced by the pressure of fluid mixture in both matrix and fractures (effective stress), together with shrinkage/swelling induced by gas sorption/desorption and thermal effects defines the total strain as The strain-displacement relation (the Cauchy formula) and stress equilibrium relations can be expressed as Substituting Eq. The coal skeleton, ternary gas mixture and water are contained within a single representative elementary volume (REV). When the gas mixture is injected into the coal seam, heat transfer occurs due to the variation in internal energy caused by temperature change, strain energy by coal deformation, isosteric heat by gas de/adsorption, as well as the heat convection and conduction among the solid-gas-water phases. The thermal equilibrium within the REV is may be expressed as The effective specific heat capacity is determined by the density and the specific heat capacity of all components within the coal mass: The effective heat convection coefficient of the coal mass is related to the convective heat transfer of the gas and water mixture in the fracture: The effective thermal conductivity of the coal mass is a linear combination of the thermal conductivity of each component: We assemble the governing equations representing the different fields (Eqs. This model comprises of a series of partial differential equations (PDEs), which can be implemented into COMSOL multiphysics software using the pre-arranged geomechanics module together with eight general form PDE interfaces to obtain numerical solution. Primary CBM recovery involves the transport of a single gas phase and water in the coal seam. In order to compare the gas production efficiency between primary and enhanced CBM recoveries, a model of single gas transport is required. Here, we simplify the already established THM model Eq. The simplified THM model for primary CBM recovery, Eq. The established THM model is first validated against primary CBM recovery The Fanzhuang area represents a typical block for CBM development in Qinshui Basin – one of the earliest developed and most commercially valuable basins in China. Coal seam #3 is characterized by uniform thickness, high gas content and shallow burial depth and is considered as the primary target for CBM recovery from the Shanxi formation Two sets of simulations are performed in this section: (i) the first is to validate the established THM model through history matching with Well spacing varies from 334.67 m to 537.98 m, with shallow vertical CBM wells usually arranged on a rectangle pattern of 300 m × 300 m–500 m × 500 m Coal seam #3 is characterized by an average thickness of 5–6 m, a relatively high permeability of 0.01–10 mD, a rich gas content of 8.27–21.54 m As shown in The simulated results for primary CBM recovery are compared with the historic production data from the Qinshui Basin. Sun et al. (2016) reported the historic production rate from an unstimulated production well subject to pressure depletion recovery We simulate the GM-ECBM recovery using the injection gas mixture 15%:85% CO    However, due to the large volume and thermal mass of coal As demonstrated in Eq.    The rationale for injecting the N The following investigation is completed with two scenarios representing injection at either constant-composition or with time-varying composition of the gases. Sensitivity studies are first applied to recover the optimized CO The composition of the injected gas mixture is retained constant during the entire process of GM-ECBM recovery. According to the CO As N  We extract the CO  As anticipated, the variation of cumulative CO We have previously discussed the effect of Langmuir strain constant of CO In this approach, the composition of the injected gas is changed after every period (step) of 1000 days. Defined by the variation of CO  Cases 15–17 begin with a relatively low CO As illustrated in The cumulative CH Note that the optimal composition of the injected gas will vary among different sites and geological conditions, and the impacts of well spacing, injection pressures and other parameters, including the definition of economic conditions controlling recovery. However, an optimal variable-composition schedule for gas mixture injection can always be determined according to the actual situation. An improved thermo-hydro-mechanical (THM) model is developed to couple the responses of coal deformation, mass transport of a mixture of ternary gases (CH Injection of gas mixture (CO As gas pressure drops due to production, CH Permeability evolution is controlled by both gas mixture injection and methane production. Before the arrival of the CO An increased Langmuir strain constant to CO The fully coupled THM model developed in this work not only offers useful framework to investigate important technical challenges associated GM-ECBM, but can also be applied to other forms of unconventional gas extraction, and other fields such as CO The author(s) thank the editors and anonymous reviewers for their comments and suggestions. This research was financially supported by the Notes The authors declare no competing financial interest.