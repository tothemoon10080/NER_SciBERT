A coupled extended finite element method (XFEM) is presented here for modeling propagation of fluid-driven fractures in different regimes including toughness- and viscosity-dominated regimes. The extended finite element method allows to model growth, and coalescence of arbitrary discontinuities (fractures) without requiring the mesh to conform to discontinuities nor significant refinement near the fractures. Fluid-driven fractures propagation is a coupled, nonlinear and non-local problem with moving boundary conditions. The proposed method is based on the extended finite element method with modifications to incorporate variable stress singularity at the crack tips for the transition between toughness-dominated and viscosity-dominated regimes. These modifications consist of enriched functions that are initially inspired by the asymptotic analytical solutions. The standard extended finite element approximation is enriched by adding near tip asymptotic solutions just for displacements, however the proposed method introduces a consistent enriched function for fluid pressure calculations close to the fracture tips to catch the singularity. Additionally, a technique is presented to remove singularity issue for required numerical integrations. Green's functions concept is proposed here to expedite calculations. To circumvent violation of partition of unity and parasitic terms in the approximation space induced by the blending elements at the edge of the enriched domain, the ramp function is utilized to improve the convergence rate. Stress intensity factors are calculated using a new contour integral method that can handle cases with different tip singularities. The proposed technique is verified with the cases that have analytical solutions. Some examples are presented to show the advantages of this technique in comparison to the regular XFEM.During the last two decades, a gigantic amount of natural gas has been discovered in low-permeability reservoirs around the world. Because of the low permeability of these formations and the low conductivity of the natural fracture networks, stimulation techniques such as hydraulic fracturing are necessary to make economic production possible. Hydraulic fracturing is a common technique not only for enhancing hydrocarbon production, but also for improving geothermal energy extraction. A primary difficulty of accurate modeling hydraulic fracturing problems comes from the coupling of the fluid flow inside the fracture and rock deformations, which provide the fracture's width. Inaccurate calculations can lead to hazardous consequences, for instance, excessive fluid pressure may lead to creating a cylindrical crack around the wellbore. In recent years, there has been a return to analytical solutions to achieve a better understanding of different fracture propagation regimes. Analytical solutions are limited to very simple planar geometries in a homogeneous isotropic medium, but they provide insight into asymptotic behavior of the fluid pressure distribution near the fracture tips. Analytical solutions have revealed the controlling role of two energy dissipative processes in impermeable formations: fracturing of rock (toughness) and dissipation in the fracturing fluid due to friction (viscosity). Depending on competition between the dissipative processes, the singularities at the fracture tips may vary. Adachi To address above-mentioned challenges, several numerical methods using the finite element methods, Lecampion We chose the XFEM to solve the hydraulic fracture propagation problem, because it particularly provides the opportunity to model fracture growth without mesh updating during the fracture network evolution. Furthermore, the XFEM does not require a high mesh concentration near the crack tip to catch the singular behavior of stress field at the crack tips. The hydraulic fracturing process involves coupling three processes: (i) mechanical deformation of the formation caused by fluid pressure inside the fracture, (ii) fluid flow within the fracture network, and (iii) fracture propagation. The plane strain geometry is utilized in this paper. We consider a regular body Ψ bounded by a smooth curve The weak form of The last equation in The motion equation for the fluid inside the hydraulic fracture after neglecting the gravitational forces can be written as After putting It is assumed that at the initial time the fracture is closed, i.e. Choosing the second boundary condition is crucial as it affects the strategy for solving coupled elasticity and fluid flow equations. In this paper, the secondary boundary condition is that at the fracture tip ( Another possible way to determine the second boundary condition is assumed that there is no flow at the fracture tip, so Note that the zero-flux boundary condition is applicable if and only if the fluid fills the whole fracture volume and no fluid lag exists between the fluid front and fracture tip. In the case of fluid lag, fluid pressure in the lag zone will be zero, or more precisely, equal to the pore pressure in the formation. The last process that should be addressed is the criterion for fracture propagation. The required propagation condition at the moving tips is that the Mode I stress intensity factor ( Crack propagation analysis requires the evaluation of stress intensity factors (SIF) at the fracture tips to determine the length, velocity and orientation of the propagation. For this purpose, we used the Contour Integral Method (CIM), a super-convergent extraction method, as the associated results converge to the exact values as fast as the strain energy converges to its real value. CIM is based on using extraction function and computing energy functional from finite element solutions. The functional can be a stress at a point or a stress intensity factor. This method is originally developed by Babuŝka and Miller Now we solve The test functions The weak form of the equilibrium equation and traction boundary condition is The extended finite element method is a partition of unity method. In the partition of unity method, the trial space of finite element method is enriched with non-polynomial shape functions that are related to extra activated degrees of freedom. Therefore, in developing extended finite element for the crack growth problem, it is necessary to identify elements that require activation of extra degrees of freedom. Such elements are in the vicinity of the fracture tip and elements that surround the remainder of the crack. Whereas other elements in the model do not require activation of extra degrees of freedom. Now the solutions are set up for each node set, the displacement approximation for any point in a regular body Ψ can be written as follows  A loss of partition of unity is present in the blending elements, which have both tip-enriched and non-tip-enriched nodes, leads to accuracy reduction. To preserve the partition of unity property for the whole domain, which is required to have an optimal convergence rate for the XFEM, a treatment is required for the blending elements. The ramp function approach of the corrected XFEM of Fries For when To find a displacement field across the hydraulic fracture, the displacement approximation defined by By substituting the defined strain approximation Partially F-enriched elements do not satisfy the partition of unity principle on which the XFEM is built. This problem may lead to a degraded convergence rate. To dissolve this issue, the tip enrichment (F-enrichment) is not only used for crack-tip elements but also for all the nodes within a certain radius, The expression for external forces, which includes cohesive forces and inside crack forces is The external forces in our problem are fluid pressure inside the crack and possible far field stresses (like tectonic stresses). The standard Galerkin finite element method is utilized to solve Considering zero width at the fracture tip that is described by Based on the derived weak form, However, due to the presence of pressure singularity at the fracture tip in the viscosity-dominated regime and for transition from the toughness to viscosity-dominated regimes, we considered additional enrichment for the fluid pressure at the tips to address it. The fluid pressure inside the fracture can be approximated as a function of coordinate along fracture length, Since the integrals In the case of more complicated fluid models, for instance, power-law fluids, In the above asymptotic analysis, leak off was not included. Therefore, the validity of the proposed method is limited to impermeable formations. Additionally, the proposed method is applicable for cases with linear elastic fracture mechanics. This explains the failure of brittle materials since assumptions of linear elasticity and small deformation/displacement near the crack tip can be used. It is possible that fluid pressure would be smaller than the closure stress in some parts of the fracture and still have positive fracture width. Additionally, negative net fluid pressure does not mean negative absolute pressure. Only in very small parts of the fracture near the tips, fluid pressure gets very large negative values. Similar to singularity of stresses at the crack tips, this singularity is considered to happen in an area with too negligible size to violate the laws of physics. The zero fluid pressure boundary condition has been used by several authors. One of the complications of the zero flux or only Neumann boundary condition is that the stiffness matrix The elastic fluid flow and fracture propagation equations should ideally be fully coupled to solve this problem. In this part, an algorithm is introduced to solve the elasticity and fluid flow equations given by Picard iterations modify both fluid pressure and the fracture width at each iteration so the fracture width used for fluid flow calculations is not exactly the fracture width used in calculations of the fracture mechanics model. To avoid this discrepancy in the presented model, only net fluid pressure is modified using One limitation to the Picard iterations technique is that the initial value used in the iteration must be close to the correct answer. However, using the fluid pressure from the previous step seems to be sufficient. It should be emphasized that in discretization of the problem, there is no need to have solid and fluid nodes to coincide with each other. In addition, to minimize the projection error between solid and fluid elements, it is better to choose elements of the same order. The stiffness matrix calculated by the XFEM is independent of loading and depends only on the fracture geometry. The XFEM stiffness matrix needs to be calculated once at the beginning of each time step. This leads to a significant saving in computation time. Then the Erdogan and Sih Two extra equations that represent the propagation criteria for the left and the right fracture tips ( However, the fluid pressure profile has a high gradient for the viscosity-dominated regime. Therefore, a more accurate integration technique must be used for fracture propagation calculations. The Eq. The contour integral method (CIM) is used for stress intensity factor calculations. The CIM can be applied for different orders of crack tip singularities, therefore, the toughness and the viscosity-dominated regimes as well as transition between these two regimes can be handled using this technique. The time step in simulations is determined from the total mass balance equation Detournay We examined our proposed numerical method in two extreme propagation regimes. They are the toughness-dominated regime Based on the analytical solution for the toughness-dominated regime, The solution for the zero viscosity case is given by The fracture width and fracturing fluid pressure transform to dimensionless quantities by using In this work, the L For a constant injection rate of a Newtonian fluid, the XFEM numerical model shows good agreement with the analytical solutions for fracturing fluid pressure ( It is important to note that the model has been tested with different initial guesses for the pressure distribution inside the fracture, but the solution converges so rapidly the relative error between two consecutive iterations is less than 1%. The algorithm achieves results with less than 5% error in less than 10 iterations. The model is examined for different initial lengths for the hydraulic fracture to make sure that the results were insensitive to the initial length of the hydraulic fracture in the model, or the location of the initial fracture with respect to the finite element mesh. In the case of very low dimensionless toughness, the fracture toughness of the rock could practically be considered equal to zero. Essentially, the contribution of the fracture toughness of the rock is negligible in comparison to the viscosity role. The analytical solution exists for the viscosity-dominated regime when the fracture toughness of the rock is assumed to be zero. The first order approximation of the zero toughness solution is when The fracturing fluid dimensionless pressure inside the hydraulic fracture is plotted on Dependency of error for the proposed method on the mesh size is investigated in this paper for a prescribed fluid pressure. The problem is consisted of two meshes. The first mesh is consisted of quadratic triangular elements for solving stress and displacement fields in the medium. The second mesh is consisted of quadratic, one-dimensional elements for solving the lubrication equation to find fluid pressure along the hydraulic fracture. Mesh dependency is investigated by keeping the ratio between the characteristic length of triangular elements and length of one-dimensional elements constant. The L The L The extended finite element method has been adapted to solve a non-linear coupled problem of fluid driven fractures in different propagation regimes. Propagation regimes depend on fracturing fluid viscosity, fracture toughness of the rock, and fracture length. Asymptotic analysis has shown different order of singularity of fluid pressure and displacements at the tip of hydraulic fractures for different propagation regimes. In the presented method, accuracy of the extended finite element method is improved even with the coarse mesh by adding the enrichment functions honoring these singularities to displacement and pressure fields in the nodes close to the fracture tips. The proposed methodology successfully couples elasticity and fluid flow equations, propagation criterion, and takes into account different singularity behaviors at the fracture tips. The ramp function approach is also utilized to treat blending elements to improve accuracy of the results. A new methodology is developed to calculate stress intensity factors at the fracture tips with variable singularity using the contour integral method. We validate our coupled extended finite element model with the analytical solutions for two extreme propagation regimes. Our model shows very good match with the closed form analytical solutions that are available in the literature. The main advantage of the proposed numerical model is the ability to simulate accurately fluid-driven fracture propagation by accounting different influences of dissipation mechanisms during hydraulic fracture propagation. Denis Klimenko would like to thank The We start from the equilibrium equation for two-dimensional elasticity. The Airy stress function Therefore, in the neighborhood of reentrant corners (  Similarly for the Mode II, it can be shown that We assume that the edges at Substituting By knowing the coefficient, the near-tip asymptotic expansion for displacements can be written using The extraction function for a given mode is defined by taking the same expression of the asymptotic expansion but using the negative eigenvalue associated with the mode. Substitute Using Now, we want to derive formulas for B We assume that displacement field V satisfies the equilibrium equations, and after standard manipulations Now consider the integral on the left-hand side of Let Now, we consider right-hand side of After putting Therefore, adopting  After using local Cartesian coordinates instead of polar coordinates, from Similarly it can be derived for Mode II as Elements of the local stiffness matrix for the fluid flow equation around the fracture tips for the viscosity-dominated regime as well as the transition regime can be written as Let us consider the integral We can see that if we assign “a” = “0”, “b” = “L”, “x” = ”r”, and plug in By substitution To make the integration interval in After substituting Then integral