The bubble size distribution at the froth surface of a flotation cell is closely related to the process condition and performance. The flotation performance can be reasonably predicted through continuous measuring the bubble size distribution by a machine vision system. In this work a new watershed algorithm based on whole and sub-image classification techniques is introduced and successfully validated by several laboratory and industrial scale froth images taken under different process conditions. The results indicate that the developed algorithms, in particular the sub-image classification based segmentation algorithm, can accurately and reliably identify the individual small and large bubbles in the actual froth images, which is often problematic.It is well known that the bubble size distribution at the froth surface of flotation cells gives much valuable information regarding the process conditions (i.e. air flow rate, slurry level, pH, reagent dosage and slurry solids %) and performance (i.e. recovery and grade) Accurately delineating the bubbles in the actual froth images is a challenging task owing to several reasons. The froth images comprise a large number of closely packed bubbles with weak edges which are not easily detectable. A wide range of bubble size and uneven illumination are other difficulties in accurate segmentation of froth images into bubbles In recent years, efforts have been made to develop efficient and speedy algorithms for measuring bubble size distribution in the froth images. The most common techniques include watershed algorithm based segmentation Segmentation is one of the most effectively techniques for extracting the bubble boundaries in the flotation froth images Jahedsaravani, Marhaban, & Massinaei Wang et al. In the texture spectrum approach, features are extracted by scanning the image with a 3 In the current research study, a new segmentation technique based on classification of the froth images is developed and validated by a number of froth images taken at different process conditions. It is well known that the large and small bubbles in the froth images are often subject to over- and under-segmentation, respectively. In other words, fine details extracted from the froth images with the large bubbles may lead to over-segmentation, so this additional information must be carefully removed from this type of froth images. On the other hand, for the froth images with the small bubbles elimination of such fine details may results in loss of the bubble edges and under-segmentation, so these details should be completely preserved in these cases. Thus, for the actual froth images with a wide range of bubble sizes a balance should be made between removal and preservation of specific details. As a result, it is expected that classification of the froth images based on the bubble size before any further processing will significantly improve the performance of segmentation. In a previous paper by the present authors, a marker based watershed algorithm by extraction of three sets of markers was developed for segmentation of the froth images The proposed approach is a marker-based watershed algorithm coupled with a neural network classifier. The watershed segmentation algorithm is based on the detection of white spots (total reflectance formed above the bubbles, are known as white spots where the pixel intensities are considerably higher than other parts of bubbles) and markers. The size of white spots is proportional to the size of bubbles and the number of white spots is inversely related to the number of bubbles. Hence, it is expected that an accurate estimation of the bubble size distribution to be achieved by measuring the size and number of the white spots A block diagram of the developed algorithm is shown in Therefore, the size of pre-median filter is updated and the size of post-median filter is determined. Afterwards, a new pre-median filter followed by an adaptive threshold value is implemented and first sets of markers are extracted. Second and third sets of markers are extracted by applying some morphological operators on the smoothed original froth image. All sets of markers are superimposed to the topographic surface of the froth image obtained by inverting the processed froth image and then the topographic image is filtered by the post-median filter. Finally, watershed transform is applied to the smoothed topographic surface. In this way the developed marker-based watershed algorithm could adapt itself to the given froth type to achieve an accurate segmentation. In fact, the watershed algorithm is first adapted to the froth type (class) and then makes a decision to preserve or remove the detailed information accordingly. It should be noted that elimination and preservation of information is accomplished by using a two dimensional pre- and post- median filter. Pre-median filter is directly applied to the original image whereas the post-median filter is applied to the topographic surface Sensitivity of these non-linear filters to changes in intensity of each pixel (i.e. edges) is less than linear filters, so removal and preservation of the detailed information is easily accomplished by such filters. Actually, the median filters are square matrices scanning the whole image in order to smooth it. Smoothing of the scanned images is dependent mainly on the size of median filters. In other words, image details that can be easily maintained by a small median filter, will be excluded by a big median filter To have a comprehensive database, 81 froth images captured from a laboratory flotation cell operating at different conditions (i.e. air flow rate, reagent dosage, pH, slurry solids %) were used Artificial neural networks have been recognized as a powerful tool for pattern classification problems. The froth image classification was performed by using a Self-Organizing Map (SOM) or Kohonen neural network. SOM is a type of neural network that is trained using unsupervised learning to produce a two-dimensional topological order preserving feature maps of the data. These networks typically consist of an input layer which is connected to a two-dimensional Kohonen layer SOM benefits from a competitive learning algorithm for classifying the data set with any number of features into as many clusters as the number of neurons. The two-dimensional maps of size 2 Consequently, four different pairs of median filters consistent with four different image classes were defined. The small median filters were utilized for the froth images with small bubbles (e.g. class A in Visual and operational characteristics of four identified froth classes are listed in In the previously described approach, the whole froth image was first classified according to the extracted white spots into four classes and then the watershed algorithm was applied to the classified image. Since the actual froth images comprise a wide range of bubble sizes, the target images may be subject to mis-classification and mis-sementation. The suggested solution to deal with this problem is sub-image classification followed by watershed segmentation. In this method, the original froth image was first divided into several sub-images and then each sub-image was classified based on the assigned white spot features (i.e. the number and mean size of white spot in each sub-image) As mentioned before, the whole froth image consisting of closely packed small and large bubbles cannot be unambiguously classified by human visual system, hence an unsupervised neural network classifier was employed. However, the sub-images are mainly composed of bubbles with more uniform sizes and narrower size distributions. Thus, a trained supervised neural network can more correctly classify the froth images based on their white spot features. A total of 320 sub-images captured from the video images were labeled into five classes by a couple of human operators. Then, the number and mean size of the white spots constituting the sub-images were determined. Finally, a neural network classifier was trained to classify the sub-images based on the assigned froth features. The labeled froth classes and their corresponding white spot features are given in A three layer feed-forward neural network with three inputs and five outputs was designed as a classifier. It should be noted that 60% of data were randomly used as training set and 40% as test set to evaluate the generalization capability of the trained network. The number of input variables to the neural network is three (i.e. mean size of white spots, number of white spots, total area of white spots) and the number of outputs is five (i.e. five froth classes). Determination of the number of neurons in the hidden layer is of central importance in developing a fast and reliable neural network. The number of network parameters and degree of freedom of the developed model are a function of the number of hidden neurons. In other words, a low number of the hidden neurons results in under-fitting in the training set (i.e. high bias) and poor generalization capabilities, and a large number of the hidden neurons leads to over-fitting in the training set and poor generalization capabilities (i.e. high variance). To improve the classification efficiency of the developed neural network and avoid under- and over-fitting, the test data set was divided into two sets as validation and testing (i.e. 60% training data, 20% validation data, 20% testing data). In order to obtain the optimal neural network, the number of hidden neurons was changed and several networks were trained. Eventually, the neural network with the lowest error between the actual and modeled values was chosen. The optimal number of hidden neurons was 16. The confusion matrices representing the neural network performance are shown in  The proposed algorithms were validated by a number of laboratory and industrial scale froth images taken at different process conditions. The first data base was image data taken from a laboratory flotation cell operated under various process conditions To quantify the accuracy of the developed algorithm, the automatically segmentation results were compared with the manually segmented froth images. Comparison between the automatic and the manual segmentation results indicates that the developed algorithms can accurately and reliably identify the individual small and large bubbles in the actual froth images, which is often problematic. Furthermore, sub-image classification of the froth images results in improved segmentation performance particularly for images with more heterogeneous or wider bubble size distributions. In other words, the froth images containing large and small bubbles are more subject to mis-classification and hence mis-segmentation by the whole image classification algorithm, while such images can be more accurately categorized and delineated by the sub-image classification technique. Undoubtedly, the suggested sub-image classification algorithm requires more computation time which is natural because there is always a trade-off between running time (speed) and performance. The potential of other algorithms to speed-up the classification process can be evaluated, which is the subject of ongoing work. The promising results indicate that the developed algorithm for bubble size measurement together with the previously proposed algorithms for extraction of other froth features (i.e. froth color, velocity and stability) In this research study a new adaptive watershed segmentation algorithm based on the whole and sub-image classification techniques was developed and successfully validated by a number of froth images taken under different process conditions. In the whole image classification based segmentation approach, the froth image was first classified (by a neural network classifier) according to the size and number of the extracted white spots and then an adaptive watershed algorithm was employed to detect the bubble boundaries. In the sub-image classification based segmentation method, the froth image was initially split into several sub-images and then each segment was classified (by a trained neural network) based on the measured white spot features. Analysis of the manually and automatically segmented froth images revealed that the proposed sub-image classification algorithm is capable of accurately and reliably delineating the individual small and large bubbles in the actual froth images, which may be mis-classified and wrongly segmented by the whole image classification based segmentation algorithm. In other words, a significant improvement in classification and segmentation performance, in particular for the froth images with heterogeneous bubble size distributions, was achieved by using the sub-image classification based segmentation approach.