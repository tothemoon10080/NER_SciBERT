Complex polymetallic mining projects with multiple processing streams tend to require tight blending constraints, with different operational and processing targets. These blending requirements are generally not focused solely on metal grade, but rather on a set of geometallurgical variables that affect the performance of the operation and its ability to meet targets and maximize project value. Because of this, a multivariate destination policy is developed here, based on coalition formation clustering (a line of study of cooperative game theory), which avoids the use of cut-off grades and defines where material is sent by accounting for the value and relation of groups of blocks being processed together. This allows improving investment decisions as a result of optimizing project performance, because the variables that affect blending and processing requirements are actively accounted for in the optimization process. A case study on a copper-gold mine with six destinations is presented, where the method proposed shows significant improvements in meeting processing requirements and increases the expected net present value by 5.6% when compared to a traditional method. This shows that complex processing requirements can be accounted for and respected without any loss of project value.In mining, orebodies define the design and the value of a project, based on the attributes of the rock and the operational characteristics of the project, the processing streams used along the life-of-mine (LOM), and the range of profit produced by the project. The over-simplification that arises in the conventional optimization of mining projects is the assumption that a block of materials (mining block) has an intrinsic dollar value, and that a given cut-off grade will define what is ore (to be processed for profit) or waste. However, there are various other parameters that effect the dollar value of a block. For example, the presence of deleterious elements (such as arsenic), hardness, spatial location (which will define when the material can be extracted), and so on, will all have an effect over block value. Because of this, these pertinent variables should be considered during planning to optimize to which processing stream a mining block will be directed to and with this, to realistically evaluate the project's performance and value. This issue takes precedence in the increasingly complex deposits being presently developed, where processing plants’ and refineries’ performance depends greatly on how their different requirements are met (for example, blending constraints must be met in order to maximize metallurgical recovery). These hard constraints force the project to be optimized around them, making it necessary to consider from an early stage not only grade uncertainty, but also all the variability of relevant geometallurgical characteristics (rock hardness, material types, etc.) that affect the configuration of the different processing streams (i.e., energy consumption, metallurgical recovery, etc.). However, because of the high costs associated with exploration, the limited information obtained from sample composites and the inherent flaws in sampling and testing systems, obtaining reliable geometallurgical information is difficult and requires cross-disciplinary efforts ( Geological uncertainty extends to uncertainty in the supply (materials) to various processing streams, giving special importance to the process of re-distributing the extracted rock between the available destinations, so that the different constraints are met. This reordering and delivering process, referred to as This paper aims to tackle this problem by developing an optimal destination policy mechanism for polymetallic deposits in order to increase project value and the reliability of project evaluation. This destination policy is based on a multidisciplinary implementation, combining mine planning with coalition formation theory using the “Shapley Value” (which is a line of study of cooperative game theory), and considers within the decision process the deposit's geometallurgical variables, its blending requirements, and the uncertainty related to its geology. These considerations increase project value by improving the performance of the available processes, meeting the project's planned targets, as well as taking maximum advantage of the limited resource. The next section of this paper reviews the existing literature on mining optimization, focusing on destination policy, as well as on the inclusion of geometallurgical variables. The description of the proposed method follows, with a brief introduction on game theory, and the concepts that will be used. The proposed method is then tested over a real life copper gold deposit with six possible destinations, showing that including complex variables of the processed material in the optimization not only allows the project to meet blending constrains, but also increases final project value without even changing the extraction schedule. Conclusions and future work follow. Thus far, the decision of defining where each block is sent after extraction is based mainly on two aspects: defining certain ranges of grades accepted at the different destinations (commonly referred to as cut-off grades, Some work has been done in designing dynamic policies, such as in Few methods have been presented in the literature that dynamically account for the destination policy in the optimization process and, at the same time, develop a global mine plan. The multistage stochastic optimization method developed by As the complexity of mining projects increases (in terms of the number of deposits, processing streams, and elements), traditional destination policies, such as the ones presented in the previous paragraph, lack in their ability to consider the multidimensional aspect of the mining optimization problem. Recent work on destination policy has extended from cut-off grade optimization to integrate multivariate distributions, making them more adept for complex mining projects. An example of this clustering process is presented in However, in Thus far, geometallurcial research has been increasing, with a general agreement from the industry of its importance in a project's performance. However, most of this information is lost through the planning process, or is not used to its full extent, leaving a gap when it comes to actually using this information in the mine plan to obtain a truly optimized operation that considers the whole flow of material. The method proposed herein aims to integrate this information into the planning process by creating clusters of blocks with two objectives. On one hand, the method aims to reduce the computational cost inherent in mining optimization, which is mainly caused by the large amount of blocks encountered in real-size mining projects; and on the other hand, the method seeks to take into account not only metal grade and recovery, but also the relation of a wider range of geometallurgical variables. The latter variables help to obtain more reliable values of the aggregates of blocks in the different processing streams. This happens because the final recovery and metallurgical performance will depend on the total material being processed together and not on the individual properties of each block. Once material arrives at the plant, there is no longer any perception of a “block”, but rather a blend of extracted material. Geometallurgical variables involve any rock property that has a positive or negative effect on the business’ ultimate value ( Some work has been done to incorporate these variables into the mine design and planning steps, such as in   With respect to the realistic representation of geometallurgical variables,  It is known that geometallurgical variables directly affect the performance of the downstream processes of a mining complex. Because of this effect, the approach presented herein includes these variables directly into the destination policy mechanism by implementing a multivariate selection method that defines which blocks are processed together at a given place, given their combined multivariable attributes. This is done by implementing coalition formation algorithms (which are an extension of cooperative game theory), which are defined as grouping mechanisms that are able to account for multiple non-linear attributes. This way, the proposed method considers not merely the main elements’ grade in a block, but rather a set of properties of the rock, which have an effect on the downstream processes, and groups them according to their processing preferences. This new clustering algorithm will better maximize project value, and will achieve production targets while taking into account the complex blending requirements. A global overview of game theory and, in particular, the concept of coalition formations is presented next, together with its relation to the destination policy of a mining project. Game theory is the study of strategic interactions between decision makers ( There are multiple ways to divide revenues, but the most recurrent form studied is such that the value allocation is “fair” (  Given two coalitions Given two disjoint coalitions It can be noted that the third axiom highlights the non-linear nature of the characteristic function (and thus, of the coalition formation process), enabling the representation of complex relations between the players. It can also be noted that, if a parameter in the definition of the characteristic function is negative (i.e. the cost Eq. Main drawback of the Shapley Value is that it cannot be calculated in polynomial time, as the calculation of all permutations of players in a game is computationally very expensive and becomes unmanageable as the number of players increase. Because of this, The basic idea behind these In the case of mining, the goal is to define the destinations of blocks being mined on a given year. Therefore, parallel with Liu et al.’s (2011) paper, each family may be represented by each block being extracted on the same period and each holiday destination can be seen as a block's possible processing destination, such as a stockpile, waste dam, mill, leach pad, etc. This leads to a major problem given that a block is considered as a player in the game and mining projects usually entail millions of blocks coming from multiple mines, while the applications presented by To reduce the computational cost of the formulation even further, it is proposed to pre-process the deposit by clustering similar blocks together. In this case this is done by using k-means++, where blocks being extracted in the same period which belong to the same initial cluster can be treated as families of blocks and optimized together, as presented in Another pre-processing mechanism that could be considered is to remove from the destination policy optimization blocks, which are clearly waste (defined by low concentrations of any or all of the valuable elements encountered), and can be sent directly to the waste dump. However, there are two points that might hinder this removal. Firstly, due to geological uncertainty, a block may appear as waste in some simulations, but not in others, adding ambiguity to the robust definition of a block as “waste”. Secondly, even though a block may appear to be waste, as different geometallurgical characteristics are considered, the block can still contain other valuable elements needed for meeting blending constraints. Together with the clustering mechanism, as a measure to reduce the complexity of the initial formulation, in the following case study the mine production schedule will be assumed fixed. In other words, it will be known which blocks are to be extracted in each period. This way, the focus of the optimization process will be to determine the different coalitions involved on a period, where a coalition represents the blocks that are sent to each destination (as all blocks scheduled to be extracted in one period must be sent somewhere). This will be done over multiple simulations of the orebody model in order to account for the geological uncertainty of the deposit. When applying the coalition formation process to a mining complex, the different possible targets of the cooperative game will correspond to the possible processing destinations of the mining system. In a mining system, the characteristic function of a coalition can be considered as the “willingness” of a given destination to pay for the set of blocks contained in the coalition. This means that each destination may have a different characteristic function that is specified to meet the individual processing constraints, and the players forming the coalition will define the value of the characteristic function In general, the characteristic function is a linear combination of a set of Given this definition, a simple definition of the characteristic function could be to calculate the discounted revenue of the cluster in a given destination as an addition of the parameters that define mining revenue. This formulation is presented in the following equation: A possible alternative is to generate independent characteristic functions for each set of comparable attributes of a block, obtaining a characteristic function The following case study corresponds to a copper-gold deposit, extracted as an open pit with a mining capacity of 25 Fifteen different geological simulations where generated using direct block simulation (DBSim) ( A diagram of the system is also provided ( Each of these processing streams have a variable recovery curve dependent on the head grade fed to the destination. These curves are presented in For the SM: Accepts material types 1 and 2. Processing capacity of 3Mtpa, plus a stockpile of 1Mt capacity. Sulphur sulphide concentration must be within 6.5% and 8.2%. Arsenic content must be below 0.2 to maximize recovery. Processing cost of material type 2 is 10% more expensive to process than material type 1 due to rock hardness. On the other hand, the SHL: Accepts material types 2 and 4. Processing capacity of 8Mtpa. Copper concentration must be over 0.2% at all times. It must be recalled that these requirements must be met simultaneously, where the value generated will proportionally correspond to the quality of material being sent to be processes together in the different destinations. To track the different requirements, a set of characteristic functions will be defined according to the requirements of each main destination, which will help define the most valuable coalitions to process together. Based on the previous mining complex and the different requirements to maximize processing performance, the following characteristic functions have been defined. In this case, these functions are divided between: Global functions applied over all destinations, which correspond to: Maximize revenue (function of recovery and metal content of material processed together) Minimize deviation from production targets Sulphide mill functions: Minimize deviation from sulphur sulphide concentration limits (6.5–8.2%) Minimize deviations from arsenic maximum concentration (<0.2%) Minimize processing costs (function of material types of rock being processed) Sulphide heap leach Minimize deviations from copper's minimum concentration (>0.2%) Each of these characteristic functions is applied over all the pairwise combinations of players. However, due to the computational intensity of performing all of these combinations, two pre-processing steps are applied over the data to reduce the computing time of the algorithm. Firstly, all scenarios of the whole deposit are clustered together using k-means++ to group blocks into families, making the material type the same for all blocks within a family. Then, together with k-means++, material-type/destination connections between families and unfeasible processing destinations are cut, in order to avoid performing calculations with blocks that are not allowed to be processed in a particular destination due to their material type. This relationship is depicted in In the initial application of the method, the deposit is assumed to have a fixed schedule. Then, the extracted material of each period is optimized into coalitions to be sent to the best available destination given the system constraints and the maximization of revenue. To compare the algorithm proposed with current practices, a base case is developed using the traditional method, where blocks are sent to a certain destination given their particular attributes (copper and gold grades in this case). It can be seen that, in the case of the mill, there is a 20% shortfall in tonnage along the LOM, showing that the base case is not really realistic when faced with geological uncertainty. In the case of the SHL, the shortfall is less, but there is still difficulty to meet production targets. The other destinations are not presented, as their capacities were unlimited and no geometallurgical constraints where applied over them. The main constraints considered in this case study were: the sulphur sulphide blending limits in the mill, arsenic's maximum concentration in the mill, copper's minimum grade in the SHL. The comparison between the base case and the proposed method for these three constraints are presented next, where (a) presents the base case's performance (left side figure) and (b) presents the results obtained by optimizing the destination policy with the proposed coalition formation algorithm (right side figure). In the case of arsenic (As), the mill requires a concentration lower than 0.2% in order to maximize metal recovery and obtain optimum processing performance. The base case presented in Finally, Considering a discount rate of 10% over the 10 year LOM, The case study presented shows a novel contribution to the mining optimization process by developing a formulation that uses cooperative Game Theory techniques to include non-linear relations between the wide ranges of variables that are involved in the optimization of a poly-metallic mining complex. From the previous results, one can see that, by optimizing the distribution of the material being extracted in a multi-variate non-linear manner, it is possible to improve project value and ensure that the processing streams work at their planned targets (i.e. blending constraints, metallurgical recovery, etc.). The distribution mechanism was done by a coalition formation algorithm that considers not only the attributes of each extracted block, but also the characteristics of the cumulative material being processed together (i.e. the interrelation of the blocks’ attributes). By doing this, it was shown that all blending constraint requirements are improved without compromising the grade of valuable metals (as shown in In addition, this case study shows that priority grouping can be successfully implemented to reduce the computational cost of calculating the Shapley Value (as in Liu et. al, 2011), making it applicable at the mining scale. It was also shown that coalition formation through the maximization of the Shapley Value is able to generate value by considering multiple categorical and qualitative variables within the grouping process. This finding can be widely applied over different areas, even though computational advances are making it possible to work with increasingly complex models, due to the high amount of data available and being produced, it is crucial to have effective grouping and classifying systems that account for complex non-linear relations of the data at hand. The previous study shows promising results, however, a clear extension of this work would be to consider the scheduling problem within the optimization process. Future research will focus on this by extending the current formulation to consider the selection of material that is extracted in every period and, at the same time, ensuring that blending constraints are met while maximizing project value. Together with this, the presented destination policy distributes the extracted material as if all of the blocks extracted in a given period where processed together, which is an oversimplification, as a period corresponds to a year and extracted material is treated on the daily. Because of this, future research will seek to apply this method in a shorter-term, making the “cumulative processed material” a more realistic amount. Another limitation of the presented study is that geological and geometallurgical uncertainties are not directly integrated into the coalition formation, only in the optimization process. To extend this approach, we propose as future research to implement a stochastic Shapley Value ( This will provide a distribution of the Shapley Value of a block belonging to a coalition C, and the coalition formation process can aim at maximizing the Applying this stochastic coalition formation method to mining optimization would provide a scenario-independent destination policy, which would facilitate the operational applicability of the method (as geological scenarios do not aim at locally forecasting reality, but rather at representing a set of possible scenarios and particularly, the spatial variability present in the simulated variable). The actual material encountered at the moment of extraction will probably deviate from its simulations, making it necessary to have a fast classification mechanism to define material when it is extracted, and decide its destination based on this classification. A crucial problem with this approach is that must be studied further is the misclassification errors, as the simulated material type of a block can vary from one scenario to another, making a block infeasible to process in a given location in one scenario, but not in others. This study presents a multi-objective destination policy for extracted material, which is developed through grouping blocks according to their associative attributes by using a A case study of a copper-gold deposit with six material types and six possible destinations showed that the proposed PG method is able to account for the value generated from extracted material with multiple categorical and continuous attributes, and optimize its processing destination so that not only all processing and blending constraints are met, but also project value is maximized. This promotes a more realistic representation of the project value. Results from the case study showed that the proposed algorithm was able to reduce As concentrations and improve SS ranges in the mill feed material without reducing Cu grades nor final revenue, as the PG destination policy delivered a project with an NPV 5.6% higher than the base case, which was (developed by traditional methods that violate blending constraints. These results were obtained by redistributing the extracted material, as the schedule was assumed constant for both BC and PG cases. The work in this paper was funded from the