This paper concerns a real-world application of an expert system to the automation of a zinc hydrometallurgy plant. The leaching process in zinc hydrometallurgy involves dissolving zinc-bearing material in dilute sulfuric acid to form a zinc sulfate solution. The key problems are to determine and track the optimal pHs of the overflows of the neutral and acid leaches, and to ensure the safe running of the process. This paper describes an expert control and fault diagnosis scheme that solves those problems. The expert control is based on a combination of steady-state mathematical models and rule models, and the fault diagnosis employs rule models with certainty factors and a Bayes representation. A real-world application of this scheme showed that it not only improved the control performance, but also correctly diagnosed faults.Leaching, purification and electrolysis are the three basic processes in zinc hydrometallurgy. Leaching, which is the first process, involves complex chemical reactions for dissolving zinc-bearing material in dilute sulfuric acid to form a zinc sulfate solution ( Conventional methods are mainly based on manual operation and mathematical models. It is difficult to obtain the desired performance by such methods because of the complexity of the chemical reactions involved ( This paper concerns a combination of expert control and fault diagnosis for the leaching process. Empirical knowledge and data on the process show that the key control problems are to determine and track the optimal pHs of the overflows of the neutral and acid leaches, and that the key fault diagnosis problem is to provide information about the cause and location of any fault that occurs as well as the appropriate countermeasure. Empirical knowledge and statistical data show that there exist pHs for the overflows of the neutral and acid leaches under certain operating conditions such that, when the overflows have those pHs, the resulting zinc sulfate solution meets the given standard and a maximum amount of the soluble zinc in zinc-bearing material is dissolved. These pHs are called optimal pHs in this paper. This paper describes an expert control and fault diagnosis scheme employing the model-based expert technique developed by Wu, Nakano and She (1999a) to improve control performance and ensure safe operation of the process. The scheme employs an expert controller to determine the optimal pHs and a fault diagnosis module to perform on-line and off-line fault diagnosis. It is based on a combination of steady-state mathematical models and rule models for expert control, and rule models with certainty factors and a Bayes representation for fault diagnosis. The models are constructed from empirical knowledge, statistical data and chemical reactions for the process. A conventional single-loop control technique provides tracking control of the optimal pHs. This paper mainly describes the scheme and a real-world application. The leaching process considered in this paper is shown in The zinc-bearing material is delivered to a flotation cell and mixed with an oxidized iron solution and spent electrolyte containing sulfuric acid that is returned from the electrolytic process. The solution is delivered to four water-powered classifiers. The overflow is pumped to the 1st neutral leach tank, and the underflow is milled by four ball mills and pumped to the 1st tank of each acid leach series. The spent electrolyte is also added to the neutral and acid leaches. The chemical reactions are carried out in the tanks. The solution is then sent to thickeners to settle. The overflow from the neutral leach is sent to the purification process in the form of a neutral zinc sulfate solution, and the underflow is added to the 1st tank of each acid leach series. The overflows from the acid leaches are pumped to the 1st tank of the neutral leach, and the residues are sent to the residue treatment process. The concentrations of zinc and the major impurities in the neutral zinc sulfate solution from the neutral leach should satisfy the standards given in In addition, an important consideration in process control is to dissolve as much of the soluble zinc in the zinc-bearing material as possible. This requires optimal conditions for the chemical reactions. Generally speaking, these conditions are influenced by many factors, such as the pH and temperature of the solution, the duration of the reaction, and the composition and particle size of the zinc-bearing material, etc. However, for steady-state operation, the main factors are the pHs of the overflows of the neutral and acid leaches. So, the key to process control is to determine the optimal pHs, and to track them. Empirical knowledge and data on the process show that the pHs of the overflows have to be in the range of 4.8–5.2 for the neutral leach and 2.5–3.0 for the acid leaches to guarantee the optimal conditions. An expert control and fault diagnosis scheme based on the hierarchical configuration shown in The scheme employs an expert controller, a fault diagnosis module, three single-loop controllers and measurement equipment. The expert controller optimizes and coordinates process control. It determines the optimal conditions for the chemical reactions involved in the process and obtains the corresponding optimal values of the control parameters of the process. Coordination means that the optimal values of the control parameters must be in accord with the actual states of the chemical reactions involved in the neutral and acid leaches. Empirical knowledge and statistical data on the process show that the pHs of the overflows of the neutral and acid leaches are the main factors influencing the chemical reactions. They are considered to be the main control parameters in the proposed scheme. The optimal pHs can be achieved by adjusting the amount of spent electrolyte added to the leaches. So, the main control inputs are the flow rates of the spent electrolyte added to the neutral and acid leaches, and the main control outputs are the pHs of the overflows of those leaches. The expert controller employs a reasoning strategy that combines steady-state mathematical models and rule models of the process and uses forward chaining and model-based chaining to determine the optimal pHs; and it computes the target flow rates of the spent electrolyte that yield the optimal pHs, so that the composition of the neutral zinc sulfate solution meets the given standards, and as much of the soluble zinc in the zinc-bearing material is dissolved as possible. The fault diagnosis module monitors the process. It sends information to the expert controller that restricts the control activities to the safe range, for example, by ensuring that the pHs of the overflows of the neutral and acid leaches are not abnormally high or low. These limitations are also used as constraints in the optimization and coordination of process control. The fault diagnosis module uses an expert reasoning strategy based on rule models with certainty factors and a Bayes representation, and combines forward and backward chaining to perform on-line and off-line fault diagnosis, so as to ensure safe operation. As shown in The three single-loop controllers track the target flow rates by means of PI control algorithms to ensure that the actual pHs match the optimal values. The variables controlled in the single-loop controllers are the flow rates of the spent electrolyte to be added to the 1st neutral leach tank and the 1st tanks of the two series of acid leaches. The single-loop controller controls the amount that the valve is opened to adjust the flow rate of spent electrolyte. Measurement equipment is used for the on-line measurement of process parameters such as pHs, concentrations, flow rates, etc. The design of the expert controller is based on the model-based expert technique developed by Wu, Nakano and She (1999a). The controller determines the optimal pHs by means of rule models, and computes the target flow rates through a combination of steady-state mathematical models and rule models. There exist optimal pHs in the leaching process that ensure that as much of the soluble zinc in zinc-bearing material as possible is dissolved on condition that the concentration standards of the zinc sulfate solution are met. The values of the optimal pHs vary with time. Conventional control methods choose fixed pHs in the allowable ranges in advance and track them. So, they cannot guarantee that the resulting pHs of the overflows are optimal. To solve this problem, it is indispensable to determine the optimal pHs in the given ranges at every moment to obtain the optimal chemical reaction conditions. Empirical knowledge and data revealed that the optimal pHs are mainly related to the following factors: the composition and particle size of the zinc-bearing material; the temperature of the solution; and the concentrations of zinc and impurities in the overflows of the neutral and acid leaches. However, it is very difficult to express the exact relationships among the optimal pHs and these factors with mathematical models. To obtain the optimal pHs, production rule models of the If–Then form ( The If part contains the zinc content ( The rule models for determining the optimal pHs are constructed based on empirical knowledge and data on the process. Some typical rule models for the neutral leach are given in In The rule models for the acid leaches are similar to those for the neutral leach. The algorithm that determines the optimal pHs is divided into two stages as follows: Stage 1. Select the initial pHs based on    Stage 2. Adjust the initial pHs based on the concentrations of zinc and impurities to obtain the optimal pHs.  The pHs of the overflows are adjusted by controlling the flow rates of the spent electrolyte added to the leaching process. So, it is crucial to determine the target flow rates of spent electrolyte that yield the optimal pHs. In the calculation, conventional control methods are based solely on mathematical models obtained from the main chemical reaction equations. However, those models do not consider other chemical reactions, variations in the reaction conditions, or the incompleteness of the reactions. Leaching can be considered to be a steady-state chemical process because it is generally run within a specific operating range. Based on this observation, this paper proposes a method for determining the target flow rates that yield the optimal pHs by a combination of steady-state mathematical models and rule models describing the process. The chemical reactions occur mainly in the leach tanks. The steady-state mathematical models are based on the assumptions that the zinc-bearing material and the solution in the tanks are agitated and completely mixed, and that the temperature of the solution is uniform. The mass balance principle (e.g. For steady-state operation, d Combining The rule models for determining The following algorithm computes the target flow rate that yields the optimal pH for the neutral leach. An algorithm similar to the one for the neutral leach computes the target flow rates for the acid leaches. The expert controller consists of a characteristics-capturing mechanism, a database, a knowledge base, an inference engine and an user interface. The characteristics-capturing mechanism captures the characteristics of the process data from the measurement equipment and the three single-loop controllers. These characteristics are matched up with the conditional parts of rule models. The database stores process data from on-line measurement. It also stores the quality requirements for the neutral zinc sulfate solution, statistical data on the process, reasoning results from the inference engine, etc. The knowledge base stores the rule models, steady-state mathematical models, empirical data, calculation laws, etc. The inference engine acquires data from the database, and then uses both the knowledge in the knowledge base and a reasoning strategy that combines forward chaining ( The user interface is used to configure and edit the knowledge base, and to display and print data, graphs, reasoning results, etc. The basic structure of the fault diagnosis module is similar to that of the expert controller. It is shown in The knowledge base stores the rule models, Bayes representation and empirical data for fault diagnosis; the causes and locations of faults; the corresponding actions to be taken; etc. The database stores data from measurement equipment and input by operators, statistical data, reasoning results, etc. The inference engine uses forward chaining and backward chaining to perform fault diagnosis. The user interface displays reasoning results and gives off fault alarms, and is also used to send commands to the expert controller to remove faults. The main functions of fault diagnosis are to detect and diagnose faults in important equipment, such as the leach tanks, pumps, etc., and to indicate the causes and locations of faults as well as suitable countermeasures. The fault diagnosis module is designed to provide support for the safe running of the process. It monitors the process in real time to detect any unusual states, such as excessive flow rates or temperatures, abnormally low pHs, etc. In addition, it also accepts fault facts and data input by operators. Based on unusual states and fault facts and data, the module performs on-line and off-line fault diagnosis. Then it outputs the diagnostic results, which indicate the cause and location of the fault as well as suitable actions to be taken. The module uses rule models with certainty factors and a Bayes representation, and combines forward chaining and backward chaining. The procedure is as follows: Based on the diagnosis, the operators find the cause and location of the fault by checking the site, and take suitable countermeasures to correct the fault. According to type of the fault, operators can also send commands through the user interface to the expert controller to correct it. An important aspect of the design of the fault diagnosis module is the construction of rule models, which are based on the empirical knowledge of engineers and operators as well as on empirical data and statistical results of past fault countermeasures. The procedure for constructing rule models is shown in The main variables that can be measured on-line are as follows: the flow rate of the spent electrolyte, zinc-bearing material, oxidized iron solution, and overflows and underflows of the classifiers, leach tanks and thickeners; the temperatures of the solutions in the acid and neutral leaches; the pHs of the overflows and underflows of the classifiers, leach tanks and thickeners; and the operating states of the flow regulation valves and the pumps. Unusual states are generally represented by +1 (above the allowable range) or −1 (below the allowable range), but for valves and pumps they are represented by +1 (closed for a valve and stopped for a pump). Some typical rule models are given in A two-step forward chaining strategy is used for on-line fault diagnosis: First, select a fault mode based on information about the unusual state; and Then extract the cause and location of the fault and a suitable countermeasure from the knowledge base. It follows from the above two steps that fault diagnosis using forward chaining requires a method of selecting the rule models and related data in the knowledge base according to the unusual state. The procedure from choosing a rule model executing it has three steps: marching, clash resolution and action. In our case, a clash-resolution strategy ( A backward chaining strategy based on the fault facts and data input by operators is used for off-line fault diagnosis. The inference procedure is shown in Assume that all possible fault modes are selected from among The designed expert control and fault diagnosis scheme was used in the leaching process of a nonferrous metals smeltery. As shown in The distributed computer control system runs under the Windows 98 operating system. The functions of the expert controller were implemented using a package of application programs written in the C++ language, while those of the 761 controllers were implemented through the configuration. It should be pointed out that the package of application programs used in the expert controller was specially developed for the electrolytic process. Compared with programs designed using the development platform of an expert system, our package has the advantages of quick execution speed and high efficiency, but also the disadvantage of a long development time. Special instruments are used to accurately measure different kinds of process data. More specifically, the pHs are measured with industrial pH meters, the concentrations with an X fluorescence analyzer, the flow rates with E+H electromagnetic flow meters, etc. The distributed computer control system is currently running in a nonferrous metals smeltery. It is an important part of the control of the overall hydrometallurgical zinc process. The optimal pHs and the corresponding target flow rates are determined by the expert controller, and the target flow rates are—tracked by the single-loop controllers. The results show that the pHs are kept in the optimal ranges of 4.8–5.2 for the neutral leach and 2.5–3.0 for the acid leaches, and that the concentrations of zinc and the major impurities (Cu, Cd and Co) in the neutral zinc sulfate solution meet the given standards ( In contrast, results for the conventional control show that it could only keep the pHs in the ranges of 4.0–5.8 for the neutral leach and 2.0–3.5 for the acid leaches, the concentration of zinc in the range of 120–150 For conventional control, it is clear that the pHs could not be kept in the optimal ranges, and that the concentration of zinc was relatively low and those of the impurities were relatively high. Compared with conventional control, statistical data shows that the expert control method proposed in this paper considerably cuts costs, makes the leach rate of zinc-bearing material 5.0% higher, and dramatically reduces the consumption of zinc-bearing material. This means that much more of the soluble zinc in the zinc-bearing material is dissolved. Regarding fault diagnosis, actual runs show that the percentage of hits is over 90% for on-line diagnosis and over 95% for off-line diagnosis. Fault diagnosis reduces the frequency of occurrence of actual faults to quite a low level because it pinpoints the cause and location of faults so that suitable countermeasures can be taken before the fault occurs. This paper has described an expert control and fault diagnosis scheme for the leaching process in a zinc hydrometallurgy plant. The results of actual runs show that the scheme not only provides effective control, but also ensures safe operation of the leaching process. The following conclusions can be drawn: The complex behavior of the leaching process can be described using a combination of steady-state mathematical models and rule models. The models are constructed based on the steady-state chemical reactions involved in the process and empirical knowledge and data on the process. Expert control that combines steady-state mathematical models, rule models, forward chaining and model-based chaining can be used to determine the optimal pHs of the overflows of the neutral and acid leaches and the corresponding target flow rates of the spent electrolyte added to the process. The conventional single-loop control technique is used to track the target flow rates. Fault diagnosis that employs rule models with certainty factors, a Bayes representation, forward chaining and backward chaining guarantees the safe running of the process. Expert control and fault diagnosis can be implemented by an expert controller and by a fault diagnosis module, respectively, in an industrial control computer. A real-world application has demonstrated the effectiveness of the scheme. The authors would like to thank Professor De-Yao Shen of the Central South University for his helpful direction, and engineer Xiao-Qing Zhu of the Zhuzhou Smeltery for his contributions to this project.