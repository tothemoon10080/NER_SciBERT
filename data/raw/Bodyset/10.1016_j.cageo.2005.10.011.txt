In geostatistical applications, the local distributions of the values of a regionalized attribute at unsampled locations can be assessed by nonlinear methods such as indicator or multigaussian kriging. Disjunctive kriging can also be applied in the framework of bivariate isofactorial models, for which there exists a complete family of functions (factors) with no spatial cross-correlations. This work focuses on the point-support models with polynomial factors and gives practical tips for the modeling of the univariate and bivariate distributions and for the implementation of disjunctive kriging, mainly in what refers to the convergence of the expansions into factors, the post-processing of the estimated statistics and the use of ordinary kriging.
                  The tools and concepts are complemented by a set of computer programs and applied to two case studies. The first one consists of topsoil samples measuring the lead concentration at a smelter site in Dallas, Texas. A gamma isofactorial model is fitted to these data and disjunctive kriging is used to map the local probabilities that the actual concentrations exceed a toxic threshold and to divide the smelter site into a safe and a polluted area. The second case study concerns the infestation of field crops by a caterpillar. A negative binomial model is used to characterize the number of bored stalk internodes and to assess the risk that this number exceeds given values.In application fields such as mining engineering, agricultural land management, air, soil and groundwater pollution studies, the practitioner often looks for assessing the risk that a regionalized attribute (e.g. the grade of a metal of interest, a soil property or the concentration of a contaminant) exceeds a given threshold at a specific unsampled location, conditionally to a set of neighboring sampled values. The geostatistical methods currently used to address this concern are conditional simulations ( Two reasons can explain the lack of interest in non-bigaussian disjunctive kriging: first, the mathematical formalism is not straightforward, and second, there is no comprehensive work on the subject the practitioners can refer to. These points are the motivation of this paper, which presents several families of bivariate distribution models suited to disjunctive kriging, explains how to fit and validate these models and provides computer programs to estimate conditional distributions and point-support transfer functions. Let us consider a univariate distribution, characterized by its cumulative density function (cdf) any polynomial basis, such as the monomials the set of indicator functions are complete for any discrete distribution ( In the geostatistical approach, the regionalized attribute is viewed as a realization of a random field Since any complete family can be expressed from any other one by linear operations, the result of Eq. The disjunctive kriging system requires knowing the univariate and bivariate distributions of the random field under study. Indeed, let us consider the example in which the indicator functions are chosen as a complete family: Performing simple indicator cokriging requires specifying the means of the indicator functions, which provide the univariate distribution:  their simple and cross-covariances, which give the bivariate distribution of any pair {  Disjunctive kriging amounts to the cokriging of a countable family of functions [Eq. Under the isofactorial hypothesis, the disjunctive kriging estimator of Furthermore, because the factors have no cross-correlation, the set of coefficients Let { This quantity is estimated by substituting a disjunctive kriging of the indicator variable for the conditional expectation: Therefore the pseudo-distribution plays the same role for the disjunctive kriging as the true local distribution for the conditional expectation. More details on the models and the steps to follow are given in the next sections. This work focuses on isofactorial models with polynomial factors. Although other models have been developed in the geostatistical literature ( The expression of the coefficients { The mosaic model is characterized by the fact that all the factor covariances are the same ( Under these conditions, disjunctive kriging [Eq. In these models the univariate distribution is standard Gaussian and the factors are the Hermite polynomials ( The Hermitian distribution is more general, since it corresponds to a mixture of bigaussian distributions, in which the correlogram is randomized: If These models are analyzed in The beta univariate distribution is defined on the interval [0,1] and depends on two positive scalar parameters { The combination of both parameters allows one to model a vast family of distributions. The factors are the normalized Jacobi polynomials of orders { This can be generalized in a Jacobi model, by randomizing the correlogram These models are presented in The factors are the normalized Meixner polynomials of orders { The binomial distribution is defined over a bounded set of integer values { Contrarily to the models presented so far, here there is a limited number of factors (Krawtchouk polynomials of orders { The Poisson univariate distribution depends on a single positive parameter The covariances of the factors (Charlier polynomials of order The discrete Jacobi model ( The integer The discrete anti-Jacobi distribution depends on three parameters: two positive scalars { The factors are the discrete anti-Jacobi polynomials of orders { Let Usually, the random field that represents the regionalized attribute under study, The case of discrete distributions may raise a problem, since one cannot transform a discrete distribution into another one, unless an untying procedure is defined. Two approaches can be considered: (1) the attribute has a continuous univariate distribution (with, maybe, a few spikes) and one accepts to discretize it up to a certain precision level; or (2) the attribute is discrete (for instance, it is a count variable) and no transformation is possible. In the second case, the univariate distribution must be directly modeled by one of the above-mentioned distributions. The choice of the model can be guided by a comparison between the data mean and data variance. In the Poisson model, the mean is equal to the variance; in the binomial model, the mean is greater than the variance, while it is lower in the negative binomial model. If none of the three previous distributions manages to fit the data histogram, one can use the more complete discrete Jacobi and anti-Jacobi models with their three parameters. Program HIST_TRA.M transforms the original data in a way similar to the one presented by Numerical approximations of the Gaussian, gamma and beta inverse cdf can be found in At the end of the data transformation procedure, one obtains a data set with the target univariate distribution and a conversion table between the original and transformed values. In general, for estimating the original attribute or a function of it, one needs the entire transformation function, not only the A first possibility is to view the conversion table as the representation of a stair function and fit a polynomial model by expanding this function into the factors ( This linear model can also be used for tail extrapolation if the transformed variable is bounded, by considering two additional points ( The parameters Once the transformation function is determined, the parameters needed to complete the modeling are related to the random variable In all the aforementioned isofactorial models, compute the sample indicator variograms associated with a set of thresholds { select a candidate parameter compare the sample indicator variograms with the theoretical variograms derived from the bivariate distribution with parameter  if the comparison is not satisfactory, return to step (2) or change the model. This procedure allows one to complete the parameter inference (choice of for absolutely continuous distributions: for discrete distributions: In the mosaic model, all the indicator correlograms are equal, so the test is easy to perform and does not require expanding the indicators into the factors. For the other continuous models, the expression of the coefficients    Most of the previous models use infinite expansions into the factors to express the disjunctive kriging estimator [Eq. Let us review the implications of a truncation, depending on whether the bivariate distribution corresponds to a “pure” model or a mixture of “pure” models. In the first case, the covariances of the factors are given by Eqs. For the non-pure models, some difficulties arise if the convergence of Eq. if if For most applications, based on the experience of the author, an order To make the estimator robust to local fluctuations of the mean without estimating this mean in each kriging neighborhood, one may trade simple kriging for ordinary kriging ( Program DK3D.M calculates the mean of the pseudo-conditional distribution (e-type estimate), the probabilities that the original variable is greater than or equal to one or several thresholds and the expected metal quantities above these thresholds, by applying formula Disjunctive kriging does not always give mathematically consistent estimates. For instance, the estimated conditional probabilities may increase with the threshold or lie outside the interval [0,1] ( Since the factors have no spatial cross-correlation [Eq. Together with the kriging variances of the first factors, this expression requires the knowledge of the prior variance of The proposed routines are ASCII scripts written in MATLAB language (version 4.0 or later) and can be used with either 2D or 3D data. Three main programs are provided: HIST_TRA.M transforms a set of original data to values that follow a pre-specified univariate distribution. CHK_BIVA.M calculates the indicator variograms associated with given thresholds, under a bivariate isofactorial model. This routine is helpful for validating the bivariate model and for choosing its parameters. DK3D.M performs local estimations of point-support transfer functions by disjunctive kriging. A detailed description of these programs is given in the next subsections. Program HIST_TRA.M transforms the original data and can account for declustering weights. The input parameters are the following:   1=standard Gaussian 2=standard gamma 3=beta 4=negative binomial 5=binomial 6=Poisson 7=discrete Jacobi 8=discrete anti-Jacobi   The outputs of this program are:   Program CHK_BIVA.M computes the theoretical indicator variograms under a given isofactorial model and can be used to validate the bivariate distribution model. The entries are:   1=nugget 2=spherical 3=exponential 4=cubic 5=Gaussian 6=stable with parameter 0.5 7=quadratic 8=cardinal sine 9=pentaspherical    2=Hermitian model 3=mosaic model 4=bigamma model 5=Laguerrian model 6=beta model 7=Jacobi model 8=negative binomial model 9=Meixner model 10=binomial model 11=Krawtchouk model 12=Poisson model 13=Charlier model 14=pure discrete Jacobi model 15=general discrete Jacobi model 16=pure discrete anti-Jacobi model 17=general discrete anti-Jacobi model      The conventions for the angles are the same as in GSLIB (  Program DK3D.M calculates the conditional mean, probabilities that the variable is greater than or equal to a set of thresholds and metal quantities above these thresholds. It previously models the univariate distribution of the The entries of the program are listed below:                    The outputs of program DK3D.M are:       The previous programs require the availability of the Matlab Statistical Toolbox for computing the cdf, inverse cdf and pdf of the Gaussian, gamma and beta distributions. Five additional subroutines (NEGBPMF.M, BINPMF.M, POISPMF.M, DJACPMF.M and DAJACPMF.M) are provided to calculate the negative binomial, binomial, Poisson, discrete Jacobi and anti-Jacobi probability mass functions respectively. Other useful subroutines are: PLOT_YZ.M: draws the transformation function model (see SETROT.M: sets up the matrix for rotation and reduction of coordinates Y_TO_Z.M: converts the transformed data to the original scale HERMITE.M, LAGUERRE.M, JACOBI.M, MEIXNER.M, KRAWTCH.M, CHARLIER.M, DJACOBI.M, DAJACOBI.M: these routines calculate the polynomial factors for all the aforementioned isofactorial models, based on Eq. COEF_IND.M: gives the coefficients of the polynomial expansions of the indicator functions COEF_Q.M: calculates the coefficients of the polynomial expansion of the metal quantity below threshold SQ_METAL.M: calculates the expected value of the squared metal quantity below threshold OMNI.M: calculates the omnidirectional variogram of a set of data SEARCH.M: looks for the neighboring data for kriging in a moving neighborhood DK3DMAIN.M: solves the disjunctive kriging systems and calculates the conditional statistics and error variances at each location to estimate. Programs for declustering and for non-isotropic variogram analysis are not included, since they can be easily obtained from public code such as GSLIB ( To illustrate the previous contents, an application to a soil pollution data set is considered first. The data are 180 measurements of the lead concentration at a smelter site sampled over a circular area (approximately 1.7 The declustered histogram of the lead concentrations ( Regarding the variogram analysis of the gamma scores data ( Disjunctive kriging can now be performed with program DK3D.M. The following quantities are sought after, since they are involved in the decision-making process for soil remediation: expected local lead concentrations over the entire area and risk of exceeding a threshold of 1000 The e-type estimate ( The probability map in This second example deals with the infestation of a field planted to sugar cane by a caterpillar (sugar cane borer The histogram of the counts is positively skewed, with a mean equal to 15.9 and a standard deviation of 11.8 ( Because of such a nugget component, an estimate (e.g. by kriging) of the number of bored internodes would provide an over-smoothed image of the real infestation. To determine the areas of the field that require pesticide treatment, the farmer is interested in knowing the risks that the number of internodes bored by the caterpillar exceeds given thresholds, say 15 and 20 per set of fifteen contiguous stalks, hence a disjunctive kriging approach is considered instead of linear kriging. Since the histogram has been fitted by a negative binomial distribution, a Meixner model is used to characterize the bivariate distributions. The parameter The risks of finding more than 15 or more than 20 damaged internodes on a set of 15 contiguous stalks can now be estimated by disjunctive kriging. To weaken the stationarity decision, an ordinary kriging of the factors (Meixner polynomials) is used, so that the factor means are omitted in the kriging process. The estimation is performed with a circular moving neighborhood containing up to 50 data. The resulting risk maps are displayed in Disjunctive kriging can be applied as an alternative to indicator and multigaussian kriging, for estimating conditional distributions and transfer functions of a regionalized attribute at unsampled locations. Its implementation is fairly simple when done in the scope of a bivariate isofactorial model. In practice, given the wide range of possibilities in the modeling, trial-and-error procedures are often necessary to choose a type of bivariate distribution and fit its parameters. This choice may be based on the experience of the practitioner and its understanding of the data. To avoid misinterpretations, it is advisable to check the suitability of the model by examining a few indicator variograms, say the ones associated with the quartiles of the univariate distribution. The proposed disjunctive kriging program DK3D.M allows the use of either simple or ordinary kriging when performing local estimations. Two applications have been presented, in which a gamma and a negative binomial models are used to assess the risk that the variables under study (lead concentrations in the topsoil or number of bored internodes in sugar cane stalks) exceed given thresholds. It is hoped that these examples taken from very different application fields will encourage practitioners in applying disjunctive kriging with models that extend the capabilities of the bigaussian model. Two problems have been set aside and may be of interest for future works: The internal consistency of isofactorial models: this problem refers to the question of which correlograms can be associated with a random field with a given type of bivariate isofactorial distributions. Except in the bigaussian case, there is no complete answer to this question so far. Some elements are given in Disjunctive kriging can be extended to the estimation with a change of support, subject to the definition of a bivariate model that relates the point-support and block-support values. In the Gaussian case, this is done in the scope of the The author is grateful to Codelco-Chile for supporting this research and to the French Agricultural Research Centre for International Development (CIRAD) for providing one of the data sets used in this work. Thanks are also due to Dr. Julián Ortiz (University of Chile) and to the reviewers for their comments on this paper.