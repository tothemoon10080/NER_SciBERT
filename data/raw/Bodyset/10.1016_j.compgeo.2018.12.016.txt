A mesh mapping method is proposed to incorporate stress effect into the hydraulic analysis for highly fractured rock masses. Mechanical and hydraulic mesh are introduced for the hydraulic and mechanical simulations, respectively. The mechanical mesh contains strong discontinuities for capturing the fracture opening, closure and shearing, while the hydraulic mesh only consists of merged triangles on fractures. Using finite element method and unified pipe network method, stress effects on the equivalent permeability of complex discrete fracture networks (DFNs) are studied. The numerical result demonstrates that the mesh mapping method is effective to the stress-dependent analysis of 3D complicated DFNs.Discrete fracture network (DFN) method is known as an alternative to conventional continuum method for simulating fluid flow in fractured rocks. It has been widely applied in geotechnical engineering, such as sequestration of carbon dioxide, enhanced geothermal systems and oil recovery The hydraulic permeability and transmissivity of fracture networks are influenced not only by initial apertures of fractures, but also in-situ stresses. The localized stress can induce fractures to close, open, slip or stick. Consequently, the preferential flow path in the DFN can potentially change significantly. Recently, the effects of stress on the fracture hydraulic aperture have drawn extensive attention in research. For instance, Zhang et al. There have been many numerical methods being proposed for modeling the mechanical behavior of pre-fractured media. Discrete element method (DEM) is a discontinuum method primarily proposed by Cundall and Strack The spatial discretization method of three-dimensional DFN models for FEM-based methods is still a challenge. Many 3D mesh generation methods were developed for discretizing the three-dimensional fractured media embedded with DFNs into conforming tetrahedral elements To model the stress-dependent permeability of a fractured rock, different numerical methods and models have been used. Based on discontinuous deformation analysis (DDA), Jing et al. In this paper, a mesh mapping method is developed to connect the mechanical behavior with the hydraulic behavior of 3D discrete fracture network for modeling the stress-dependent fracture apertures. In Section The DFN model can be discretized into conforming tetrahedral finite elements using DFNMeshGenerator Usually, the boundary faces use the first N identity numbers and the fractures use the others. Thus the identity numbers from 1 to N are assigned to the triangle facets on the boundaries, while the other identity numbers are given to the fracture facets. The reason why we distinguish the boundary faces from fracture faces is that the facets on boundaries have different rules in the process of duplicating nodes. These different rules for the fractures and boundary faces are introduced in Section The generation of strong discontinuities on fractures based on the provided conforming meshes is straightforward: duplicating nodes, generating extra fracture facets and updating the topological connectivity. However, due to the characteristics and geometric complexity of discrete fracture networks, some rules have to be proposed to regularize the process. There are basically two stages in the algorithm of generating the strong discontinuities models. The first stage is to recognize crack tip nodes for fractures as shown in Then, to generate the strongly discontinuous fractures, the nodes and facets on the fractures are duplicated and the relevant elements are also update in terms of the new node indices. The set of nodes on the fracture surface needs to exclude the set of crack tip nodes to obtain the set of noeds that will be duplicated. These duplicated nodes have the same spatial coordinates as the original nodes, but only different node indices. These new nodes are appended to New topological units within the strong discontinuities can be generated on the establishment of newly generated nodes and facets, such as interface elements and discontinuous Galerkin elements. To track the aperture change on each fracture during rock deforming, the original nodes and the duplicated nodes are paired to form the Besides the topology of contact pairs, a local coordinate system on each pair capable of modeling frictions is also built. The local orthogonal coordinates system (n-s-q) consists of one unit normal vector and two tangential unit vectors. The unit normal vector In this study, the finite element method (FEM) is adopted to model the aperture change in fractured rock masses, under the assumption of linear, elastic and quasi-static deformation. As the fracture growth is not of interest in this paper, all loads are assumed to be below the critical loads of fracture propagation and rock failure. The governing equations of the solids including the equilibrium equation and essential and natural boundary conditions are written as, Using the principle of virtual work, the governing equation can be written as in a weak form, Various stress-induced aperture constitutive models were proposed to evaluate the fracture aperture change under different loading modes. According to some normal loading and unloading tests on fractures, Barton et al. From the Eq. The displacement field in the domain is obtained by solving the Eq. The initial aperture The hydraulic apertures of fractures have been calculated in the frame of The fluid flow in the complex fracture network can be simulated by adopting unified pipe-network method (UPM) As shown in In Section The original data assumes that the apertures on all fractures are the same. Some studies have depicted that the apertures in fractures obeys a lognormal distribution As shown in The boundary conditions in both uniaxial compression and tri-axial compression simulations that will be carried out in Sections Firstly, the model is simulated under an uniaxial compression stress which is increased in steps from 5 MPa to 25 MPa. The average hydraulic apertures and the equivalent permeability components regarding to different uniaxial stresses are plotted in Several numerical experiments under triaxial compression are implemented for analyzing the stress ratio effect and the stress magnitude effect. Nine combinations of triaxial loads in total are employed in this numerical analysis. The confining stresses (σ  The mean apertures and equivalent permeability components in terms of different combinations of triaxial stresses are plotted in In this paper, the conventional conforming tetrahedral mesh ( A strong heterogeneity of apertures becomes apparent with the increase of uniaxial load. Fractures that are preferentially parallel to the loading direction tend to shear rather than close or open. Equivalent permeability in the direction of imposed load is affected less than the other directions. The divergence of equivalent permeability components also enhances the anisotropy of hydraulic properties to some extent. Under the assumption of neglecting the aperture increment contributed from the shear dilation, the increasing confining stresses reduce the mean aperture to approach the residual hydraulic aperture, but the decreasing rate is sensitive to the stress along z axis. Similar phenomenon is also observed in the equivalent permeability components. After the stresses on all directions are beyond a critical value, the change of hydraulic properties in the fracture network becomes trivial and the distribution of apertures is almost homogeneous. The present method is demonstrated as an effective way to simulate and predict the stress-dependent apertures and permeability in 3D complicated fractured rocks under different loading situations. This method provides a way to study the geomechanical and hydraulic problems in highly discontinuous formations. In many practical projects of underground engineering, the multiple fields, such as flow, thermal and chemical reaction, often are involved and influence the hydraulic transmissivity of the subsurface fractures in a coupling way. Future studies will be carried out to investigate the fully coupled multi-physical fields in rock masses containing complex DFNs. This research was supported by the