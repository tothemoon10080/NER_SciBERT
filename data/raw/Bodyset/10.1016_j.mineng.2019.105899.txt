Heavy minerals are generally trace components of sand or sandstone. Fast and accurate heavy mineral classification has become a necessity. Energy Dispersive X-ray Spectrometers (EDS) integrated with Scanning Electron Microscopy (SEM) were used to obtain rapid heavy mineral elemental compositions. However, mineral identification is challenging since there are wide ranges of spectral datasets for natural minerals. This study aimed to find a reliable, machine learning classifier for identifying various heavy minerals based on EDS data. After selecting 22 distinct heavy minerals from modern river sands, we obtained their elemental data by SEM/EDS. The elemental data from a total of 3067 mineral grains were collected under various instrumental conditions. We compared the classification performance of four classifiers (Decision Tree, Random Forest, Support Vector Machine, Bayesian Network). Our results indicated that machine learning methods, especially Random Forest, can be used as the most effective classifier for heavy mineral classification.Heavy minerals with densities higher than 2.89 g/cm In recent years, some researchers have attempted to develop classification and identification systems for heavy minerals, but little progress has been made. Currently, the Quantitative Evaluation of Minerals by SCANning electron microscopy (QEMSCAN), produced by the FEI Company, is the only commercially available method for heavy mineral analysis ( Energy-Dispersive However, like QEMSCAN, the SEM/EDS method of mineral analysis does not always provide accurate results; possible causes include (1) variable mineral chemical compositions; (2) the same chemical composition of some minerals; and (3) the low resolution of The fields of Machine Learning (ML) and Artificial Intelligence (AI) have recently seen a number of highly-publicised successes in the field of earth sciences ( At first, computer-aided techniques for mineral classification based on EDS data only checked look-up tables for identified minerals in scanning electron micrograph frames and employed a maximum likelihood classification ( From our review it is clear that most previous investigations in this area have focused on the use SEM/EDS data to identify different rock types (mainly magmatic and metamorphic rocks) in thin sections ( In this study, heavy minerals were selected from three modern river sand samples, which were collected on active sand bars in the main trunk of Yangtze River (16A001, GPS: 32°10′0.02″N, 118°58′41.61″E, near Nanjing Qixia Mountain), Yarlung Zangbo (16A063, GPS: 29°19′13.5″N, 88°51′28.4″E, near Xigaze Cong Song village), and Pumchu (16B027, GPS: 28° 09′35.96″N, 87°20′45.87″E, near Chentang village). More information about the Tibetan river sands can be found in In total, 2255 mineral grains from 22 types of heavy minerals were selected for SEM/EDS analysis, which was carried out using Oxford Aztec X-Max 150 X-ray spectrometry and the Zeiss Supra 55 Field Emission Scanning Electron Microscope at the State Key Laboratory of Mineral Deposit Research, Nanjing University. The working distance was 8.7 mm, with an acceleration voltage of 15 kv and a beam current of 60 nA. The test times for each grain of heavy mineral by EDS were 90, 40 and 6 seconds, respectively. The data obtained in the 90-second test were regarded as the most reliable and were used as the standard for heavy mineral characterization in the training and test (or validation) sets. Data produced under the 40- and 6-second tests was used to evaluate the reliability of classification of heavy minerals. Some of minerals included in our analysed sample are very similar in chemical composition (e.g., zoisite, actinolite and epidote - all of which belong to the “epidote group”; orthoferrosilite, clinoenstatite, augite, and pigeonite - all of which belong to the “pyroxene group”). Accordingly, the system was only trained to identify minerals which have distinctly different chemical compositions (see The data obtained was divided into training and testing sets, and the training set contained the 22 most commonly used heavy minerals, as shown in Heavy minerals handpicked by Langfang Geological Service Co., LTD ( The chemical composition of heavy minerals was obtained by SEM/EDS. Generally, the major element is greater than 10 wt% while minor and trace elements have mass concentrations of between 1 and 10 wt% and less than 1 wt%, respectively (see Our EDS data indicated that major elements varied among minerals with positive detections in certain minerals but none in other minerals. Therefore, we counted all nonzero elements in each mineral. If the nonzero elements accounted for 80 percent of the total analyzed heavy mineral grains we considered the element to be a decision attribute of the heavy mineral; otherwise, it was regarded as a non-decision attribute. In our study, each heavy mineral was analyzed separately to determine its decision attributes according to its major and trace-element composition (see the dataset related to this study, Mendeley Data, In recent decades, a large number of machine learning classification methods have been developed, such as Decision Trees, Random Forest, Support Vector Machine, Bayesian Classifiers, Artificial Neural Networks and Ensemble Learning. Among them, these former four methods have been used widely in mineral analyses ( (a) Decision Tree (DT) ( (b) Support Vector Machine (SVM) ( (c) Random Forest (RF) ( (d) Bayesian Network (BN) ( To evaluate the performance of the classifier, we employed two methods: a 10-fold cross-validation and a special test set. In 10-fold cross-validation on trainning set ( To determine suitable performance measures for the classifier, we mainly use accuracy, the kappa coefficient and mean absolute error. Accuracy is the ratio of the correct number of all classifications to the total categories, which describes the ability of the model to correctly predict the class labels. The kappa coefficient is used to determine the classification difference between the specified classifier and the random classification. For categories The mean absolute error (MAE) is the average of the absolute values of the deviations between the predicted value and the true value. It represents the deviation of any predicted values in the set. We proposed three major methodological parameters that can be addressed by the automated classification of heavy minerals in river sands using SEM/EDS: (1) Which is the best classification method for the heavy minerals in river sands using EDS data? (2) Which elements of heavy minerals can be used as decision attributes for effective classification? (3) Is there any classification difference between the shorter test times (40 and 6 s) and the standard test time? The EDS data from 2255 single heavy minerals from 22 types of heavy minerals were obtained under the 90-second test. Twenty-six decision attributes were made according to the proposed methods. The EDS data were classified by using Decision Tree, Random Forest, Support Vector Machine and Bayesian Network algorithms. For each algorithm a 10-fold cross-validation was used to evaluate the classification performance of each classifier, and accuracy, kappa coefficient, and mean absolute error were calculated to conduct the quantitative performance measures. The test results show that the classification of heavy minerals by four classifiers was nearly identical, with an accuracy greater than 97.29% and a kappa coefficient greater than 0.97, which is highly consistent with the expert label; the average absolute error is less than 0.004. Confusion matrixes were supplied in the dataset related to this study, Mendeley Data, The best classifier is the Random Forest, of which the classification accuracy is 98.63%, the kappa coefficient is 0.99, and the MAE is 0.004. The worst classifier is the Decision Tree, of which the classification accuracy is 97.29%, the kappa coefficient is 0.97, and the MAE is 0.003. In order to compare different attributes automatically selected by their values and by manual characterized elements as showed in The results based on 12 decision attributes show that the Random Forest is the most effective classifier, with a classification accuracy of 97.97%, kappa coefficient of 0.98, and MAE of 0.0055. Compared with the results of 26 decision attributes, the classification performance is slightly lower, and the classification accuracy decreases by 0.66%. The classification accuracy of the other three classifiers decreased to a different extent but ranged between 0.66% and 0.75%. The classification results based on 12 decision attributes are very close to those based on 26 decision attributes (the difference is less than 2%). As data collected at longer intervals exhibit less pronounced noise, it produces more precise characteristics of the heavy minerals. However, qualitative heavy mineral analysis requires large numbers of grains, usually at least 400. Hence, it is necessary to simplify the test process and quickly complete classification and identification of heavy minerals. We produced heavy mineral classification based on EDS data in 40-second and 6-second tests in order to compare these data with the 90-second test data, thus further to evaluate the effects of the test time on heavy mineral classification. The 2255 EDS data produced under the 90-second test interval were used to train the four classifiers. A total of 492 EDS data of 16 heavy mineral types were included in the 40-second test and 320 EDS data of 17 heavy mineral types in the 6-second test. Both of these data sets were subjected to analysis by the trained (90-second) classifiers. Because six heavy minerals types were not analyzed in 40-second and 6-second test, three elemental components (PmO The classification results based on the data of the 40-second test showed that the classification accuracy decreased by 0.34–1.5%, whereas the MAE increased by 0.001 to 0.004. Confusion matrixes were supplied in the dataset related to this study, Mendeley Data, As with the 90-second test, the Random Forest is the most effective classifier among the four classifiers under the 40-second test, with a classification accuracy of 96.54% and a kappa coefficient of 0.96. Compared to the 90-second test, the classification accuracy decreased by 0.66%, the MAE increased by 0.004, and the kappa coefficient decreased by 0.007%. Overall, the classification performance of the 40-second test is consistent with that of the 90-second test. The classification based on the EDS data obtained under the 6-second test showed that there is a significant difference in the classification accuracy between the heavy mineral EDS data obtained under the 6-second and 90-second tests. The accuracy rate decreased by 0.8–10.55%, while the MAE increased by 0.007–0.014, and the kappa coefficient variation range was also large, decreasing by 0.009 to 0.115. As with the classification based on EDS data produced under the 40-second and 90-second tests, for the 6-second data testing, the Random Forest is the most effective classifier among the four classifiers, with an overall classification accuracy of 97.81%, a kappa coefficient of 0.98, and an MAE of 0.018, which is consistent with classification based on the EDS data produced under the 90-second test. However, the classification accuracy of the other three classifiers fluctuated greatly, especially the Support Vector Machine, for which the classification accuracy rate decreased by more than 10%. This paper documented the performances of a selection of machine learning methods for the heavy mineral classification of a single, composite sample of river sands by using SEM/EDS data. Through the comparison of test results generated by different classifiers, different decision attributes and different test times, we drew the following conclusions: The 26 elemental compositions of heavy minerals as the decision attribute can distinguish the 22 most common heavy minerals in our composite river sands and could be used as a basis for the classification of this sample. Our results indicate that machine learning methods, including Decision Tree, Random Forest, Support Vector Machine and Bayesian Network, can be used as effective classifiers for heavy mineral classification. Among these, the Random Forest approach delivered marginally better results than all others tested. The results based on 12 decision attributes by using the Random Forest are comparable with a classification accuracy of 97.97% relative to those based on 26 decision attributes. With the application of the machine learning methods, the classification performance on the EDS data of the heavy minerals produced under the 6-second test is comparable to that obtained in the longer (40 and 90 s) test times. This may provide a method for reducing the test time and improving the test efficiency of the heavy mineral analysis. Through the best classification method (Random Forest), decision attribute (26 elements for 90-second testing and 23 elements for 40-second testing and 6-second testing) and the shortest testing time (6 s), the potential for precise, fast and efficient heavy mineral auto-identification by SEM/EDS data seems promising. In the classification of sand, other types of heavy minerals besides the 22 studied types of heavy minerals need to be included, which may require the use of deep-learning algorithms. In heavy mineral classification, minerals with similar chemical components, such as garnet group, pyroxene group and amphibole group, cannot be precisely distinguished. This true mineral identification (as opposed to mineral category identification) may require the incorporation of other information (e.g., optical images) in the overall machine learning system design. The used software is Weka 3 (120.3 MB), available in The dataset related to this study is published in Mendeley Data, The authors have no completing interests to declare. Mrs Juan Li was thanked for helping in the SEM/EDS lab. Prof. Dr. Norman MacLeod in