In order to simplify the network configuration and enhance the expandability and flexibility of the hydrogen network, one or two hydrogen utility headers are typically set with the consideration of requirement of hydrogen consumers. This paper proposed a superstructure-based mathematical programming model for the synthesis of hydrogen network with intermediate hydrogen header. The comprehensive superstructure is embedded with hydrogen utility, internal hydrogen sources and sinks, hydrogen headers, fuel system, compressors, purifiers and all the feasible interconnections between them. Two case studies are utilized to illustrate the feasibility and applicability of the proposed approach. The results show that the optimal flow rate of hydrogen utility will be decreased with the increase of the total number of connections as well as the increase of the number of hydrogen headers. The minimum flow rate of hydrogen utility for direct reuse/recycle without any intermediate hydrogen header can be achieved with the emplacement of two intermediate hydrogen headers. Besides, there is no direct connection among the hydrogen sources and hydrogen sinks. The Pareto front is made for the comparison on the flowrate of hydrogen utility and number of connections. The purification reuse/recycle scheme is investigated with the installation of purifier and the flowrate of hydrogen utility is reduced further.The amount of high-sulfur, heavy and inferior crude oil processed in industry has been increasing continuously. For instance, Sinopec, a Chinese oil and gas company imported 70 Mt of high sulfur crude oil in 2010 and this corresponded to an yearly growth of 17% Based on the analogy of pinch analysis for heat exchanger networks Hallale et al. However, in these earlier works, hydrogen sources are directly connected to hydrogen sinks for reuse/recycle (with or without purification). The resulting network may thus be relatively complex, and any variations in hydrogen flowrate and purity at an upstream hydrogen unit (hydrogen source) will affect the downstream hydrogen sinks. In order to simplify the network configuration and enhance the controllability of the hydrogen network, hydrogen utility headers are commonly used. It should be noted that similar work has been conducted to simplify the piping network while facilitating the operation and control of water networks in large process plants. Feng and Seider In this paper, a comprehensive superstructure-based mathematical programming model for the synthesis of hydrogen networks with intermediate hydrogen headers is proposed. The comprehensive superstructure incorporates hydrogen utility, internal hydrogen sources and sinks, hydrogen headers, the fuel system, compressors, purifiers and all feasible interconnections between them. The flowrate of hydrogen utility and the number of connections of the hydrogen network with up to two intermediate hydrogen headers are to be optimized. In addition, the optimal placement of compressors can also be determined using the proposed model. Two case studies are used to illustrate the feasibility and applicability of the proposed approach. The problem can be expressed as follows. Given a set of hydrogen utilities with a total number of The superstructure of the problem embedding potential configurations of interest is shown in Hydrogen production processes, such as steam reforming, serve as hydrogen utilities in refinery plants. Other possible external hydrogen sources include ethylene plants, fertilizer plants and coal gasification sections. As the pressure of the hydrogen utility may not fulfill the pressure requirement of the As shown in The flowrate balance is made on the splitting node after the In addition, the distributed flowrate from the The continuous catalytic reforming (CCR) process is a typical hydrogen source in the refinery. In addition, the purges of hydro-treating and hydrocracking processes contain certain amount of hydrogen. They are categorized as process or internal hydrogen sources. As shown in The flow rate balance is made for the splitting node after the It implies that the gas stream from the Besides, the total flow rate for the Typically, there exists a hydrogen utility header in each refinery plant. There will also be other hydrogen headers of intermediate hydrogen purities to simplify the hydrogen network configuration. As shown in The flow rate balance is made for the mixing node before the It means that the inlet flowrate of the The mass balance for The flow rate balance is made for the splitting node after the It means that the outlet flowrate of the The concentration of the The inlet gas stream of the The flow rate balance is made for the mixing node before the The mass balance for The flow rate balance is made around the outlet and inlet of the The concentration of The flow rate balance is made for the splitting node after the For the retrofit problem or design problem with several available compressors, the limitation for the maximum capacities for existing compressors should be taken into account, For the grass-root design problem, the judgment on where the compressor should be placed is much more important and the modeling for the judgment of the placement of the compressors is presented later. Once the judgment of the placement of the compressors is determined, the Equations If there are several compressors are available for use in the grass-root design, Equations As shown in The flow rate balance is made on the mixing node before the It means that the inlet flowrate of the Component mass balance for the mixing node before the Component concentration limitations for the The schematic diagram for a typical purifier is illustrated in The flow rate balance is made on the mixing node before It means that the inlet flowrate of the purifier is the summation of all the allocated flowrate from the The mass balance for The flow rate and component mass balance are be made around the The The flow rate balance is made for the splitting node after the PSA, The surplus internal hydrogen source, the residual gas stream of purifier would be sent to fuel system. The schematic diagram for the mixing node for the fuel system is illustrated in The flow rate and component mass balances are made on the mixing node before the fuel system, Note that, the inlet flow rate of fuel system ( Binary variables The total number of connections ( For grass-root design of hydrogen networks, the compressors should be placed between hydrogen sources and hydrogen sinks if necessary. The modeling technique for the judgment on the placement of compressors introduced by Liu and Zhang The binary variable Then Equation The flow rate of hydrogen utility is strongly related to the capacity of hydrogen plant and its operating cost. Therefore, the objective function can be formulated to minimize the consumption of hydrogen utility. In addition, the minimum total number of connections can be determined by setting its upper bound. The upper bound is reduced until the optimal flow rate of hydrogen utility increases. The critical number of connections is considered the minimum. Three scenarios, i.e. Direct reuse/recycle, Purification reuse/recycle without/with the judgment of the placement of compressors are explored. The relationship between the minimum flow rate of hydrogen utility and number of connections is investigated.  Objective function: Equation Subjected to Equations Note that the equations and terms related to the compressors and purifiers are omitted. In addition, the component mass balance for the fuel system as shown in Equation  Objective function: Equation Subjected to Equations Compared with Scenario 1, the equations and terms related to the judgment of the placement of compressors are included.  Objective function: Equation Subjected to Equations A refinery hydrogen network for case 1 is taken from Alves and Towler The process data and extracted limiting data are listed in To determine the minimum hydrogen utility as well as the minimum number of connections, the mathematical model for Firstly, only one hydrogen header so-called hydrogen utility header is placed. Once those limiting data in Next, two hydrogen headers are installed. To keep the total number of connections as 12, the minimum flow rate of fresh hydrogen from the import is determined as 457.400 mol/s. With the placement of one more intermediate hydrogen header, 9% of reduction for the minimum flow rate of fresh hydrogen is achieved. The hydrogen purities for two intermediate hydrogen headers are determined as 81.095 mol% and 75.769 mol%, respectively. In order to reduce the minimum flow rate of fresh hydrogen from the import, the total number of connections would be increased. By setting the upper bounds for the total number of connections to be 13, 14, 15 and 16, the minimum flow rate of fresh hydrogen from the import is determined as 359.889 mol/s, 294.178 mol/s, 279.630 mol/s and 268.821 mol/s. The optimized results and the optimal hydrogen network of Case 1 with two hydrogen headers are shown  In order to investigate the influence of placement of compressor on the hydrogen utility, the models without and with the consideration of placement of compressor will be solved separately. To determine the minimum hydrogen utility of hydrogen network for direct reuse/cycle without the placement of compressor, the mathematical model for Scenario 1 is utilized). It is solved in GAMS software The extracted flow rates and purities for hydrogen sinks and maximum flow rate and purities for hydrogen sources are shown in In addition, on the basis of the data listed in To consider the placement of compressors, the mathematical model for The extracted flow rates, purities and pressures for hydrogen sinks and maximum flow rate, purities and pressures for hydrogen sources are shown in In order to further reduce the consumption of hydrogen utility, the purification unit (i.e. PSA) is incorporated into the hydrogen network to upgrade the quality of internal hydrogen sources and the product of the PSA will be assigned to hydrogen sinks if the pressure requirement is fulfilled. To model the placement of compressor and purifier, the mathematical model for The process data for the purification unit PSA are assumed in this paper. The inlet pressure for PSA is set as 300 psi. The pressure for the product of PSA is assumed to be 300 psi and the slight pressure drop is neglected. The hydrogen purity for its product is given as 95% and the hydrogen recovery is defined as 90%. Besides, the pressure for its residue is set as 200 psi. The maximum inlet flow rate for PSA is assumed to be 32 MMSCFD. The optimal flow rate of hydrogen utility is found at 61.4 MMSCFD with the minimum number of connections of 22. The optimized results are listed in This paper proposed a superstructure-based optimization model for the synthesis of hydrogen networks with hydrogen headers. The comprehensive superstructure is embedded with hydrogen utility, internal hydrogen sources, hydrogen sinks, hydrogen headers, fuel system, compressors, purifiers and all the feasible interconnections between them. The comparative analysis is conducted for several scenarios: hydrogen utility versus number of hydrogen headers, hydrogen utility versus number of connections, placement of compressors and purifiers. Two case studies are analyzed to illustrate the feasibility and applicability of the proposed approach. The results show that the optimal flow rate of hydrogen utility will be decreased with the increase of the total number of connections as well as the increase of the number of hydrogen headers. The decision can be made according to the resulted Pareto front. The results show that the minimum hydrogen utility without hydrogen header can be achieved for the network with two hydrogen headers and there is no direct connection between hydrogen sources and sinks. With the installation of purifier, the flowrate of the hydrogen utility can be further reduced. Financial support provided by the  set of hydrogen utilities set of hydrogen sources set of hydrogen sinks set of compressors set of components set of hydrogen headers set of purifier set of fuel system index for hydrogen utility index for hydrogen source index for hydrogen sink index for compressor index for component index for hydrogen header index for purifier index for fuel system  upper bound for flow rate allocated from hydrogen utility upper bound for flow rate allocated from hydrogen source upper bound for flow rate allocated for the inlet of compressor inlet flow rate for hydrogen sink outlet pressure for hydrogen utility outlet pressure for hydrogen source inlet pressure for hydrogen sink pressure for hydrogen header inlet pressure for purification system product pressure for purifier residue pressure for purifier inlet pressure for fuel system upper bound for pressure difference between lower bound for pressure difference between recovery ratio for outlet concentration of component outlet concentration of component maximum inlet concentration of component minimum inlet concentration of component  flow rate allocated from hydrogen utility flow rate from hydrogen utility flow rate from hydrogen utility flow rate allocated from hydrogen source flow rate from hydrogen source flow rate from hydrogen source flow rate from hydrogen source flow rate from hydrogen source inlet flow rate for hydrogen header outlet flow rate for hydrogen header flow rate from hydrogen header flow rate from hydrogen header flow rate from hydrogen header inlet flow rate for compressor outlet flow rate for compressor flow rate from compressor flow rate from compressor inlet flow rate for purifier product flow rate for purifier residue flow rate for purifier flow rate from product of purifier flow rate from product of purifier flow rate from residue of purifier inlet flow rate for fuel system flow rate between supplier total number of connections inlet concentration of component outlet concentration of component inlet concentration of component outlet concentration of component inlet concentration of component inlet concentration of component product concentration of component residue concentration of component inlet concentration of component  connection between supplier pressure difference between supplier  Lower bound Upper bound minimum maximum inlet outlet mix  cracked naphtha hydrotreater continuous catalytic reforming diesel hydrotreater gas oil hydrotreater hydrocracker unit mixed integer linear programming mixed integer non-linear programming material surplus composite curve naphtha hydrotreater pressure swing adsorption residue hydrotreater The following is the supplementary data related to this article: Supplementary data related to this article can be found at