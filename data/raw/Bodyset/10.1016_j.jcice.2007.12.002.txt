Cone beam X-ray microtomography (XMT) instrumentation is a state-of-the-art non-invasive technology now used for several years to describe important characteristics of packed particle beds in three-dimensional (3D) detail. Many process engineering operations involve the transport of fluid in porous media. It is well known that the flow in porous media depends on the geometric properties of the pore network structure and in this regard X-ray microtomographic imaging captures the porous network structure of opaque packed particle beds which is later used for fluid flow analysis. The coupling of XMT 3D imaging with a novel fluid flow simulation method, known as the lattice-Boltzmann model (LBM), allows for direct local flow determination and micro-permeability calculations for complex porous structures. In this paper the methodology is briefly explained, implementations for some practical problems are addressed, the application of the technique from results for packed particle beds of interest are presented, and a comparison with experimental data is made.physical voxel size cross-sectional area (cm lattice speed given by Δ sound speed unitary vector direction of the discrete direction continuous particle distribution function depending on space, time and velocity describe the population at lattice node describe the equilibrium distribution function at lattice node particle distribution at node permeability coefficient of the porous matrix (cm body force hydraulic conductivity and has units (cm/s) length of the pipe particle mass pressure at point macroscopic fluid pressure flow rate in (cm collision term radius of the pipe macroscopic fluid velocity at node average velocity along the plane of flow kinematic viscosity of the fluid maximum velocity in the velocity in the distance to the datum level in point dynamic viscosity macroscopic fluid density at node relaxation time velocity porosity hydraulic gradient collision frequency In the last decades the subject of numerical simulation, and in particular computational fluid dynamics (CFD) simulation, has increasingly become a very popular approach to resolve complex practical problems in engineering and science. Several numerical simulation methods have been developed for analysis of physical–chemical problems improving our understanding of complex processes and allowing for the optimization/improvement of process engineering operations. Independent of their differences, in general, all numerical simulations follow a similar procedure or structure. There is a physical phenomenon which requires a mathematical model for interpretation and a computational framework or domain discretization is defined over which the mathematical model or governing equations are solved. The computational framework is a mesh or grid of connected points or grid nodes where the field variables are evaluated and used for analysis. The evaluation is accomplished by numerical simulation which requires an appropriate numerical algorithm, its coding, and its implementation. This conventional methodology has been applied with great success during the last 50 years. Two of the most successful grid-based numerical methods are the well-known finite difference method (FDM) and finite element method (FEM) which have been widely applied to various areas of computer fluid dynamics and computer solid modeling (CSM). These standard grid-based methods suffer from an inherent limitation in its application for porous network structures. In the case of FDM, constructing a regular grid for irregular or complex geometry requires additional mathematical operations that can be more expensive than solving the problem itself. On the other hand, in the case of FEM the construction of an irregular grid consumes a significant part of the computational effort making the treatment of complex geometry problems computationally very expensive and time consuming. In contrast to these standard methods, the coupling of X-ray microtomography (XMT) technique and LBM allows for fast and easy construction of the porous structure and determination of the fluid flow regime. Recently, LBM has received increasing attention in the area of fluid flow simulation in porous media due to these attractive features, its ability to incorporate molecular level interactions, and its structure which facilitates code parallelization ( Unlike the conventional CFD methods, which involves a ‘top-down’ approach based on discretization of macroscopic continuum equations, the LBM method is based on a ‘bottom-up’ approach where constructed kinetic models incorporate microscopic model interactions and mesoscopic kinetic equations. In LBM methods the resulting macroscopic dynamic behavior is the result of the collective behavior of microscopic particles interacting at the pore scale and where the macroscopic averaged properties of the flow obey the desired Navier–Stokes macroscopic equations. In order to capture the porous network structure of the packed particle bed, which defines the geometric properties for the flow, the sample is subjected to an X-ray micro-CT analysis where a computer reconstructed image is obtained by computerized tomography (CT). The use of the principles of CT at the microscale level, or microtomography, allows quantitative investigations of objects in three dimensions. Recently, in an effort to advance the study of particle characterization, researchers at the University of Utah have used X-ray microtomography as a major analytical tool ( In this paper we will describe the fundamentals aspects involved in the use XMT/LBM and its application for the analysis of packed particle beds. We will address the methodology and application for the determination of permeability for packed particle beds of limestone, sand, and rock particles. Sections X-ray tomographic imaging is, in general terms, an X-ray-based method by which radiation of an opaque sample in different directions allows for the three-dimensional (3D) reconstruction of multiphase systems. The first device capable of producing true reconstructed images was developed by G.N. Hounsfield only in 1972 at EMI in England and it was based, in part, on mathematical methods developed by A.M. Cormarck a decade earlier ( The mechanics of X-ray tomography testing is relatively simple. The sample is located between the X-ray source and the detector. Then the sample is illuminated in different directions, and for each direction the two-dimensional (2D) projection of the attenuation coefficients is measured. Finally, a computerized reconstruction is carried out. The reconstruction of the samples is based on a mathematical formalism known as Radon transform and its mathematical framework (  The images of porous structures for packed particle beds reveals why the LBM method is more suitable for this kind of problem than the standard CFD mesh methods. The standard solution with a CFD solver requires the construction of a grid, the definition of the boundary conditions in the boundary nodes, and the solution of the Navier–Stokes equation at each node. The standard CFD methodology, therefore, will require an enormous amount of time for grid construction and also for computer simulation. The description of fluid motion can be done at different scales. From one side the microscopic level requires the description of each fluid particle based on Newton's law of motion and microscopic force influences. This level of description has given origin to the computational branch known as molecular dynamics. On the other hand, we have the macroscopic level of description with CFD which is based on the very well known Navier–Stokes equation and its continuum description. In between these two scales we find the lattice-Boltzmann method which belongs to the group of mesoscopic methods which are based on a statistical mechanics approximation and describes the fluid motion in terms of distribution functions. From a historical point of view, LBM evolved from the original lattice-gas cellular automata (LGA) ( The Boltzmann equation establishes that the collision between two particles follows a complicated integro-differential equation that can be expressed in terms of the distribution function, For the LBM space, time and particle velocities are all discrete. Typically in the LBM, the space is discretized into a regular lattice arrangement and a set of particle distribution functions Discrete equations of this form are referred to as lattice-Boltzmann equations due to correspondence to the complex integro-differential Boltzmann equation for the single particle distribution function like Eq. In the lattice BGK model the local equilibrium distribution is chosen in such a way to recover the Navier–Stokes macroscopic equations. In fact, The D3Q19 model consists of a lattice where each node has 19 velocity vectors: 1 is in the center, 6 along the axis and 12 for all combinations of two axes. For each velocity vector a particle distribution function (PDF) The LBM consist of two basic steps, streaming and collision. The streaming step represents the advection of the particles in the fluid, and if the size of a cell Δ The collision step describes the evolution of a system towards equilibrium by relaxing the PDFs of a node towards the equilibrium distribution function. For a D3Q19 lattice, a second order expansion of the equilibrium distribution function is commonly used and it is given by Eq. The flow in a pipe has a very well known analytical solution obtained from the direct application of the boundary conditions in the Navier–Stokes equation. Under moderate-to-low Reynolds number flow conditions the solution is easily determined and it is given by As in the real world, in the LBM the fluid flow through a pipe can be body-force-induced (gravity) and/or pressure-induced. In the former case the fluid flow is driven by a gravitational field applied to the fluid particle population which drives the flow in the field direction. In the later case, the pressure is induced by a difference in pressure between the inlet and outlet points. The simplest way to induce flow in LBM is by using a body force which accelerates the flow in the motion direction. It is defined in such a way to produce the same momentum input to the flow as a true pressure gradient. In fact, this acceleration requires only the addition of the extra momentum to the velocity before applying the relaxation to equilibrium. This modification leads to an incompressible NS equation with an additional momentum source term given by the volume force term Because we are interested in the fluid of a fully developed flow, the phenomena at the inlet and outlet of the pipe can be neglected and therefore a periodic boundary condition may be used in the flow direction. This is equivalent to assuming that we are working with an infinitely long pipe. Since the gravity body force, density, fluid viscosity and pipe diameter are all defined, the maximum velocity of the analytical problem can be approximated by The application of the pressure-induced flow by setting the pressure at the inlet and outlet requires the addition of some boundary conditions rules after streaming ( Both approximations, body-force-induced and pressure-induced flow, have shown almost equivalent results in the range of low Mach numbers and low Reynolds numbers and the selection of either one may be decided depending on the particular application. In contrast to the standard CFD methods which directly discretized the Navier–Stokes equation, the LBM works with the PDFs. Thus, unlike the standard CFD method which sets the boundary conditions in terms of the macro variables (velocity, pressure and density), the LBM requires that the boundary conditions be set in terms of the PDF of the incoming and outgoing population. In this work our concern is the simulation of the fluid flow in packed particle beds confined in a container of cylindrical or rectangular geometry. Therefore, we only address the boundary conditions dealing with such a system where the flow can be driven by a pressure gradient or a body force. A complete discussion and explanation of the boundary conditions can be found elsewhere ( The periodic boundary condition is probably the most simple and practical feature of the LBM. The periodic boundary condition is applied along the flow direction where the outgoing PDF in the outlet (inlet) face is streamed back to the corresponding inlet (outlet) PDF. Therefore, this boundary condition by definition assures mass conservation in the system. The non-slip boundary condition requires that the velocity component parallel to the flow must be zero at the solid surface. In such a case, a mid-grid second order accuracy implementation has been used. Basically, at the wall, the outgoing PDF is bounced back towards the interior of the fluid in a way that preserves mass and where the tangential and normal momentums to the wall vanish. Many interpolation methods have been proposed to reduce the error of approximation in the position of the solid–fluid interface. These methods are complex and difficult to implement compared to the standard mid-line bounce-back rule. Furthermore, they lose importance if the real solid–fluid interface is not well defined as could be the case for CT images. In this regard, improvements in the resolution during discretization of the system's geometry are expected to be more important and significant. Consequently, we use the second order bounce-back boundary condition because of its simplicity and good results. The flow can be driven by a small density difference between the inlet and the outlet. In this case, the pressure difference is imposed by a small density drop in the flow direction as explained by  The simulations were stopped after 10,000 iterations to assure equilibrium. The initial conditions include the density that was set at 3.0, the relaxation time at 1.0, the gravity force in the flow direction set at 0.00005 or an equivalent pressure drop of 0.00960. Furthermore, periodic conditions in the flow direction and non-slip boundary condition at the walls were applied. It is clearly indicated that there is an excellent agreement between the analytical solution and the results obtained with the 3D LBM simulation. As has been previously mentioned, the flow in porous media depends on the geometric properties of the packed particle beds. In this regard, the CT scan analysis allows for the 3D digitalization of the porous structure which controls the local flow. The LBM uses the digitalized porous structure for fluid flow simulation and determination of the local flow from which the macro flow properties for these complex geometries can be obtained. The resolution of the 3D image is a major factor in application of this technique to real porous samples. In fact, it has been shown that a minimum of 4 Darcy's law establishes that the flow rate passing through granular material is directly proportional to the constant cross-sectional area ( The proportionality constant, Different particle types have been collected to carry out a comparison of the experimental permeability determinations with the LBM simulations from corresponding XMT images. The experimental determination of the coefficient of permeability is done by a constant head set-up for laminar flow of water through granular samples. The experimental set-up follows the recommendations given in ASTM D 2434 “Standard Test Method for Permeability of Granular Soils”. Experiments were run at different defined pressure head differences but being careful in keeping the flow under laminar flow conditions. After flushing the sample with CO For each particle sample five experiments were carried out with different head differences. The data then was used to obtain the best-fit-line to the relationship between flow rate and hydraulic gradient. Then, the hydraulic conductivity was calculated from the slope of the line and the permeability obtained from its relation with hydraulic conductivity according to Eq. The high-resolution cone beam XMT facility at the University of Utah has a microfocus X-ray generator, a sample stage and a CCD detector of 2048 Sample preparation is simple. After sampling a particle population, the sample is packed in a cylindrical plastic container up to 40 There is a physical limitation of the maximum resolution obtained for a voxel which depends on the energy of the X-ray source, the density of the material, and the technology of the sensors. The cone beam X-ray scan has a maximum range resolution, and the application of these maximum resolution requires longer time of exposition and smaller size of scanning, therefore, smaller representative sample size. Furthermore, to increase the level of resolution requires more voxels for describing the same volume geometry and therefore this also increases the computing task. In the range of particle size under our analysis, a 20-μm resolution has proved to be a good balance to give excellent results. If smaller particles are analyzed a smaller resolution is suggested and vice versa, if bigger particles are under analysis then less resolution will be more convenient to increase the total volume under analysis. There is a strong relation between the voxel resolution and the accuracy of the results with respect to the real permeability value. If the number of voxels describing the porous geometry increases, the accuracy of the surfaces description increases, and therefore the accuracy of the simulation results are expected to improve. This error in space discretization has been analyzed elsewhere ( Because of the fundamental principles of the LBM theory, which relax from a non-equilibrium situation to the equilibrium, the initial conditions of the simulation do not have an effect in the steady state results; however, they do have an effect on the time of convergence. Convergence and stability are still evolving areas of research and, for now, simple heuristics are used. In these particular cases, the domain has been initialized with a uniform velocity of zero magnitude and a uniform density of 3.0 in each fluid node. The relaxation parameter has been set at 1.0 and therefore, according to Eq. The domain is composed of the packed particle bed constrained for a box and the flow is driven by a body force normal to the inlet and outlet faces going in the The periodic boundary condition forces mass conservation in the system but it can generate some abnormalities in the flow field because the porosity at the inlet and outlet are not necessarily connected. Some authors ( Since we are interested in measuring the permeability when steady state is achieved, the simulation is run for around 5000 iterations after which the velocity profiles in the porous structure are checked for convergence. Convergence is achieved when the relative change of the average velocity is less than 10   The same procedure was done for each one of the samples under analysis. In order to validate the implementation of the code, the same results were also compared with the permeability obtained from the simulation carried out with the same 3D image but the code developed at the National Labs by   From From the results presented here the LBGK approximation seems to work fine for unitary relaxed times for these porosities and particle sizes using 20 LBM agrees well with the Navier–Stokes equation for simulation with Mach numbers well below 1. Therefore, it is always desirable to keep the maximum flow speed well below the sound velocity of the lattice, in this case In this study we have developed a LBM based on the D3Q19 lattice discretization for the simulation of saturated flow in porous media in three dimensions. With the help of X-ray microtomography (XMT) we have been able to reconstruct the porous structure controlling the flow conditions in packed particle beds. The flow of fluid through porous media according to the LBM with a LBGK approximation has been presented. In this paper a practical application of the method to six different samples of our particular interest has been carried out. Packed particle bed samples were used for experimental permeability determination and later used for XMT analysis for porous structure digitalization. The results between experimental permeability determinations and from simulations were compared and the results agree well for all cases under analysis when the simulation works with a unitary relaxation time. However, over-relaxed or under-relaxed simulations, i.e. using fluid with normalized simulated viscosity different than 1/6, gives results which differ from the actual experimental permeabilities. The combination of the XMT technology and LBM simulation allows the direct pore flow simulation in 3D particle beds and therefore is a great opportunity for studying the different problems of transport on a pore-scale basis. This LBM/XMT technique will allow the study of the effect of geometric factors (connectivity, pore diameters, etc.) on flow through porous media and the pore scale simulation of reactive flow. The authors would like to thank to the Center for Advanced Separation Technologies (CAST) for their financial and technical support. Also we want to extend our thanks to Dr. Michel Sukop, Dr. Danny Thorne and Dr. Harlan Stockman from Florida International University, from the Georgetown College and from SANDIA National Lab, respectively, for their time and invaluable help. Finally, an allocation of computer time from the Center for High Performance Computing at the University of Utah is gratefully acknowledged. The computational resources for this project have been provided by the National Institutes of Health (Grant # NCRR 1 S10 RR17214-01) on the Arches Metacluster, administered by the University of Utah Center for High Performance Computing.