Increasing electricity costs coupled with lower prices for some metals such as platinum group metals require a reevaluation of the operation of grinding processes. Demand side management (DSM) has received increasing attention in the field of industrial control as an opportunity to reduce operating costs. DSM through grinding mill power load shifting is presented in this paper using model predictive control and a real-time optimizer. Simulation results indicate that mill power load shifting can potentially achieve cost reductions of $9.90 per kg of unrefined product when applied to a run-of-mine (ROM) ore milling circuit processing platinum bearing ore. DSM is however still not economically feasible when there is a demand to continuously run the milling circuit at maximum throughput.As energy costs increase, the operating procedures of energy intensive processes should be reevaluated in order to find cost saving opportunities. One such process is the run-of-mine (ROM) ore milling circuit used in the mineral processing industry. ROM ore milling circuits are used for primary grinding of ore so that valuable minerals within the ore can be liberated, separated, and concentrated in downstream processes ( In addition to being an energy intensive process, ROM ore milling circuits are also complicated processes to control. Difficulties in the control of ROM ore milling circuit result from integrating features with strong disturbances, large time delays, non-linearities, and strong interactions ( The concept of demand side management (DSM) was formalized in the 1980s by Demand side management projects can be categorized as energy efficiency, time-of-use (TOU), demand response, and spinning reserve projects ( Load shifting as a DSM technique has received increasing attention in recent years as electricity utilities encourage customers to reduce peak demands. Load shifting is performed in response to the TOU tariffs implemented by utilities. Reduced peak demands result in less stress on power generation facilities during peak periods and help maintain a stable reserve margin ( While the mining sector accounts for approximately 15% of electricity consumption in South Africa ( DSM techniques that have been studied within the mining sector include hoist scheduling techniques for a deep level mine ( DSM, specifically load shifting, presents an opportunity for the control community to contribute to profitability improvements of processes. Projects aimed at retrofitting older plant equipment with new energy efficient equipment are associated with capital expenditure and often long payback periods which discourage the implementation of such projects. Implementation of load shifting projects require less capital expenditure while offering potential reduction of operating expenditure ( Traditionally ROM ore milling circuits have been controlled to achieve maximum throughput as the cost of electricity was low. Electricity has however become increasingly expensive. This paper focuses on the production of platinum group metals (PGMs) of which South Africa produced approximately 75% of the total world output in 2011 ( A number of studies in the optimization of milling circuits have been performed at the supervisory control layer. An expert system based on IFâ€“THEN logic was developed to optimize mill power in order to achieve maximum throughput on a milling circuit ( The traditional control of ROM ore milling circuits must therefore be reevaluated to determine whether operating at maximum throughput remains effective. An implementation of mill power load shifting to realize a reduction of operating costs associated with electricity consumption is therefore developed. This reduction of operating expenditure is also evaluated against the performance of a ROM ore milling circuit controller that does not take DSM into account. The ROM ore milling circuit (see Ore is fed to the SAG mill at approximately 90 t/h. The ore is mixed with feed water, steel balls, and underflow from the cyclone. A slurry is formed within the mill which can be classified into coarse ore, fines, and water as described in In the sump water is added to dilute the slurry to achieve a desired density and to facilitate transport through the circuit. The diluted slurry is then pumped to the hydrocyclone. The hydrocyclone splits the particles in the slurry so that approximately 80% of the overflow stream is made up of fines. The overflow stream is sent to downstream separation and concentration processes. The underflow consists primarily of coarse ore which is fed back to the mill for regrinding. Separation of the liberated product of a milling circuit can be achieved using e.g. flotation or leaching. For this study it is assumed that the PGMs are separated using a flotation circuit ( A non-linear model was developed for the milling circuit as described in The feeder module is used to combine the solids feed, mill inlet water feed, and ball feed with the underflow of the cyclone which are all fed to the mill. The mill module is used to simulate the grinding action within the mill. The sump module is used to simulate the state of the sump and the cyclone module is used to simulate the classification process within the hydrocyclone. For this study the mill module is of particular interest as it is mill power draw that will be shifted according to TOU tariffs. The mill power draw model originates from the mill module and will be discussed here. A full discussion of the modules is given in The mill power model is a function of mill load, the mill rheology factor, and the fraction of critical mill speed, referred to from here on as mill speed (SPD). Mill load is defined as the fraction of the mill filled, and the rheology factor is used to describe the fluidity of the slurry based on the mill states. The rheology factor is given by The effect of rheology on power consumption is given by Mill power consumption is given by The parameters used for the mill model are given in Run-of-mine ore milling circuits are inherently difficult processes to control. They exhibit integrating features with strong external disturbances, large time delays, non-linearities, and strong interactions ( Traditionally the control objectives for a ROM ore milling circuit can be given as ( improve the quality of the product by increasing the fineness of the grind and decreasing product size fluctuations, maximize throughput, minimize consumption of grinding media, and minimize power consumption The control objectives are however not all complementary and therefore require certain trade-offs. A frequently applied trade-off is to rather maximize throughput than minimize power consumption. This trade-off is often applied owing to the high value of the product compared to the traditionally low cost of electricity in South Africa ( In recent years the cost of electricity has significantly increased in South Africa and will continue increasing ( maintain milling circuit stability, maintain a constant product size and decrease product size fluctuations around this value, maintain a specified average throughput over a seven day horizon, and minimize the costs associated with power consumption. Traditionally the controlled variables (CVs) for a ROM ore milling circuit are product particle size (PSE), the percentage of the mill volume filled (LOAD), and sump level (SLEV). The manipulated variables (MVs) most commonly used to control the milling circuit are the flow-rate of water to the mill (MIW), the feed-rate of ore to the circuit (MFS), the flow rate of slurry from the sump to the cyclone (CFF), and the flow-rate of water to the sump (SFW) ( Owing to the trade-off between throughput and power, mill power is generally not controlled directly ( The traditional MVs are used to control the milling circuit in this study with mill speed (SPD) added to achieve functional controllability ( The addition of balls to the milling circuit is often performed manually and the feed-rate of balls to the mill (MFB) is therefore not used as an MV. MFB is kept constant at the nominal value of 2 In a recent survey that addressed the control of grinding mill circuits, 90% of the respondents reported that an electric motor is typically used as the actuator for mill speed ( The controlled and manipulated variables of the milling circuit are given in Model predictive controllers have been shown to perform better than single loop PI(D) controllers for ROM ore milling circuits ( In this paper the non-linear plant model described in All transfer functions are given with time constants in hours. The transfer functions between PSE and the MVs as given in The transfer functions between LOAD and the MVs are The transfer functions between SLEV and the MVs are The transfer functions between PWR and the MVs are The linear plant model was identified through SID using step response data generated by the non-linear plant model. First order transfer functions with time delay were fitted to the step response data. Where the first order transfer functions did not produce an accurate fit, a zero was added to the model form to improve the fit. The PWR/SPD transfer function, As mill speed changes the states within the mill begin to change. The time constants The fit of all the models is not presented in this paper owing to space constraints. The models are however similar to those presented by The MPC controller was designed using the linear model from The constraints for the CVs are given by The matrices The weights were chosen to achieve the control objectives listed in The effect of SLEV and LOAD set-point deviations on the objective function was set to approximately 20 times less than that of PSE and PWR set-point deviations. The effect of PSE and PWR set-point deviations on the objective function was made equivalent. These weight choices resulted in slightly detuned sump level and mill load control while implementing tight control on particle size and mill power. The sampling time of the controller, The sampling time of the controller cannot be increased much from 10 The choice of prediction horizon was modified to be based on the longest settling time between PSE and the MVs. The prediction horizon was therefore chosen as 830 moves, corresponding to 2.3 The number of control moves, In order to choose the set-points for the mill power load shifting controller, a non-linear cost function was developed to be minimized. The cost function was developed as a loss function based on turnover and the costs associated with electricity consumption. The supervisory control layer has a sampling time The cost function is given by The turnover associated with the milling circuit product is given by The mineral price, Electricity consumption is calculated based on the average mill power draw every half hour. Electricity cost is then calculated based on the half hourly electricity consumption billed at the applicable TOU tariff for that half hour. This function is given by The cost function In addition to using the steady-state model as equality constraints for the cost function, the input and output constraints had to be included too. The CV constraints used in the cost function were made 10% tighter than those used by the regulatory MPC controller as given in In addition to the constraints on the controlled and manipulated variables, the average throughput was implemented using an equality constraint. The average throughput refers to the throughput over the seven day period for which the optimization is done. The throughput constraint is implemented as The throughput constraint originates from the assumption that ore can be supplied to the milling circuit at a certain rate, i.e. a buffer in the form of a silo or storage facility lies between the source of ore and the milling circuit. The average throughput rate of the milling circuit must therefore be the same as the average feed-rate of ore supplied to the milling circuit over a seven day period. In order to take dynamic changes in the mineral price, electricity price, and throughput availability into account, the loss minimization function is implemented as a real-time optimizer (RTO). The formulation of the RTO is as follows: The RTO is implemented with a sampling interval, The optimal set-points, The set-points calculated by the RTO for an average weekly throughput of 90 The RTO calculates optimal set-points for PSE, LOAD, SLEV, and PWR. Implementing all four optimal set-points simultaneously decreases the stability of the ROM ore milling circuit. As discussed in Additional design choices were made to improve milling circuit stability. The set-points of LOAD and SLEV were maintained at the nominal values, which are in the middle of the respective operating regions. By maintaining the sump level set-point and marginally relaxing sump level control, control of particle size is improved. Similarly maintaining the mill load set-point while allowing increased variations in mill load, improves control of particle size and mill power. The only set-point that is changed is the mill power set-point. Mill power set-point changes are filtered using a first-order filter. Without filtering, step and ramp function mill power set-point changes result in the sump running dry. The set-point change filter (with the time constant in hours) is given by Simulations were performed on the non-linear ROM ore milling circuit model using the linear model predictive controller described in The first simulation was performed to determine the power consumption for maximum throughput without mill power load shifting. The second simulation was used to determine the baseline power consumption when no mill power load shifting was performed. The third simulation was performed with mill power load shifting aimed at maximizing profit. For the simulations, profit is considered as the turnover less the operating costs for electricity consumption. The maximum achievable average throughput for the milling circuit model is approximately 97 The average throughput of 90 A number of factors can affect the average throughput at which a milling circuit operates. These factors include low availability of ore from the mine, restricted throughput of the downstream processes, and even attempts to reduce operating costs. The set-points for the mill power load shifting simulation were calculated using the RTO. The average weekly throughput was chosen as 90 The simulation results are presented as electricity cost savings, throughput losses, and cost improvement per unit of unrefined platinum. The electricity costs are calculated by taking the average power consumption of the mill every hour and billing it at the relevant TOU tariff. The total electricity cost is then calculated by summing the hourly electricity cost over the simulation horizon. Total electricity cost is given by The electricity costs, in US dollars per week, for each of the simulations are given in The average throughput achieved for both the baseline and mill power load shifting simulations was 90.94   The cost improvement per unit production is based on only the baseline and mill power load shifting simulations as the throughput achieved for each of the simulations was the same. The cost improvement was calculated using When performing power load shifting it is necessary to have some storage facility, such as a silo, that acts as a buffer between the upstream ore supply and the milling circuit. It is generally not economically feasible to perform mill power load shifting on a milling circuit where the upstream ore supply is higher than the average throughput of the circuit as is illustrated in The RTO is designed to take the upstream ore supply into account and match the average milling circuit throughput to the supply of ore while minimizing the cost function. The storage facility is therefore only necessary for storing ore when the circuit throughput is reduced during peak tariff periods and then increased during off-peak periods. The change in the holdup of ore within the silo can be given by The maximum additional holdups of ore within the silo for the high and low demand season mill power load shifting simulations are 249.5 If the stockpile is sized such that the safety stock covers one week's worth of production or 15278.2 t, ( As can be observed in The manipulated variables CFF, MFS, and SFW remain comfortably within their constraints. This indicates that the controller is not running at its limit and has room to maneuver if disturbances are introduced ( Disturbances were not introduced for the simulations performed as much work has been done in the area of disturbance rejection. MPC is sensitive to large disturbances and disturbance observers have been developed that significantly attenuate the effect of disturbances on milling circuits ( It has been shown that by controlling mill power using mill speed that the operating costs attributed to power consumption can be reduced without sacrificing product quality. The control of mill power was implemented using a linear model predictive controller on a non-linear plant model. The results of the simulation study indicate that performing mill power load shifting on a milling circuit not running at full capacity is more cost effective than simply running at a lower mill power. With increasing electricity costs this is an important consideration. The simulations show that for a 2 For mines that implement power scheduling the benefits of mill power load shifting should also be evaluated according to maximum demand charges. In order to evaluate the maximum demand charges, the maximum demand of already implemented scheduling operations should be added to the maximum demand for mill power load shifting. The advantage of using an RTO is that the optimizer is run on-line and can take changes in ore availability into account. The RTO can also take dynamic changes of electricity cost and mineral price into account. Though the profitability can be added to an MPC cost function, using an RTO allows for a decoupling between economic objectives and control objectives in the supervisory and regulatory control layers respectively. By using this regulatory/supervisory control layer approach with a controller and RTO the stability of the system can be prioritized. Economic optimization can then be performed when the system is stable without requiring a trade-off between stability and economic performance. Implementation of mill power load shifting is dependent on the milling circuit design. An ore supply storage facility is needed to buffer the ore supply during the week when electricity is expensive and throughput is reduced. For a controller that controls mill power based on mill speed it is necessary that the mill motor is equipped with a variable speed drive. Finally it is necessary to have an accurate real-time measurement of product particle size.