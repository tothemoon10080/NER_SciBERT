The performance of a model predictive controller depends on the quality of the plant model that is available. Often parameters in a run-of-mine (ROM) ore milling circuit are uncertain and inaccurate parameter estimation leads to a mismatch between the model and the actual plant. Although model-plant mismatch is inevitable, timely detection of significant mismatch is desirable. Once significant mismatch is detected the model may be partially re-identified in order to prevent deteriorated control performance. This paper presents a simulation study of the detection of mismatch in the parameters of a ROM ore milling circuit model using a partial correlation analysis approach. The location of the mismatch in the MIMO model matrix is correctly detected, and the process model subsequently updated.Grinding mill circuits are still predominantly controlled using single-loop PI(D) controllers Milling circuits, and mineral processing operations in general, are often affected by poor modelling The aim of the mismatch detection strategy is to locate the specific transfer function element(s) in the model transfer function matrix that contain significant mismatch. Once significant mismatch has been detected, re-identification of the particular part of the plant model that contains the mismatch may be done. This partial re-identification would be much less costly and time-consuming than full process re-identification This paper describes a simulation study of the application of a model-plant mismatch detection strategy described in This section gives a brief introduction to the ROM ore milling operation considered in this work. The discussion is based on a single stage semi-autogenous mill operated in closed circuit with a hydrocyclone. Ore bearing some valuable mineral is fed to the milling circuit at about 100 The feed to the mill (see The controlled variables in the milling circuit are the product particle size (PSE), the fraction of the mill volume filled with material (LOAD), and the volume of slurry in the sump (SLEV). The manipulated variables are the feed-rate of solids into the mill (MFS), the feed-rate of water into the mill (MIW), the feed-rate of steel balls into the mill (MFB), the flow-rate of water into the sump (SFW), and the flow-rate of slurry into the hydrocyclone (CFF). The operating point of the milling circuit and constraints on the variables are given in the nomenclature table.  The milling circuit model is based on phenomenological equations and consists of separate modules for the feeder, mill, sump and hydrocyclone such that arbitrary circuit topologies may be constructed. The model uses five states, namely water, rocks, solids, fines, and steel balls to describe the flow of material through the milling circuit. All the equations that constitute the non-linear model are based on these material classifications. A full description of these equations can be found in The mill module is capable of modelling various mill types e.g. ball, SAG (semi-autogenous grinding) and AG (autogenous grinding) mills. The model adds the effects of mill power and slurry rheology (as described by The mill has five states, which are the holdups of the five classifications of material in the mill, namely water, rocks, solids, fines, and steel balls. The state equations are given by The milling circuit is controlled by a linear model predictive controller, which is described in the next section. The controller requires a linear model of the plant that is obtained through applying a standard system identification (SID) procedure as described by The other 6 transfer functions are in the form The model does not contain reference to the manipulated variables MIW and MFB. In this study the value of MFB is kept constant at its nominal value (as reported in the nomenclature table). The value of MIW is derived from the value of MFS through a constant water to solids ratio into the mill as discussed by The controller for the milling circuit is a linear model predictive controller based on the linearized plant model discussed in the previous section. At each sampling instant the objective of the controller is to minimize some scalar performance index At each sampling instant the controller calculates the required values for the manipulated variables CFF, SFW and MFS. The prediction horizon should be chosen large enough to capture the dynamics of the model, but small enough such that the control action calculation is not too computationally expensive. The control horizon should be chosen small enough such that the controller is not too aggressive, but large enough such that a sufficient part of the prediction horizon contains control action. The controller uses a prediction horizon of 800 (covering 2.22 The simulation results in The values of the manipulated variables for nominal operation are shown in A model-plant mismatch identification technique is applied to the ROM ore milling circuit to detect differences between the available model and the actual plant. Recently Consider the closed-loop internal model control (IMC) structure represented in The residuals ( At each sampling instant the values of the manipulated variables are calculated based on the difference between the output and the reference vectors. Depending on the interactions in the model and the design of the controller, correlation may exist between manipulated variables. This may lead to the detection of spurious correlation or to the non-detection of hidden correlation between residuals and manipulated variables. This would in turn obscure the correct identification of the location of significant MPM. To overcome this Data for analysis should be chosen from a period of time where there is sufficient set-point excitation. Since models are fitted to the sensitivity functions Next the component of each MV that is uncorrelated with all other MVs is computed. Each MV may be represented as When the parameter A discussed in Section A simulation run is initially performed with the nominal plant over 5 From In order to ensure sufficient excitation in the generation of these results, which is one of the requirements for applying the MPM detection algorithm of Craig and MacLeod From In practice a set-point change for LOAD is not very realistic. This is because the LOAD needs to be maintained at a specific value in order to achieve maximum throughput in the mill. Here the set-point change was made to ensure sufficient excitation in order to employ the model-plant mismatch algorithm. A power peak-seeking throughput optimizer is sometimes employed The presence of large non-stationary disturbances, which may be found in actual milling circuits, will also affect the accuracy of the MPM detection algorithm. The way Another common occurrence on industrial milling circuits is measurement biases. As far as these may be seen as external disturbances they may also be handled as The next question that arises is regarding the course of action to take once the model elements containing significant mismatch have been detected. One logical option is to re-identify the elements containing significant mismatch via an open-loop step test of the plant. It is however common for at least one of the model elements to be open-loop unstable which prompts additional consideration in the experiment design. This drawback can, among others, be eliminated through the use of a closed-loop identification procedure. The advantages of using closed-loop identification, as listed by The use of manual step tests to re-identify the model does require some effort on the part of the control engineer, but due to safety concerns such a supervised method is often advisable. Irrespective of the way in which the new model is found, the objective is to minimize the magnitude of the residuals produced over the duration of the experiment. Given that the residual is the difference between the plant and model output, the modelling objective can be written as Open and closed-loop model identification is well documented in As open and closed-loop identification is broadly discussed elsewhere Certain constraints on the parameters supplied by the minimization algorithm are imposed to ensure that reasonable results are obtained. When the parameters for a transfer function containing a time delay have to be calculated, it is logical to constrain the minimization algorithm to produce a time delay value that is non-negative. This is because the time delay can only be equal to or greater than zero. The constraint for the gain can be given as The overall MPM detection and model re-identification process is shown in The application of the minimization algorithm for partial re-identification will now be illustrated for the case where the gain of Next the sequential quadratic programming algorithm is used to determine the parameters ( Although this example shows how the automatic model update algorithm handles a transfer function element that contains large uncertainty, it does not show the full potential of the algorithm. This is because the algorithm is basically only required to find the correct gain to minimize Sufficiently exciting signals are once again required for the correct operation of the re-identification strategy. This paper describes a simulation study of the application of model-plant mismatch detection and model re-identification to a ROM ore milling circuit under MPC control. The milling circuit model used is a linear time-invariant approximation of a fundamental milling circuit model. Model-plant mismatch, motivated from industrial experiments, is introduced in the model and its location in the multivariable matrix model is correctly detected. Next the new model is re-identified by making use of a sequential quadratic programming algorithm to explicitly minimize the residuals. For the MPM detection and re-identification strategies to work adequately, sufficiently exited signals are required â€“ if this does not occur during normal plant operation, setpoint changes in the relevant outputs may have to be introduced. This study shows how the re-identification strategy can be automated, but it is not recommended that this procedure be applied blindly. Due to safety concerns the process engineer should firstly inspect the re-identified model before the controller is redefined therewith. The models used to find the component of each MV that is uncorrelated with all other MVs in the time constant mismatch detection step are listed here. They are all in the form