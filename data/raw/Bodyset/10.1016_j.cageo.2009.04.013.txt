Regionalized variables with discrete distributions are commonly associated with counts of individuals (precious stones in ore deposits, wild animals in ecosystems, trees in forests, etc.), that can be represented by a spatial point process. In this paper, we propose to model the point distribution by a Cox process, i.e., a Poisson point process with a random regionalized intensity. The model is parsimonious and versatile, as it allows fitting the histogram of the count variable, its variogram and madogram. Simulation conditional to data is performed by recourse to iterative algorithms based on the Gibbs sampler. Computer programs are provided for parameter inference and for simulation, and an application to a forestry dataset is presented.Discrete-valued observations (counts) associated with spatial point processes are encountered in various fields of applications, e.g., evaluation of mineral deposits (counts of diamonds in kimberlite pipes, or of gold grains in alluvial placer deposits), forestry (counts of trees of a given species), ecology (sightings of wild animals), epidemiology (disease mapping based on reported infection cases), pest management (counts of infected plants), environmental sciences (radioactivity counts). Several approaches are available to model the distribution of count variables and to predict the outcomes at unobserved locations. One option is the application of kriging methods. Apart from traditional linear kriging, which can be used for both continuous-valued and discrete-valued variables, specific approaches have been developed for dealing with count data, among which one can mention transitive kriging ( Another option is the recourse to hierarchical models, in which the count variable is driven by a latent (hidden) random field that accounts for the spatial variations in the counts. The construction is hierarchical as, once the latent random field is fixed, the counts at different locations are assumed to be mutually independent. These models have been widely used for developing variants of kriging, such as binomial and Poisson kriging ( In this work, we will consider a specific model (the Cox point process) for describing the spatial distribution of discrete-valued observations or counts. The model is hierarchical and driven by a random field (known as To propose a methodology for inferring the model parameters based on the fitting of the histogram and spatial continuity measures of the count data. To present a parametric family of random fields for modeling the potential, including Gaussian and gamma random fields as particular cases. To present algorithms for conditional simulation, in order to assess the uncertainty in the outcomes of the discrete-valued (count) variable. To provide a set of computer programs and to illustrate them on a case study. The aforementioned kriging approaches (transitive, disjunctive, binomial, Poisson kriging) are helpful for spatial prediction and for quantifying the uncertainty in the outcome of the variable at a location without observation. In comparison, conditional simulation allows a deeper analysis, since it provides measures of the joint uncertainty at multiple locations ( Consider a Poisson point process in The number  If { Because of the last property, there is no stochastic dependence between the numbers of points observed in non-overlapping domains of space. Hence, the spatial structure of the point process is entirely controlled by the (deterministic) regionalized intensity function In practice, the intensity of the point process is often uncertain in areas without data, so that it is convenient and more parsimonious to use a stochastic modeling of this intensity. This leads to the so-called In general, there exists a stochastic dependence between the numbers of points observed in non-overlapping domains, due to the spatial dependence structure of the potential field The Cox process has been used in the geosciences for modeling natural hazards ( Assume that the numbers of points have been counted in a set of non-overlapping domains { In practice, knowing the distribution of the counts, i.e., the distribution of The motivation for choosing a generalized Sichel distribution is the capability to model a very large family of univariate distributions for the count data, in particular highly skewed distributions such as stone number frequencies in diamondiferous deposits (    Other choices of univariate distributions are possible. For instance, one can assume that the potential field has a lognormal distribution, which yields a point process known as log-Gaussian Cox process ( There exists a simple relationship between the covariance function of the potential field and that of the counts ( This equation proves that The knowledge of the covariance function of the potential random field still leaves a large indetermination on this field and many models can be designed. In this work, we consider the case when the potential  δ∈ {  The motivation for the model proposed in   In the general case, ( The proposed model depends on the parameters ( Find the parameters ( Choose a value for the shift parameter Construct a conversion table between the potential field and its chi square transform: Simulate a large number of independent random variables with generalized inverse Gaussian distribution. Simulate a large number of chi-square random variables with 1 degree of freedom and shift parameter The conversion table, which models the transformation function Calculate the sample variogram of the available count data for various lag vectors (or lag classes if distance and/or angle tolerances are taken into account). Calculations can be done by the method-of-moments approach or by recourse to robust variogram estimators ( Propose a model for the correlation function For each lag vector Simulate a large number of bi-Gaussian pairs { Shift and square the simulated values, then back-transform by using the conversion table obtained at step (3). Obtain realizations of { Simulate independent Poisson random variables with parameters If the variogram calculated at step (6) does not satisfactorily fit the sample variogram obtained in (4), then go back to step (5) and propose another correlation function To better determine the spatial structure of the potential field, the above procedure (steps (4)–(7)) can also be applied to structural tools other than the variogram, in particular indicator variograms associated with specific thresholds, or variograms of different orders, e.g., the madogram or first-order variogram ( Unlike with Bayesian approaches, here the model parameters ( We now address the problem of simulating the count variable Conditional simulation consists of the following steps: Simulate Simulate the Gaussian random field At each target location Steps (2) and (3) are straightforward and the only difficulty concerns step (1). According to Bayes’ theorem and Eqs. define a random permutation { set set simulate calculate the conditional probabilities associated with the former and new states:   simulate a uniform random variable if  set if The iterative algorithm (steps (a)–(i)) must be run until a maximum number of iterations has been reached, ensuring the convergence of the simulated vector To initialize the Gibbs sampler, it is convenient to simulate each component This inequality allows simulating Simulate Simulate a uniform random variable If Rejection sampling can also be used in the iterative steps of the Gibbs sampler, which leads to the following acceptance criterion at step (g) (corrected from However, criterion To illustrate the proposed algorithm, a non-conditional realization is generated on a 400×400 grid ( One hundred locations are selected at random (uniformly) among the 160,000 grid nodes ( The proposed algorithm can become time-consuming if the conditioning dataset is very large (say, over a few thousand data), insofar as it requires solving a kriging system in the Gibbs sampler (step 1(d)) and in the conditional simulation of The algorithm for parameter inference proposed in The reader is referred to the header of the program file for details on the input and output parameters. Alternatively, program COXINFER can be used with an external parameter file (by default, COXINFER.PAR), in which case there is no need to enter the parameters in the Matlab workspace ( The simulation of generalized inverse Gaussian random variables (step 3(a) of    Simulate a standard Gaussian variable Calculate The simulated variable is The conditional simulation algorithm presented in    The input parameters (see header of the program file for details) consist of: information on the locations targeted for simulation: coordinates, block discretization if a change of support (regularization) has to be considered; information on the conditioning data: coordinates, count values, trimming limits, parameters ( spatial structure of the potential field: shift parameter simulation parameters: numbers of lines to use for turning bands simulation, number of realizations to generate, seed for random number generation, number of iterations to use for the Gibbs sampler; information on kriging neighborhood: radii, angles, octant division and number of data per octant; information on the output: name of output file, presence of a header in this file. The output of program COXSIMU is an external ASCII file with the simulated values of the count variable (one column per realization). For simulations at regular grid nodes, the nodes are ordered point by point to the east, then row by row to the north, and finally level by level upward. As for the inference program, COXSIMU can also be used with an external parameter file (by default, COXSIMU.PAR), without the need to specify the input arguments in the Matlab workspace ( In this section, the proposed model and programs are applied to a forestry case study. The dataset consists of 108 measurements from a ground survey in a forest domain located in southern Chile (Arauco Province) and owned by Bosques Arauco S.A. Each measurement corresponds to a rectangular plot of about 500 To assess the wood resources that can be recovered, it is of interest to predict the number of trees, both globally over the entire domain and locally, and to measure the uncertainty in this number. To fulfill these goals, the spatial distribution of trees will be modeled by a Cox process, as described in The histogram of tree counts ( the mean should be no more than the nugget effect, i.e., approximately 25 (Eq. the variance should coincide with the variogram sill, i.e., approximately 120. Based on these statements, the parameters of the negative binomial distribution (Eq. The remaining parameters of the model (correlation function    Note that the model parameters have been determined only on the basis of the univariate and bivariate distributions of the count data, and higher-order distributions (multiple-point statistics) have not been examined. Therefore, as long as the sample histogram, variogram and madogram are deemed reliable, there is no real danger of over-fitting, i.e., the selected parameters are expected not to exceed the content of information contained in the data. To put the fitted model to the test, leave-one-out cross-validation is performed. At each data location, the number of trees is simulated one thousand times conditionally to the remaining data, and a prediction is obtained by averaging the simulated values. Having determined and validated the model parameters, we can now simulate the numbers of trees over the study domain by using program COXSIMU. The domain is covered by a regular grid containing 5662 cells with size 22.4×22.4 The average of the realizations is almost the same as the ordinary kriging predictions: the correlation coefficient between kriging and the average of realizations is equal to 0.997 for traditional kriging and to 0.999 for Poisson kriging. Also, traditional and Poisson kriging yield estimated totals of 176,230 and 176,095 trees, respectively, which are very close to the expected number (175,545) found via conditional simulation. However, in contrast to the kriging approaches, simulation aims at reproducing the spatial variability and allows determining probability intervals on the number of trees (either globally or locally) and quantifying the risk of not meeting planned production targets. For instance, let us assume that the area will be harvested by skidding at a rhythm of 7.45 One motivation of this work was to present a stochastic model for representing discrete-valued regionalized variables associated with count observations. The proposed Cox process turns out to be versatile and parsimonious, as it depends upon few parameters that allow fitting the main characteristics of the discrete-valued variable: univariate distribution (histogram) and spatial continuity (variogram, madogram, or other continuity measures). Because the process is driven by a potential obtained by transforming a Gaussian random field, conditional simulation is easily performed by recourse to iterative algorithms. Of course, many other random field models could be designed for representing the potential, in particular models based on operations and/or combinations of Gaussian random fields, for which the Gibbs sampler is well-suited ( The proposed approach can also be enriched by including covariates spatially correlated with the potential field. For instance, in the presented forestry case study, one could think of physiographic variables such as terrain elevation, slope and profile curvature to explain the spatial variations of the number of trees. Adaptations of the simulation algorithm to the multivariate framework are straightforward (the mean and variance of the conditional distributions of A difficulty of the algorithm (not tackled in this work) is that all the samples must have congruent supports and the total domain must be divisible into the sample support. If these requirements are not fulfilled, compensation techniques must be introduced to reshape and resize the sample supports to proper dimensions ( The authors are grateful to the anonymous reviewers for their constructive comments. The first author also acknowledges the Chilean Commission for Scientific and Technological Research (CONICYT) for funding the Advanced Mining Technology Center at the University of Chile. Supplementary data associated with this article can be found in the online version at 