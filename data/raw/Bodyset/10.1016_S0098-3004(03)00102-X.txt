The authors describe the structure and implementation of SPECSIM2, an ANSI Fortran-77 program for simulating anisotropic two-dimensional random fields via a spectral approach. This new program overcomes the limitation of the previously published version (Pardo-Igúzquiza and Chica-Olmo, Comput. Geosci. 20 (4) (1994) 597), which was confined to the direct generation of isotropic fields with any anisotropy imposed by a subsequent co-ordinate transformation.
                  The diagonal symmetry of the two-dimensional covariance function with respect to the origin, i.e. C(x,y)=C(−x,−y) and C(x,−y)=C(−x,y), implies that its Fourier transform (i.e. the spectral density) is real (the imaginary part vanishes). This observation leads to a straightforward direct simulation of anisotropic fields by the spectral method. Examples are given to demonstrate the performance of the method using semi-variograms with or without nugget effects and with simple or nested structures, as well random fields with several structures that have different anisotropy angles.Geometric anisotropy is a common form of spatial variability for two-dimensional data (i.e. data located in a plane) and is reflected in experimental semi-variograms with directionally dependent ranges. Zonal anisotropy (also called stratified anisotropy, There is a belief that spectral methods (as introduced by Diagonal point symmetry implies that the simulation of anisotropic fields is no different to the simulation of isotropic fields; the former can be achieved by sampling the anisotropic covariance in the general spectral simulation algorithm. The algorithm for spectral simulation in two dimensions, given in Sample the stationary covariance (or semi-variogram) model that is to be reproduced by the simulation. The sampling grid is the simulation grid. Calculate the discrete spectral density from the discrete covariance by means of the (fast) Fourier transform. Calculate the discrete amplitude spectrum from the discrete spectral density. Except for multiplicative constants, the amplitude spectrum is the square root of the spectral density. Generate a random discrete phase spectrum. The amplitude spectrum and phase spectrum are the Fourier transforms of a real random field and thus the random field can be obtained by the inverse (fast) Fourier transform of amplitude and phase spectra. The simulated random field reproduces the covariance sampled at step 1. The method is general and any second-order stationary covariance (with or without nugget effect, with simple or with nested structures) can be sampled and then reproduced by the simulation. The method is valid for both isotropic and anisotropic covariances and has been implemented in the SPECSIM2 program, which is an extension of SPECSIM ( SPECSIM2 is the main program, which calls four external subroutines ( Subroutine AMSPEC4 samples the covariance and calculates the spectral density and amplitude spectrum. The simulation grid is defined by its origin, ORX and ORY, in the Apart from the nugget effect, the structures that comprise the semi-variogram (covariance) model may be isotropic or anisotropic. Each anisotropic structure may have a different anisotropy angle. In practice, however, all structures usually have the same anisotropy angle because geometric anisotropy is generally due to some global geological characteristic that affects all structures in the same way. Four different semi-variogram models have been used to simulate realizations on a 128×128 grid with unitary grid spacings in the The first example is an anisotropic covariance with no nugget effect and a simple spherical model structure with a longer range of 16 units and an anisotropy ratio of 2; the anisotropy angle is 140° and the variance is 1.0. The covariance and the amplitude spectrum are shown in The second example is an anisotropic covariance with an anisotropy ratio of 8.0. The longer range is 40 units and the anisotropy angle is 45°. The model has no nugget variance and the covariance is spherical with sill equal to 1.0. The 3D representations of covariance and amplitude spectrum of the anisotropic field are shown in The third example is an anisotropic covariance model with a nugget effect of 0.2 units of variance, and two nested spherical structures. The first structure has a sill equal to 0.4 variance units, a longer range of 10 units, an anisotropy angle of 20°, and an anisotropy ratio of 2.0. The second structure has a sill of 0.4, the longest range of 50 units, an anisotropy angle of 20° and an anisotropy ratio of 5.0. The covariance model and amplitude spectrum are shown in The fourth example is an anisotropic covariance model with a nugget effect of 0.2 units of variance, and two nested spherical structures. The first structure has a sill equal to 0.4 variance units, a longer range of 50 units, an anisotropy angle of 120°, and an anisotropy ratio of 4.0. The second structure has a sill of 0.4, a longer range of 20 units, an anisotropy angle of 30° and an anisotropy ratio of 5.0. The covariance model and amplitude spectrum are shown in There are no noticeable artefacts on the generated random fields shown in The spectral method of simulation has been adapted for simulating anisotropic random fields with nested semi-variograms in which each structure may have a different anisotropy angle. The method has been implemented in the SPECSIM2 program. Four examples have been given to demonstrate the quality of the generated images, in the sense of the absence of artefacts and faithful reproduction of the semi-variogram models. The method has the same advantages and disadvantages as the original spectral method. For example, the realizations are multivariate Gaussian and conditioning is a post-simulation process achieved, for example, by kriging or the method of phase identification ( The method proposed here is a modification of the well-known spectral method of simulation and it thus shares the advantages and disadvantages of the basic method (see, for example, This work was supported by UK Engineering and Physical Sciences Research Council (EPSRC) grant reference number GR/M72944.