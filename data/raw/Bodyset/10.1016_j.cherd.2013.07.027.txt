Although the process of heap leaching is an established technology for treating minerals, such as copper, gold, silver, uranium and saltpeter, as well as remediating soil, no studies to date have investigated process optimization. This work presents a methodology for the design and planning of heap leaching systems to optimize the process. This methodology consists of the creation of a superstructure that represents a set of alternatives to search for the optimal solution; from this superstructure, a mixed integer nonlinear programming (MINLP) model was generated, and a BARON-GAMS solver was used to find the optimal solution. This method was applied to the extraction of copper from systems with one, two and three heaps, and the effects of copper price, ore grade and other variables were analyzed for each system. From the results, it can be concluded that this methodology can be used to optimize heap leaching processes, including planning and design issues.{ { { { area of heap (m recovery constants for disjunction model acid consumption constants for disjunction model costs (MUS$) cost of building a heap total fixed cost of heap acid consumption at infinite time (kg/ton) acid consumption of heap initial acid consumption (kg/ton) acid consumption of heap total acid consumption (kg/cycle) variable cost of heap operational cost before leaching of heap operational cost after leaching (MUS$/ton) linear availability of species planning time horizon (days) income (MUS$) mass flow from process unit input mass flow to process unit output mass flow from process unit molecular weight of acid (ton/ton-mol) molecular weight of species mass of mineral loaded on heap constant in the big number of cycles production of species price of species price of acid (MUS$/kg) volumetric flow from process unit output volumetric flow from the recovery from heap recovery of species recovery at infinite time (%) cycle time of the heap system (days) end time of leaching of heap profits (MUS$) weight factor for income weight factor for cost concentration of stream from process unit concentration of output stream from the binary variable of the cycle times disjunctive binary variable height of heap (m) recovery constants for acid consumption constant for the analytical model ore density (ton/m grade of species k in the ore (%) lower bound upper bound disjunctive Heap leaching is a hydrometallurgical process that is widely used in the mining industry, in which low-grade metals, such as copper, gold, silver and uranium, are extracted; the process also has new applications in the treatment of non-metallic minerals, such as saltpeter ( Heap leaching is a mineral processing technology in which piles of ore (crushed or run-of-mine rock) are leached with various chemical solutions to extract valuable minerals. Large tonnages are involved, and metal is recovered over a long period. As shown in The objective of this research was to develop a methodology that allows design and planning to simultaneously find the optimal operational conditions, such as recovery and leach time, and the optimal design parameters, such as heap height. The methodology is based on a superstructure that represents the flowsheet alternatives and a mathematical model that is solved through a mixed integer nonlinear programming (MINLP) approach. The development of the model with its superstructure and corresponding equations is provided in Section The design and planning of heap leaching systems is a coupled problem. The purpose of this work is to develop a methodology to design and plan heap leach systems. To accomplish this goal, a superstructure representing a set of flowsheet alternatives to look for the optimum solution was constructed, based on which a mathematical model was developed using mass balances and their corresponding operational conditions to obtain a model that can determine the values of variables and parameters affecting the process. The resulting model corresponds to an MINLP. The superstructure was built based on heap leaching and solvent extraction units. The schematic in To develop the mathematical model, the following sets are defined. First, the set of units is defined as To perform the corresponding balances, the following assumptions were considered. (a) The evaporative water losses are compensated for with fresh water so that the water losses and fresh water flow rates are null. The water balance and the cost of water losses were not considered because these balances and costs depend on weather conditions, heap irrigation technology, and evaporation losses/evaporation mitigation technologies in solution pools. (b) The heaps are considered to be in a series, where heap Eq. The balance of acid consumption is given by Eq. The total acid consumption is the sum of the acid consumption for each heap, that is, For the mixers and dividers, the mass balance per component was performed based on the input and output mass flows rates of the different process units. There is a mixer and a divider on each process unit The mass balance for species To design and plan the heap leaching process, certain restrictions must be considered. First, the number of cycles throughout the planned time horizon must be obtained as follows: Note that if a non-overlapping operation is used, then the cycle time is the sum of the operation times of all heap units. Heap In this work, Eq. The following operational bounds must be considered to achieve satisfactory results. These restrictions include lower and upper bounds in the mass flows, the height of the heap, the recovery, the number of cycles and the cycle time as follows: In the following discussion, the expressions to calculate some bounds and parameters are given. First, the model uses the mass flow rates of species In addition, from Eq. The expression to be maximized is an economic optimization that must be simultaneously maximized in terms of income and minimized in terms of costs. The income is represented as the total production multiplied by the price, and the cost is the number of cycles produced multiplied by the cost of each heap over the time horizon. A possible expression is represented in Eq. The income, In addition, the cost, Then, the cost of building and operating heap In this work, two methods are used to express the recovery of copper, but different models can be used depending on the leaching technology and the leached ore. First, a disjunctive expression is used to approximate the recovery using straight lines, and an analytical model developed by The recovery is expressed by straight lines for different time ranges and heap heights. The disjunctive expression of recovery in Eq.  The parameters of Eqs.  Similarly as for copper recovery, two ways of expressing the acid consumption were used. First, a disjunction expression based on straight lines for different time ranges and heap heights was used, and then an analytical model was used. The disjunctive expression is written as follows: The disjunctive expression for acid consumption in Eq. The analytical model is The parameters of Eqs. The disjunctive model of acid consumption (Eqs. This section illustrates the application of the model for the copper heap leaching process in systems of one, two and three heaps to analyze the effects of variables such as copper price, heap size, ore grade, acid price and variable cost on the process. The case studies consider a heap of 200,000 We must consider that the variable cost, the pre-leaching cost and the total cost in systems with two and three heaps apply only to the first heap. In other words, the costs of heaps two and three are zero because the heaps operate in series and because their costs have been considered in the first heap; furthermore, it is assumed that the operational cost of heaps two and three can be neglected. In the following sections, the three studied cases are shown, which were implemented in GAMS and solved by BARON using an AMD Athlonâ„¢ II Dual-Core M300 2.00 The one-heap leaching case corresponds to the application of the model to a heap leaching system with the corresponding variables, parameters ( For this system, the effects of the copper price, ore grade, heap area, acid price and variable cost were studied using both the disjunctive model and the model by Copper prices significantly affect the profits of the process; higher copper prices result in a larger income and therefore greater profits. However, variables such as recovery, cycle time, and heap height did not change. The second and third columns in The heap area does not affect the height of the heap, number of cycles, recovery or cycle time; however, it does affect profits, as the production of copper increases with heap size. When the effect of the ore grade on the system is analyzed, a strong impact on the cycle time and recovery is observed, along with an effect on the profits, which increase as the ore grade increases. Nevertheless, no changes in the heap height are observed (9 The effect of the variable cost (assuming constant expenses for acid consumption), including expenses for power, water consumption, ore transportation, maintenance and labor, is significant. If the variable cost is increased, the cycle time and recovery increase proportionally, and profits and income decrease. The effect of the acid price was studied separately from other variable costs. When the effect of the acid price on the system is analyzed, an impact on the cost and profit is observed: cost increases and profit decreases as the acid price increases. Nevertheless, no change in the height of the heap is observed (9 The models are applied to a system formed by two- and three-heap leaching units to compare its behavior to the single heap system and to observe the effect of parameters such as copper price, heap area, ore grade, acid price and variable cost. The results obtained in these systems show a trend similar to that obtained for the single heap leaching system. For example, when the copper price increases, the profits increase in systems with one, two and three heaps. In addition to the copper price, the variation of profits with other parameters is important to characterize. As in the single heap system, if the ore grade is increased the cycle time decreases, and, therefore, the number of cycles increases; the only difference in these cases is the shorter leaching time. With more heap leaching units in a system, the leaching time in each heap is shorter.  In addition, the recovery decreases as the ore grade increases in the different systems. As shown in As in the single heap system, if the acid price is increased the cost increases, and therefore the profit decreases. In all of the systems, the heap height calculated using the disjunctive model was 9 Finally, As shown in these studies, parameters such as copper price, ore grade and variable cost have an important effect on the profit as well as on some process variables. In addition, the results of the disjunctive and Convergence problems and local optima can be attributed to the fact that the model is a mixed integer nonlinear programming problem; it is nonconvex due to exponential terms (recovery in the In this work, a method has been developed to plan and design a heap leaching system. Two models were used to calculate the recovery, one based on disjunction and the other based on the model by As determined in the copper leaching cases that were studied, one of the primary variables affecting the profit of the process is the copper price, as expected. Additionally, certain other variables are shown to be important, such as the ore grade, acid price and the variable cost, as they significantly affect the operation planning and the profit. The cycle time and recovery decrease, but the profit increases with increasing ore grade. In addition, the cycle time and recovery increase, but the profit decreases with increases in variable costs. The cycle time decreases in systems with more than one heap. Moreover, the use of more than one heap allows better control of the irrigation rate in each heap. These results show that as the number of heaps increases, there is more flexibility in planning and a greater production capacity. This study has shown that the design (heap height) and planning of a heap leaching operation are coupled problems from an economic perspective, and therefore, these variables must be included in the model. This coupling occurs because these are interactive factors, and these variables affect both the recovery and the capacity of the operation in the heap leaching process. In addition, the results of the analytical model by Finally, this study should be considered as a new step in the development of methodologies for the design and planning of heap leaching systems, and future studies must include the effect of other variables, such as the particle size, irrigation rate and acid concentration, to predict the optimal operational conditions. The authors wish to thank CONICYT for its support through the Fondecyt Project 1090406 and 1090592.