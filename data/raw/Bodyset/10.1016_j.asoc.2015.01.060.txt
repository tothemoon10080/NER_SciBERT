The optimal layout or geometry of the production area (stope) in an underground mining operation maximises the undiscounted value subject to the inherent physical, geotechnical, and geological constraints. Numerous approaches to develop possible stope layouts have been introduced. However, owing to the size and complexity of the problem, these approaches do not guarantee an optimal solution in three-dimensional space. This article proposes a new heuristic algorithm that incorporates stope size variation for solving this complex and challenging optimisation problem. A case study demonstrates the implementation of the algorithm on an actual ore body model. In a validation study, the proposed algorithm generates 10.7% more profitable solution than the commercially available Maximum Value Neighbourhood (MVN) algorithm.The prerequisite to inception of a successful mining operation rests in the existence of adequate supply of ore (valuable raw material) or economic reserves. A decent supply of ore guides the selection of the appropriate production scale of an operation and assists in reducing the corresponding costs of producing ore The foremost step in mine planning process resolves the question on mining a particular ore body through a surface or an underground operation. While, spatial (size, shape, depth, location) characteristics of the ore body facilitate the solution to this question, the economy remains the driving force that guides this selection between surface or underground mining operation. If this strategic decision is made in favour of an underground mining operation, then, at the same time, among a few available options, the most appropriate underground mining method may be selected. The selection of an optimal stope layout is the core to mine planning process in the majority of underground mining methods, because, it dictates the net present value maximisation in subsequent production scheduling    Given this stope layout, the metal content (average grade or the quality of ore) as well as volume and density of ore (consequently, the quantity or tonnes of ore) in each stope is calculated from the quality and quantity of ore available in the mining blocks that are combined to form a stope. This qualitative and quantitative information describes the economic value of stopes, which becomes input to the subsequent production scheduling formulations aiming to maximise the discounted value of future cash flows under physical and geotechnical constraints Given the physical and geotechnical constraints or characteristics of the available material, a predefined (safe) stope size becomes a requirement, which ultimately guides the possible set of mining blocks included inside a stope  These possible combinations may consist of both ore and waste blocks. If the total negative economic value from waste blocks of a stope is higher than the total positive economic value from ore blocks of that stope, the overall economic value of a stope can be negative. Similarly, when the total positive economic value of the ore blocks of a stope is higher than the total negative economic value of waste blocks of that stope, the overall economic value of a stope can be positive. However, out of several possibilities, a mining block may be combined with other mining blocks to become part of a stope that maximises the overall economic value of the underground mining operation It is evident that in this simple example, for candidate mining block A, the evaluation procedure requires analysing six (6) possible combinations of stopes for a predefined stope size of 2  Over the years, a number of algorithms have been developed and implemented to solve the stope layout optimisation problem. The existing stope layout optimisation algorithms may be classified as exact and heuristic Ovanic and Young Alford Cawrse Ataee-Pour Griceo and Dimitrakopoulos Sens and Topal Bai et al. Given the computational complexity of the problem, it may be concluded that previous studies do not offer solution to the problem as a whole, and consequently, lack in the development of an optimal stope layout for an ore body in three-dimensional space. However, as opposed to exact methods, heuristic approaches Realising the performance of the heuristic methods The proposed heuristic algorithm considers an ore body model consisting of mining blocks and relevant economic parameters as an input, translates the grade and tonnage of a mining block in the ore body model into an economic value of a mining block (i.e. converts the ore body model into an economic block model), and then develops an optimal stope layout by maximising the total economic value (profit) subject to the physical and geotechnical constraints. The following notations are defined for explaining the steps of the algorithm:  block indicator of a regularised block model stope indicator indicator for a set in a family of non-overlapping stopes sets indicator for a unique set in a family of non-overlapping stopes sets location ( length (m), width (m), and height (m) of block metal content or grade (% or g per t) of block material density (t per m metal weight (g) of block total weight (t) of block economic value ($) of block location ( length (m), width (m), and height (m) of stope metal content or grade (% or g per t) of stope material density (t per m metal weight (g) of stope total weight (t) of stope economic value ($) of stope number of mining blocks inside stope location ( location ( economic value ($) of unique non-overlapping stopes set The steps of the proposed algorithm are as follows: Initialise all variables, read relevant ore body model and associated economic/technical parameters, convert the ore body model to an economic block model (i.e. calculate Aggregate mining blocks to generate set of possible stopes Update the attributes of stope  Extract a subset Identify overlapping stopes in  Create a family of unique sets of non-overlapping stopes Calculate the value Determine the maximum   This section presents the implementation of the algorithm at a realistic ore body model. The ore body model represents a standard copper deposit consisting of 47,052 irregular sized blocks with the largest size being 20 The steps of the proposed algorithm have been implemented through C# in Microsoft During initialisation, upon reading the relevant information, the algorithm transforms the original (irregular) ore body model to regular mining blocks with a fixed size of 10 Given the positive-valued stopes from step (4), the possible combinations to generate sets of non-overlapping stopes in step (5) are enormous (infinite), leading to the computational complexity of the problem. The algorithm is thus modified to address this issue. As such, the modified algorithm implements step (5) over a number of iterations. In each iteration, the algorithm limits the sets of non-overlapping stopes to a predefined count, implements steps (5) to (6), and records the highest value solution through equation (7). For each subsequent iteration, it increments the count for sets of non-overlapping stopes to a new value, repeats steps (5)â€“(8), performs a comparison of new and old solutions, and continues until the convergence of the solution.   In this section, the performance of the proposed algorithm is compared with MVN algorithm that has been implemented in commercially available mining software  This article presents an innovative heuristic algorithm to solve the stope layout problem for an underground mining operation. The algorithm takes an ore body block model as an input, generates a set of all possible stopes, and recommends the unique solution which maximises the economic value of the stope layout under physical and geotechnical constraints. The article describes and establishes the computational complexity of the stope layout problem, more specifically, in the context of generating unique and non-overlapping stopes, and unlike previous studies, an implementation of the algorithm in an actual case study reflects the success in addressing the computational complexity of the problem. The application of the algorithm in cases A and B demonstrates that the algorithm is robust and its structure ensures convergence to the highest economic value, however, depending upon the stope size and resulting stope combinations, the solution time to generate the optimal stope layout may vary from one scenario to the next. The validation study indicates that the proposed algorithm generates more profitable solutions than the industrially available MVN algorithm for realistic block models. While, the proposed method generates unique and non-overlapping stopes, it is limited to the predefined stope sizes. Also, it ignores the stope shape variations and the provision of rock pillars between consecutive stopes for improved stability of these production zones. Therefore, in future, it will be worth incorporating these additional features into the structure of the algorithm.