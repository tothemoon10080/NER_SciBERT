The simulation of vector random fields whose spatial correlation structure is represented by a linear coregionalization model can be performed by decomposing the vector components into spatially orthogonal factors and by simulating each factor separately. However, when the number of basic nested structures is large, so is the number of factors, making simulation computationally demanding.
                  This paper proposes a methodology to construct linear coregionalization models with as many nested structures as desired, together with as few orthogonal factors as possible. The construction rests on the decomposition of the model coregionalization matrices into pairwise commuting matrices, followed by a factorization by principal component analysis. The proposed approach is illustrated through a case study in mineral resources evaluation and compared to the traditional fitting procedure, obtaining an equally good fit of the direct and cross variograms but with significantly less factors.The background of this paper is the simulation of stationary Gaussian vector random fields whose spatial correlation structure can be represented by a linear coregionalization model, a problem commonly found in mineral resources evaluation, hydrogeology, geochemistry, reservoir modeling, soil and environmental sciences ( For instance, two widespread factorization techniques (principal component analysis and minimum/maximum autocorrelation factors) provide as many factors as vector components, but these factors are spatially orthogonal under quite specific restrictions, such as having a linear coregionalization model with only one or two basic nested structures ( In the following, we will work in the Euclidean space Because the proposal for the desired decomposition relies on both principal component and coregionalization analyses, these two approaches are briefly recalled in the next section. Subsequently, the theoretical and practical backgrounds of the proposal will be explained ( Let us consider the spectral decomposition of the variance–covariance matrix of Accordingly, the covariance matrix of the vector random field In particular, because of Eq. From Eq. In turn, this property (simultaneous diagonalization) is equivalent to the following: for any set of lag vectors On account of Eqs. The previous results (simultaneous diagonalization and commutativity of coregionalization matrices) have already been mentioned by other authors ( coregionalization model with a single structure (i.e., coregionalization model with two structures, one of them (nugget effect) associated with a coregionalization matrix proportional to the identity matrix; coregionalization model will block-diagonal coregionalization matrices, such that the components of Coregionalization analysis ( Each of these vector random fields is then factorized through principal component analysis, by putting: In the following, it is of interest to reduce the number of orthogonal factors with respect to coregionalization analysis, considering the general case of a linear coregionalization model with Suppose that there exists an integer ∀ ∀ As with coregionalization analysis, by decomposing In practice, given a linear coregionalization model (Eq. Two criteria may be used to determine the model: The number The modeled covariances fit the sample covariances as well as possible. For instance, one can minimize the following weighted sum of squares, which measures the deviation between sample and modeled covariances:    Alternatively, the weighted sum of squares In order to satisfy the commutativity condition, a particular subset of coregionalization matrices will be considered for the modeling of direct and cross covariances or variograms. Specifically, we will assume that the The model in Eq. the number the basic symmetric matrices the polynomials For a given value of The starting point is an initial guess of the coregionalization model, which provides a set of coregionalization matrices First, a coregionalization model with Once the coregionalization model with The same procedure is repeated recursively to construct models with The algorithm described in   The inputs of program VMODEL are the following: AZM: azimuths of sample directional variograms ( DIP: dips of sample directional variograms ( NLAG: number of lags of sample directional variograms ( TAIL: indices of tail components of sample directional variograms ( HEAD: indices of head components of sample directional variograms ( GAM: matrix containing information on lag distances, number of data pairs and sample variogram values (sum( MODEL: nested structures used in the linear coregionalization model ( CC: sills of the nested structures for an initial guess of the linear coregionalization model ( SIGMA2: set of weights WEIGHT: an option to define the weights ϖ weights are the same weights are proportional to the number of data pairs weights are inversely proportional to the lag distance weights are proportional to the number of data pairs and inversely proportional to the lag distance. SILL: an option to fix the sills of the direct variograms of the initial coregionalization model (0=no, 1=yes). In the latter case, a set of supplementary sample variogram values corresponding to the fixed sills are considered in the non-linear least-squares fitting procedure, associated with large weights ϖ DISPLAY: an option to display the sample and modeled direct and cross variograms for each possible choice of The outputs of program VMODEL are B: set of coregionalization matrices EIGENVECTORS: eigenvector matrices that simultaneously diagonalize the members of a given set of commuting matrices. The first two fields correspond to the indices of rows and columns (between 1 and WSS: weighted sum of squares between sample and modeled variograms (Eq. The advantages of the proposed approach over traditional coregionalization analysis are twofold. The first advantage is of computational nature. Despite the recent advances in computer technology, the simulation of large-size vector random fields is still computationally expensive. An example is the modeling of large polymetallic ore deposits with five or more elements of interest, for which it may be necessary to simulate tens to hundreds of millions of point-support values ( The second advantage relates to model interpretation. The orthogonal factors obtained by coregionalization analysis are often interpreted as underlying components operating at different spatial scales ( The following case study deals with a dataset from a copper–silver ore deposit located in northern Chile and sampled through exploration drill holes. The samples have been assayed for the copper (main product), silver (by-product) and arsenic (contaminant) grades. The data statistics are summarized in In order to cosimulate the grades, the original data are transformed into normal scores. The normal scores variograms are then calculated in the horizontal plane and along the vertical direction, identified as the main anisotropy directions, and fitted with a linear coregionalization model. The initial fitting considers four nested structures (a nugget effect, two exponential models and a spherical model, with parameters specified in the instruction file provided together with this article) and is done in order to ensure a unit sill for the direct variograms, using the program MGFIT proposed by Program VMODEL is then used in order to determine a set of alternative coregionalization models with a given number The coregionalization models with The coregionalization model with In contrast, the fit is poorer with the model that considers a single set of commuting coregionalization matrices ( A methodology has been proposed to construct linear coregionalization models with as many nested structures as desired but, at the same time, as few spatially orthogonal factors as possible. This methodology relies on the decomposition of the coregionalization matrices associated with the nested structures into sets of pairwise commuting matrices, for which the principal components have no spatial cross correlation. The application indicates that the proposed methodology is straightforward and allows significantly reducing the number of orthogonal factors with respect to classical coregionalization analysis, without losing quality in the fitting of the sample direct and cross variograms. This research was funded by the Consider a linear coregionalization model of the following form: The model in Eq. However, the model can be rewritten in the following fashion: Under this standpoint, one has an From the above example, it is seen that the factors obtained by coregionalization analysis are not unique and depend on how the coregionalization model is written out, which leaves their interpretation quite unclear. In contrast, given that Supplementary data associated with this article can be found in the online version at 