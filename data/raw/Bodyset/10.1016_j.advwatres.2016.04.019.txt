Inverse problems involving the characterization of hydraulic properties of groundwater flow systems by conditioning on observations of the state variables are mathematically ill-posed because they have multiple solutions and are sensitive to small changes in the data. In the framework of McMC methods for nonlinear optimization and under an iterative spatial resampling transition kernel, we present an algorithm for narrowing the prior and thus producing improved proposal realizations. To achieve this goal, we cosimulate the facies distribution conditionally to facies observations and normal scores transformed hydrologic response measurements, assuming a linear coregionalization model. The approach works by creating an importance sampling effect that steers the process to selected areas of the prior. The effectiveness of our approach is demonstrated by an example application on a synthetic underdetermined inverse problem in aquifer characterization.The scarcity of direct measurements of the hydrologic parameters has been long ago recognized as a major impediment to the use of groundwater models and to their full utilization ( However, no matter what the inversion method is, the number of unknown parameters usually exceeds by far the available number of measurements, leading to an undetermined problem. Of course, when, as in the case of geosciences, a spatially correlated model is used, the effective number of free parameters can be much lower. This characteristic is known as ill-posedness and results in non-uniqueness in the solution of the inverse problem. In a Bayesian perspective, the terminology is different. Ill-posedness is not defined anymore and the question can be phrased as whether the likelihood of the data is sufficient or not to constrain the posterior distribution to be different from the prior. Thus, the solution to a Bayesian inverse problem is an a posteriori probability density. Using sampling methods, the goal is to generate a sample from the posterior, such that statistics consistent with the posterior distribution can be inferred. Yet, in addition to the classical optimization methods, a possible approach for the solution to inverse problems is the use of Markov chain Monte Carlo (McMC) techniques ( Howbeit, the use of informative priors in a Bayesian context has been a crucial issue of disagreement ( Adopting the objectivism point of view, we have proposed ( Consider a hydrologic system In a Bayesian framework, the parameters Under this point of view, the probability density functions represent states of knowledge and the Bayesian statistics can be regarded as a mechanism of making inferences on the basis of incomplete information ( As seen in the previous section, the general solution of an inverse problem is a probability distribution over the models space. It is only when this probability distribution is very simple, that analytic techniques can be used to characterize it ( Furthermore, McMC techniques preferentially visit the model space where the posterior density is high. The basic idea behind these methods is to perform a random walk that normally would sample some prior probability distribution and then, using a probabilistic rule, to modify the walk by accepting or rejecting samples in such a way that the produced samples are representative of the target distribution. In inversion problems, McMC techniques generate candidate models from the prior distribution and use an acceptance criterion to reject or not the candidate model under the consideration of likelihood function. A candidate model Different transition kernels have been proposed in previous studies to investigate Markov chains applied to spatially dependent variables. In this work, since the aim is to condition on the state measurements, we use ISR to create a chain of dependent realizations by obtaining a random subset Generate an initial model Iterate on Select randomly a subset Generate a proposal realization Evaluate Accept or reject the candidate model The performance of the method depends on the criterion for candidate model selection ( It is also noted that, even though in this work we apply ISR with two point statistics, its principal is not associated with a specific simulation method or a certain type of spatial variability ( In an optimization context, instead of sampling the posterior, the objective is to reach an optimal solution which maximizes the posterior distribution. Therefore, the searching strategy is to not sample the prior distribution uniformly, but rather to sample the space where the likelihood function is maximized, in order to avoid areas of low fit and quickly obtain samples with a high likelihood. If we consider the case of independent, identically distributed Gaussian measurement errors, then the likelihood function of In order to avoid entrapping in local maxima and explore particular spaces of prior distribution under the framework of McMC methodology, the optimization process requires a large number of independent samples of the prior distribution. Thus, sampling the posterior using McMC techniques raises two important issues: the criterion to accept a state model as a member of a chain and the criterion to accept a model as a member of the posterior ensemble. Concerning the first issue, Concerning the second issue, it is well known that the convergence of the chain must be reached before performing any sampling. In addition, to ensure uniform sampling of posterior, as previously stated, many independent samples of the prior are required. In the usual case where the number of model parameters and thus the number of manifold dimensions is high, as systematic exploration of the prior models space is not possible because the number of required points grows too rapidly with the dimension of the space, while most of these models will have near zero probability. Therefore, sampling has to be done by making small jumps, using a random walk. However, this kind of sampling does not produce independent samples. Then, if the samples of the prior distribution presented to the Metropolis algorithm are not independent, the samples of the posterior distribution produced by the Metropolis algorithm will not be independent ( To overcome this problem,  The main difference between the two approaches is that Mosegaard and Tarantola propose an algorithm whose purpose is to generate a ‘sample’ of the posterior distribution. Mariethoz et al. propose a method that generates a selection of models that fit the data and the prior information. Then, this collection of models provides a good approximation to the posterior. In this work, we adopt the second procedure, which allows the optimization process to be more efficient, reducing the computational cost by skipping the unnecessary forward solutions. A convenient way to cosimulate facies distribution with the reference variables, is to represent these facies by one or more truncated Gaussian variables: Consider a standard Gaussian RF Ιn order to transform between the Gaussian RF and the facies indicators, a proper set of Approximating the proportion of a particular facies We assume that As seen in the previous sections, when inverting under the McMC framework, hydraulic measurements can only be used as indirect data to evaluate the prior models and drive the search path. This inconvenience is due to the nonlinearity relation between hydraulic measurements and unknown parameters. On the other hand, well known cokriging and cosimulation rely on a linear predictor approach and use covariance and cross covariance functions derived from a first-order approximation, therefore they often result in unacceptable solutions when the multivariate distribution of integrated variables is not Gaussian ( In our algorithm, although the problem is not linear, we use cosimulation with the reference data as auxiliary variable, in order to improve the search path in the Markov chains. More specifically, each proposed model In standard geostatistical inverse methods and under the assumption of uniform flow, the coregionalization model can be derived analytically and used in a straightforward manner in cosimulation. Here, the situation is more difficult and more complex since the underlying Gaussian variable is indirectly related via a set of truncation rules and the flow equations to the state variables. We propose the following steps in order to fit a linear coregionalization model: First, one has to infer the variogram of The second step is to define a variogram model for the state variable, using the available measurements. To do so, the state measurements have first to be transformed into Normal scores on which variogram analysis will be performed. The last step is to define a linear coregionalization model between the underlying Gaussian variable Once the process of calculating the experimental variograms is finished, fitting of an appropriate model can be performed utilizing the iterative algorithm proposed by In order to obtain one sample by an interrupted Markov chain, we design an ever‐improving Markov chain that accepts new members under condition ( Generate an initial model Iterate on Select randomly a subset Generate a proposal realization Evaluate If Decide whether or not to interrupt the chain: Compute Draw If u ≤ Hence, the above means of successive linearizations is used to transfer from one model to another at each step of the optimization procedure in every Markov chain. The approach works by creating an importance sampling effect ( The effectiveness of cosimulation is demonstrated by means of a synthetic aquifer example using a pump test. A simple two-dimensional synthetic flow system is set up for that purpose and finite element software package COMSOLۛ 3.4 ( The hydraulic potential governing the flow through the aquifer zone and the surrounding area can be represented by the 2D pressure head Prior information on the aquifer structure consists of a set of 16 facies observations. Using this information together with the 9 head measurements as shown in For the needs of TGS, a standardized Gaussian variable Considering the state variable, the head measurements were first transformed into Normal scores on which variogram analysis would be performed. A Gaussian model with a sill of 1 and isotropic range of 41.5 The last step is to define a linear coregionalization model between the underlying Gaussian variable The experimental, model and cross-variogram of the underlying Gaussian variable and the transformed heads are displayed in For both the C-ISR and ISR approaches, we ran 250 independent Markov chains. We used the likelihood function of A first post processing of the posterior ensembles is shown in Also, the distribution in  We presented an algorithm (C-ISR) to narrow the prior and produce improved proposal realizations in McMC optimization under the Bayesian framework for inversion, using cosimulation with system response data. This algorithm works in combination with ISR and relies on the approximation that, temporally, the vector of normal scores transformed hydrologic measurements is related to the underlying Gaussian variable of the facies The effectiveness of cosimulation is illustrated by a synthetic aquifer inversion example, using a pump test. We applied C-ISR vs. ISR based solely on TGS. The results of 250 individual optimizations for both approaches show that C-ISR needs less forward model runs and, as a result, is faster. Also, it is more reliable since it produces smaller RMS errors and explores more effectively the prior space avoiding entrapment in local maxima. Future research will focus on extending the concept of C-ISR to the direction of multiple point statistics (MPS). It has been shown ( We acknowledge the contribution of the two anonymous reviewers who made critical remarks and detailed comments and gave us the opportunity to substantially improve the original manuscript.