A fast and efficient method to simulate multivariate fields with non-linear models of coregionalization (N-LMC) is described. The method generalizes FFTMA to the multivariate simulation of the N-LMC with symmetric cross-covariances, hence the name GFFTMA. It allows us for example to use an exponential model as the direct covariance for the main variable, a Cauchy model for the secondary variable and a K-Bessel model for the cross-covariance. Each covariance and cross-covariance are Fast Fourier Transformed (FFT) to get the discrete spectral densities. Then the spectral matrix is eigen-decomposed at each frequency separately to provide the square root matrix and to enforce positive-definiteness in cases where small negative eigenvalues are found. Finally the simulated spectrum is obtained as multiplication of the root matrix and the white noise coefficients. The method is particularly fast for covariances having derivatives at the origin and/or for covariances with long range. Hence, two-variables’ 2D fields of 100 million pixels with all-Gaussian or all-cubic covariances and cross-covariance are both simulated in less than 200s. The CPU-time increases only as N
                     log(N) (N, the number of points to simulate). Additional realizations are obtained at a low marginal cost as the eigen-decomposition step needs to be done only once for the first realization. The main limitation of the approach is its rather stringent memory requirement. Synthetic examples illustrate the simulations of N-LMC with two and three variables for different combinations of the seven available models. It shows that the theoretical models are all well reproduced. An illustrative case-study on overburden thickness simulation is provided where the secondary information consists of a latent Gaussian variable identifying the geological domain.In geology, mining, petroleum, hydrogeology and other applications, it is common to observe several secondary variables that are spatially correlated to the main variable of interest. Often, the secondary variables are more exhaustively sampled than the main variable. To improve precision, it is important to include this information in the simulation of the main variable. Up to now, essentially two cases of figure are encountered in applications. The first one is when a physical relationship exists between the main variable and the secondary ones. This situation is common in geophysics ( Recently Alternatively, In this contribution, based on the discrete spectral method, the FFTMA is adapted to the unconditional simulation of multivariate fields with the N-LMC. One requirement on the coregionalization is the cross-covariances must be symmetric. The square root of the spectral matrix is obtained at each frequency sampled by the FFT. Then spectrum of white noise fields for After reviewing the FFTMA algorithm, we describe the necessary modifications to simulate N-LMC. We then discuss implementation details related to the type of simulated covariance, the admissibility issue, the computing time and the solution proposed for the case of samples not on a regular grid. We show that the program, named GFFTMA, reproduces the desired N-LMC. CPU time and memory requirements are examined. Finally, a case study is presented. The moving average method (MA) was presented for simulation of one dimensional Gaussian random fields in The convolution theorem, either in its continuous or discrete versions, states that the Fourier transform of the convolution of two functions is the product of the Fourier transform of the two functions (  The covariance matrix function At any given frequency Compute the FFT of each of the Generate For all frequencies, respectively compute the eigenvalue–eigenvector decomposition of the spectral matrix Calculate the spectrum of simulation at all frequencies Take the separate inverse FFT on each component of vectors The reader will note that the above procedure is the direct analog of what is done by FFTMA in the univariate case, where The classical method of post-conditioning by cokriging ( An important limitation of the FFTMA is to simulate only on a regular grid. This is a problem for the post-conditioning step as one also needs simulated values at sampled points. Moreover, they must have the right structure and be compatible with all the points already simulated on the regular grid. Relying on the screening effect approximation, one idea is to locally propagate the unconditional simulated vectors of the regular grid to sample points. By the Cholesky or SGS method, values on the sample points can be simulated conditioned by the neighboring regular grid vectors. This is repeated for each sample point in turn. Sample points that are simulated by SGS or Cholesky are added to the already simulated vectors for the next sample points. At the end of the procedure, correlated random vectors with approximately the right covariance structure and compatible with the regular grid are available at each sample point. One can then proceed with the post-conditioning as usual. Note that this step is relatively fast compared to a standard SGS as only the sample points need to be simulated, not the grid points that are already simulated by GFFTMA. Following To account for possible geometric anisotropies in different directions and of covariances formed of multiple nested components, the maximum range or the practical range among all directions and all components of the N-LMC was retained as the unique parameter The examples presented in Because of the use of FFT, GFFTMA is probably unequaled for the computing time required to get the unconditional simulations. The post-conditioning is generally the slower step, although this step can be also quite fast when dual kriging is used in a global neighborhood ( No doubt, the main limitation of the approach is the memory usage, especially when simulating large grids for models with long practical range. The maximum memory mobilized by the current implementation of GFFTMA is approximately The case study bears on the cosimulation of overburden thickness and surface lithological information represented by a Gaussian latent variable. The overburden thickness data includes 4730 boreholes in Montérégie Est, in the south of Québec. The study area covers approximately A bivariate field is aimed to simulate by the GFFTMA. The logarithm of overburden thickness is treated as the first variable. Another known information is the indicator of geological domain of the studied area. A number of approaches can be used in the simulation of the geological types or facies, such as sequential indicator simulation (  Two series of unconditional realizations of logarithm of overburden thickness were obtained on a regular grid: an univariate simulation by FFTMA and the bivariate N-LMC simulation involving geological domain by GFFTMA. Then, the unconditional simulated values were extended to the sample point locations by local LU simulation.  To assess the gain obtained by considering the geological information, the full dataset is split into two parts: a small part (10%) is used as conditioning data and the rest (90%) is used as test data. Conditional realizations are obtained at the test data locations for two different cases: one using the univariate simulation of log(thickness) and the second using N-LMC simulation of log(thickness) with the Gaussian latent variable as secondary information at both conditioning points and test data locations. Then the final simulations of log(thickness) for overburden are transformed to the thickness.  Examples were provided illustrating simulation of the models available in GFFTMA. The average experimental direct and cross-variograms reproduced almost perfectly the theoretical model in all cases presented (see The eigen-decomposition is done at each frequency where the amplitude exceeds the threshold The memory requirements are rather important as the field size to simulate internally in GFFTMA to reduce aliasing is equal to the size of the field to simulate plus the maximal practical range found among all model components. As an example, with a maximal practical range of 100, 48G of RAM enables simulation of a field comprising approximately 238 million pixels in 3D, corresponding to 620 pixels along each dimension. One avenue to limit the size of the simulation may be to try to approximate models displaying asymptotic sills (exponential, Gaussian, Cauchy and K-Bessel) by combination of models with compact support (spherical, cubic and penta). This could reduce significantly the size of the field to simulate internally, although it is not clear if the number of frequencies to eigen-decompose does also diminish. The GFFTMA program can generate unconditional simulations in both isotropic and anisotropic situations for any number of variables and any number of covariance components for each direct and cross-covariances. It enables us to simulate N-LMC with symmetric cross-covariances. Basic covariance models included in GFFTMA are nugget, exponential, Gaussian, spherical, cubic, penta, generalized Cauchy and K-Bessel (Matérn). If needed, other models can be added easily with a single line of code. Simulated examples show that GFFTMA succeed to produce realizations having on average the desired N-LMC. This research was financed by The program GFFTMA is a Matlab function used to produce unconditional simulations of N-LMC models. For conditional simulation, it must be completed with other functions performing 1-extension of the unconditional grid to sample points not lying on the grid and 2-the post-conditioning by cokriging with the same N-LMC model. The check of the admissibility of the N-LMC model can be done with program TASC3D ( The input The input The input The input The input The input The output