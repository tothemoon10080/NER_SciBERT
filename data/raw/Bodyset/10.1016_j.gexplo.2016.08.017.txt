The rock chemical composition may be affected by a wide variety of primary and secondary geological processes. Analyzing geochemical datasets of highly altered rocks is usually faced with the challenges in detecting the relationships among objects. Using traditional clustering methods in such datasets with high-dimensional data and various types of attributes commonly leads to poor quality results. Hence, a graph-based geochemical approach was proposed in this study to solve this problem. In order to determine the relationship between objects, various similarity measures related to whole-rock composition, REE pattern, and the geographical location were employed in combination to weight the edges of a similarity graph. A spectral method was effectively used to identify clusters (communities) representing rock groups, geological units, or geochemical zones in the weighted similarity graph. It could also recognize the corresponding groups being compositionally and genetically similar to each other and distinguish sub-groups or anomalous samples in the dataset with regard to the different levels of clustering. Firstly, the performance and effectiveness of the proposed approach was evaluated by testing on a GEOROC
                        1
                     
                     
                        1
                        Geochemistry of Rocks of the Oceans and Continents.
                      dataset based on some graph clustering quality functions. Then the approach was applied to the geochemical dataset of Choghart orebody comprising various altered rocks. The obtained clusters were visualized by a k-nearest neighbor classification technique to represent geochemical zones as a continuous map.Chemical compositions of altered and metamorphosed rocks might be complicated due to a different exchange and a relative mobility of major and trace elements. Major element variations occur as a result of primary and secondary geological processes ( Rare earth elements (REEs) are a group of chemically similar elements commonly associated with each other in the Earth's crust. The REE replacement is restricted due to their different ionic radius in rock minerals. Hence, the presence of each REE-bearing mineral (e.g., apatite, allanite, monazite, xenotime) might cause the different fractionation of LREE relative to HREE in melts ( Identification of previously unknown groups is significant in achieving a better understanding of geochemical data samples and also in defining the geological relations between them. The cluster analysis algorithm is a useful exploratory tool for this purpose. Data samples, described by 10 or more attributes, are referred to as a high-dimensional data space. Traditional clustering methods will be ineffective in high-dimensional data analysis as the use of conventional dissimilarity measures (e.g., Euclidean or cosine distance) may be dominated by the noise in many dimensions ( A graph-based approach is proposed in this paper to overcome some of the shortcomings of traditional clustering methods. It is designed to identify homogenous groups based on whole-rock major-oxide compositions and REE patterns in geochemical datasets. Nowadays, a graph theory has an important role in modeling and analyzing the real world problems. There are some applications of graph theory in the geosciences ( A graph or network is represented as a set of points or vertices joined in pairs by lines or edges. In the real networks, the distribution of edges is inhomogeneous with high concentrations of edges within special groups of vertices and low concentrations between these groups. Such groups are called communities or clusters. The number of communities is usually unknown and their sizes and densities could be different. Community detection algorithms identify groups of vertices sharing common properties or having similar roles in the graph ( Numerous techniques such as spectral clustering, random walks, modularity maximization, differential equations, and statistical mechanics have been developed for detection of communities ( The proposed approach identifies rock groups in a stepwise manner without requiring a prior knowledge about the number of clusters. It could determine corresponding groups being compositionally and genetically similar to each other and integrate more similar rock groups with regard to the different levels of clustering. Providing maps to represent continuous geochemical zones and introducing a new measure to evaluate the approach performance are another important issue in this paper. The proposed stepwise approach is successfully applied to two geochemical datasets including representative samples of GEOROC The Bafq mining district, located in the Posht-e-Badam Block structural zone of Central Iran, hosts several Kiruna-type iron oxide-apatite (IOA) deposits. The intrusion of granitic plutons into the sequence of unmetamorphosed formations happened at the period of the Early Cambrian. These formations include interlayered micro-conglomerates, sandstones, black siltstones and shales, dolomites and dolomitic limestones, mafic to felsic volcanic rocks, volcanoclastic beds and tuffaceous shales ( The iron oxide-apatite deposits are a potential source of REEs generally concentrated as a by-product ( The Choghart deposit, as the main deposits in the Bafq mining district, occurs within unmetamorphosed welded rhyolitic to rhyodacitic tuffs and volcano-sedimentary rocks. The intrusive rocks include predominantly syenite and secondarily pyroxenite, gabbro and granite. The Choghart orebody are cut by several diabasic dikes and also are surrounded by Quaternary formations. The rock deposits represent a wide variation in mineralogy, texture, composition, and hydrothermal alteration degree ( Magnetite is the major ore mineral, hematite is typically created from a secondary source, and apatite is the most abundant gangue in the Choghart orebody. The primary magnetite with different grain sizes sometimes exhibit ilmenite exsolutions. Some magnetite crystals show signs of recrystallization. Apatite occurs in the form of two distinct generations. The euhedral apatites are simultaneous with the iron oxide creation whereas the subhedral to anhedral apatites are found in lenses, dikes, and veinlets cutting the magnetite-apatite ore ( Data matrix and similarity matrix are common data structures used in data mining applications. The data matrix is an object-by-attribute structure storing the data objects in the form of n-by-p matrix, where n is the number of objects and p is the number of attributes or features describing the objects. Similarity matrix is an object-by-object structure storing similarities between each pair of objects in the form of n-by-n symmetric matrix. Data in the form of a data matrix should be transformed into a similarity matrix before applying many clustering algorithms. This transformation is performed in three steps as briefly described as follows. The data should be normalized in an optional way before calculating the dissimilarities the data is normalized to give all attributes a unified weight. The data normalization gives all attributes an equal weight. It attempts wide range attributes would not be more predominant (effective) than those with limited range. The min-max and z-score normalization appropriately applied in this study are defined as follows ( Given an object represented by where The z-score normalization converts all the values in the dataset to use the same proportional scale. It is useful when the actual minimum and maximum of attribute where A non-negative value of dissimilarity between two objects evaluates to what extent they vary with each other. In view of the objectives of this study, Euclidean distance and correlation distance are used to calculate the dissimilarity between each pair of objects. Given an n-by-p data matrix Euclidean distance computes dissimilarity between objects Note that the Euclidean distance does not adjust for differences in scale and only appropriates for the same scale data ( Correlation defines the similarity in shape between two trend patterns. Ignoring the differences in scale among the variables, the correlation distance computes the dissimilarity between two objects where Using various types of dissimilarity in clustering problems could lead to different results as shown in Similarity matrix is an n-by-n symmetric matrix storing similarities between each pair of objects. The similarity between objects The scaling parameter In order to build a similarity matrix, the similarity functions are compared in A graph is a representation of a set of objects and existing connections among them. It is commonly denoted as an ordered pair A collection of data objects The distribution of edges is inhomogeneous in the real networks which reveals a high level of order and organization. It shows high concentrations of edges within special groups of vertices and low concentrations between these groups. This significant feature is called clustering or community structure. The clusters (or communities) are groups of vertices with similar characteristics in the graph ( Clustering algorithms group objects by some notion of closeness or similarity. As mentioned in the previous sections, traditional clustering techniques may be dominated by the noise in many dimensions so they will lead to poor quality clusters. High-dimensional data could be clustered by means of dimensionality reduction methods such as spectral analysis which significantly decreases the complexity of data ( Spectral methods generally take a graph-structured data as input and rely on to find a minimum cut that divides the graph into several clusters (communities). In a weighted graph where A graph clustering algorithm based on spectral factorization, introduced by Let the Each row of matrix Let a weighted graph The nodes associated with a cluster have more densely linked to each other compared to the rest of graph. This feature is quantified by global density function ( where So for disjoint clusters containing subsets of densely connected nodes in the network Q This function is used to formalize the idea of densely connected node subsets. Local inner density and local outer density are defined as follows. The local weighted density quality function is defined as: In this function, the term corresponding to each local cluster is weighted by the term The modularity of where Normalized mutual information (NMI) measures the amount of information about partition where A silhouette value describes each object is how similar to objects in its own cluster relative to objects in other clusters. Suppose a graph with where − Let where A graph-based approach is proposed in this section to identify different rock groups, geological units, and geochemical zones based on the different types of attributes. Each data sample in the geochemical datasets is indicated by a high-dimensional vector comprising the content of major-element oxides and rare earth elements as well as the geographical location of sample. Since each attribute has a different scale, the data should be normalized to a specified limited range. Moreover, the various types of attributes measured in different units (e.g., wt% or ppm) disqualify appropriate use of dissimilarity calculations and affect the data analysis. The similarity measure between each pair of samples should be considered based on the different types of attributes. Therefore, a stepwise manner is introduced to combine various measures into a component of a similarity matrix defining the relationship between samples in the best way possible as the following. In the first step, the attribute values related to the content of the major-element oxides are normalized by the z-score normalization and then the absolute difference between each pair of samples is computed by Euclidean distance. The dissimilarity values are converted to the interval [0, 1] as the similarity values by the Gaussian function (with In the next step, the contents of REEs are taken into consideration. The REEs display specific distribution patterns in different geological processes and thermodynamic conditions. Thus, the correlation distance is used to calculate the similarity in trend between each pair of samples related to REE patterns. This measure emphasizes on the REE trends rather than the absolute values of them. With regard to complicated problems about the REE (mobility condition, accurate chemical analysis, and etc.), it seems that this thought will have a significant impact on the outcomes. The similarity values obtained by the Gaussian function are allocated to each edge of the graph The spectral algorithm, introduced by The proposed approach can be used to identify different groups (e.g., rock groups, geological units, and geochemical zones) based on different types of attributes in geochemical datasets. The performance of the algorithm is first evaluated by testing on the GEOROC dataset with predefined groups. The approach is then applied to the Choghart geochemical dataset. In order to assess the performance of the proposed method, some samples with predetermined groups are selected from a geochemical database ( An exploration project systematically performed in the Choghart deposit to provide a geochemical dataset. To do so, an adequate number of representative rock samples were taken from the different zones of orebody as shown in The proposed algorithm is applied to the GEOROC dataset, step-by-step. The data samples are modeled based on their major oxide attribute values as the similarity graph The similarity graph To verify the similarity threshold in GEOROC dataset, all possible values for cutting edges (as a similarity threshold) are considered in the fully connected graph The results of The silhouette plot displays the distance among samples in their own cluster compared with the distance to samples in the neighboring clusters and so provides a visual way to evaluate the results. For each sample in silhouette plot, a high positive value shows that it is well-matched to its own cluster and a low negative value exhibits that it may be allocated to the wrong cluster. In addition, a value close to zero reveals that the sample is very close to the decision boundary between two neighboring clusters. In this case, the sample does not belong to a rock group in terms of chemical composition and thus a transition state can be considered for it. The silhouette plots in In this paper, a new quality function is proposed in order to evaluate and visualize the clustering results. This measure is named “relative purity of clusters” and defined with the aid of impurities in clusters as Eq. where Based on this new measure, the clustering results are visualized with the simpler diagrams such as  In order to define the role of REE in the detection of the various rock groups, the similarity graph is constructed without considering the effect of the REE patterns and analyzed by proposed algorithm. The findings are compared to the previous ones using the quality function as shown in The findings of this section confirm the effectiveness of the proposed algorithm to identify different rock groups and to recognize corresponding groups that are compositionally and genetically similar to each other. These characteristics could be very important particularly in regional and detailed geochemical investigations. The proposed algorithm is applied on the Choghart dataset in which the number of groups is not predetermined. The similarity threshold value (0.01), related to the major-element oxide composition, and its cumulative frequency (73.24%) are indicated in the cumulative frequency plot as shown in In order to maintain valid spatial relationship among the samples, their geographical distances are also considered to modify the similarity graph The final weighted graph By taking the five actual groups, all possible values for cutting edges are considered in the fully connected graph In order to compare the proposed graph-based algorithm with traditional clustering methods, some various basic clustering methods including k-means, Single-linkage, Average-linkage, Complete-linkage, and DBSCAN are applied on the Choghart orebody dataset. The results of the comparison, explained in A well-designed visual representation enhances understanding of obtained results and helps in decision-making. A symbol map could be used to visualize clusters (group of objects) and their spatial relationships. In this study, a more suitable method is utilized to recognize patterns and to identify anomalies with the aid of a k-nearest-neighbor (k-NN) classifier which is an instance-based learning algorithm. The k-NN method defers data processing until it receives a request to classify an unlabeled object. This classifier compares a given test object with training objects being similar to it. The k-NN classifier is intuitive, easy to implement, adaptive and effective in practice. Therefore, it has been widely used in many pattern recognition problems ( In this geochemical study, a grid square map is made in the study area, firstly. The map includes a network of horizontal and vertical lines being superimposed for locating points as unknown objects. The collected geochemical samples (with identified groups) are considered as training objects. Then the k-NN classifier searches a three-dimensional pattern space for the k training objects being nearby to each unknown object. The k training objects named “k-nearest neighbors” are defined by the Euclidean distance. A good value for the k is determined experimentally. The k value which gives the minimum error rate of the classifier is selected as the number of neighbors. After that, the unknown object is assigned the most common class among its k-nearest neighbors. Finally, a specified color is allocated to each point on the map. The colored points represent a view of continuous zones in the Choghart orebody which is presented in The map includes five different geochemical zones labelled as A, B, C, D, and E. The median of Chondrite-normalized REE concentrations for each geochemical zone in Choghart orebody are compared in a spider diagram as shown in According to Chemical compositions of altered and metamorphosed rocks may show wide variations due to different exchange and relative mobility of major and rare earth elements. Geochemical data samples described by the various types of attributes are referred to as a high-dimensional data. The use of cluster analysis in such datasets is significant to gain insight into the distribution of data and to achieve a better understanding of the geochemical relationships between data samples. Conventional distance measures used in clustering algorithms may be dominated by the noise in many dimensions, leading to meaningless and unreliable results. In order to solve this problem, the samples and relationships among them are modelled as a similarity graph based on the different types of attributes. A spectral method was used effectively on the weighted similarity graph to identify the clusters (communities) at the different levels of granularity. The proposed approach was first applied to GEOROC geochemical dataset with ten specific groups. It was able to identify different rock groups and to recognize corresponding groups (e.g., Dacite and Rhyodacite) being compositionally and genetically similar to each other. The graph clustering quality functions provide ways to determine the similarity threshold value in the graph construction, to identify the appropriate number of clusters (nine or ten), and to confirm the important role of REE patterns in the detection of the different rock groups. The algorithm was then applied to the Choghart geochemical dataset and as a result five different clusters were identified in the study area. The k-nearest neighbor technique was utilized to visualize continuous zones and to display geochemical trends. The resulting geochemical map was in good agreement with Choghart orebody geological map. The graph-based approach proposed in this study can be used widely in regional and detailed geochemical investigations. The authors express their gratitude to the managing director of the ICIOC (Iranian Central Iron Ore Company), Eng. Askari for his support and assistance. We would like to thank Eng. Rahimipour and Eng. Akhigan provided access to the Choghart Mine, sampling and support during field work, geological data. We wish to thank Eng. A. Ghanbarpour and others for their useful advices that helped us in this study. A part of this study is indebted to the unlimited access to GEOROC database (