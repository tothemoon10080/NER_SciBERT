Large-scale separation cells, used in primary extraction in the oil sands industry, are integral parts of the overall process of bitumen extraction. Good regulation of the interface level between the bitumen froth and the middlings in these cells can result in a significant improvement in bitumen recovery and throughput and heavily influence process economics. This paper details a case study application of identification and design of a model based predictive controller for the separation cell process. Internal model control (IMC) and model predictive control (MPC) schemes using linear models are designed and implemented in real time on the industrial separation cell. The industrial implementation result shows that both IMC and MPC schemes provide significant benefits over the current operations which use a PID controller. The benefits include significant reduction in the variance of the interface level and underflow pump movement, resulting in higher bitumen recovery, smoother operations downstream and pump energy savings.Oil sands mainly contain mineral solids (silica sands and clays), water, and bitumen, a highly viscous petroleum-like hydrocarbon. The Athabasca oil sands reserves in Northern Alberta, Canada, have one of the largest deposits of oil in the world next to Saudi Arabia and Venezuela ( A majority of the oil sands industries that use surface mining to prepare the feed use hot water based extraction to extract bitumen from the oil sands. One of the earliest papers in this regard was The extraction process consists of large gravity vessels known as primary separation vessels (PSV) or just separation cells (SepCell). Inside the cell three layers are formed due to density of the slurry mixture; the interface level between the top layer (bitumen froth) and the middle layer (middlings) is particularly important as it influences froth quality and process economics. More details on the entire process is explained in the beginning ofsection 2. In the oil sands industry, control of this interface at an optimum level to improve bitumen recovery is of particular interest to the operating engineers. However, interface level control in separation cells presents a lot of challenges for controller design. Modeling of these separation cells to control the interface level based on the physical laws is difficult not only because of the constantly changing nature of the oil sands entering the plant (disturbances in the feed quality and quantity), but also because of the lack of plant information due to lack of available measurement systems which can reliably track the various process and disturbance variables. In the last few years, reliable estimation of the interface level has been obtained from an image based soft sensor. Recent development in the area of soft sensors and their industrial implementation includes The complex flow dynamics, because of the multi-phase flow inside the separation cell, presents a big challenge. Inside the SepCell, the interface dynamics are distributed in nature because of the presence of three layers. Modeling of the interface dynamics is non-trivial. The phenomenon is highly nonlinear and fundamental understanding of the interface level is a multidisciplinary area that overlaps with colloid science and surface chemistry, and requires understanding of the interfacial properties of oil/water and water/sand grain layers at the molecular level. In contrast to this, building a data based input–output model offers a relatively simple way to design a model based control scheme for such processes. The common practice in industry is the awareness that many of the industrial processes are nonlinear; however, locally linear models are often sufficient to approximate a process around single operating condition. Modeling the process using data based nonlinear models is an attractive option for this complex process but the idea is to simplify the control design and make it work in practice. Even though some of the measurements of flow and densities are available for mass balance calculations and validation, since there is a lot of wear and tear due to nature of the slurry that is being transported, the quality of these measurements are not reliable and depends heavily on maintenance programs. Therefore, the operating strategy for the separation cell efficiency is totally dependent upon the quality of the information used to build models and the control design schemes which use these models. It is important to understand the process and instrumentation constraints to have a successful application of advanced model based control schemes. The separation cell process has large and variable time delays, and in addition to this, because of the disturbances upstream and downstream of the process, the process gain and delay vary significantly. A varying feed flow (disturbance) because of improper design at the upstream end, is one shortcoming commonly found in the mining and oil sands industries. The ore quality, which translates into the amount of bitumen and sand grain particles present in the oil sands slurry being carried to the SepCell, has a direct effect on the process gain between the interface level and the pump speed. Also, if there is too much back pressure in the underflow line which occurs at one operating condition, it becomes difficult to pump heavy sands and it adds up as a significant dead time for the interface level dynamics. Because of these limitations it is important to have multiple models at different operating conditions because the interface level dynamics change very quickly with changes in feed conditions (upstream) as well as downstream changes. If there is too much turbidity or the fuzziness due to the presence of too many fine particles, the interface level is generally not well defined and measurements from the image based soft sensors are not available. Sometimes the operator workload and behavior also have an effect on process operations and this clearly does not offer favorable conditions to reap automation benefits. A recent paper by The widespread adoption of MPC methods in the process industry is a clear indication of its success and these ideas are now starting to attract interest in other process industries as well. For single-input single-output (SISO) systems, internal model control (IMC) proposed in The separation cell is a very important front end to a variety ofmineral processing industries, and the main contribution of this paper is that this case study should serve to inform the industrial reader and the research community, the benefits of advanced process control in oil sands and in particular, to regulate the interface level in an oil sands separation cell. Model based predictive controllers, IMC for SISO design and MPC controllers for SISO with and without feed forward control for feed rate, are designed for the interface level control and experimentally evaluated on an industrial separation cell. The implementation was carried out at the primary extraction unit at Suncor Energy Inc.'s, operation in Fort McMurray, Alberta, Canada. The principles of the IMC and MPC controllers are the same; however, real industrial implementation is tailored to this separation cell application. The objective of the control is to regulate the interface level when subjected to process feed rate changes, and provide reduction in the variance of the main controlled variable, the forth bitumen and middlings interface, and thereby improve bitumen recovery and also save on pump energy with smoother operations downstream. Both feedback and feedback plus feed forward control are applied to operate the process dynamically using MPC. The organization of this paper is as follows: An overview of an industrial hot water based extraction process can be found in The surface mining of the oil sands is done using big trucks and shovels at the mining site. The mined oil sand lumps are crushed, moved on to the conveyor and then mixed with process water in slurry boxes, stirred tanks, and rotary breakers. This forms the oil sands slurry which is sent to hydro-transportation pipelines or to tumblers, where the oil sand lumps are sheared, and reduced in size. Some chemical additives are also added during the slurry preparation stage. Within these hydro-transport pipelines, bitumen is liberated from the sand grains and entrained air attaches to the bitumen particles. The flow from these hydro-transport pipelines is transferred to large gravity separation vessels, normally referred to as separation cells (SepCell), as shown in In the extractions process, the interface level between the bitumen-froth and the middlings is known to affect bitumen froth quality and thus heavily influences process economics. For example, when this level is too high, fines (fine sand particles) escape with the bitumen-froth, degrading its quality and adversely affecting the downstream upgrading process; and when the level is too low, bitumen is lost to the tailings ponds, causing financial losses and environmental problems. For these reasons, there has been much interest in the oil sands industry to control this interface at an optimum level for good bitumen recovery. Presently, an image based soft sensor developed in The process is complex and highly dynamic in nature and due to the large volumes being processed in the mining operation, most of the oil sand variability is propagated to the froth bitumen and middlings in the separation cell. Good model based control of the interface level between the bitumen froth and the middlings in these cells can result in a significant improvement in bitumen recovery and have a favorable impact on process economics. Stabilization of the interface level results in much smoother operation of the separation vessel and provides conditions that are more favorable for froth treatment and bitumen recovery from middlings and the underflow. Due to the size of these SepCells and the distributed nature of the flow to and from the cell, time delays are present in the process and the process behaves as a higher order system. Apparent time delays also appear in the identification exercise when such a higher order process is modeled by a low order model to design a reduced-complexity model based controller. Model based advanced control methods applied to the extraction process could reduce the variability in plant operating conditions which could consequently lead to much smoother plant operations downstream while maintaining safety margins. Also, these techniques could improve plant efficiency by compensating for external disturbances that separation cells are routinely subjected to. However, modeling these processes is a big challenge. In extraction, some of the physical and chemical mechanisms are not completely understood. Building models based on physical laws such as mass and energy balances is difficult due to multi-phase or slurry flows in the large gravity separation vessel. In the SepCell, the aerated bitumen floats to the top as froth while heavy sands settle at the bottom of the cell due to gravity. Thus, the distributed nature of the flow inside the SepCell makes it difficult to model the process based on first principles model using physical laws. The dynamics of the interface level between the bitumen froth and the middlings is governed by a lot of factors. These include: Feed composition (or feed quality): If the oil sands feed contains higher content of fines, due to hindered settling, it takes longer time for heavier coarse material to settle. Similarly, if the fines are low, the settling is much quicker. This influences the dynamics between the interface level and the underflow flow. Rate of settling of sands from the Bitumen froth to the Middlings layer: The aerated bitumen separates from lighter middlings and heavy components by gravity. So, the rate at which heavy components settle at the bottom also influences the interface level between the bitumen froth and the middlings. Flow rate of oil sands feed: Fluctuations in the oil sands feed flow entering the SepCell causes fluctuations in the interface level. The feed flow also includes the recycle flow, which is added to the oil sands feed before it enters the SepCell. Middlings flow rate: The middlings stream is one of the outflows from the SepCell. If there is more middlings output from the SepCell, the interface level would go down; however, the middling flow draw is a gravity flow, hence the influence on the interface level would be less when the interface level is low. Underflow flow rate: The underflow flow rate is varied by varying the pump speed and for normal operation this pump speed is used as a manipulating variable to control the interface level between the bitumen froth and the middlings in the SepCell. Since the objective is to design a model based predictive controllers, building data based input–output models is the best way to model SepCell. To build an accurate model using input–output data, it is necessary to excite the plant and collect a rich data set. In this respect model identification is a costly affair as it requires the plant to be perturbed for sufficient period of time and during this period the bitumen yield may be poor leading to poor recovery. To balance the requirements for good signal to noise ratio and yet have the plant run at normal operating conditions, the plant excitation is kept to a minimum level. To start off, a simple step change is first conducted followed by rigorous excitation, with more information gained at each step of this exercise. The controlled plant tests were done to include a sufficiently wide operating range, while still remaining in the safe operation. To design a model based controller, system identification tools ( The operating conditions inside the SepCell differ mainly because of the feed quality and hence the process has to be operated at different regimes or zones. In addition, the process dynamics also change in terms of the amount of the oil sands fed being hydro-transported to the SepCell. Relative to the quantity of feed being feed to the SepCell, the operating condition does not change for long periods of time. In this respect a majority of the plant operation is carried out in either one of two operating conditions: 1) operating condition-1: when either LINE-1 or LINE-2 are operational and 2) operating condition-2: when LINE-1 and LINE-2 both are operational. Favorable condition downstream helps process operation inside the SepCell and at operating condition-1, the bypass line in the downstream side is closed (see  The input–output response data presented above is used with the MATLAB system identification toolbox and CONTSID toolbox ( The process has a large dead time and the dead time is modeled by careful examination of the step response plots. If the bypass line is open in the downstream side (operating condition-2), it is easy to pump the underflow and consequently the interface level responds faster to changes in the pump speed. The time delays in the process are of the order of 6–8 At operating condition-1, for the model identification exercise, the data is down sampled to 15 For operating condition-2, a first order continuous-time OE model using CONTSID and second order ARX model were obtained. They both provide parsimonious models for control design purposes. For this condition, the data is down sampled to 5 s to build models. As evident from There are a lot of disturbances which affect this process. In mineral processing, To design feedforward plus feedback controller, the effect of feed flow rates on the interface level as the potential measured disturbances were studied. In order to obtain good overall control of separation cells, one needs good control of the local variables such as flow rates, feed density. Only after these are satisfactory, can one integrate them with the interface level control and the primary and secondary floatation cells to obtain specific grades for the outflows from the separation cell such as middlings and the underflow tailings. However, with current process operations, it is not easy to change the set points of a majority of the local controllers and also one should not upset the process much by ‘experimenting’ with so many factors at the same time. Thus, the objective here is to apply advanced control schemes to improve the regulatory interface level control compared to current operations, and move in a sequential manner to integrate the local controllers, for example, feed flows, feed characteristics and plant constraints to achieve performance close to the target requirements. One can find examples of many important industrial control loops in process industries which exhibit long dead time characteristics and very large dominant time constants. The reason for very slow dynamic responses of these control loops is the presence of dead time. The controller design of such processes is a challenging problem. PID controllers are still widely used in the industry because they are easy to implement and they perform well for a wide class of processes. However, PID controllers are not very well suited for control of processes with large time delays since it can cause stability issues for the closed loop systems. The most popular and effective dead-time compensator in use today is the Smith predictor ( Internal model control (IMC) was developed by For processes with time delays, the Smith predictor structure and the internal model control structure are equivalent and by suitably selecting the tuning parameter Model predictive controllers (MPC) are good for highly complex andinterconnected dynamic systems. In contrast to a standard PID controller, MPC calculates an optimal control action by taking intoaccount process dynamic behavior and operational constraints ( Model predictive algorithms utilize the moving horizon approach, computing a set of control moves over a horizon. The initial control moves are implemented, while the remaining calculated moves are discarded. The process is then repeated at subsequent sampling times. Implementations of MPC in industry commonly use linear process models. MPC techniques have been implemented in various forms, some of which have found their way to the market place. Examples of such implementation algorithms are available in the review by The objective in MPC consists of minimizing the following dynamic objective function: Thus, the objective function penalizes the deviation from the desired output trajectory Only the first input Before implementing the control scheme (both IMC and MPC) on the real process, a number of off-line simulation studies were undertaken to identify suitable parameters for the controller and achieve the required closed loop performance and provide some robustness to the controller. Finally, the controllers were tested and implemented at the Suncor's Extraction unit. On-line implementation of the controllers was performed using OPC (Object Linking and Embedding for Process Control) objects as the communication channel between the commercial software Controller Performance Optimizer (CPO) and the DCS (distributed control system). Thus, the calculations were done in CPO and the results of the calculations are sent back to the DCS through an OPC client object that connects to an OPC server. The results presented here are actual field test results to show the benefits of the advanced process control application to the extraction unit. The performance of the controllers (regulatory performance) is assessed by comparing the standard deviation ( The closed loop performance for the PID controller presented for comparison purpose is based on a well tuned industrial PID controller.  As can be seen, the IMC controller delivers satisfactory performance and keeps the process variable near the set point while keeping the pump movement to the minimum compared to the results before and after the testing period. Validation and comparison of controllers in an industrial setting are difficult as the variabilities of the influences (disturbances) from outside are significant and differ during different times.  It is important to get a feel for the potential benefit a controlscheme like the one presented here can offer in comparison to current operation. However, to handle process constraints and feedforward disturbance along with further moving the set point closer to the limits, MPC implementation results for the same are presented next. Using MPC, we added process constraints for both the interface level and the pump speed. We used the estimated models as obtained at two operating conditions to design MPC with and without feedforward control. The Prediction horizon and the control horizon were chosen based on the rule of thumb that the prediction horizon should be slightly more than the settling time and control horizon close to fifth of the prediction horizon.  These settings were chosen such that the required closed loop performance from the controller can be achieved. The desired output trajectory is built using time constant of 600 As can be seen, there is significant reduction in the standard deviations of all three key performance indices using MPC. The pump speed is also relatively constant using MPC, resulting in a smoother operation of the controlled system downstream. The execution time for MPC at this operating condition was also set to 10 Again, these settings were chosen such that we achieve the good performance from the controller. The desired output trajectory is built using time constant of 300   Therefore, as can be seen that feed forward control really helps in regulating interface level in the presence of one of the major disturbance to the process and helps to improve the closed loop performance of MPC. The testing using MISO MPC using middlings flow as additional MV, is the subject of ongoing research for this process and more detailed testing at the two operating conditions will be done to have a multivariate MPC application in the extraction unit. In this paper, a case study application of identification and model based predictive control design for the interface level control in an industrial separation cell process in the oil sands industry has been discussed. In the introduction it was discussed that a small improvement in the process efficiencies and operation can greatly influence bitumen recovery, reduce environmental impact and influence process economics. The test results using IMC and MPC have been very positive and show significant reduction in the standard deviation of the interface level compared to current operations. As a result of this the overall variability of the process and manipulated variables were shown to be significantly reduced when using IMC and MPC controllers. Since there is also significant reduction in the pump movement, this translates into pump energy savings and hence significant cost reduction. Since the extraction process is a continuous process, a smoother operation of the separation cell ensures smoother operation downstream, and all these benefits are directly related to increased bitumen recovery and throughput. The economic evaluation cannot be disclosed in this paper due to proprietary nature of the information. In future studies, a multi-input single output (MIMO) control formulation, incorporating additional CVs and MVs would be tried and tested. This is expected to make the control problem more challenging. The authors would like to acknowledge financial support through the