The modeling of uncertainty in continuous and categorical regionalized variables is a common issue in the geosciences. We present a hybrid continuous/categorical model, in which the continuous variable is represented by the transform of a Gaussian random field, while the categorical variable is obtained by truncating one or more Gaussian random fields. The dependencies between the continuous and categorical variables are reproduced by assuming that all the Gaussian random fields are spatially cross-correlated. Algorithms and computer programs are proposed to infer the model parameters and to co-simulate the variables, and illustrated through a case study on a mining data set.           In many disciplines concerned with the analysis of spatial data (mining and petroleum engineering, hydrogeology, soil and environmental sciences), practitioners often have to deal with variables of different natures: on the one hand, Frequently, it is of interest to model the uncertainty in the outcomes of a continuous variable, conditionally to the data on this variable and on a categorical co-variate, say, a rock-type. Traditionally, a deterministic rock-type model based on geological knowledge is constructed, and geostatistical simulation is performed within each rock-type separately in order to reproduce the spatial variability of the continuous variable. Although simple, this approach suffers from two impediments: It does not take into account any uncertainty (possible misclassifications) in the assumed rock-type model. It ignores the spatial correlation of the continuous variable across the rock-type boundaries. Such a correlation may be weak (hence, negligible), especially if the continuous variable presents abrupt transitions when crossing the rock-type boundaries (e.g. mineral grades in sedimentary deposits such as banded iron formations, coal seams and sedimentary exhalative deposits), but this situation is not always the case in practice. For instance, the mineralization in a porphyry Cu–Au deposit is usually disseminated with gradational transitions between rock types, which produces a correlation of grades across rock-type boundaries ( A way around the first impediment is to simulate the rock-type distribution in space, by using object-based, sequential indicator, truncated Gaussian, plurigaussian or multiple-point simulation ( To account for the spatial correlation of the continuous variable when crossing rock-type boundaries and for the uncertainty in the rock-type distribution, a natural approach is to a restrictive coregionalization model is assumed for the two Gaussian random fields; the transformation of the rock-type data into Gaussian data is approximate, since it does not account for the data on the continuous variable; and the truncated Gaussian model yields spatially ordered sequences of rock types. In the following section, a more general model that avoids the previous limitations is presented. It corresponds to an extension of the multivariate Gaussian and plurigaussian models, for representing continuous and categorical regionalized variables. In the sequel, the continuous variable will be represented by a random field The proposed model is based on the following assumptions:     The random fields The model is determined by the following parameters: the transformation function The following approach is proposed for inferring these parameters: Codify the rock-type information into indicators:  Transform the data on the continuous variable into Gaussian data ( Calculate the sample simple and cross semi-variograms of the Gaussian data and indicator data defined in steps (1) and (2). Choose a number Propose a coregionalization model { If the theoretical semi-variograms do not fit the sample semi-variograms calculated in step (3), return to step (5) and modify the coregionalization model, or go back to step (4) and change the plurigaussian parameters. To cope with the proposed model when the available data are not enough to calculate reliable sample semi-variograms (step 3), one may assume an intrinsic correlation model at step (5), in which the simple and cross semi-variograms of Quite often, the rock types are defined by truncating a single Gaussian random field (truncated Gaussian model) or two independent Gaussian random fields. In both cases, the simple and cross-covariance functions of the Gaussian random field Let One can expand the indicator Θ Since the Hermite polynomials are orthogonal polynomials for the standard univariate and bivariate Gaussian distributions, the non-centered covariances between Θ Eqs. Let us now consider the case when One finds the following expressions for the non-centered covariance between Θ Similarly, the non-centered covariance between Θ Again, if We now tackle the problem of co-simulating the continuous variable (random field Co-simulate the vector Gaussian random field Co-simulate Transform the simulated Gaussian random field Transform the simulated vector Gaussian random field Steps (3) and (4) are straightforward, once the transformation function Step (1) can be done by recourse to the Gibbs sampler, an iterative algorithm that allows sampling a complex multivariate distribution via the sampling of a series of univariate conditional distributions. Let { (1a) For each β∈ (1b) Select an index β uniformly in (1c) Perform simple co-kriging of (1d) Simulate a Gaussian random vector (1e) If (1f) Go back to (1b) until a large number of iterations are done. The proposed simulation algorithm (steps 1–4) allows reproducing the joint distribution of the continuous and categorical variables, conditioned to the available data on these variables. In particular, the simple and cross semi-variograms of the Gaussian random field statistical fluctuations because of the limited size of the simulation domain; distorsions caused by the conditioning data (the conditional semi-variograms may differ from the prior semi-variogram models); inconsistencies between the conditioning data and the coregionalization model (poor model fitting); and implementation approximations: neighborhood restrictions in the conditional co-simulation of the Gaussian random fields, use of a finite number of iterations in the Gibbs sampler, etc. A MATLAB program called CC_COSIM relies on programs formerly developed for the simulation of Gaussian random fields ( Details about the input parameters are given below. The modeling of the transformation function φ (Eq.  The truncation rule (Eq. At each location with rock-type data, the vector Gaussian random field The co-simulation of the Gaussian random fields ( Eleven covariance types are available for the basic structures of the coregionalization model, as described in the program-file header and in sub-routine COVA. For each structure, the user has to specify three scale factors, three angles (an azimuth, a dip and a plunge) defining a possible rotation of the anisotropy axes, an additional parameter (optional for some covariance types), and the number of lines to use for turning bands simulation. Non-conditional co-simulation is done when the name of the input conditioning data file does not correspond to an existing file. The convention for rotating the coordinate axes is the same as in GSLIB ( If the first search radius is set to infinity, a unique neighborhood is assumed and dual co-kriging is used for conditioning the realizations, which entails a computational gain with respect to standard co-kriging (sub-routines DUAL and SETDUAL). Otherwise, the neighboring data are selected according to their (possibly anisotropic, if the search radii are not the same) distances to the target location, irrespective of whether or not one variable is undefined for some of these data (heterotopic situation). To quicken the search of nearby data, a super-block strategy is adopted (sub-routines SEARCH, PICKSUPR and SUPERBLK). At each target location, the Gaussian random fields The output of CC_COSIM is an external ASCII file containing the realizations of the continuous variable Given a number The Río Blanco-Los Bronces porphyry copper deposit is located in the Chilean Central Andes at 60 To evaluate the mineral resources, we will use a set of 3 085 data from an exploration drill hole campaign, where each datum corresponds to a 16 The porphyry rock type represents the smallest fraction of data and the lowest average copper grade, while the highest average grade is found in the tourmaline breccia, which suggests that copper grades and rock types are co-regionalized variables. It is essential to determine whether the boundaries between rock types correspond to Two tools have been used to analyze the rock-type boundaries: lagged scatter plots (in which one plots the copper grade in one rock type versus the copper grade in another rock type for a given lag separation vector), and sample cross-covariances between grades in different rock types. It is concluded that a soft boundary exists between granitoid and tourmaline breccia (copper grades in these rock types show a spatial correlation up to 250 The grade data are declustered with the cell method ( When examining the drill hole data, one observes that each rock type can be in contact with the other two. To allow the realizations to reproduce these contacts, two independent Gaussian random fields ( Location Location Location The granitoid rock type is defined by truncating the first Gaussian random field, while the other two rock types also depend on the truncation of the second Gaussian random field. The thresholds So far, we have introduced six nested structures (one nugget effect and five spherical models). For each structure, we wish to determine the coregionalization matrix that indicates the contributions to the sills of the simple and cross semi-variograms { The following trial-and-error procedure is applied: Calculate the sample cross semi-variograms between the Gaussian data ( Propose a set of coefficients ( By using program VMODEL, calculate the theoretical cross semi-variograms between If the fit is not satisfactory, go back to step (2). The following values are finally found: Having determined the transformation function for the copper grades, truncation rule, thresholds and coregionalization model, one can proceed with the joint simulation of the copper grades and rock types in the area under study, by using program CC_COSIM. In total, one hundred realizations are generated, two of which are displayed in The models shown in For the two approaches under consideration (simulation of grades within deterministic rock types, or co-simulation of grades and rock types), one observes that prediction errors are greater for the blast holes located around the boundary between breccia and porphyry. This deterioration may be explained because the mean grade changes when crossing this boundary, despite the existence of a spatial correlation of grades across the boundary. In such a circumstance, a hierarchical approach may be preferable, by simulating the rock types first (via the plurigaussian model), then the copper grades within the simulated rock types (via the multi-Gaussian model). This approach slightly improves the grade modeling around the breccia–porphyry boundary (the mean-squared prediction error is found to be 0.109), but underperforms the co-simulation approach around the breccia–granitoid boundary (mean-squared prediction error of 0.085). In practice, to better reflect the nature of the rock-type boundaries, one could design a mixed approach by considering four cross-correlated Gaussian random fields: two random fields ( Modeling the uncertainty in the values of regionalized variables with different natures (continuous and categorical) is a challenge in many disciplines of the geosciences, such as mineral resources evaluation, oil reservoir characterization or groundwater hydrology. The joint simulation of these variables offers several advantages: It accounts for the uncertainty in the spatial layout of the boundaries between categories, which is ignored when using a deterministic category model. It accounts for the spatial correlation of the continuous variable across the boundaries ( It accounts for the dependencies between the continuous and categorical variables. In particular, the incorporation of categorical data (whether observed or assumed from the geological interpretation of the ore deposit, reservoir or aquifer, depending on the application field) has an impact on the simulated continuous variable and appears as a helpful tool for geological control and data integration. The model proposed in this work is an extension of the well-known multi-Gaussian and plurigaussian models for jointly representing continuous and categorical variables. It is versatile and, together with the accompanying computer programs, remains relatively simple to use. It can also be generalized in order to incorporate non-stationary features by using The authors are grateful to Codelco Chile for providing the data set used in this work and to the Chilean Fund for the Promotion of Scientific and Technological Development (FONDEF) for supporting this research through project D04I-1055. The second author acknowledges a student research grant from the International Association for Mathematical Geology. Consider the expansion of the indicator Θ The non-centered covariance of interest can be expanded in the following fashion: By using Eq. The last equality is due to the orthogonality of the Hermite polynomials with respect to the standard Gaussian distribution. Accordingly, all the terms in Eq. The expression given in Eq. We now wish to calculate the non-centered covariance between Θ One has By substituting the probability density function for its Hermitian expansion (Eq. If