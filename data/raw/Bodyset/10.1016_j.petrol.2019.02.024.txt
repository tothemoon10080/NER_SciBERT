Corner-point is an industry-standard type grid for application in reservoir simulation. The flexible gridding in corner-point grids provides several advantages over Cartesian grids for the representation of complex geological features. In this work, an embedded discrete fracture model (EDFM) is extended to corner-point grids with a full-permeability-tensor formulation to simulate complex fractures in this type of grids. The developed model is implemented in an IMPEC, compositional reservoir simulator. We first describe the formulations of the full-permeability-tensor implementation together with the modified governing equations for EDFM simulations. Then, we present methodologies for computing matrix-fracture intersections and fracture-fracture connections in the EDFM considering the various block geometries in corner-point grids. Subsequently, case studies are presented to verify the developed model, where the impacts of grid distortion and cross derivatives on simulation results are discussed. Three-dimensional case studies are also shown to illustrate the influence of natural fractures on secondary recovery. The results of this study demonstrate the reliability of the developed model, and they also show the compatibility of the EDFM with different types of numerical solution schemes in existing simulators.Corner-point is widely used in reservoir simulation due to its flexibility to represent geological features, such as faults, and complex boundaries of hydrocarbon reservoirs. Different from Cartesian grids, the locations of corner points for each block are defined using coordinate lines and depths ( Although corner-point grids give a better representation of the reservoir geometry, the numerical solution scheme used in conjunction with the corner-point grids is much more complicated than the one using Cartesian grids because in general, the grid is non-orthogonal. For three dimensional problems, this typically results in a 19- or 27-point stencil ( Simulation of fractures adds another dimension of complexity to the numerical formulations. As a traditional type of grid, corner-point grids are frequently used for simulating different types of reservoirs, including naturally fractured reservoirs and hydraulically fractured reservoirs. Therefore, it is necessary to develop methods to simulate the fractures in models using corner-point grids. A traditional method for the simulation of naturally fractured reservoirs is the dual-porosity model ( Discrete fracture models were developed to explicitly simulate the impact of individual fractures. To accurately describe the fracture geometries, unstructured grids were often used in these models ( The embedded discrete fracture model (EDFM) was developed as a solution to these issues. The initial idea of EDFM was proposed by As the EDFM combines the advantages of conventional reservoir simulators and discrete fracture modeling, it is of great importance to combine the EDFM with different types of grids in reservoir simulation. Most of the previous works using EDFM have been conducted with Cartesian grids ( In this work, the EDFM is implemented in UTCOMP-RS, an IMPEC, multi-phase, multi-component, in-house reservoir simulator ( One of the most important equation in the simulator is the material balance equation. Material balance equations describe the mole conservation across the reservoir domain. In UTCOMP-RS, the fluid flow in the porous media is modeled using Darcy's law. Local phase equilibrium is assumed for the hydrocarbon phases, while no mass transfer between the water phase and hydrocarbon phases is considered. Therefore, the material balance equation for each component without considering fractures is given by Eq. The Peng-Robinson equation of state ( The non-orthogonal boundary fitted approach ( Neglecting the physical dispersion terms for simplification purpose only, the material balance equations in the computational domain for hydrocarbon components in the matrix medium are given by The coefficients of the D tensor involve the direct metrices of the transformation and the absolute permeabilities components, which are given by  If we set the volume of each control volume in the computational domain as a unity, the equivalent volume in the physical domain ( On the right-hand side of Eq. The approximate equation for the matrix can be obtained by integrating the material balance equation (Eq. As it can be noted from the above equations, for every gridblock, there are Assuming the rock is slightly compressible with compressibility In this work, the matrix pressure is obtained by Eq. The EDFM discretizes the fractures into fracture segments using the matrix cell boundaries. In the simulator, similar to the matrix, each fracture segment is represented as a control volume. The introduction of new control volumes brings a new term Flow between a fracture segment and the matrix gridblock it intersects (matrix-fracture flow) Flow between fracture segments that are connected with each other or intersect each other (fracture-fracture flow) Both types of flow are represented in the simulator using NNCs. After considering the flow through NNCs, Eq. In the EDFM, two-point flux approximation is used to approximate the flow between matrix control volumes and fracture control volumes, or the flow between fracture control volumes. For a matrix or fracture control volume In the EDFM, the general formulation to evaluate the transmissibility factor For matrix-fracture flow, For fracture-fracture flow, For a fracture control volume, Eq. Only the flow through NNCs and the flow between the fracture and wellbores are considered. When evaluating After the transmissibility factors and well indices are calculated, the terms pertaining to NNCs are also added to the pressure equation (Eq. A challenge for the EDFM in corner-point grids is the geometrical calculation. The calculation of matrix-fracture intersection, fracture-fracture connection, fracture-fracture intersection, and fracture-well intersection requires knowledge of computational geometry. In the literature, the EDFM approach has mainly been applied in Cartesian grids, which has a relatively simple gridblock geometry. The gridblock geometry of corner-point grids might be much more irregular, where the gridblock cannot be represented as a cuboid. In addition, since the eight vertices of a gridblock is defined individually, there is a possibility that two vertices of the gridblock have the same location (degeneracy). The gridblocks may also be pinched-out when they have close-to-zero thickness. We first discuss the methodology for the calculation of intersections between matrix gridblocks and fractures. In this work, considering the irregular block geometries and degeneracy, we treat each gridblock as a general polyhedron represented using vertices, edges, and faces, and each fracture as a general polygon represented using vertices and edges. The intersection between the polyhedron and the polygon is also a polygon, and the vertices of the intersection polygon can be found by calculating three types of points: The vertex of the fracture polygon that is inside the polyhedron The intersection point between an edge of the fracture polygon and a face of the polyhedron The intersection point between an edge of the polyhedron and the fracture polygon The three types of points are shown in The pinch-outs of gridblocks are also considered in the EDFM. When a gridblock is pinched-out, no matrix-fracture intersection is calculated for this gridblock. In addition, in the vertical direction, the fracture segments above and below this gridblock are connected to remain the connectivity of the fractures. The geometrical calculation is performed in an EDFM Preprocessor developed in this work. After the calculation, the EDFM Preprocessor exports NNC pairs, transmissibilities factors, and well indices calculated by Eqs. To illustrate the applicability of the developed model, several synthetic case studies are simulated. Both 2D and 3D corner-point grids are used in these studies. A conventional reservoir with dimensions of 1,000  To investigate the influence of fractures on water flooding, The use of full-tensor permeability is of great importance in the simulation of this process if a distorted grid is used. In this case, the three 2D grids used in Case 1 are extended to 3D, and the reservoir is uniformly discretized into five layers in the vertical direction, as shown in  This study simulates water flooding in a reservoir with irregular boundary. A 60 Three sets of natural fractures with different orientations are placed inside the reservoir. The total number of fractures is 128. The conductivity of fractures is 100,000 md-ft. In naturally fractured reservoirs, the formation of different sets of natural fractures might be related to geological activities at different times. Therefore, the three sets of fractures are restricted in different layers in this study. The first set of fractures only penetrates Layers 1–10, the second set only penetrates Layers 11–20, and the third set penetrates the whole formation in the vertical direction. The fracture segments obtained from EDFM preprocessing are shown in The cumulative oil and water production rate curves predicted by the simulation are shown in In this study, an Embedded Discrete Fracture Model was extended to matrix grids with corner-point geometry to simulate complex fractures in geologically complex reservoirs. The model was implemented in an IMPEC, compositional reservoir simulator with a full-tensor-permeability formulation. Modifications in the simulator governing equations and key points for geometrical calculations were presented in this work. Several case studies were presented for verification and application of the developed model. It was found that the accuracy of the EDFM approach is not greatly influenced by matrix gridding when similar numbers of gridblocks are used. With the full-permeability-tensor simulation, similar simulation results were obtained on grids with different levels of distortion. The inclusion of cross derivatives in the governing equation was also found to be of great importance when the matrix grid is highly distorted. Therefore, although the EDFM result is not sensitive to grid distortion, numerical solution schemes should be carefully selected when the grid is not orthogonal. The impact of natural fractures on water-flooding efficiency was also investigated. Serving as high-speed channels, the highly conductive fractures might speed up the movement of the injected fluid from the injector to the producer, lowering the flooding efficiency. The gravity is also playing a significant role in the simulation of water-oil system, and care should be taken for the discretization of simulation grid in the vertical direction to accurately simulate the movement of waterfront through the fracture network in different layers. This study illustrates the compatibility of the EDFM approach with different types of grids widely used in reservoir simulation, including both Cartesian grid and corner-point grids. As the EDFM requires no special treatment of the matrix grid around fractures, it makes it easy and convenient to place complex fractures in existing reservoir simulation models using these types of grid.  Accelerated Successive Substitution Embedded Discrete Fracture Model Non-Neighboring Connection Two-Point Flux Approximation