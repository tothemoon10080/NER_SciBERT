Most scheduling methods are limited to the short-term scheduling case and solution of problems over long time horizons may prove challenging or impossible with these methods. Including additional considerations such as Heat Integration further complicates the problem. A model for the simultaneous optimisation of the schedule and energy usage in heat integrated multipurpose batch plants operated over long time horizons has been presented. The method uses a cyclic scheduling solution procedure. The proposed model includes indirect Heat Integration via heat storage, rather than just direct Heat Integration. This has not been considered in long-term Heat Integration models in current literature. Both the heat storage size and initial heat storage temperature are also optimised. The solution obtained over 24 h using the proposed cyclic scheduling model with direct Heat Integration for a multipurpose example was compared to the result obtained from the direct solution and an error of less than 6% was achieved.In a batch process, discrete tasks follow a specific sequence or recipe, whereby raw materials are transformed to final products. The recipe includes the amounts of materials to be processed as well as the processing times of the various tasks ( Heating and cooling are required in most processing facilities. The objective of Heat Integration is to optimise the use of energy. This becomes a possibility if a process includes both heat generating and heat consuming operations. Heat Integration may be accomplished in two ways in a batch process. If the operating schedule allows an overlap in time of hot and cold units, direct Heat Integration may be used if both units are active. However, due to the time dependent nature of batch processes it may be necessary to store heat from a hot unit using an intermediate heat storage fluid and reuse this heat at a later time when it is required, resulting in indirect Heat Integration. The inclusion of heat storage instead of only direct Heat Integration leads to more flexibility in the process and therefore improved energy usage. Heat Integration in batch plants has in the past been largely disregarded as utility requirements are considered less significant due to the smaller scale of batch operations compared to continuous plants. However, utility requirements in some batch plants, such as in the food and drink industries, dairies, meat processing facilities, biochemical plants and agrochemical facilities, contribute largely to their overall costs. Optimal scheduling and equipment use and decreased energy requirements can have a significant effect on the efficiency and revenue of a batch plant. Minimising energy usage is also influenced by the need to comply with stricter environmental regulations, reduce the effects of higher energy prices and conserve scarce environmental resources. Early techniques for Heat Integration in batch processes were based on Pinch Analysis, originally developed for Heat Integration in continuous plants at steady state. Variations of the technique for batch processes still appear in literature. However, their reliance on a predefined schedule and averaging energy requirements over time intervals may lead to suboptimal results. For many mathematical Heat Integration techniques presented in published literature, the processing schedule also tends to be predefined, leading to suboptimal results. Some methods may include heuristic approaches which also cannot guarantee optimality. Methods specifically applicable to batch plants are required as they capture the essence of time. Scheduling and Heat Integration may be combined into a single problem for a more optimal solution. However, models may then need to be simplified in order to avoid excessive solution times. Most Heat Integration methods are limited to the short-term case and solution of problems over long time horizons may prove challenging or impossible with these current methods. The model of A brief discussion on the concepts used in cyclic scheduling is given in the next section. The problem statement and objectives are then presented. The mathematical model and solution procedure are then discussed. The model is applied to a literature example and an industrial case study and conclusions are then drawn.  In the cyclic scheduling approach, the length of the cycle is an optimisation variable. The unit schedule is then also optimised. For the unit schedule to be repeatable, a certain amount of each intermediate state must be available to start the cyclic period. It is also required that the intermediates be produced and stored at the end of the period to be available for the next period. In cyclic scheduling, each unit has an individual cycle with cycle time equal to the unit period cycle duration. The units therefore do not need to share the same starting and ending times. This leads to the concept of the “wrapping around” of tasks as proposed by The overall long time horizon is divided into three periods ( The initial period, the start-up phase, is then solved. This is a two-part short-term scheduling problem. The results from this period ensure that the intermediates required to start the cyclic period are produced. The first objective is to minimise the makespan which ensures there is a feasible solution and the required intermediates are produced in the shortest possible time. A profit maximisation problem is then solved over the time horizon obtained from the makespan minimisation problem. A profit maximisation problem is then solved for the final period, which is the remainder of the long time horizon. The final period, or shut-down phase, uses up all the remaining intermediates to form products. The initial period and final period profit maximisation problems are both MILP short-term scheduling problems with known time horizons. The combined lengths of the three different periods add up to the overall long time horizon. This method can easily be applied to any long time horizon as the initial period is not affected by the overall length of the time horizon considered. The number of cycles can be increased or decreased and the final period solved for again if the overall time horizon changes. The solution procedure and computational complexity are also not affected by a change in the overall time horizon. The method provides another option for the solution of long-term scheduling problems rather than solving them directly with short-term scheduling methods and its usefulness will therefore depend on the application. For the problem addressed in this paper, the following is given:  production recipe for each product available units and their capacities maximum storage capacity for each material task durations time horizon of interest costs of raw materials selling price of final products  hot duties for tasks requiring heating and cold duties for tasks that require cooling operating temperatures of heat sources and heat sinks minimum allowable temperature differences heat capacities of materials costs of hot and cold utilities design limits on heat storage The objectives are then to determine the optimum cycle time and cyclic operating schedule as well as the schedules for the initial and final periods in order to optimise the profit over the given long time horizon. The mathematical formulation comprises the following sets, continuous variables, binary variables and parameters:                                                                            The mathematical formulation consists of the scheduling constraints, with modifications for cyclic scheduling, as well as the Heat Integration constraints of The Heat Integration model is based on the superstructure in Constraints Constraints Constraint Constraints Constraints Constraint Constraint Constraints Constraint Constraints Constraints Constraint Constraint The upper bounds of the heating load of a cold state, the cooling load of a hot state and the amount of heat exchanged during direct Heat Integration are given in Constraints For the specific case where the heating and cooling loads are fixed, Constraints The amount of heat transferred through direct Heat Integration will be limited by the smaller heating or cooling requirement of the heat integrated tasks. Constraints Furthermore, it is possible that a given pair of tasks cannot be heat integrated or that a possible The amount of heat transferred through direct Heat Integration can also be limited by the duration of the shorter task if the tasks have different durations. Constraints Constraint In Constraints Constraints Constraints Constraints Constraints The necessary constraints for determining the optimal cyclic schedule are now described. The scheduling model of Constraint Constraint Constraint Constraint Constraint This is the same constraint as in the scheduling model, but the time horizon is now the cycle length. Constraint Constraints Constraints Constraints Constraints If the heat storage temperature at the end of the cycle is higher than the temperature at the beginning of the cycle, cooling will be required to bring the storage temperature back to the starting temperature – essential for repetition of the cycle. Constraint Both constraints Constraints Constraints Constraint If neither extra heating nor extra cooling are required to bring the heat storage temperature back to its initial temperature, In order for the heat storage temperature to return to its starting temperature, the total energy into the heat storage vessel must be equal to the energy out of the heat storage vessel within the cycle. Constraint The profit is given by Equation The objective for the cyclic period is then to maximise the average profit per cycle, as given by Constraint For the cyclic period, the same solution procedure as used by The objective function for the cyclic portion of the problem, Constraint Constraints Once the optimal cycle length has been determined, the initial and final periods can be solved. The overall objective is the maximisation of profit over the entire long time horizon.  The required scheduling data may be found in As the model used to solve the cyclic portion contains nonlinear terms, the solution procedure as described in Section The results obtained for the cyclic portion can be seen in The results obtained for the optimal schedule for the optimal cycle length of 5 h are shown in In In order to solve for the initial period of the time horizon, the amounts of intermediates at the end of the initial period are fixed to the values required to start the cyclic period. These values were obtained from the solution of the cyclic period. This ensures there will be sufficient of the intermediate states produced in the initial period to be available to start the cyclic scheduling period. First, a makespan minimisation problem is solved to determine a feasible time horizon for the initial period. A profit maximisation problem is then solved in order to maximise the profit in the initial period. The optimum heat storage size of 0.357 t which was obtained from the solution of the cyclic period is now fixed in the initial period. Since this is the case, both the makespan minimisation and profit maximisation problems will be MILP problems. The short-term Heat Integration model can be linearised to a MILP if the heat storage capacity is a fixed parameter. The final temperature for the heat storage vessel is set at 70 °C. From the makespan minimisation problem, a feasible time horizon of 9 h was determined for the initial period, in a CPU time of 0.593 s and required 6 time points for solution. The Gantt chart for the profit maximisation problem over 9 h is shown in From A total time horizon of 24 h was chosen. Repeating the cyclic portion once and accounting for the initial period of 9 h, a final period of 10 h remains. A profit maximisation problem was solved for the final period and an objective value of 46,605.928 c.u. was determined in a CPU time of 1.794 s and required 6 time points. The Gantt chart for the maximisation of profit over the final period is shown in During the final period, shown in The problem was solved directly over a time horizon of 24 h for the case where only direct Heat Integration was used as well as the case where only utilities were available for heating and cooling. In order to have a long enough time horizon for a fair comparison, the problem becomes too complex to solve directly for the heat storage case. A fairly long final period is required in the cyclic scheduling model as most of the products are formed during this time and this makes the overall time horizon lengthy. However, the results for the direct solution of the problem for the other two cases are shown in As can be seen from  The scheduling data for the problem may be found in The results obtained for the cyclic portion can be seen in The results obtained for the optimal schedule for the optimal cycle length of 9 h are shown in In The amounts of intermediate states at the end of the initial period are fixed to the values required to start the cyclic period to ensure there will be sufficient of the intermediate states produced in the initial period available to start the cyclic scheduling period. The optimum heat storage size of 0.22 t, which was solved for in the cyclic period, is now fixed in the initial period. The final temperature for the heat storage vessel is set at 95 °C. From the makespan minimisation problem, a feasible time horizon of 11 h was determined for the initial period, in a CPU time of 0.73 s and required 6 time points. The Gantt chart for the profit maximisation problem over 11 h is shown in As seen in A total time horizon of 48 h was chosen. Repeating the cyclic portion three times and accounting for the initial period of 11 h, a final period of 10 h remains. A profit maximisation problem was solved for the final period and an objective value of 338,884.348 c.u. was determined in a CPU time of 1515.2 s and required 9 time points. The Gantt chart for the profit maximisation over the final period is shown in Direct Heat Integration takes place three times during the final period, as seen in The problem was also solved for the case with direct Heat Integration only as well as the case where only utilities are available. A summary of results for each case is given in This same example was considered by To compare the models, the Heat Integration and cost data as used by The model proposed in this paper, with direct Heat Integration only, was used to solve for the optimal cycle time between 6 h and 9 h and the same optimal objective value of $161.05 was obtained. The proposed model was also applied over an interval of 9 h–12 h. The optimal cycle time was found to be 11 h and gave a better objective value of $164.71 compared to $161.05 for the reported optimal cycle time of 9 h. A model for the cyclic scheduling of multipurpose batch plants using direct and indirect Heat Integration has been presented. Cyclic scheduling constraints were combined with the Heat Integration model of The model may give better results when compared to an existing method ( The inclusion of Heat Integration constraints within a scheduling model increases the complexity of the model and it may become difficult to solve. The model presented in this paper may be preferred for the solution of problems over long time horizons as direct solution using short-term scheduling models may not be feasible. The solution obtained over a time horizon of 24 h using the proposed cyclic scheduling model with direct Heat Integration for a multipurpose example was compared to the result obtained from the direct solution using the short-term scheduling and Heat Integration model and an error of less than 6% was achieved. The authors gratefully acknowledge support from the