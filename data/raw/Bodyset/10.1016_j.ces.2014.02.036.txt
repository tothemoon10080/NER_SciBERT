Presented in this contribution is a formulation that addresses optimization of both water and energy, while simultaneously optimizing the batch process schedule. The scheduling framework used in this study is based on the recent and efficient formulation. This formulation has been shown to result in a significant reduction of computational time, an improvement of the objective function and leads to fewer time points. The objective is to improve the profitability of the plant by minimizing wastewater generation and utility usage. From a case study it was found that through applying only water integration the cost is reduced by 11.6%, by applying only energy integration the cost is reduced by 29.1% and by applying both energy and water integration the cost is reduced by 34.6%. This indicates that optimizing water and energy integration in the same scheduling framework will reduce the operating cost and environmental impact significantly.In recent years, batch processes have been getting more attention due to their suitability for the production of small volume, high value added products. The flexibility of batch plants allows the production of different products within the same facility. Batch manufacturing is typically used in the pharmaceutical, polymer, food and specialty chemical industries as demands for such products are highly seasonal and are influenced by changing markets. A common feature of many batch plants is that they utilize fossil fuels as the energy source and use water for process equipment cleaning, due to inherent sharing of equipment by different tasks. Despite the advantage of batch plants being flexible, they also pose a challenging task to operate in a sustainable way. In the past, batch industries could tolerate high inefficiencies in energy and water consumption due to the high value of final products which outstrips the production costs. However, greater public awareness of the impact of industrial pollution, more stringent environmental regulations and escalating raw materials, energy, and waste treatment costs have now motivated energy and water saving measures for more sustainable operations ( Much research has been done on developing mathematical models to improve batch plant efficiency. The substantial advancement in modern computers allows the possibility of handling large and more complex problems by using optimization techniques. Excellent reviews of current scheduling techniques based on different time representations and associated challenges have been conducted ( Many heat integration techniques are applied to predefined schedules which are inherently suboptimal.   For a more optimal solution, scheduling and heat integration may be combined into an overall problem. Wastewater is generated in batch plants during cleaning of multipurpose equipment and when water is used as a solvent. Tight environmental regulations and increased public awareness demand that batch plants consider rational use of water during their operation. Many researchers have developed methodologies for the efficient use of water through direct reuse, indirect reuse and regeneration of wastewater. Direct reuse consists of recycle and reuse. Recycle refers to the reuse of an outlet wastewater stream from a processing unit in the same unit, while reuse refers to the use of an outlet wastewater stream from a processing unit in another processing unit. Indirect reuse is when wastewater is temporarily stored in a storage vessel and later reused in a processing unit requiring water. Based on the analogy of heat and mass transfer, several methodologies for synthesizing water reuse network in batch processes have also been developed.  From the review it can be seen that wastewater minimization and heat integration in batch plants are addressed separately. To the knowledge of the authors the only work presented by In this paper a contribution is made to close the literature gap by simultaneously solving energy integration and wastewater minimization problem in the same scheduling framework. The model is based on TAM and time slice model (TSM) where the time slice is a variable determined by optimization to keep the flexibility of the schedule as compared to previous models based on fixed schedule and fixed time slice for heat integration. The model also addressed the two basic limitations as discussed above in the model of  The production recipe (STN or SSN representation). The capacity of units and the type of tasks each unit can perform. The maximum storage capacity for each material. The task processing times. Hot duties for tasks require heating and cold duties for tasks that require cooling. Operating temperatures of heat sources and heat sinks. Minimum allowable temperature differences. The material heat capacities. The units׳ washing time. The mass load of each contaminant. The concentration limits of each contaminant. The costs of raw materials, products and utilities. The scheduling time horizon (for profit maximization problem). Production demand (for makespan minimization problem).  The optimum production schedule, i.e. allocation of tasks to units, timing of all tasks, and batch sizes. Optimum energy requirement and associated heat exchange configuration. Optimum water requirement and associated water-reuse network. The scheduling model by The mathematical model is based on the superstructure in Constraints (1) and (2) are active simultaneously and ensure that one hot unit will be integrated with one cold unit when direct heat integration takes place, in order to simplify operation of the process. It is worth noting that, mathematically it is also possible for one unit to integrate with more than one unit at a given time point when the summation notation is not used. However, this is practically very difficult to implement. Also, if two units are to be heat integrated at a given time point, they must both be active at that time point. For better understanding, the difference between time point Constraint 3 describes the amount of cooling load required by the hot unit from its initial temperature to its target temperature. In a situation where the temperature in the reactor unit is fixed during exothermic reaction, the heat load becomes the product of the amount of mass that undergoes reaction and the heat of reaction. Constraint 4 describes the amount of heating load required by the cold unit from its initial temperature to its target temperature. In a situation where the temperature in the reactor unit is fixed during endothermic reaction, the heat load becomes the product of the amount of mass that undergoes reaction and the heat of reaction. Constraints 5 and 6 describe the average heat flow for the hot and cold unit, respectively during the processing time which is the same as time average (TAM) model to address the energy balance during heat integration properly. Constraints 7 and 8 define the heat load at time point Constraints 9 and 10 are used to calculate the temperature of the hot and cold unit at the intervals. Constraint 11 states that the amount of heat exchanged by the hot unit with the cold units should be less than the cooling load required by the hot unit during the interval. Constraint 12 states that the amount of heat exchanged by the cold unit with the hot units should be less than the heat load required by the cold unit during the interval. Constraints 13 and 14 state that the temperature of the unit at the start of an interval should be equal to the temperature at the end of the previous interval. Constraints 15 and 16 state that the temperature at the start of the first interval, which is time point Constraints 17 and 18 ensure that the minimum thermal driving forces are obeyed when there is direct heat integration between a hot and a cold unit. Constraints 19–22 ensure that the times at which units are active are synchronized when direct heat integration takes place. Constraints 23 and 24 stipulate that the starting time of the heating load required for the cold unit and cooling load required for the hot unit at the first interval should be equal to the starting time of the hot and cold unit. Constraints 25 and 26 state that the starting time of heating and cooling in an interval should be equal to the finishing time at the previous interval. Constraint 27 ensures that if heat integration occurs, the heat load should have a value that is less than the maximum amount of heat exchangeable. When the binary variable associated to heat integration takes a value of zero, no heat integration occurs and the associated heat load is zero. Constraints 28 and 29 state that if the binary variable associated with heat integration is active, then the binary variable associated with heating and cooling must be active at that interval. Constraints 30 and 31 state that the heating and cooling loads take on a value for a certain duration when the binary variables associated with heating and cooling is active. Constraints 32 and 33 state that temperatures change in the heating and cooling unit when the binary variables associated with heating and cooling are active. Constraint (34) states that the cooling of a hot unit will be satisfied by direct heat integration and external cooling utility if required. Constraint (35) states that the heating of a cold unit will be satisfied by direct heat integration and external heating utility if required. The superstructure on which the wastewater minimization model is based is depicted in Constraint 36 defines the amount of water entering the unit as the sum of freshwater and reuse water from other units. Constraint 37 states that the amount of water leaving the unit is equal to the sum of reuse water sent to other units and water sent to effluent treatment. Constraint 38 is the water balance around the unit and states that the amount of water entering the unit equals the amount of water leaving the unit. Constraint 39 defines the inlet contaminant load as the mass of contaminant, entering with reuse water. Constraint 40 states that the amount of contaminant leaving the unit equals the sum of the contaminant entering into the unit and the contaminant removed from the process. Constraint 41 ensures that the amount of reused water from unit Constraint 42 ensures that the reuse of water from unit Constraint 43 gives the upper bound on the water entering into unit In Constraints 44 and 45, wastewater can only be directly reused if the finishing time of the unit producing wastewater and the starting time of the unit receiving wastewater coincide. Constraint 46 defines the finishing time of the washing operation as the starting time of the washing operation added to the duration of washing. Constraint 47 ensures that the staring time of a task in a unit is greater than the finishing time of the washing operations. Constraint 48 stipulates that the starting time of the washing operation in a unit occurs after the completion of the task in the unit. Constraints 49 and 50 ensure that the inlet and outlet concentrations do not exceed the maximum allowable concentration. Constraint 51 is the objective function in terms of profit maximization, with profit defined as the difference between revenue from product, cost of utility, raw material cost, freshwater cost and effluent treatment cost. Constraint 52 defines minimization of energy and wastewater if the product demand is known. Case studies from published literature were selected to demonstrate the application of the proposed model. The results from the proposed models were obtained using CPLEX 9 as MILP solver and CONOPT 3 as NLP solver in DICOPT interface of GAMS 22.0 and were solved using a 2.4 This case study has been investigated extensively in published literature ( The computational results for case study I using the proposed model for the different scenarios and results obtained from literature are presented in The performance of the proposed model was compared to the sequential optimization technique by The energy requirements of unit  The amount of material produced, the starting and finishing times of the processes and washing tasks are shown in This case study obtained from Raw material, Feed A, is heated from 50 Reactant materials, 50% Feed B and 50% Feed C are used in reaction 1 to produce IntBC. During the reaction the material has to be cooled from 100 60% of the intermediate material, IntBC, and 40% of HotA are used in reaction 2 to produce product 1 and IntAB. The process needs to be heated from 70 20% of the reactant, Feed C, and 80% of intermediate, IntAB, from reaction 2 are used in reaction 3 to produce ImpureE. The reaction needs its temperature to be raised from 100 The separation process produces 90% product 2 and 10% IntAB from Impure E. Cooling water is used to lower its temperature from 130 The processing time of a task The computational statistics for this case study using the proposed model and results obtained from literature are presented in For the scenario of water integration only allowing the use of reuse water the total cost was $112, resulting in 12.2% saving when compared to the standalone operation which had a total cost of $127.52. By using only energy integration the total energy requirement was reduced from 125.5  In the presented method, wastewater minimization and heat integration are both embedded within the scheduling framework and solved simultaneously, thus leading to a truly flexible process schedule. Results from case studies show that addressing profit maximization together with heat integration and wastewater minimization gives much better overall economic performance. From the case studies a better objective value was achieved using the proposed model compared to previous literature models. Forthcoming communications will address the usage of heat storage, wastewater storage and wastewater regenerator with the consideration of capital investment to investigate further improvement in energy and water usage. Although this invariably complicate the model formulation. Additionally, this work only addressed short-term scheduling problem. Extending this work to medium-term scheduling problem using a cyclic approach will be reported in future communication.  { { { { { {  specific heat capacity for the heating task specific heat capacity for the cooling task inlet temperature of the heating task outlet temperature of the heating task inlet temperature of the cooling task outlet temperature of the cooling task maximum thermal driving force maximum temperature change for a task minimum thermal driving force big-M mostly equivalent to the time horizon maximum heat requirement from the heating and cooling task specific contaminant load produced by a task maximum water inlet to a processing task minimum duration required for a washing task maximum inlet contaminant concentration allowed for contaminant maximum outlet contaminant concentration allowed for contaminant price of a product amount of product produced at the end of the time horizon time horizon of interest cost of freshwater cost of effluent water cost of steam cost of cooling water  binary variable signifying whether heat integration occurs between the hot and cold unit binary variable associated to whether the hot state is active at time point binary variable associated to whether the cold state is active at time point binary variable associated to whether the hot and cold states are active at time point binary variable associated with reuse of water from unit j to j′ at time point p cooling load required by the hot task at time point heating load required by the cold task at time point average cooling load required by the hot task at time point average heating load required by the cold task at time point amount of material processed by the hot task amount of material processed by the cold task end time of a heat flow for a task starting time of a heat flow for a task cooling load required by the hot task active at time point heating load required by the cold task active at time point starting time of a heat flow for a task active at time point finishing time of a heat flow for a task active at time point inlet temperature of a task active at time point outlet temperature of a task active at time point amount of heat load exchanged by the hot and cold unit active at time point external cooling water used by the hot task external heating used by the cold task mass of water entering to wash a unit after a task is performed mass of water leaving after washing mass of freshwater entering to a unit mass of water recycled from unit mass of water entering to effluent treatment produced from washing inlet contaminant concentration at time point outlet contaminant concentration at time point starting time of washing operation for unit finishing time of washing operation for unit