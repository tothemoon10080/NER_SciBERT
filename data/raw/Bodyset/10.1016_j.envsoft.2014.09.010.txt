Over the last two decades, evolutionary algorithms (EAs) have become a popular approach for solving water resources optimization problems. However, the issue of low computational efficiency limits their application to large, realistic problems. This paper uses the optimal design of water distribution systems (WDSs) as an example to illustrate how the efficiency of genetic algorithms (GAs) can be improved by using heuristic domain knowledge in the sampling of the initial population. A new heuristic procedure called the Prescreened Heuristic Sampling Method (PHSM) is proposed and tested on seven WDS cases studies of varying size. The EPANet input files for these case studies are provided as supplementary material. The performance of the PHSM is compared with that of another heuristic sampling method and two non-heuristic sampling methods. The results show that PHSM clearly performs best overall, both in terms of computational efficiency and the ability to find near-optimal solutions. In addition, the relative advantage of using the PHSM increases with network size.Evolutionary algorithms (EAs) have been used successfully and extensively for solving water resources optimization problems in a number of areas, such as engineering design, the development of management strategies and model calibration ( One application area where this is the case of is the design of water distribution systems (WDSs) ( Increased network size and complexity result in significant challenges in terms of achieving good quality near-optimal solutions given the computational budgets that are typically available in practice ( In order to address this issue, two main approaches have been adopted in the literature. As part of the first approach, it is argued that for large, real problems, the focus should be on finding the best possible solution within a realistic computational budget, rather than on attempting to find the global optimal solution (e.g. As part of the second approach, efforts have been made to increase the computational efficiency of the optimization process. This has been done in a number of ways, including the use of increased computational power, such as parallel and distributed computing ( Although some of the methods mentioned above utilize engineering knowledge in their development (e.g. In order to address these shortcomings, the objectives of this paper are (i) to introduce a new heuristic sampling method for determining the initial population of GAs for the least-cost design of WDSs that is based on engineering experience/domain knowledge and that overcomes the potential shortcomings of the method of The remainder of this paper is organized as follows. The proposed heuristic, domain knowledge based sampling method for determining the initial population of GAs for the least-cost design of WDSs is introduced in next section, followed by the methodology for assessing the performance of this method against that of the KLSM and the two non-heuristic sampling methods. Next, the results are presented and discussed, followed by summary and conclusions. The proposed heuristic sampling method for initializing the population of GAs for the least-cost design of WDSs based on domain knowledge is called the Prescreened Heuristic Sampling Method (PHSM). It uses a three-step procedure that (i) selects pipe sizes based on knowledge that pipe diameters generally get smaller the further they are from the source; (ii) dynamically adjusts the velocity threshold to account for the fact that appropriate velocity thresholds are likely to be network dependent; and (iii) enables the diversity of the initial population to be controlled by sampling from distributions centred on the solutions determined using the heuristic procedures in (i) and (ii). The PHSM has some similarities to the KLSM in that it aims to find initial pipe sizes that restrict flow velocities to lie within certain ranges. However, it overcomes the potential limitations of the KLSM outlined in the Introduction. Details of the three steps of the PHSM are given below.  As mentioned above, the first step of the PHSM is motivated by the knowledge that, in real WDSs, the diameters of upstream pipes are generally larger than those further downstream ( Find the shortest distance to a reservoir in the water network, Obtain the largest value of the shortest distance Divide the network into Assign pipes in each area a different diameter, with the largest diameter assigned to the pipes in the area nearest to the source and the smallest diameter to the pipes in the area furthest from the source (reservoir). All pipes in a single area are assigned the same diameter. For example, for the WDS introduced by  In this step, the diameters obtained in step 1 are refined to achieve flow velocities in all pipes that are close to a particular threshold. This is based on the domain knowledge that the velocity in each pipe of an optimal solution for a WDS is in a limited range. In addition, in order to ensure that the chosen pipe diameters approach optimal values, the velocity threshold is selected to result in solutions that are on the boundary between feasibility and infeasibility. This is because the optimal solution is often located on the boundary of the feasible and infeasible areas of the search space. The stages in the process for achieving this are shown in As can be seen from As continuous diameter values are generated using Equation The inner loop continues until there is no further change in diameter in accordance with Equation  In order to ensure sufficient diversity in the initial solution, the initial diameter for each pipe is generated from a distribution, such that the pipe diameter obtained in Step 2 has the highest probability of being selected. The logic behind this is that the approximate diameter for a pipe determined in Step 2 is most likely to be the optimal diameter relative to other diameter options. Hence, a relatively higher density function value is assigned to this diameter (i.e. it is more likely to be selected during sampling). The density function In order to illustrate how the approach outlined above is used to generate the pipe diameters in the initial solution, the following example is used. It should be noted that the assumption made in Step 1 that the upstream diameters are typically larger than those further downstream might not hold for all networks due to the influence of network topology and zoning, However, as the initial diameters obtained in Step 1 are adjusted based on flow velocities in Step 2, the influence of network topology and zoning is accounted for in the overall approach. As stated in the Introduction, one of the objectives of this paper is to provide a rigorous assessment of the relative performance of the PHSM compared with that of the KLSM and two sampling methods that do not consider domain knowledge. The flowchart of the process for achieving this is shown in Each of the sampling approaches is applied to seven WDSs of varying size and complexity, including the Hanoi, Extended Hanoi, Fosspoly 1, ZJ, Balerma and Rural networks, as well as a modified version of the KL network (KLmod). The networks are optimized for total life cycle costs while satisfying pressure head constraints at each demand node. The hydraulic simulations required to check pressure constraints are performed using EPANET 2.0, as demand-driven modelling is most commonly used in optimization studies, although pressure-driven modelling is likely to be a better alternative under some circumstances ( Details of the KLSM (Method 2, As mentioned previously, in this approach, initial solutions are generated by adjusting pipe diameters to ensure that the velocities in all pipes are less than a pre-set velocity threshold selected from a practical range of velocities for average and peak flows in water supply networks. The heuristic procedure for achieving this is as follows: All pipes to be optimized are set to the minimum allowable diameter. A hydraulic simulation is carried out to obtain the flow velocity in each pipe. The resulting velocity in each pipe is compared with a pre-set velocity threshold selected from within the range of 0.45–1.5 m/s (e.g. 1 m/s). If the velocity is larger than the threshold, this pipe diameter is increased to the next larger commercial size. Steps (2) and (3) are performed repeatedly until all velocities in all pipes are below the threshold and the resulting pipes sizes are used to form one solution of the initial population. A number of different initial solutions is generated by varying the value of the velocity threshold within the pre-defined velocity range of 0.45–1.5 m/s. In order to maintain solution diversity, half of the initial solutions are generated using this heuristic method, while the other half are generated randomly. In this study, the velocity thresholds of the KLSM are obtained using the following equation: In random sampling (RS), each diameter option has the same probability of being selected for each pipe within the WDS. When generating a solution, each decision variable (i.e. pipe) is assigned a diameter value that is randomly selected from all available diameter options. Latin Hypercube Sampling (LHS) is a type of stratified sampling method that ensures that all portions of the sample space of each variable are sampled ( Details of each case study are given in Minimize. Subject to: As shown in The Extended Hanoi case study is developed based on the original Hanoi problem ( The topology of the KLmod network case study is taken from the network used by The description of genetic algorithms (GAs) has been well documented (see e.g. The four sampling methods (i.e. the PHSM, the KLSM, RS and LHS) were used to generate the initial solutions for GAs applied to each of the seven WDS case studies ( For the PHSM, the value of the initial threshold velocity The parameter values of the GAs applied to each case study were fine-tuned with the aid of a large-scale sensitivity analysis. For the crossover probability, values ranging from 0.1 to 0.9 were tried. For the mutation probability, 10 different values around the value of In order to facilitate easier discussion of the results, the seven case studies were assigned to three groups based on the number of decision variables ( The performance of each sampling method was assessed using the method outlined below: For each case study, ten GA runs were performed for each of the four sampling methods using different random number seeds, resulting in a total of 40 final optimal solutions. The best final solution from the 40 solutions was selected for each case study and used as a benchmark against which the performance of each sampling method was assessed. This benchmark optimal solution was also compared with the current best known solution in the literature obtained using similar GAs, if available (see For each sampling method, the average of the best solution at each GA generation was calculated for each case study based on the ten runs with different starting random number seeds (denoted ABS). In addition, among the ten best solutions at each generation, the one with the lowest cost was selected (denoted as BBS). The deviation of ABS and BBS from the corresponding benchmark optimal solution was plotted against the number of evaluations for each sampling method. This resulted in four convergence curves on the same plot, enabling a comparison of the performance of the four sampling methods considered. The performance of each sampling method was also assessed in terms of its computational efficiency in being able to find near-optimal solutions. For this purpose, optimal solutions that had objective function values within 5% of the benchmark optimal solution were defined as being near-optimal. In order to enable a fair comparison between the methods, the computational overheads associated with implementing the proposed PHSM are also considered ( The costs of the best solutions found using the GAs initialized with the four sampling methods considered for each of the seven case studies are given in From The convergence plots for each of the algorithms for the case studies belonging to the three different groups defined in As can be seen from As can be seen from The results in In terms of the quality of the solutions found, use of the PHSM resulted in the best solutions for all three G2 case studies by some margin ( As far as convergence speed is concerned, use of the PHSM results in significantly faster convergence to near-optimal solutions (i.e. solutions that are within 5% of the benchmark optimal solution, as defined previously) than use of the other three initialization methods, which all performed similarly ( As can be seen from In terms of the relative performance of the two heuristic sampling methods, while both converged to near-optimal solutions after approximately the same number of iterations, use of the PHSM resulted in clearly better best-found solutions. This is likely to be due to a combination of the better initial solutions identified using the PHSM, as well as the additional control over population diversity afforded by the PHSM. However, the relative performance of the KLSM compared with that of the PHSM was much better for the KLmod case study, which is most likely because the KLSM was designed for a modified version of this problem. In order to improve the ability of GAs to find optimal or near-optimal solutions in reasonable timeframes for realistic-sized water distribution optimization problems, a new heuristic sampling method (the PHSM) for initialising GA populations was introduced and evaluated in this paper. The performance of the PHSM was compared with that of an existing heuristic sampling method (the KLSM) and with that of more traditional sampling methods, including RS and LHS, for seven WDSs of varying size and complexity. The results obtained based on the seven WDS optimization (pipe-sizing) problems considered indicate that overall, the proposed PHSM performed significantly better than the other three sampling methods, both in terms of solution quality and computational efficiency. It was also found that the relative advantage of the PHSM increased with network size and complexity. While for the smaller (G1) networks, the performance of the GAs initialised using the four different methods was very similar, there were clear advantages in using the PHSM for the larger (G2) networks and in using both heuristic sampling methods (i.e. PHSM and KLSM) for the largest network considered (G3). This advantage is likely to be due to the ability to find better initial solutions, enabling more favourable regions of the solution space to be explored more quickly. The results also indicate that PHSM outperforms the KLSM, which is likely due to a combination of the ability to find better initial solutions and the additional population diversity provided by the PHSM. As the focus of this paper was on the development and evaluation of the PHSM, all analyses were conducted using a reasonably standard GA. However, as the PHSM is independent of the optimization algorithm used, it can be tested in combination with other algorithms. Such investigations would be useful in terms of assessing the generality of the results obtained in this paper. In addition, it would be useful to extend and apply the proposed approach to a larger number of case studies with increased hydraulic complexity, such as the inclusion of tanks, valves and pumps. However, given that pipe sizes generally represent the largest number of decision variables, application of the PHSM to the subset of the decision variables consisting of pipe diameters is still likely to be beneficial for WDSs including tanks, valves and pumps. Finally, it would be interesting to compare the performance of the PHSM with that of other methods that could be used for initialising EAs, such as the cellular automata network design algorithm of The following are the supplementary data related to this article: Supplementary data related to this article can be found at