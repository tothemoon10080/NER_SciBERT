This article presents a computer program to directly simulate continuous regionalized variables such as mineral grades over a block support. Simulation is performed in the scope of the discrete Gaussian model and does not rely on a block discretization. The realizations can be made conditional to point-support data by use of simple or ordinary kriging, depending on whether or not the average value of the data is considered known. The proposed program can account for an information effect (misclassifications between ore and waste) by co-simulating the true block-support grades together with the grades that will be predicted at the production stage to discriminate between ore and waste.Change of support is critical in geostatistical applications when the volumetric support on which statements must be made is larger than the support of the available data. Examples include mineral resources/ore reserve evaluation and polluted soil management, in which one is interested in estimating the distribution of mineral grades over selective mining units or of pollutant concentrations over remediation units. To simulate a regionalized variable on a block support, one option is to perform point-support simulation on a fine grid and to average the simulated values within each block ( An alternative to the discretization approach is to use an explicit change-of-support model and to directly simulate block-support values, conditionally to point-support data, To determine block-support conditional distributions, a substitute for disjunctive kriging is the conditional expectation, whose calculation requires knowledge of the multivariate distributions of the random field being simulated. Such an approach is applicable in the framework of the so-called In the following sections, an overview of this model will be presented, together with an algorithm for the direct conditional block-support simulation. Two extensions will then be proposed, namely the accounting for an information effect and for an uncertainty in the spatial average. In the discrete Gaussian model, the space The regionalized variable under consideration is interpreted as a realization of a random field { The discrete Gaussian model relies on the following assumptions: The point-support random field {  The block-support random field {  The two random fields { For any set of points and blocks { The point- and block-support random fields are linked by Cartier's relationship ( Together with the previous model assumptions, this relationship entails the following ( The block-support transformation function can be expressed as a function of  The simple and cross semi-variograms are related through the identities  Accordingly, the model is entirely defined by the point-support transformation function It is of interest to simulate the regularized random field Transform the original data { Calculate the change-of-support coefficient Simulate the Gaussian random field Simulate the Gaussian random field  Condition the simulated block-Gaussian random field to the point-support data  Back transform to the original scale by applying Eq. The information effect arises because of misclassifications when selecting blocks whose values exceed a threshold. In the following, we will consider the case of mineral resources evaluation, in which the variable of interest is a mineral grade, although the information effect has also been recognized in soil pollution management ( In selective mining, it is important to distinguish whether a block is Fraction of tonnage: Metal content: Mean grade: Our purpose is, therefore, to simulate the predicted block grades together with the actual grades, i.e. to co-simulate The following additional assumptions are made:   The random field {  For The random fields { The coregionalization model is defined in the following fashion (see the semi-variogram of the cross semi-variogram between the cross semi-variogram between In addition to the parameters defined in As for the correlation coefficients The conditional co-simulation of Simulate the Gaussian random field Simulate the Gaussian random field  Simulate the Gaussian random field  Condition the simulated block-Gaussian random fields to the point-support data  Back transform to the original scales by applying Eqs. In this section, it is of interest to extend the discrete Gaussian model to account for an uncertainty in the spatial averages of the Gaussian random fields, so as to make the model more robust to a possible misspecification of such spatial averages. Proposals in this direction include the use of service variables or uniform conditioning ( We shall modify the third hypothesis made in {  Furthermore, we will assume that the relationships between the point- and block-support transformation functions Eq. For From Eqs. In the following, we use the same notations as in Simulate the Gaussian random field Simulate the Gaussian random field  Simulate the spatial average Condition the simulated block-Gaussian random field to the point-support data  Back transform to the original scale by applying Eq. Consider the system used at step (4) and define the simple kriging error A remarkable result is that, if the prior variance of One approach to modeling the transformation functions Another approach is to model the transformation function By using Eq.    An illustration is given in Because of the randomization of data locations within the blocks, data that belong to the same block will receive the same kriging weights and can therefore be grouped together. For the sake of simplicity, results are presented in the case of ordinary kriging. Let { The previous concepts are implemented in a Matlab program called The transformation functions are defined in accordance with Eqs. The semi-variogram model for Simulation is restricted to The non-conditional simulation of Gaussian random fields is done via the turning bands algorithm (subroutine TBMAIN). Accordingly, the user must define the number of turning lines to use for each simulating nested structure; the line directions correspond to an equidistributed sequence on the unit sphere of Conditioning kriging can be done in a unique neighborhood by setting the search radii to infinity, in which case dual kriging is used (subroutines DUAL and SETDUAL). Otherwise, kriging is done in a moving neighborhood (subroutine KRIGE). In this case, the neighboring data are searched within an ellipsoid centered on the target block (subroutines SEARCH and SETROT to define angle rotations); a preliminary ordering of the data into super-blocks is made (subroutines PICKSUPR and SUPERBLK). As explained in The input parameters can be entered either in the Matlab workspace or in an external parameter file. In the last case, BLOCKTBSIM is run with no input argument and the user is prompted for the parameter file name. A default file (BLOCKTBSIM.PAR) is created if the parameter file does not exist (subroutine CREATE_PARAMFILE) ( The output consists of an ASCII file with the simulated block values (one column per realization). No output is generated in the Matlab workspace. The reader is referred to the headers of the program files for a more detailed description of the input/output parameters. Program BLOCKTBSIM offers the following facilities: Possibility to simulate blocks over a regular grid or scattered blocks defined by their coordinates. Possibility to perform non-conditional simulation, if the data matrix is empty or if the parameter file refers to a non-existing data file. Possibility to use simple or ordinary kriging for conditioning the realizations. Possibility to account for an information effect. In this case, three change-of-support coefficients must be entered: No restriction on the number of blocks targeted for simulation, number of conditioning data, number of nested structures in the semi-variogram model or number of required realizations. Another program called This section presents an application to a case study in mineral resources evaluation. The available dataset consists of 3085 samples from an exploration drill hole campaign in a porphyry copper deposit located in the Chilean central Andes. The area of the deposit under consideration is owned by Codelco Chile and mined by open pit. A location map and a histogram of the assayed copper grades are shown in In the following, our objective is to simulate the distribution of copper grades over blocks of size 15 The previous information allows one to determine the change-of-support coefficients and semi-variogram of the block-Gaussian random field ( A model composed of exponential and Gaussian structures is fitted to the semi-variogram of Program BLOCKTBSIM is now used to co-simulate the true block-support copper grades (random field The information effect produced by ore/waste misclassifications during grade control can be assessed by comparing the true grade The results obtained in the scope of the discrete Gaussian model can also be compared to that obtained in the scope of the traditional multi-Gaussian model, consisting in simulating the point-support grades over a fine grid, then averaging the simulated grades within each block. This approach is implemented with the semi-variogram model given in Eq. The conditional averages and conditional variances over 100 realizations are found to be similar in both the multi-Gaussian and discrete Gaussian models ( The discrete Gaussian model allows directly simulating continuous regionalized variables (mineral grades, contaminant concentrationsâ€¦) at a block support, without the need for a point-support simulation on a fine grid. It constitutes an alternative to the traditional multi-Gaussian model that reduces the CPU time required to generate realizations. In this paper, a set of computer programs to perform such block-support simulation has been presented and two extensions of the discrete Gaussian model have been proposed to account for an information effect, and to condition the realizations to data via ordinary kriging instead of simple kriging. The author is grateful to Codelco Chile for providing the dataset used in this work and to the Chilean Fund for Science and Technology Development (FONDECYT) for supporting this research through Project 1061103. Let us consider the notations introduced in The covariance between The variance of The last equality is derived by using Eq. This identity remains valid under the assumptions of Eq. Model the semi-variogram of Obtain the semi-variogram of Standardize this regularized semi-variogram, so as to obtain the semi-variogram of For ease of use, fit a parametric model to the semi-variogram of This approach differs from the one proposed by The results presented in The proof for Eq. Accordingly, the strategy for determining the semi-variogram models and the correlation coefficients ( From the semi-variogram model for Standardize the semi-variogram of Standardize the semi-variogram of Determine the cross semi-variogram between Find a coregionalization model for According to steps (2) and (3), if the kriging predictor This identity is always fulfilled when Supplementary data associated with this article can be found in the online version at 