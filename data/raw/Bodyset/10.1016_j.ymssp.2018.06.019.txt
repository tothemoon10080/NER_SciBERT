In the field of railroad dynamics, multibody models used for on-board state observation, parameter identification and track geometry measurement must ensure a high computational efficiency, particularly when real-time simulations are required. In this paper, a simplified model based on the assumption of weakly coupled lateral and vertical dynamics is proposed. Generalized forces included in the equations of motion are obtained using symbolic computations and the wheel-rail contact is modeled using knife-edge contact constraints and the concept of equivalent conicity. Resulting contact constraint equations can be solved analytically allowing the solution of ODE equations of motion in terms of independent coordinates. This general model considers arbitrary-geometry tracks including rail centerline irregularities.
                  With the aim of showing the accuracy of the proposed model for the simulation of railways vehicle dynamics, a comparative study with a full 3D coupled dynamic model has been carried out for different vehicles and track geometries. The comparative study shows that the proposed simplified model in this work provides acceptable results for many applications. The model greatly improves the computational effort and it is applicable to real-life situations requiring a reduced set of parameters.When modeling the dynamic behavior of railroad vehicles, the efficiency of the multibody model used in simulations is a key point. The high computational cost of these models is mainly due to the non-linearities associated with the wheel-rail contact. Reducing this cost is essential for real-time applications The numerical simulation of the wheel-rail contact problem is difficult mainly because of the complex geometry of the surfaces in contact. The mathematical expression of these surfaces is required for the contact point detection and the calculation of the normal and tangential contact forces. The constraint or rigid contact approach The modeling of railroad vehicles has many possibilities of linearization that an efficient multibody formulation has to deal with. Linearization is possible whenever the “large” motion associated with the forward motion and wheelset rotation is separated from the “small” motion associated with the vehicle internal degrees of freedom and vehicle-track relative motion. The clue to this separation is the coordinate selection. A successful separation allows the use of the small angles assumption Once the large and small motions of the railroad vehicle are identified, further separation of the small motion into vertical and lateral dynamics can provide important benefits in terms of efficiency. Many railroad vehicle models are just valid for the analysis of the vertical or the lateral motion The goal of this paper is to develop a simplified and efficient procedure based on multibody dynamics to obtain the equations of motion of railway vehicles on arbitrary-geometry tracks with irregularities. The proposed model is real-time capable and can be used for on-board state observation Wheel-rail tread contact is modeled using Vehicle lateral and vertical dynamics are computed almost independently. Lateral and vertical dynamics are weakly coupled by the wheel-rail contact forces. Longitudinal motion is prescribed. The proposed formulation is written in terms of independent coordinates thanks to the approximate analytical solution of the contact constraint equations that provides the value of the dependent wheelset coordinates (vertical displacement and roll angle). This procedure avoids the need to perform a more advanced projection of the dynamic equations in the space of allowable motions. However, the value of the reaction forces, this is, the normal contact force, is needed to compute the generalized applied forces. These reaction forces will be obtained using the dynamic equilibrium equations of the wheelsets. To check the accuracy and numerical efficiency, the results of this model are compared with the results of a nonlinear multibody railroad model that considers contact constraints with fully profiled wheel and rail surfaces and 3D fully coupled dynamics The paper is organized as follows: in Section As described in the introduction, an adequate selection of coordinates is essential for the efficiency of the resulting formulation. In the dynamic analysis of ground vehicles following a guideway, like a train on a track, it is convenient to describe the motion of the bodies with respect to an intermediate frame that is neither inertial nor body fixed The The complete list of frames used in the dynamic formulation described in this paper is:       Left Wheel Profile Frame and Right Wheel Profile Frame (LPiF or RPiF),  In this work the following symbols are used to express position vectors in different frames:     On the other hand, the following symbols are used to express the vector components given in the different fames: Bold symbols without diacritic, like Bold symbols with ‘bar’ diacritic, like Bold symbols with ‘arc’ diacritic, like Bold symbols with ‘hat’ diacritic, like Bold symbols with ‘inverted arc’ diacritic, like Bold symbols with ‘tilde’ diacritic, like The symbols used in this work to represent the rotation matrices can use one or two subscripts. When using one superscript, for example in As usually done in the railroad industry, the geometry of the track centerline is parameterized using the arc-length of the projection of that line in the horizontal In the design of the railway track (ideal geometry), the  The twist curvature Rails distributed irregularities are defined as the deviation of the rail cross-sections from the ideal position, see The well-known irregularity measurements defined in the railway industry are track gauge variation ζ The generalized coordinates associated with each vehicle body are: These coordinates can be used to find the position and orientation of the BiF with respect to the BTiF as follows (see The position vector of an arbitrary point As any other body in the railroad vehicle, the kinematics of the wheelset ‘ The wheelset coordinates As it is common in railway applications, the reasonable approximation that assumes the wheel-rail contact points to be located in the 〈 The wheel-rail contact is assumed as a point-to-curve constraint, where the curve is the wheel’s tread profile (assumed in this work as a straight line) and the rail head cross-section is assumed as a single point. In this paper, this is called Knife-edge contact constraints are imposed simply assuming that the position vector of a point on the wheels (the contact points) coincides with the position vector of the rails in the track centered frame, as follows: Substituting Eqs. These equations are only fulfilled in practice when Since That provides a solution of Eq. Once the reduced set of coordinates In order to check the accuracy of this procedure, a numerical experiment has been performed. Results show errors in the constraints of the order of one tenth of a millimeter. Railway vehicles are assumed to include As a result, the vehicle is described with The arc-length longitudinal coordinate The equations of motion of the vertical dynamics are solved once the vertical coordinates of the wheelsets The mass matrix is just an assembly of the mass matrices associated with the vertical dynamics of each non-wheelset body, as follows: The non-linear suspension forces can be computed symbolically as follows: The terms of Eq. As it can be deduced from the previous analysis, the independent analysis of the vertical and lateral dynamics of the vehicle is achieved, in part, thanks to the assumption of independent vertical and lateral suspension elements and the kinematic linearization.The generalized inertia forces associated with the longitudinal motion Similarly, the generalized gravity force vector The equations of motion for the lateral dynamics of the railroad vehicle are given by: The mass matrix is just an assembly of the mass matrices associated with the lateral dynamics of each body, as follows: Suspension matrices In the model used in this work the wheel profile is assumed to have two different areas: the tread with nominal conicity The following considerations about the contact forces are important. Tangential contact forces at the flanges The generalized contact forces acting on the wheelset in the lateral direction comprises three terms: tread tangential contact forces, flange normal contact forces and tread normal contact forces, as follows: Subscript The calculation of tread tangential forces follows the Kalker’s creep linear theory The vectors of the tangential contact forces and torques are: Once the position of the left and right-tread contact points is calculated symbolically with Eq. In order to calculate the tangential contact forces, the global velocities of the contact points have to be expressed in the local contact frame of each wheel (LCiF and RCiF), through the following expression: The nonlinear generalized creep force vector is obtained as: The flange contact forces are computed using an elastic approach, where the normal contact forces are functions of the indentation and velocity of indentation. The position vectors The flange tangential contact forces are modeled as Coulomb friction forces in the longitudinal direction, as follows: The generalized flange force vector is obtained as: Tread normal contact forces can be written in the WTiF as: Using these equations, the tread normal contact forces can be obtained as the solution of the following linear system: The value of the tread normal contact forces at each wheelset can be computed symbolically. Using this procedure the tread normal contact forces can be written as a function of The generalized tread normal force vector is obtained as: The equations of motion of the vehicle can be integrated forward in time using the following numerical procedure at each time step The value of the vehicle generalized coordinates The position The track irregularity vector Knife-edge contact constraints are computed using Eqs. The equations of motion for the lateral dynamics given in Eq. Using the computed value of the vehicle accelerations In Step 5 of this algorithm, the calculation of the normal contact forces using Eq. Dynamic equations in vertical direction given Eq. The goal of this section is to show the accuracy of the proposed model for the dynamic simulation of railway vehicles. For this reason, the simulation results using the proposed model have been compared with those obtained with a more complex model previously proposed by the authors In order to make a complete analysis of the proposed model, different scenarios have been simulated. Firstly, a single unsuspended wheelset on a curved track is studied, for both situations: large and small radius curve. Secondly, the ML95 vehicle negotiating a curved track, also for both large and small radius curve. In both cases, the behavior of the vehicles running in the transition from a straight to a curved track in case of zero superelevation is studied. In order to simulate the steady curve negotiation of the vehicles, the track is assumed free of irregularities. Finally, in order to complete the validation of the proposed model, a last example with the inclusion of irregularities is also analyzed. The first case of study is a wheelset running on a track with the following geometry: a tangent segment of 20 m, followed by a transition segment of 20 m and a curved track with a radius of  The second case of study is similar to the previous one but with a smaller value of the curve radius: The kinematics of the wheelset is shown in Finally, an interesting remark about the obtained results is presented. As shown in The third case of study is the ML95 vehicle running on a track with the following geometry: a tangent segment of 40 m, followed by a transition segment of 40 m and a curved track with a radius of  The fourth case of study is similar to the previous one but with a smaller value of the curve radius: Quite similar results to the previous case are obtained. The only remarkable difference is that, due to such a sharp curve, the yaw angle experienced by the wheelsets are significally larger than in the case of a smooth curve. With the aim of completing the validation of the proposed model, a last example with the inclusion of irregularities is now analyzed. The case of study is the ML95 vehicle running on a straight track with irregularities. The forward velocity is assumed constant, The first step is the generation of vertical and lateral track irregularities to be included in the model. To do that, since track irregularities can be understood as a random stochastic process, they can be generated from analytical expressions of the power spectral density functions (PSD) that describe them. Consequently, following this procedure and using the PSD functions of real irregularities reported in [24], vertical and lateral irregularities for both left and right rails have been generated and shown in Once the irregularities are generated, the simulation of the ML95 vehicle running on a straight track with irregularities is carried out, using both the reduced model and the 3D one. In this case, both vertical and lateral kinematics are analyzed. Firstly, results from simulations of vertical and lateral kinematics are presented in In the light of the results, even though the vehicle seems to follow the irregularities of the track, this fact is not real, since the suspension of the train has an important influence on its kinematics. In order to analize this fact, in Since the main objective of this figure is to show the kinematic response of the vehicle to track irregularities, for clarity sake, only three bodies are analized, one for each level: one wheelset, one bogie and the carbody. For the same reason, only the results from the proposed model has been plotted. From the results corresponding to the vertical kinematics in As regards lateral kinematics in Finally, with the aim of testing the efficiency of the proposed method, the computing times to simulate the different cases under study are compared for both models, the reduce and the full 3D one. Both models have been developed in Matlab R2016a with a computer with processor Intel Core i7 CPU 2600 @ 3.4 GHz. The adopted integrator is the ode15s from Matlab, which automatically uses adjusted variable time step. As shown in In this paper, a simplified model based on weakly coupled dynamics (lateral and vertical) is proposed, with the main objective of enhancing the computational efficiency without losing accuracy. The main features of the proposed model are: Vehicle lateral and vertical dynamics are calculated independently, while longitudinal dynamics is ignored. Both, lateral and vertical dynamics are weakly coupled by the wheel-rail Track irregularities have been included in the model. Numerical simulations compare the proposed model with a Full 3D coupled dynamic model. To this end, different scenarios have been simulated: an unsuspended wheelset and a ML95 vehicle running on a curved track free of irregularities, for both situations: large and small radius curve. The time evolution of the main kinematic variables (lateral displacement and yaw angle) and the different wheel-rail contact forces, have been analysed. Additionally, a last example of the ML95 vehicle running on a straight track with the inclusion of irregularities has also been analyzed. From the comparative study carried out in this work, several conclusions can be drawn. First, the accuracy of the proposed model is clearly proven, even in the case of a track with irregularities. Second, the computational efficiency is increased four times, in comparison with the Full 3D model. Consequently, the proposed model can be especially appropriate to simulate the dynamics of a railway vehicle in real-time applications, like on-board state observation, parameter identification and track geometry measurements. This research was supported by the Spanish