The design of transmission systems plays an important role in the dynamic performance of motorcycles. It is well known that power delivery and stability in motorcycles is strongly affected by the geometry of the final drive.
                  This article presents a 2D multibody motorcycle model in which the tire and final drive are considered thoroughly. A nonlinear transient model is used to reproduce forces between the tire and the road. The engine and wheel sprockets, the squat ratio and the chain slack have been taken into account in the final drive kinematic model.
                  The configuration of the final drive elements and its influence on the distance covered by the motorcycle have been studied. Furthermore, the motorcycle final drive design has been optimized to maximize the distance traveled on different uneven roads.
                  Simulations show a superior performance of the motorcycle when the configuration of the final drive elements is optimized. This study contributes to demonstrating the importance of the configuration and geometry of the final drive to improve stability and overall behavior of the motorcycle on uneven roads.Magnitude   Angular design parameter Longitudinal design parameter Height of the ground Wavelength of the ground Width of the bump  Angular coordinate of the engine sprocket Angular coordinate of the wheel sprocket Upper chain angle Stiffness coefficient Damping coefficient Unloaded length Kinematic set of equations Coordinate vector Velocities vector Accelerations vector Squat ratio Distance traveled It is well known that the motorcycle final drive design plays an important role in engine-to-slip dynamics. There are at least four parameters involved in this phenomenon Longitudinal velocity Tire radial compliance Swingarm motion Slip due to wheel rotation Nowadays, different final drive technologies coexist. The most important ones are continuously variable transmission (CVT) The modeling of in-plane dynamics is required to analyze the acceleration process of a motorcycle. To the best of our knowledge, there are basically two complete motorcycle models described in literature. The first one was published by Sharp in 2001. It makes use of independent coordinates to study motorcycle dynamics Furthermore, the tire model is of great importance in the modeling of the motorcycle. There are several contact force models, such as: the restitution coefficient Four-wheeled vehicles have received great attention from research groups. However, research studies focused on two-wheeled vehicles are less common. Although lateral relaxation lengths for various motorcycle tires have been published in literature The modeling of the final drive can be performed from several perspectives and with different simplifications. The relationships between the engine sprocket, wheel and swingarm can be modeled using kinematic constraints This paper proposes a methodology for the optimal design of motorcycle final drives by means of multibody simulation and genetic algorithms. As found in In this work, an in-plane motorcycle model with the following features is proposed: The final drive has been modeled in detail, analyzing the kinematic relationships between the wheel, the swingarm and the engine sprocket. The road-tire contact has been modeled using the Pacejka transient model Three different road profiles have been simulated: flat, bumpy and sinusoidal. Aerodynamics have not been considered. The dynamic problem has been formulated by using the augmented Lagrangian formulation Multi-step integrators (Adams-Bashforth and Adams-Moulton) have been used The modeling of the system has been carried out by means of natural coordinates Real time performance has been achieved thanks to dynamic formulation and the solver used. In addition, due to the tire model considered, the simulation can start from a singularity, such as standstill as well as moving forwards or backwards. Once the model simulations have been carried out, the parameters that influence the behavior of the motorcycle on an uneven road are studied. These parameters have been optimized by means of genetic algorithms, obtaining the final drive design that maximizes the distance traveled in the test. This work is organized as follows: in In this paper, the motorcycle has been modeled as a system composed of six bodies: chassis, swingarm, engine sprocket, lower front suspension, rear wheel and front wheel. Both the rider and the upper part of the front suspension are assumed to be rigidly attached to the chassis. This simplification has been made because only the in-plane dynamics of the motorbike are studied. A fork and a spring-shock absorber are used in the front and rear suspension respectively. The coordinate system used is the following: horizontal A total of 39 coordinates are used to model the motorcycle ( The masses and moments of inertia of the bodies that constitute the system have been extracted from Kinematic constraints are grouped into three blocks, namely: motorcycle, transmission and tire-road contact (road profile). The «kinematic model of the motorcycle» refers to the set of equations that governs the kinematics of the chassis, rear axle, front axle and wheels. The kinematic relationships that model transmission as well as tire-road interaction are described in an independent Section. Five points are used to model the chassis. Points 1 and 2 represent the axle of the swingarm and engine sprocket respectively. Point 3 is the upper anchorage of the rear shock absorber. Points 4 and 5 are used to define the front suspension slider. In addition, the lengths and angles listed in The rear train kinematics are defined by points 6 and 7. The first point is the rear wheel axis and the second one is the lower anchorage of the shock absorber. It is important to note that φ is the angle that forms the swingarm with the horizontal and not with the chassis. The length of the rear shock-absorber is determined by coordinate The kinematic constraints of the front fork suspension slider mechanism are defined by The length of the lower part of the front suspension and the front spring-shock absorber is given by parameter The wheel equations are Four points   Three different road profiles are simulated in this work, namely: Sinusoidal profile Gaussian profile (bumpy) Flat profile The coordinates of points 14 and 15 ( The forces that govern the dynamics of the system are grouped into three distinct blocks: front and rear suspensions, vertical forces on the front and rear tires and longitudinal forces on the rear tire. The parameters of the spring-shock absorber systems for both suspensions and tires can be found in The front and rear suspension parameters have been selected so that the equivalent stiffness and damping coefficients on the wheels are similar to those used in For the suspensions, it has been decided to use a linear model for both the spring and shock absorber. The equations that reproduce front and rear suspension forces are the following: The following model of a spring-shock absorber has been considered The There are fluctuations in the vertical loads due mainly to road surface irregularities and the load transfer that takes place in acceleration processes of motorcycles. In pure acceleration processes, due to the power-to-weight ratio of motorcycles, the longitudinal acceleration is important and, consequently, the slip is also high. There are important angular accelerations in the powertrain due to the geometry of the transmission system. This causes high slip fluctuations, which makes the slip oscillate from the stable to the unstable zone of the longitudinal force curve. It is important to define both the effective rolling radius, The speed of the rear wheel axle, Finally, the longitudinal slip speed, Due to the reasons stated before, it is required to resort to the fully nonlinear transient model to properly reproduce tire-road interaction. This model ( The parameters related to the stationary Pacejka tire model have been extracted from Lagrange equations in dependent coordinates The kinetic energy, The combination of expressions Kinematic constraint Eq. The system of equations to be solved is given by expressions As stated in The penalty parameter An Adams-Bashforth and Adams-Moulton solver was selected to solve this ODE system because of the stiffness of the problem. This stiffness is mainly due to the slip calculation, especially at the initial stages of the simulations, where sudden changes in the slip value were observed. Besides, sharp variations of Two types of integrators are used for the integration of the dynamic equations. The trapezoidal integrator is used to find the static equilibrium and the first four time steps of the simulation. The Adams-Bashforth and Adams-Moulton multi-step linear integrators are used for the rest of the simulation. The former is explicit and acts as a predictor, while the latter is implicit and acts as a corrector. This predictor-corrector strategy allows increasing the time steps and, consequently, accelerates the calculation process. These mathematical tools have been developed to solve systems of first-order differential equations of the following form Therefore, it is necessary to reduce the system of second order differential equations to a system of first order differential equations. To do so, the following transformations have been carried out: Once the transformations have been made, the trapezoidal integrator is used While the Adams-Bashforth and Adams-Moulton integrators are defined by Where This way, coordinate vector ( The algorithm used to perform simulations is described below: It starts by initializing the parameters of the simulation: time step, simulation time, geometry, suspension and tire parameters of the motorcycle. A single-step trapezoidal solver is used to calculate the static equilibrium for the first time step. The same single-step trapezoidal solver is used for the next four time steps. During the rest of the simulation, the Adams Bashfort-Moulton’s predictor-corrector multistep solver of the fourth order is used The static equilibrium position can be determined by means of different methods This Section describes the procedure followed in the optimization process by means of genetic algorithms. To perform this optimization, an objective function has to be defined. In this work, the objective function or fitness function takes into account the distance traveled by the motorcycle during 3.5 s of simulation and two penalties The penalties are forced to be greater than 0.95. The nature of the penalties is described next. The first one, associated with the Squat Ratio ( The second parameter is associated with the length variation of the taut stretch of the chain throughout the simulation. This extension has to be guaranteed, so the lower stretch of the chain has to be left with the appropriate slack. Too much slack is not desirable, as it may even cause the chain to escape. The penalty factor ϵ Therefore, the slack is the extra length that the loose part of the chain has in the most unfavorable situation ( One of the reasons to carry out this work was to contribute to improving motorcycle models by taking into account the influence of swingarm movement in the slip of the rear wheel. Traction and braking control system performance is affected by the changes in the slip of the rear wheel. In this kind of system, the performance is commonly evaluated by minimizing the distance travelled by the motorcycle during the braking process or by maximizing the distance during the acceleration process. Thus, the distance travelled by the motorbike during a pre-determined period of time has been selected as the main factor in the fitness function. Next, the optimization method used in this work is described. Among the different evolutionary optimization strategies, an algorithm known as differential evolution has been used. This method was described by Storn and Price in This algorithm has been used in a number of optimization problems applied to mechanical engineering, such as in the determination of the parameters of the Pacejka magic-formula Initialization of the population through the generation of random individuals. Evaluation of each individual and determination of the optimal one. Generation of the new population through differential evolution: The new population is composed of a fraction of individuals from the previous generation. The remaining members of the new population come from the offspring of the differential evolution process. From the new population, a fraction of individuals of the new population mutate. The population resulting from this iteration is constituted by the best individuals from the population of parents and offspring. The best individual of this iteration is the best individual of the resulting population. Steps 3 to 6 are repeated until the maximum number of iterations is reached. The best individual of the last population is the solution to the optimization problem. The lower and upper limits of the search space are listed in The rest of the design parameters ( The ratio between the sprocket radii ( The chain length is calculated from the geometry of the final drive The wavelength of the road, ( In the case of the road with a bump, the width, ( The results of this study are grouped in two blocks. In the first block, a simulation has been carried out by sweeping parameters It is important to remark that a computational time ratio of 2.2 has been achieved. This is understood as the ratio between the simulation time and the time used for its calculation in a single core. Therefore, real time simulations have been achieved, with an average of 1.6 s to calculate 3.5 s of simulation in an Intel® Core In this case, the variables are swept within the range set in The sweep has been made for a total of 23 different roads: Flat road. Sinusoidal road with four different wavelengths (2, 3, 4, and 5 m) and four amplitudes (1, 2, 3, and 4 cm). Gaussian (bumpy) road with three different widths (0.2, 0.5 and 1.0 m) and two heights (2 and 4 cm). For each one of the 23 cases, the fitness function was evaluated by varying parameter In the case of the optimization using genetic algorithms, in addition to the two parameters indicated above ( The results are presented in From the results shown in In this work, three parameters have been optimized: On the other hand, it has been observed that it is necessary to model the entire motorcycle, allowing pitch and bounce vibration modes and not only the rear train. Previous simulations carried out with a simplified model showed that optimizations converged to a final drive geometry with the engine sprocket placed in the lowest positions if pitch and bounce movements were restricted. If the engine sprocket is placed very low, the force of the chain compresses the rear wheel. This increases its vertical load and reduces the effective radius, which maximizes the longitudinal force and, thus, the distance traveled. However, this simplification of studying only the rear axle is not valid since the load on the rear wheel cannot grow indefinitely. These phenomena have been eliminated by modeling the front train and allowing these two additional movements.  The first geometry (geometry 1) has been provided by the optimization algorithm. These results propose a configuration with concentric axes ( For comparison purposes, a second geometry has been simulated. In this case, the sprocket is placed just below the swingarm axis at a distance of 150 mm, ( In this simulation, a sinusoidal road with an amplitude of 4 cm and a wavelength of 3.0 m was used. Differences up to 2% were observed in the distance traveled between both geometries ( From the results shown in It is also necessary to emphasize the importance of the proper selection of longitudinal velocity for the calculation of longitudinal slip ( The video attached to this paper shows the simultaneous behavior of both configurations during 3.5 s of simulation, showing the results of this study. In this work, an in-plane dynamic model of a motorcycle has been developed. Special attention has been given to the modeling of the transmission system and its influence on the power delivery. A non-linear tire transient model has been used to reproduce the generation of contact forces between the tire and road. This model makes it possible to start the simulation from standstill, where slip calculation usually presents singularities and numerical errors. In addition, this model takes into account the delay that exists between the slip changes and the subsequent generation of contact forces. This characteristic of the proposed methodology is of particular interest in situations where sudden changes in the longitudinal slip take place, such as riding on irregular roads and during ABS and TCS operation. The modeling of the motorcycle has been carried out by using 30 natural and 9 mixed coordinates respectively. This way, the mass matrix is constant and no Coriolis or centrifugal forces appear in the model equations. Consequently, a simplified formulation and easier programming of the dynamic equations are achieved. An augmented Lagrangian formulation has been used. Implicit integrators have also been programmed, both single-step: trapezoidal, and multi-step: Adams-Bashforth (predictor) and Adams-Moulton (corrector). In addition, an under-relaxation factor has been employed to improve the stability of the integrator, which allows solving stiff problems. As a result, real time simulations have been achieved. The model developed has been used to simulate the longitudinal dynamics of a motorcycle riding on uneven roads. In order to study the optimal configuration of the final drive elements, an optimization process of the relative position and size of the sprocket axis has been carried out. In this process,the transmission ratio is kept constant. The results of this work show that, in order to maximize power transmission from the engine to the road, the optimal position of the engine sprocket axis relative to the swingarm axis should be virtually concentric or aligned with the swingarm. This conclusion is consistent with the usual configuration observed in sports motorcycles, in which power transmission has to be maximized. Future works will include the optimization of the suspension system, including their non-linearities as well as the angle and length of the swingarm. Furthermore, the proposed model will be used to develop improved traction and braking control systems. The authors declare that they have no conflict of interest. This work was partly supported by the Supplementary material associated with this article can be found, in the online version, at doi:   