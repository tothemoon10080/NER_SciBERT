Compositional reservoir simulators are important tools for application in enhanced oil recovery processes. These simulators solve partial differential equations arising from modeling fluid flow in permeable media. Various algorithms for the solution of such partial differential equations are available, which their application greatly impacts the computational performance of the simulators. In this work, a new fully implicit approach called PZS (pressure, overall composition, and water saturation) is proposed and implemented. The new formulation considers pressure, water saturation, and overall compositions as primary variables, reducing the number of unknowns by one when compared to other volume balance fully implicit formulations. The new approach is obtained by a variable change and elimination of a well known volume balance approach. The new approach is implemented in the UTOMPRS simulator that has been developed at The University of Texas at Austin for simulation of several multicomponent/multiphase recovery processes. The PZS formulation is compared to the volume balance based and IMPEC (Implicit Pressure Explicit Composition) formulations in UTCOMPRS. We observe that the PZS approach is, in general, faster than the other approaches tested.Reservoir simulators are tools developed to simulate fluid flow in porous media. In the oil industry, reservoir simulators are used to forecast the oil and gas recoveries, perform field optimization and economic analysis, and assess uncertainties. For such analysis, an extensive amount of simulation is required, which may result in excessive computational effort. Therefore, fast and robust algorithms are essential. In general, fast algorithms are obtained by combining adaptive implicit methods (AIM) with high-performance computing techniques. Adaptive implicit methods are obtained by combining a Fully Implicit (FI) formulation with an IMPEC approach. Therefore, the performance of an AIM approach is limited by the performance of each formulations. Many formulations have been proposed for compositional reservoir simulation using an Equation of State (EOS). In this work, a new FI approach is proposed, implemented, and tested. The new FI is in part based on formulation uses the FI approach of A brief description and classification of some important approaches in the literature along with the one proposed in this work is presented in The new approach is implemented in The University of Texas Compositional Reservoir Simulator (UTCOMPRS). UTCOMPRS is a modified version of the UTCOMP simulator, which initially was developed by In this work, an isothermal compositional multiphase fluid flow in porous media is considered. The flow equations are obtained by combining the material balance equations with Darcy's law. The mass transfer between phases is assumed to be at local equilibria. A summary of the main assumptions employed in this study is presented below: Isothermal reservoir rock, fluid, and injecting fluids. Local phase equilibrium. Up to three hydrocarbon phases. No hydrocarbon dissolution or solubilization into the aqueous phase. No water mass transfer between the hydrocarbon phases. Phase velocities evaluated through the modified Darcy's law. No water vaporization. The material balance equations for each hydrocarbon component can then be written as The volume constraint is also necessary and is written as The porosity is computed as. The dispersion tensor is computed as the sum of the molecular diffusion and the mechanical dispersion as The Peng-Robinson equation of state (EOS) ( Phase appearance and disappearance is treated using a stability test calculation. Two phase stability test algorithms are implemented in the UTCOMPRS simulator: the stationary point location method ( After the phase stability, a flash calculation to evaluate the mole fractions and amount of each hydrocarbon phase is performed. The flash calculation used in UTCOMPRS is a combination of the Accelerated Successive Substitution (ACSS) method ( In the new scheme presented in this work, the original approximate equations are equal to the ones of the fully implicit model of The dispersive mole fluxes are computed as The volume constraint equation in its residual form is written, for each gridblock, as In UTCOMPRS, wells can be controlled by either total constant flow rate or constant bottom hole pressure. For the scope of this work, injector wells are controlled by total constant flow rate and producer wells are controlled by constant bottom hole. Injector wells controlled by constant total flow rate have the mole rate computed at each gridblock it intercepts as The mole rate for constant bottom hole pressure producer wells are computed as It is important to present a brief description of intensive and extensive variables as defined in thermodynamics. An extensive variable depends of the amount of mass or size of the system as opposed to intensive variables. Examples of extensive variables are volume, mass, and enthalpy, while mole fractions, density, and specific enthalpy are examples of intensive variables. The main idea of the formulation proposed here is to change the set of variables considered by The Jacobian for The Jacobian of Eq. Despite of the variable change, one might notice that in the new variable set only The Jacobian illustrated in Additionally, the wells can be considered coupled or decoupled. In the decoupled approach, a gridblock is assumed to consider only the segment that intercepts itself in the calculation of the Jacobian. The contribution of the other segments are transferred to the residues. On the other hand, in the coupled approach, it is considered extra equations for each component in each segment, similar to the approach presented by As it may be noted, the derivatives of properties such as viscosity and density with respect to the primary variables are not simple to be obtained, once these properties are function of the phase composition. Therefore, the derivatives of phase composition with respect to the primary variables must be obtained. The procedure to obtain these derivatives is presented in For all cases presented in this section, the linear systems were solved by the GMRES method ( Three case studies are presented for testing and validating of the new fully implicit formulation proposed in this work. The first case study considers a CO In the first case study a reservoir with heterogeneity in the X and Y permeabilities is considered. Twenty-three wells are considered in a 153 × 77 × 10 grid. The permeability field is presented in The reservoir data is presented in A comparison of the oil and gas production rates is presented in The time-step profiles are presented in  The gas saturation field at 2190 days of simulation is presented in The number of Newton iterations and the CPU times are presented in The second case study refers to a gas/solvent injection performed by The production rates are presented in a semi-log plot in A comparison of the gas saturation field at 1000 days is presented in As shown in  From For the last case study, a grid with several inactive cells is presented. Herein, only the FI approaches are compared, once the IMPEC approach was not able to simulate this case. A 200 × 200 × 10 grid is used with only 99,816 active cells. Thirteen wells are considered with 6 producers and 7 injectors. The absolute permeability, porosity and the grid shape is synthetic and was developed for testing the inactive cell approach for UTCOMPRS. Also, a second liquid hydrocarbon phase is formed in this case. Therefore, a three phase flash calculation is used and a four phase flow takes place in some parts of the reservoir. This is also an important feature that is tested in this case with the new formulation. The data for the BSB west Texas Oil ( The reservoir depth from the top of the reservoir is presented in The production curves are presented in The time-step profile for each formulation is presented in The CPU times and number of Newton iterations are presented in In this work, a new fully implicit formulation was proposed. The new formulation used pressure, water saturation, and overall composition as primary variables, all intensive variables. A procedure was presented to obtain the Jacobian for the new set of intensive variables using a formulation that was based on extensive primary variables. The new formulation was tested and compared with the extensive formulation, which the new formulation derives from, and with the original IMPEC approach from UTCOMPRS simulator that has been benchmarked with commercial and in-house simulators along the past years. The case studies presented here show that the new formulation is, in general faster, than the other mentioned approaches. Better performance was also observed for several other test cases that are not presented in this paper. Additionally, the new approach requires less storage than the previous original We can conclude that the formulation presented here is a powerful approach to speed up reservoir simulators, but more study is needed in order to determine what processes and features affect the performance of the implemented and tested formulations. The first and second authors would like to acknowledge We notice that several properties such as density, saturations, and viscosity are function of the phase composition and the phase mole fractions. Therefore, derivatives of the phase composition and phase mole fraction with respect to the number of moles of each component and pressure are required. The procedure that follows is based on the works of The derivative of phase composition with respect to a primary variable X, pressure or total number of moles in this case, of a given component is written as Therefore, obtaining the derivatives of the number of moles of each component in each phase with respect with the primary variables is essential. For two hydrocarbon phase equilibrium (i.e. oil-gas), the derivatives of For the derivatives with respect to the number of moles, Once again, the solution of the Similar procedure is performed for the three-phase equilibrium (oil-gas-second liquid). The derivatives with respect to pressure require a solution of a system with Herein, we obtain the derivatives of the moles of oil and second liquid phases. For the gas phase, the derivatives can be obtained as Similarly, the derivatives with respect to the total number of moles of each component require the solution of Notice that the coefficient matrix does not change no matter if we are trying to obtain the derivatives with respect to pressure or moles. Again, the solution of the system provides the derivatives for the oil and second-liquid phases. For the gas phase, the derivatives can be obtained as The linear systems are solved using the Cholesky's decomposition. See