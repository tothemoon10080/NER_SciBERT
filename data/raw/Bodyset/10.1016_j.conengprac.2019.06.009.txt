Vertical roller mill (VRM) is an increasingly popular comminution equipment in cement plants. Raw meal fineness at the outlet of VRM is one of the most important indicators to measure product quality. A soft sensing model developed for powder fineness in real-time could assist operators to monitor the comminution process online. However, due to frequent fluctuation of raw material properties, intrinsic nonlinearity of the process and changeable operation conditions, the data present a multimodal characteristic. Therefore, this paper proposes an indicator to measure the similarity between variables, that is, the shortest distance between nodes in the constructed weighted network. By combining the Girvan Newman (GN) algorithm, the nodes in the variable network are divided into multiple groups, and based on this, the distributed PCA (DPCA) similarity is adopted for time series segmentation (TSS). Compared with traditional similarities between samples (distance, density, etc.), the similarity between time series focuses more on the dynamic characteristics of variables. And the implementation of DPCA similarity is equivalent to increasing the sparse characteristics of principal components, which is beneficial for enhancing the generalization of the model. Support vector regression (SVR) models along with a support vector machine (SVM) based classifier are built to obtain final predictions of the powder fineness. Effectiveness of the proposed method is verified by actual industrial data. It has a root mean square error (RMSE) index of 0.3451 on the test set, which is much smaller than that of the multi-modal soft sensor based on either clustering approaches (0.6524) or PCA similarity based TSS method (0.4282).Online measurement of product quality is essential for process control and monitoring in cement industry. However, most quality relevant indicators, such as concentration and particle size, are sampled and analyzed in laboratory every two hours. Although such physical sensors are available, the cost of online instruments is quite high. Other problems such as high speed, high pressure, and high temperature strengthen difficulties of the detection work and result in a reduction of the instruments’ service life. Meanwhile, key indicators of the process get lost when these sensors are maintained or overhauled. These problems faced by industrial processes can be solved by soft sensing methods. The key indicators can be predicted continuously according to relevant process features. Hence, the soft sensor can replace the costly physical sensors and assists manual test in laboratory. In the cement manufacturing process, the particle size of the raw meal is expressed as sieving residues. A higher value indicates a coarser product. The powder with sieving residues higher than a prescribed value indicates a poor raw meal feeding for the following calcining process, resulting in high energy consumption and low product quality. On the other hand, too fine product has been reported to increase energy consumption of the comminution process ( Initially, soft sensors for particle size prediction mainly focused on multivariate statistical regression methods. A dual updating strategy for partial least square (PLS) model is reported, in which not only the prediction model but also the mean and variance of samples are updated ( While most of the previous models are built for ball mills (except for the works of Pani & Mohanta), as a fact of higher efficiency, smaller floor area and lower energy consumption, VRM is gradually becoming a standard equipment for raw material comminution process. The main difference between the two equipment is that ball mill can be regarded as a homogeneous phase along the radial direction, but material and gas in VRM are usually heterogeneous and the working conditions are much more complex than ball mill. Besides, fineness of raw meal at the outlet of VRM is greatly affected by various factors, such as raw material properties, grinding efficiency, material conveying and drying effects, especially when the raw material properties change frequently. Therefore, applying a simple prediction model is not always appropriate for a raw material grinding VRM. To cope with this problem, an online update strategy ( For model development, input–output data are collected from a VRM system in cement plant with a capacity of 520 tons per hour over a period of 3 months. The framework of the proposed soft-sensing model is shown in  The schematic diagram of VRM is shown in In a VRM system, a motor and a reducer driving the grinding table to rotate at a certain speed, four grinding rollers fitted on the grinding table, a dynamic classifier installed at the top of the mill, a bucket elevator transporting rocks discharged from the bottom back to the entrance and a bucket elevator transporting raw meal product into homogenization silo. Mixed raw material feed is transported onto the center of the grinding table. While the grinding table is rotating at a given rpm, the material moves around by centrifugal force and is crushed by extrusion of grinding rollers and grinding disk. When it leaves the grinding table, hot wind entering from the bottom of the mill blows it up. The larger particles fall directly to the bottom, then they are transported back to the entrance by bucket elevator. While finer ones are blown into the chamber of the mill. An induced draft fan operates at the outlet of the mill and brings the particles into the dynamic classifier, where unqualified ones fall back to the mill table along the cone and get reground. Fine products gathered from the cyclones and electric dust collection are finally transported into the homogenization silo for storage by bucket elevator. Usually, key indexes in VRM system include the current of the driven motor (the load of VRM), the current of the induced draft fan (the gas flow rate in VRM system), the rpm of the dynamic classifier, the differential pressure (the amount of suspended powder), the outlet temperature, the current of the bucket elevator (the amount of rocks discharged at the bottom). And the quality of the product is measured with moisture content, 80 um sieving residue, and 200 um sieving residue.  Traditionally, division of multimodality tends to depend on the magnitude of manipulated variables and observed variables of the process, that is, the distribution of data samples in high-dimensional space. In this paper, the distributed PCA similarity, an indicator determines whether time series are derived from a same modality, is adopted as the basis for modal division. This indicator describes the similarity of dynamic relationship among variables between two different time series. When the disturbance characteristic of the process or the device health condition changes, dynamic characteristics of the process will change. For example, the variations in moisture content of the raw material will cause changes in material fluidity, which in turn leads to a different dynamic response of outlet temperature to inlet temperature, as well as a change in principal component direction of time series consisting of the drive motor current and the mill load. Therefore, using the indicator to separate time series can essentially divide the data derived from different modes. As for VRM, the nonlinearity of process, multiple operation modes, and time-varying characteristics often deteriorate the prediction performance of soft sensing models (  Girvan et al. have developed an algorithm to detect community structure in a weighted topology network ( According to the idea of DPCA algorithm, relevant variables should be divided into a same group. Therefore, we first construct a topological network based on the variables of multiple time series. The point is how to assign weights to the edges of the network. An intuitive idea is to employ correlation coefficients, but in fact, in the GN algorithm, the shortest path of the network is characterized by summation. But the correlation coefficient between variables often does not have the transitive nature of addition:    Based on the above assumptions: Let Substitute Eq. The above formula is consistent with When constructing the network, assign weights to edges between nodes as follows: This means it is more appropriate to employ the shortest path as a measure of similarity between two nodes than using the weight between nodes directly. For example, suppose that variables A network is first constructed according to the aforementioned method. And it is then divided into groups using the GN algorithm operated as shown in  A numerical simulation is conducted to validate the proposed method. Stochastic variable Due to essential nonlinearity and multiple operation modes, the process shows different characteristics between periods. From the perspective of data, differences are reflected in dissimilarities between feature spaces of segments. Therefore, PCA-based similarity is reported in ( To solve the sensitivity deterioration of similarity to modal change caused by strong coupling between features, a similarity calculation based on distributed PCA is proposed as follow: Here, we give a simple example to illustrate the effectiveness of DPCA similarity. We generate a random multivariate time series with coefficient matrix When changing one of the coefficients in coefficient matrix  According to the definition of DPCA similarity, TSS process can be achieved by the algorithm explained with  Data used in this paper are collected from an actual field plant with a time span of 3 months. The sampling period is 10 s, and the period for chemical analysis is once every two hours. Since most of raw materials are limestone (approximately 90%) which comes from mining, the quality of raw materials such as hardness, water content and particle size distribution may change greatly during this period. This could induce changes in operating mode, but from the perspective of data, it should be the change of dynamic relationships between variables. For example, when the water content in raw material increases, the heat is not enough to dry it. At this time, it is necessary to increase the amount of hot air and reduce the amount of cold air to keep the outlet temperature at the set point. However, due to the movement of the equilibrium point, the dynamic response of the process has changed. In addition, variations in drying degree of the material will also cause changes in fluidity, resulting in a different dynamic response of the driven motor current to the load. The multi-rate problem does exist between the data acquired from the real-time database and the label data analyzed in laboratory. Therefore, the data are first transformed into standard input–output samples. Due to the existence of time lag and inertia, for each particle size every two hours, time-lags of input variables need to be estimated. Because the time constant of the process is small, most of the time lags are approximately equal to zero. The time lags listed in  Taking the dynamic influences from input variables into consideration, the hour during the sampling period is divided into 2 half-hours, and the averaging method is applied to these half-hour-average instrumental variables. The constructed samples consist of 26 input variables and 2 output variables. After data samples have been prepared, data pre-processing steps need to be carried out in order to improve the quality of the data ( An automated weighted outlier detection technique has been proposed for multivariate data (  The features mentioned before include 26 input variables, but not all the variables have significant influences on output variables. Considering the redundancy among variables may mislead to a complex model structure, it is necessary to extract representative features as instrumental variables. High dimensional MI is an index to evaluate the correlation between multi-dimensional input and output variables. It could be estimated with either the  By using the method proposed in the previous parts, a soft sensor is developed for raw meal fineness prediction at the outlet of the VRM. In the first step, a network describing the correlation between the 26 variables is constructed, and the network is separated into several groups with the GN algorithm. The results are shown in The TSS results are shown in  SVM was initially designed for data classification and then developed to solve non-linear regression problems known as SVR. The algorithm has been successfully applied to plenty of forecasting studies ( In this part, a SVM classifier is firstly developed to separate the working conditions and SVR models are constructed for each part. The 2-dimensional distribution of sample data mapped by t-SNE algorithm is shown in   Since the main reference index in actual production is 80 um sieving residue, only the prediction results of this index are presented in this paper. In order to verify the reliability of the algorithm, it is compared with two basic multi-model soft-sensing methods in this paper. One is a clustering-based modal partitioning method, and the other is the PCA similarity based TSS algorithm.  In addition, constructing different models under various working conditions reduces the complexity of the model. Hence, it has a better generalization ability. When the DPCA similarity based TSS strategy is implemented, the RMSE continues to decline to 0.3451. The validation result is shown in In order to describe the prediction errors in detail, the absolute prediction error distribution is shown in The paper analyzes the possible problems of modal partitioning based on clustering method in cement industry application, and proposes a time series segmentation method based on DPCA similarity. Firstly, the correlations between variables are mapped to a weighted topological network, and it is proved that the shortest distance between two nodes is a better indicator of the correlation between two variables. Then the network is divided into multiple communities by the GN algorithm for grouping variables. On this basis, the principal components are extracted for each group of variables, and the TSS based on DPCA similarity is used to separate the data derived from different modes. From the simulation results shown above, the soft-sensing method combined with DPCA similarity based TSS technique outperforms the other two algorithms. We believe that it is attributed to two reasons. First, the dynamic characteristics of the data are used to replace the original steady-state information, which makes the method more robust to large noises and uncertain drifts. Second, the use of DPCA similarity to replace the original PCA similarity is equivalent to increasing sparseness of the principal components, which is beneficial for improving the generalization ability of the model. This work was supported by None declared.