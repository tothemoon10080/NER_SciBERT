It is well-known that transit-time ultrasonic flowmeters (TTUF) are unsuitable for bubble-contained flows. This paper presents a new online monitoring method based on optical observation, which monitors the functionality of the TTUF in the presence of bubbles in the fluid. The method avoids the unnecessary Emergency Shutdowns (ESD) due to bubble presence in the fluid by bubble detection. The proposed method accomplishes bubble identification through a combination of image processing and wavelet analysis. In addition, a new method is proposed which estimates single bubble size in horizontal pipes using a data fusion approach.Transit-time ultrasonic flowmeters (TTUF) are a state-of-the-art technology and most widely used type. This type of ultrasonic flowmeter makes use of the time increment for an ultrasonic pulse to travel a fixed distance, first against the flow and then in direction of flow The goal in this project is to propose an optical observation method to detect the void fraction in a two-phase gas/liquid system. Bubble detection and bubble size estimation by means of optical observation, provides us with two main advantages that lead to overcoming the defect of bubble presence on the TTUF’s functionality. Firstly, if we detect the bubbles in the fluid, while the TTUF is sending an unnecessary Emergency Shutdown message due to bubble presence, we know that this ESD is not due to an empty pipe and therefore we can avoid such unnecessary ESD. Secondly, our experimental results have shown that despite using the Fuji Electric’s advanced ABM method, the TTUF’s measurement is not accurate in the presence of bubbles, especially when the air volume is more than the permissible air volume. The optical observation method presented herein is able to detect this condition and provide us with an alternative method for calculating the velocity of the fluid in this situation. In the sections that follow an experimental setup and image acquisition system used in this study are introduced resulting in the proposal of a simple and fast image analysis technique. Bubble identification is then reviewed by means of optical observation and image processing. The contribution of this paper in the bubble identification is a combination of image processing and wavelet analysis to detect bubble presence. In addition, a new method is proposed which estimates the single bubble size in horizontal pipes using a data fusion approach. An alternative method for calculating the velocity of the fluid in the presence of bubble is introduced in Section The clamp-on TTUF on which the experiments were carried out was a FLV-3 Fuji Electric’s product which consisted of three elements: the transducers, the clamping arrangement and the signal processing and user interface electronic package. The two ultrasonic transducers of the TTUF were mounted on a test section with single reflection (V) configuration. The temperature in all the experiments was 25 The test section was part of a vertical/horizontal transparent pipe made from Plexiglas of 60 The largest single sector where TTUFs are currently being applied is the water industry  A digital camera captures successive images of the transparent Plexiglass pipe. Not only does this method provide us with constant monitoring of the fluid condition, but is also an effective way to provide multiple measurements for horizontal pipes in which the size of a single bubble can be estimated more accurately using a data fusion approach. Flow images were captured with a rate of 30 Most of the methods offered by different authors who work on two-phase flow regime investigations lack the real-time characteristic. This is mostly due to their complex and time consuming image processing techniques, which are executed by professional image measurement software. In this work, we present a method which benefits from a simple image analysis algorithm that is suitable for online purposes in industry. Although using a simple image processing algorithm introduces error, applying the data fusion concept would increase the accuracy of the single bubble size estimation in horizontal pipes. In other words, our method relies on multiple images that are related to a single bubble which makes the application of data fusion feasible. The image processing algorithm consists of two simple and fast stages and this algorithm is executed on the grayscale images acquired form the image acquisition system. Firstly, an image-subtracted algorithm is used between each captured frame and the background image. The background image is an image of the pipe that is completely filled with water and contains no bubble. This image can be updated in an online process for some constant period of time in order to remove the undesired effect of pipe dirt that might be time variant.The second step prepares the final binary images required for feature extraction (i.e. an estimation of the size of void fraction). A thresholding technique, as one of the simplest methods was used. A similar algorithm was used by Zaruba et al. The right choice of threshold ( When the suitable threshold is selected and final binary images are prepared, the next step initials with merely counting the white pixels for each binary image. The counted pixels were scaled with a resolution factor of 0.0156 Image processing techniques have been used extensively in many different applications. In two-phase flow, image processing has become a powerful technique to study the two-phase flow phenomena. Two-phase flow occurs in a variety of engineering applications, such as steam generators, boilers, condensers, oil/gas pipelines and water-cooled nuclear power plants. Bui Dinh and Choi presented the application of image processing techniques to identify and to measure the parameters of bubbles in air/water two-phase flow The bubble identification used in this research is focused on two main topics. The first topic is the detection of bubbles or void fractions and the second topic is estimating the size of bubbles or void fractions. The former topic will enable us to avoid any unnecessary ESD due to bubble presence in the fluid and the latter topic will enable us to determine whether an ultrasonic measurement is trustworthy or not. Although the authors of this paper find it complex, if not impossible, to relate the size of void fraction with the relative error of ultrasonic measurement, it is reasonable to assume that higher sizes of bubble or void fractions will increase the probability of the occurrence of error in the TTUF’s measurement. Therefore, the size of void fraction or single bubble can determine whether an ultrasonic measurement is untrustworthy and in this situation the measuring duty should be switched to a more accurate measurement mechanism. The frames which are captured by digital camera are of two types. The first type includes frames with no bubbles present (i.e. the background image); therefore, the proposed image processing algorithm described earlier would yield a bubble size estimation near zero for this case. This estimation is not exactly zero, because there is always a small amount of noise after the background reduction, even though there are no bubbles in the captured frame. There are various sources for this noise. Different background image of the pipe due to the pipe’s dirt and also vibration of the camera are among the contributing noise sources. The second type of frames includes frames which show bubbles. In this case, the image processing algorithm would estimate the void fraction inside the vertical or horizontal transparent pipe. While the image processing algorithm is analysing each frame, it calculates a void fraction for each of the frames. Each frame is related to a specific sampling time. Therefore, in each sampling time a void fraction is estimated which corresponds to the frame being analysed by the image processing algorithm. Wavelet transforms are often used for the detection of singularity points in the output signals sampled from the machines The method for bubble detection in horizontal transparent pipe is the same as the method described in the previous Section It should be noted that when a video sequence of a bubble is available, multiple measurements of the bubble size would be available too. These measurements which are related to a single bubble are noisy estimations. There are various sources for this noise. In addition to the sources of noise that were mentioned previously in Section Here, the question is: “which of these measurements is closest to the actual size of the bubble?” In other words, “which measurement is the most accurate measurement: the smallest, the largest or the average of these measurements?” In this section, the estimation of the size of a single bubble in horizontal pipe is carried out with two well-known theorems present in data fusion literature, namely Kalman filtering and Ordered Weighted Averaging (OWA). Data fusion deals with the synergistic combination of information made available by various knowledge sources such as sensors, in order to provide a better understanding of a given scene Kalman filtering is tied with the discrete state space model of a system which is described with equations The main advantage of Kalman filtering is its online nature, because as each data enters the Kalman filter, one data is estimated simultaneously, but an average of Kalman filtering provides better estimation of a single bubble size. The Ordered Weighted Averaging (OWA) operators were originally introduced by Yager The OWA operators provide a parameterized family of aggregation operators, which include many of the well-known operators such as the maximum, the minimum, the Since this operator generalizes the minimum and the maximum, it can be seen as a parameterized way to go from the Another operator was introduced by Yager The idea of OWA is to maximize the dispersion of the weights under the constraint of a fixed maxness. By analysing more than 800 pictures and solving the optimization problem mentioned above, for a fixed number of frames (e.g. 8 frames), it can be concluded that the corresponding ordered weights inherent a Gaussian-like distribution. This is shown in In the OWA method, we have to wait for a bubble to pass through the entire width of the video capture and then, having assigned the relative weights which introduce the best estimation, we can calculate the size of a single bubble. Bayesian decision theory is a fundamental statistical approach to the problem of pattern classification. This approach is based on quantifying the trade-offs between various classification decisions using probability and the costs that accompany such decisions. It makes the assumption that the decision problem is posed in probabilistic terms, and that all of the relevant probability values are known Two independent experiments were carried out in which the flow rate was known and the error of measurement could be calculated. In the first experiment, despite the fact that ultrasonic transducers were viewing As mentioned earlier, our numerous experiments on the functionality of the TTUF showed that the device’s measurement was not reliable in the presence of bubbles in the pipe. In other words, when there are bubbles in the pipe, there is a high probability that the measurement is in error. This error is obviously related to the bubble’s parameters. In fact, the probability of the occurrence of the error in the measurement becomes higher as there are more bubbles in the pipe or there are larger bubbles in the pipe. These two parameters significantly influence the device’s measurement error. In fact, these two parameters increase the probability of the ultrasonic wave being interrupted from the normal propagation path and consequently the deviation of the measurement from the accurate value. Having detected a sufficiently large void fraction in the pipe using the previously mentioned methods, it is high time introducing an alternative method for calculating the velocity of the fluid in this situation. One way is to switch from the TTUF to an alternative flowmeter that is less sensitive to bubble presence. As seen in Another way of calculating the velocity of the fluid can be derived from the information available in the successive captured frames. An algorithm is developed in As it was mentioned earlier, gas has a tendency to float to the top for horizontal pipe runs. In this case, single bubbles are present in the captured frames. These single bubbles move in a straight line, omitting the need for calculating vertical displacement (Δ Result of the proposed image processing algorithm on an image captured from a vertical pipe that contains several bubbles is shown in The results of Kalman filtering for a typical single bubble are depicted in Hitherto, an online monitoring technique that is able to detect and estimate the void fraction inside a transparent pipe was proposed. In addition, the velocity of the fluid can be calculated alternatively using the method described in Section In order to compare our work to the previous work which is related to overcoming the defect of bubble on the TTUF’s functionality, let us now consider the effect of the Fuji Electric’s synchronized summation method for bubble contained flow. When there is no bubble on the propagation path, an ultrasonic wave emitted from the transmitter is able to arrive at the receiver. On the other hand, when there are some bubbles on the propagation path, an ultrasonic wave is interrupted from normal propagation. In case of traditional analogue signal processing, measurement failure will occur at this moment The setup described in this paper can find several applications. In the food industry, liquid filling machines play important roles in preparing the final products. It seems clear that the liquid which is to be poured into the bottles must contain no bubbles. Electromagnetic flowmeters are conventionally used in the food industry, but the liquid should be conductive. TTUF does not have this limitation. Moreover, the accuracy of TTUF is better than most of electromagnetic flowmeters. Therefore, the application of TTUF can be greatly increased in this industry, provided that bubbles in the fluid will not affect the performance of TTUF significantly. If our proposed method be implemented in such systems, not only it prepares an estimation for the bubble size inside a pipe and the related information can be used to guarantee that the bottle are completely filled, but also an unnecessary ESD due to the wrong report of an empty pipe can be effectively avoided. There are also other general examples for applicability of our proposed system. For example, air bubbles in the inlet of pumps often cause issues for the performance of pumps. Another example is feedwater for steam power plants. In both of these applications, the bubble presence in the fluid causes problem and an accurate flowmeter with information about the bubble size can find application. An online monitoring system, based on optical observation of transparent pipe was introduced to overcome one of the main drawbacks of transit-time ultrasonic flowmeter. The implementation of the setup explained in this work can avoid unnecessary Emergency Shutdowns in an industrial control loop which is being controlled by a transit-time ultrasonic flowmeter and effectively saves thousands of dollars. Moreover, this method enhances the functionality of the transit-time ultrasonic flowmeter by determining whether an ultrasonic measurement is untrustworthy and in this situation an alternative method for calculating the velocity of the fluid is proposed which estimates the flow rate with an acceptable accuracy. The contribution of this paper in the bubble identification is the new method of estimating the size of single bubble in horizontal transparent pipe using a data fusion approach. It was shown that both Kalman filtering and OWA offer better estimations compared to traditional operators; however, OWA method provides better results compared to Kalman filtering. The use of Extended Kalman Filtering (EKF) seems promising for the further research in case of a nonlinear dynamic equations for the model that was mentioned in Section The authors would like to thank the reviewers for their valuable comments, which helped to improve the original manuscript. The authors would also like to thank Robin Kalfat for correcting the grammatical mistakes in this paper.