Modern central heating systems with logwood boilers are comprised of the boiler, a buffer storage and solar thermal collectors. Conventional control strategies for these heating systems do not coordinate the utilization of all components. This can lead to a sub-optimal operation of the entire heating system resulting in a loss of efficiency and increased pollutant emissions. This contribution presents a control strategy which considers all components of the heating system including the user and forecasts for the solar yield and heat demand. It determines and carries out an optimal operating strategy that improves the user utility and maximizes the heating system efficiency while also ensuring a clean and efficient combustion. The control strategy continuously learns the user behavior and instructs the user when to refill the logwood boiler and how much fuel to use. The new control strategy was verified through test runs performed at an experimental setup consisting of a commercially available logwood boiler with a nominal capacity of 
                        28
                        
                        kW
                     , two buffer storages with a capacity of 
                        
                           1.5
                           
                           
                              m
                              3
                           
                        
                      each and a heating device with a thermal output of up to 
                        
                           12
                           
                           kW
                        
                      simulating a solar thermal collector. During these test runs, the CO emissions were reduced by 
                        
                           93.6
                           
                           %
                        
                      in the main combustion phase, 
                        
                           7.1
                           
                           %
                        
                      more solar yield was utilized, the buffer losses were reduced by 
                        
                           −
                           16.9
                           
                           %
                        
                      and the overall efficiency was increased by 
                        
                           3.1
                           
                           %
                        
                     . Thus, the application of this control strategy resulted in a significantly improved user utility and heating system efficiency.The utilization of biomass for the supply of heat in buildings has been generally increasing over the past two decades, e.g. Ref. [ Modern central heating systems with logwood boilers commonly consist of the boiler, a buffer storage and a solar thermal collector as shown in The sizing of these individual components is a decisive factor for the optimal operation of such heating systems in terms of efficiency and user utility. However, in many existing residential heating systems the sizing of the individual components is not optimally or even badly chosen. The replacement of components with optimally sized ones is associated with high costs. For this reason, a solution should be found which can also achieve an optimal utilization of existing components regardless of their sizing. A core element in such a heating system is its control strategy. The main objective of the control strategy is to ensure that consumer heat demand is always covered by managing the utilization of the heating system's components. The presented work focuses on logwood boilers with electrical ignition device, which are also commonly available on the market. These boilers enable the control strategy to initiate their burning cycle and thus, to decide when heat is delivered from the boiler to the buffer storage. Depending on when the control strategy initiates the burning cycle and how much wood is inserted into the boiler, several different unfavorable operating conditions can potentially occur. If the burning cycle is initiated too late or not enough wood is inserted into the boiler, the heat demand of the consumer might not be covered resulting in a loss of user utility. If the burning cycle is initiated too early it potentially results in available solar energy not being fully utilized. This leads to increased fuel consumption and a loss of efficiency as a result. Additionally, unconsidered solar yield during an already initiated burning cycle can fill up the buffer storage before the combustion process is completed. In this case, the boiler needs to be prematurely shut down in order to avoid an overheating and damaging of the entire heating system. A premature shut-down of an already initiated burning cycle leads to massively increased pollutant emissions as well as a loss in efficiency. As these exemplary problems demonstrate, the heating system's control strategy has a significant influence on both the heating system's efficiency and the user utility. In order to maximize the heating system's efficiency while simultaneously maximizing user utility, it is crucial that the control strategy considers all the heating system components (boiler, buffer storage, solar thermal collector) while also taking the heat demand of the consumer into account. Since logwood boilers are manually fed, i.e. they combust stacks of wood previously inserted by the user, the user is an integral part of the heating system. Once the burning cycle is initiated no additional wood can be inserted by the user the cycle is fully completed. Thus, the user has to ensure that the appropriate quantity of wood is inserted by the time the control strategy attempts to initiate the burning cycle. If not enough wood is inserted, the heat demand of the consumer might not be covered resulting in a loss of user utility. For this reason, the control strategy also needs to take the user behavior into account when managing the utilization of the heating system's components. State-of-the-art control strategies as typically applied by manufacturers are solely designed to ensure that the heat demand is always covered. They usually initiate the burning cycle when the water temperature in the buffer storage at a certain level falls below a defined threshold. This approach ignores both, the heat demand of the consumer and the solar energy potentially available in the course of the burning cycle. Therefore it fails to fully utilize the solar yield and to preventing throttling or a premature shut-down of the logwood boiler. Additionally, this approach takes neither user behavior nor user utility into account. As a result, state-of-the-art control strategies as typically applied by manufacturers are not capable of guaranteeing an operation of heating systems with logwood boiler with high efficiency and maximized user utility. For this reason, a new approach for the control strategy is needed which maximizes the heating system's efficiency while simultaneously ensuring a maximized user utility. In doing so, this new approach plays an important role in supporting the further distribution of heating systems with logwood boiler. The optimal operation of residential heating systems in terms of efficiency is well covered in the literature,and is typically achieved using model predictive control (MPC) approaches. The importance of a predictive control is shown by Prívara et al. [ To support the further distribution of central heating systems with logwood boilers, a control strategy is required that needs little computational effort and can easily be adapted to different logwood boilers and buildings. For this reason, this contribution presents a new approach for control strategies which optimizes the operational behavior of central heating systems with logwood boiler, buffer storage, solar thermal collector that requires low computational effort and can be adapted to different heating systems with minimal effort. The main objective of the new control strategy is to ensure that the heat demand of the consumer is always covered while simultaneously maximizing the heating system's efficiency and maximizing the user utility. During the development of this new control strategy, particular emphasis is placed on its applicability for the central heating systems that are typical and are currently used in buildings. For this reason, all work described in this contribution is based on an experimental setup representing such a typical central heating system. A detailed description of this experimental setup is given in section The experimental setup is divided into two parts, the hydraulic system and the boiler, see  The hydraulic system consists of two buffer storages connected in series with a total capacity of The boiler, illustrated in The design of this configuration and the sizing of all components was chosen according to the specifications of the boiler manufacturer KWB - Kraft und Wärme aus Biomasse GmbH for an apartment building or a multi-family house with three families. As stated in the introduction, central heating systems with logwood boiler should be improved in terms of efficiency In summary, the heating system's control strategy should determine an optimal The following section will explain the boiler control (BC) in detail. As explained in section The boiler's feed temperature The strong coupling between All the problems described in the previous section result from the fact that the control strategies typically applied by boiler manufacturers keep The new control strategy adjusts This new approach for the boiler control is in principle capable of implementing supervisory control instructions while simultaneously ensuring a clean combustion. In section As explained in section The goal of the supervisory control is to increase the user utility The heat demand needs to be covered at any time. The user only needs to refill the boiler during preferred time slots defined by the user. The user is given simple instructions on how much fuel to refill. As the typical application scenario are households and, thus, the users are typically families, they can not be expected to insert an exact quantity of fuel. For this reason, to meet criterion 3, only two different fill levels The efficiency Eq.     In summary, to maximize Based on this conflict, the goal of the NEW-SC is defined as increasing  The forecasts for solar yield and heat demand are determined utilizing the forecasting methods described in Ref. [ The forecasting method for the heat flow generated by the boiler is presented in the next section To forecast the heat flow generated by the boiler, a model is needed that describes the progression of The SOA-BC presented in section The four phases of the progression of The parameters of the model can be determined from measurement data by minimizing a quadratic cost function. With Eq. The user behavior only affects the amount of energy provided during one burning cycle. First, different users each have a different understanding of how much wood needs to be stacked in the boiler in order to fill it to a specific level and also how the logs must be stacked (e.g. randomly thrown in or systematically stacked in a criss-cross pattern). The quantity of wood varies considerably depending on the way the logs are stacked. For the boiler used in this work, variations of up to 20 % of the wood mass fed into the boiler, on constantly filling it to the full with the same fuel, were observed during preliminary tests. Second, the fuel used by the user also directly influence the provided energy, due to differences in its net calorific value. For each  Thus, the progression for a certain The optimization algorithm is designed to run on control systems typically applied in logwood boilers, i.e without high computational capabilities. Thus, a rule based approach is preferred instead of a solver-based approach. The algorithm calculates the optimal values for First, as stated in section Second, refilling of the boiler is only possible if the fuel chamber is cold enough. The time from the last ignition until a refill is possible again is described by the parameter Third, there are only two temperature levels for Fourth, the buffer storage is assumed to be fully charged, when the temperature at the bottom of the storage is higher than To find the optimal values for The algorithm is provided with the current forecasts for solar yield and heat demand as well as the current conditions of the buffer storage (temperatures) and the boiler (time of last ignition). These are used to simulate the possible future behavior of the buffer storage for a certain operating strategy. The simulation assumes the next ignition uses If no refill time slot lies between Then the algorithm checks if a refill time slot lies between If no refill between If no sufficient ignition time with If no viable solution can be found by the optimization algorithm, then The found values for Test runs are performed to evaluate the operational behavior of the new approach for the boiler control (NEW-BC) proposed in section A test run consists of one burning cycle, specifically the combustion of a stack of spruce logs with a length of    In a similar manner to the evaluation of the feed temperature a time period is defined in which the controlled variable   Test runs are performed to evaluate the NEW-SC proposed in section The supervisory control was experimentally verified in test runs lasting several days. These were performed once with the developed supervisory control (NEW-SC) and once with the state-of-the-art control strategy (SOA-CS). For this purpose, representative heat demand and solar yield profiles typical for days during transition time were created based on [ The refill time slots for the user were defined in the periods from 8:00–10:00 and 18:00–22:00 each day. The optimization algorithm was executed every 15 min. Beech logs with a length of The SOA-CS which uses the state-of-the-art boiler control (SOA-BC) depends on the user to refill the boiler and manually start the ignition. It was assumed that the user checks the mean temperature of the buffer once during the defined refill time slots. If the temperature is below For the very beginning of the test runs at hour 0, it was assumed that the entire heating system has been shut down for a period sufficiently long to have completely cooled down. Thus, the buffer storage had a uniform temperature of In the following both test runs are compared to each other and their differences are discussed. The topmost graph shows the operation of the boiler. It can be seen that five ignitions of a fully filled burning cycle where performed by the SOA-CS. In comparison the NEW-SC opted to ignite two half filled burning cycles (second and third ignition) resulting in a total of six ignitions. Following the strategy of the SOA-CS, the boiler delivered a little bit more energy, while burning slightly less fuel (see The second graph of The third and fourth graphs in The last graph in  The presented control strategy, consisting of a boiler control and a supervisory control, ensures an optimal operation of heating systems with logwood boiler, solar thermal collector and buffer storage in terms of efficiency and user utility. The boiler control utilizes mathematical models for the primary and secondary air control valves and also the suction fan for ensuring that the fuel is combusted as completely as possible in the course of each burning cycle. Test runs demonstrate that this new boiler control is capable of keeping the residual oxygen content of the flue gas at its desired value with significantly reduced fluctuations and control error in comparison with the tested state-of-the-art boiler control. This also resulted in significantly reduced carbon monoxide emissions (reduction of The supervisory control utilizes mathematical models for each component of the heating system in combination with forecasts for the load demand and the weather in order to generate an optimal operating strategy for the entire heating system in terms of efficiency and user utility. The supervisory control identifies this optimal operating strategy by choosing the latest ignition time possible. Although, it is not a classical optimization algorithm, the supervisory control, thus, identifies the optimal operating strategy with the given constraints. As the user ultimately determines the quantity and quality of the fuel inserted into the boiler, the user behavior has a significant influence on the operation of the entire heating system. For this reason, the superordinate control determines the suitable quantity of fuel to be inserted into the boiler and communicates this optimal quantity to the user. The user can not be expected to supply exactly the optimum quantity of fuel in every case, however. Furthermore, the fuel properties can change drastically over the course of a heating season. For this reason, the superordinate control detects changing user behavior and fuel properties and adapts the optimal operating strategy accordingly. A series of test runs demonstrated, that this control strategy is capable of significantly improving the user utility (no refills outside of desired refill windows) and simultaneously increasing the heating system's efficiency (increase of Due to the large number of combinations of seasonal/weather effects and user behavior, it was not feasible to cover all possible cases in the validation test runs. In future work additional test runs to analyse the behavior of the supervisory control in different scenarios and over longer periods of time will be performed. Adapting the supervisory control to other central heating systems with logwood boilers needs very little effort. The forecasting method developed for the heat flow generated by the boiler automatically adapts itself to the boiler and user. Methods to forecast heat demand and solar yield are available in literature which adapt themselves to the heating system. Thus, no additional effort is required for the forecasts. The buffer model needs to be parameterized to a new buffer. Information about the geometry and the insulation are needed for this. In future work a method should be developed to adapt the buffer storage model automatically to the buffer storage, completely removing any need for manual adaption of the supervisory control. While an optimization of the sizing of all components can significantly improve the overall efficiency, this was not the focus of the work presented. The presented control strategy is designed to optimize the operational behavior of these heating systems regardless of the sizing of their components. The presented control should be applicable for any heating system with logwood boiler, solar thermal collector and buffer storage. The adaption of this control strategy to heating systems with differently sized components can be achieved with little effort. This only requires an adaptation of the buffer storage model, which is achieved by changing the dimensions of the buffer storage in the model. The forecasts for the solar yield also need to be adapted. By utilizing forecasting methods which already are adaptive with respect to different sizing of the solar thermal collector, e.g. Ref. [ A control strategy for logwood boilers with solar thermal collector and buffer storage has been developed and verified. The control strategy is comprised of two components, the boiler control and the supervisory control. It requires no physical modification of any of the components in the heating system or replacement of any hardware. The control strategy increases the user utility in terms of heat delivered and by limiting boiler refilling to time slots defined by the user, thus making it compatible with the user's lifestyle. The results have demonstrated that this is accompanied by reduced carbon monoxide emissions which in turn can be correlated with reductions in tar, PAH and particulate emissions. There are also efficiency gains that reduce fuel consumption in favour of the solar yield. Due to the resulting fuel saving this new control strategy reduces the operating costs for heating systems with logwood boiler, solar thermal collector and buffer storage. Simultaneously the new control strategy will help to improve the acceptance of these heating systems since users can expect that their heat demand is always fulfilled. The adaption of this control strategy to heating systems with differently sized components can be achieved with little effort. This only requires changes to the parameters of the buffer storage model. By utilizing weather and solar yield forecasting methods which are already adaptive with respect to different sizes of the solar thermal collector, no additional changes to other heating systems are needed. Additionally, minor changes are required in the control strategy, so that changes in the heat delivered from the boiler are automatically identified and considered in the control strategy by the algorithm presented in this work. The results are applicable to all heating systems with logwood boiler, solar thermal collector and buffer storage. The authors would like to acknowledge the contribution of Ing. Tanja Gollinger (BEST – Bioenergy and Sustainable Technologies GmbH) for analysis work and providing data for the chemical fuel composition. The research leading to these results was carried out in two research projects. One part of the research leading to these results received funding from the