In the analysis of spatial data, one is often interested in modeling conditional probability distributions, in order to assess the uncertainty in the values of the attribute under study and to predict functions of this attribute.
                  This work examines three geostatistical models in which the attribute is assumed to be, up to a monotonic transformation, a realization of a Gaussian random field. In the first model, the mean of the Gaussian field is a known parameter and the conditional distributions at any set of locations are Gaussian, with expected values equal to simple kriging predictions and covariance matrix equal to that of the prediction errors. In the second model, the mean value is replaced by a random variable adding to the Gaussian field and whose prior variance is infinitely large, indicating a total lack of prior knowledge on the true mean. It is shown that the conditional distributions are still Gaussian, with expected values equal to ordinary kriging predictions and covariance matrix equal to that of the corresponding prediction errors. The third model considers a random drift that adds to the Gaussian field; the conditional distributions are then obtained by substituting universal kriging for simple or ordinary kriging.
                  A computer program is provided to calculate recovery functions (tonnages, metal contents and mean values above given thresholds) and uncertainty measures (probability intervals and conditional variances) defined at point or block supports. The concepts are illustrated with a case study consisting of evaluating the recoverable resources in a porphyry copper deposit.Many disciplines in the geosciences are concerned with the prediction of spatial attributes in relation to threshold values. For instance, environmentalists want to determine whether or not pollutant concentrations in the air, water or soil fall short of given regulatory levels. Pest managers are interested in mapping the probabilities that pest densities or pathogen genotypes exceed critical thresholds, in order to define plant disease control measures. Hydrologists intend to characterize the depth to water table in relation to a threshold depth so as to assess the risk of runoff generation during rainfall events. Soil scientists and land planners are concerned with excesses or deficiencies in soil properties. Mining engineers aim to delineate the volume where mineral grades are greater than an economic cutoff that makes mining profitable. Because of its smoothing property, linear kriging is ill-suited to predict whether or not the values of an attribute exceed a threshold. Instead, one can use nonlinear kriging (indicator, disjunctive or multi-Gaussian kriging) to characterize the unknown values by conditional probability distributions. Indicator and disjunctive kriging make hypotheses on the bivariate distributions of the random field representing the attribute of interest. They may produce order relation violations between different thresholds and require corrections to obtain consistent results ( This article focuses on the multi-Gaussian approach to the modeling of conditional probability distributions and prediction of recoverable resources above given thresholds. Its objective is to weaken the assumption of a known mean and to provide a theoretically sound framework to account for an uncertain mean. The concepts are complemented by a set of computer programs and illustrated with a case study in mineral resources evaluation. The attribute of interest is regarded as a realization of a random field over a spatial domain The following assumptions are made:    The values of Let The conditional variance–covariance matrix is that of the simple kriging errors, which will be denoted by Eq. For instance, Let us consider a function In practice, the expectation can be calculated by Monte Carlo integration ( Suppose that the original attribute is the grade of an element of interest in an ore deposit. Let The selection of the block as ore or waste material is based on a predicted grade, which is usually derived from a weighted average of production data (e.g. blast hole data) located at From the information on drill hole data (exploration stage), it is of interest to anticipate the resources that will be recovered at the mining stage. One assumes that the pattern of blast hole sampling { Tonnage above cutoff Metal content above cutoff  Apart from predicting the expected recovery functions, it is also of interest to quantify the uncertainty in the actual block grade conditional variance; bounds of the interval in which The assumption of a known mean is quite restrictive, as it does not allow any uncertainty in the value of this parameter. In particular, the prediction of a transfer function is biased when the mean is misspecified. To weaken the model requisites, one option is to use the following model: To avoid the previous difficulty, a different approach is proposed. It consists of replacing the unknown mean by a random variable constant over space: This covariance does not tend to zero as the norm of From a practical point of view, the models with unknown mean (Eq. Except for the covariance function, the model in Eq. The variance of the kriging error at this location (Eq. The case of a known mean value is met when The last identity (covariance between the ordinary kriging errors at locations  The above results are remarkably simple and easy to implement, since they amount to substituting ordinary kriging for simple kriging in the approach presented in The prior variance of the Gaussian random field The use of ordinary kriging is advantageous when the data are scarce in the kriging neighborhood and the mean value can be considered constant only at the scale of this neighborhood (local stationarity). The results of the previous section can be extended to a more general model, in which the Gaussian random field The drift is represented by a weighted average of the form: Here, we assume that these coefficients are independent Gaussian random variables and are independent of the residual component The simple kriging variance of the To account for a complete prior ignorance on the drift, one assumes that the variances of the drift coefficients are infinitely large: One recognizes the unbiasedness constraints introduced in universal kriging. Accordingly, if the variances of the drift coefficients tend to infinity, simple kriging ( This system is established in the same fashion as Eq. In this model, the conditional distribution of A problem specific to the universal kriging approach is the inference of the residual covariance identify a direction along which the drift is approximately constant and calculate the sample semi-variogram along this direction only; restrict variogram analysis to short distances, for which the bias between the sample and theoretical semi-variograms is small; use the formalism of intrinsic random fields and generalized covariances and work with Another problem in the implementation of multi-Gaussian kriging in the presence of a drift is the difficulty to validate the univariate and multivariate Gaussian assumptions. In practice, checks should be done by analyzing the distributions of generalized increments, which are not “contaminated” by the drift. To avoid these difficulties, ordinary kriging is often preferred to universal kriging, even if the data reveal clear spatial trends ( The main program associated with this article ( coordinates of scattered locations (block centers) targeted for predictions (void for gridded locations) if gridded locations: minimum grid coordinates along number of grid nodes along grid meshes (block size) along block discretization along data coordinates ( Gaussian data values ( trimming limits (inf and sup) for Gaussian data (1×2 vector) conversion table between original ( minimum and maximum values for the original ( additional parameters for tail modeling ( semi-variogram model for Gaussian residuals ( sills of nested structures ( additional parameters for some semi-variogram models ( nugget effect variance maximum search radii along rotated angles for anisotropic search ( divide the neighborhood into octants? 1=yes, 0=no number of conditioning data per octant (if octant=1) or in total (if 0) kriging type: 0= cutoffs for recovery calculations (1× probabilities for probability intervals (1× number of realizations for Monte Carlo simulation with Latin hypercube sampling blast hole coordinates (relative to the block center) along The outputs of MK3D.M consist of three recovery functions that are of interest in mineral resources evaluation: metal content (Eq. Program MK3D.M can also be run with a parameter file: no input argument is required in the Matlab workspace and the user is prompted for the parameter file name. If no name is entered, a default file (MK3D.PAR) is assumed; if this file is not found, a blank file is created. When using the parameter file mode, the coordinates of the locations targeted for prediction (if these locations are not gridded), the data coordinates and data values and the conversion table between original and Gaussian values must be stored in ASCII files without header. The outputs of MK3D.M are written in separate ASCII files with a common base name. Program MK3D.M uses 10 subroutines: back-transformation from Gaussian to original values calculate covariance values calculate covariance matrices calculate covariance matrix and its inverse for kriging in a unique neighborhood (case when the search radii are set to infinity) create default parameter file MK3D.PAR calculate kriging weights build template of super-blocks for search strategy search data located in a moving neighborhood set up matrix for rotation and reduction of coordinates set up super-block strategy. In this section, we apply multi-Gaussian kriging to predict the recoverable resources in a porphyry copper deposit located in the Central Andes, Chile. The available information consists of 2811 composite data (10 The prediction of mineral resources proceeds according to the following steps. Declustering weights are assigned to the data by using the cell method ( Before using multi-Gaussian kriging, it is worthwhile to check whether or not the multivariate Gaussian assumption is compatible with the normal scores data. In practice, the check is limited to bivariate distributions, as the inference of higher-order distributions is beyond reach. A test that does not depend on the (possibly unknown) mean value of the normal scores data consists of examining the semi-variogram of order For The semi-variogram of the normal scores data is calculated along the main anisotropy directions (north, east and vertical directions). The fitted model is the sum of a nugget effect, a spherical and an exponential model ( Multi-Gaussian kriging is now used to assess the recoverable resources at a 20×20×20 For each block, the predicted resources consist of the metal content and tonnage above a cutoff of 0.8%Cu, taking into account the information effect that will occur at the time of ore-waste selection, by assuming that the block grade will be predicted from 16 regularly spaced blast hole data ( One observes that predictions obtained by using simple and ordinary kriging are similar, except in the western area of the deposit where drill hole data are scarce ( To validate the predictions obtained by ordinary multi-Gaussian kriging, a cross-validation is performed. At each data location, the point-support metal contents above given cutoffs (from 0.0% to 2.0%) are assessed by using the data situated at least 50 The average true and predicted metal contents are given in One can also validate the uncertainty model derived from the conditional distributions, by constructing probability intervals with, say, probabilities from 0.1 to 0.9, and plotting these probabilities versus the fractions of data that actually belong to the intervals so defined ( It is worth mentioning that the quality of the validation results depends on the number of conditioning data considered in the kriging neighborhood. For instance, with the current implementation (four data per octant), the slope of the regression of the true grades upon the predicted grades is equal to 0.99 ( The conditional distributions determined by ordinary kriging can also be used in the context of conditional simulation ( In the following, we will perform sequential simulation at the nodes of a regular grid with 100,000 nodes, by considering a pure nugget semi-variogram with a unit sill and a single original datum located at the origin and with a zero value. Ten realizations are generated, in each of which the experimental mean and variance are calculated. A sensitivity analysis is made by changing the number of conditioning data (original data and already simulated values) considered in the kriging neighborhood ( This exercise proves that, although the use of ordinary kriging for determining conditional distributions and for sequential conditional simulation is legitimate, care must be taken in the design of the kriging neighborhood. In particular, too restrictive neighborhoods are likely to lead to an overestimation of the true spatial variability. The reason is twofold: The moving neighborhood ignores part of the conditioning data and loses information when constructing the conditional distributions. In the case of the pure nugget semi-variogram, this problem is important because closest data do not screen off the influence of farthest data (the ordinary kriging weights of all the data are the same). Each simulated value is re-used for conditioning the next ones. Hence, any error made by restricting the neighborhood propagates when the simulation proceeds. Note that this problem is not raised in the multi-Gaussian kriging approach presented in This work addressed the problem of assessing the uncertainty in the values of a spatial attribute and predicting functions of this attribute, at the support of the available data or at a larger support. It focused on the multi-Gaussian model, in which the attribute is represented by the transform of a Gaussian random field. In the traditional approach, the mean value of the Gaussian random field is supposedly known and its conditional distributions at any set of locations are jointly Gaussian, with means equal to simple kriging predictions and variance–covariance matrix equal to that of the prediction errors. An extension of this model consists of replacing the known mean by an independent random variable constant over space that adds to the Gaussian field. When the prior variance of this random variable becomes infinite, one obtains a model in which there is a total prior ignorance on the true mean value. The conditional distributions are then found by substituting ordinary kriging for simple kriging. Similarly, one can design a more general model that includes a random drift and use universal kriging instead of simple or ordinary kriging. In all these models, the knowledge of the joint conditional distributions allows calculating the conditional expectation of a transfer function defined at a block support and deriving measures of the uncertainty in the actual block values, by discretizing the block into several points and by resorting to Monte Carlo simulation. The proposed approach can easily be extended to the stochastic simulation framework, for instance by using the sequential Gaussian algorithm and substituting ordinary or universal kriging for simple kriging when deriving the successive conditional distributions. This constitutes a significant step towards the conditional simulation of locally stationary or non-stationary random fields. Concerning the implementation of the proposed methods, close attention has to be paid to the design of the kriging neighborhood. In the light of the exercise made in the previous section, this design is critical for the sequential simulation algorithm, since too restrictive neighborhoods lead to an inaccurate reproduction of the spatial variability, especially if the semi-variogram model presents a nugget effect. Additional research is required in this respect to improve the neighborhood definition when using ordinary kriging. This research has been funded by the Chilean Fund for Science and Technology Development (FONDECYT) and is a part of Project 1061103. The author is grateful to Georges Verly and to an anonymous reviewer for their constructive comments and acknowledges Codelco-Chile for providing the dataset used in this work. Supplementary data associated with this article can be found in the online version at 