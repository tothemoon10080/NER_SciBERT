This paper deals with the simulation of a stationary vector Gaussian random field whose spatial correlation structure is given by a linear model of coregionalization. Traditionally, simulation is performed by decomposing the vector random field into a set of independent vector random fields with coregionalization models that contain a single nested structure, and a factorization of these fields into principal components. A variation of this approach is proposed, by considering the minimum/maximum autocorrelation factors associated with groups of two nested structures. This variation reduces the total number of independent factors by one-half, thus considerably decreases memory requirements and CPU time for simulation, without any loss of accuracy for reproducing the linear model of coregionalization, regardless of how many nested structures are contained in this model. The proposed approach is implemented in a set of computer programs and illustrated through a synthetic example and a case study in mineral resources evaluation.Many algorithms have been developed for simulating scalar Gaussian random fields in the Euclidean space Hierarchical or cascaded simulation, in which each scalar random field is simulated in turn and conditioned only to its data and to the collocated data of the other random fields ( Joint simulation with a small local neighborhood in order to restrict the amount of conditioning information ( Transformation of the random fields into factors with no (or with little) spatial cross-correlation, followed by the simulation of each factor separately. The most widespread factorization techniques are principal component analysis ( This last approach will be explored in this paper for simulating a second-order stationary vector Gaussian random field Principal component analysis allows transforming a set of cross-correlated scalar random fields (the components of Their covariance matrix for a given lag separation vector Because of Eq. For Let Their covariance matrix for a given lag separation vector This covariance matrix is diagonal for Because Because of Eq. Accordingly, the minimum/maximum autocorrelation factors are not cross-correlated for the two lag separation vectors As an exception, the minimum/maximum autocorrelation factors do not have spatial cross-correlation if the coregionalization model contains one or two basic nested structures (i.e., Accounting for Eqs. The off-diagonal terms of this matrix are zero, irrespective of the choice of lag vector Coming back to the general form of the linear model of coregionalization (Eq. Here Coregionalization analysis therefore decomposes a set of The simulation of a vector Gaussian random field via the separate simulation of the factors obtained by PCA or MAF is accurate when the coregionalization model contains one or two nested structures. Otherwise, the factors may be spatially cross-correlated, therefore not independent, and should not be simulated separately. Here, it is of interest to accurately simulate a vector Gaussian random field when the coregionalization model contains any number of basic structures, for which one looks for a set of factors with no spatial cross-correlation. The leading idea of the proposed algorithm is to modify traditional coregionalization analysis, by applying MAF factorization to groups of two nested structures instead of principal component analysis to each nested structure separately. This will allow reducing the total number of independent factors by one-half. Specifically, given a linear model of coregionalization with For Consider the coregionalization matrices Simulate a vector Gaussian random field Combine the components of Add the simulated vector random fields In total, one therefore needs simulating It should be emphasized that the proposed approach is equivalent to simulation through coregionalization analysis ( Direct conditional simulation can be performed only when the coregionalization model has no more than two nested structures ( To avoid such restrictions, it is convenient to split the simulation problem in two stages. The first stage is a nonconditional simulation of In addition to conditioning the realizations even in the presence of a heterotopic sampling, the two-stage approach allows the use of ordinary cokriging when the mean vector of The algorithm described in Program SGCOSIM can be executed with no input argument in the MATLAB workspace. In such a case, the user is prompted for a parameter file (by default, SGCOSIM.PAR) ( SGCOSIM offers the following functionalities: The backtransformation from the vector Gaussian random field to the raw vector random field relies on a set of transformation tables input by the user (subroutine BACKTR). Additional parameters (minimal and maximal raw values and parameters controlling the modeling of tail distributions) are needed for extrapolation beyond the first and last values of the transformation tables. The reader is referred to The linear model of coregionalization representing the spatial correlation of the vector Gaussian random field may contain any number of nested structures. Each structure is coded as a covariance type ( Concerning the search for conditioning data, two options are considered, depending on whether these are original data or previously simulated values. The original data are first preordered into superblocks (subroutines SUPERBLK and PICKSUPR), and then are selected by a closeness criterion using an ellipsoid centered at the target location and possibly divided into octants (subroutine SEARCH). The previously simulated values, when located on a regular grid, are selected according to a spiral search (subroutine SPIRAL); otherwise, they are selected according to an ellipsoid search ( Either simple or ordinary cokriging can be used for conditioning the realizations to the original data (subroutine COKRIGE). In contrast, in the nonconditional simulation stage, the local distributions of minimum/maximum autocorrelation factors are always determined by simple kriging (subroutine KRIGE), in order to accurately reproduce the coregionalization model ( Options for sequential simulation include the use of multiple grids, as well as random or regular paths for visiting the target locations ( It is known that the sequential simulation of a Gaussian random field may have numerical problems when the covariance model is smooth (twice differentiable) at the origin. This is mainly due to the sensitivity of the kriging results to the selection of highly correlated data ( To illustrate the ability of the proposed program to accurately reproduce a given linear model of coregionalization, a second-order stationary vector Gaussian random field with three components is simulated on a regular grid with 200×200 nodes, without considering any conditioning data. The correlation structure of the vector random field consists of four isotropic nested structures (a nugget effect and three spherical models with ranges 40, 120, and 200, respectively), with the following sill matrices: A total of 100 nonconditional realizations are generated with program SGCOSIM. For simulating the minimum/maximum autocorrelation factors, up to 60 conditioning data at previously simulated nodes are used for constructing the conditional distributions. This would be equivalent to using 180 scalar data if simulations were performed with the three components of the original random field without any factorization. The sample variograms of the realizations (calculated for lag vectors parallel to the first coordinate axis) are then compared to the theoretical models. It is seen ( It is also interesting to compare the previous results with those that would be obtained by PCA or MAF factorization followed by the separate simulation of the factors. To determine the expected correlation structure of the simulated vector random field, the following steps are required: Calculate the matrices Calculate the direct and cross covariance functions of the factors, Set to zero the off-diagonal terms of Calculate the direct and cross covariance functions of the vector random field obtained by separately simulating the factors, as if they were independent:  Derive the direct and cross variograms of the simulated vector random field As shown in We now consider a dataset from an iron ore deposit explored by diamond drill holes, with information on iron and silica grades (expressed in percentage) and on iron recovery. The latter (a fraction between 0 and 1) depends on the granulometry and on the magnetite content of the ore. The samples are located in a volume of 1000×1400×700 The statistics of the data are presented in The joint simulation of iron grade, silica grade, and iron recovery is performed through the following steps: For each variable, the data are transformed into normal scores with zero mean and unit variance. Cell declustering ( The sample variograms of the normal scores data are calculated along the main anisotropy directions (horizontal plane and vertical direction), and fitted with a linear model of coregionalization. This model contains three basic nested structures (a nugget effect, an isotropic exponential variogram with a practical range of 180  Sequential simulation of the normal variables, conditional to the normal scores data. Simulation is done with program SGCOSIM at the nodes of a regular grid with mesh 2.5×2.5×10 Backtransformation to the original variables. The simulated variables reproduce the univariate distributions and cross-correlations fairly well ( Simulation approaches based on PCA or on MAF factorization ( We presented a novel approach to simulate a vector Gaussian random field whose spatial correlation structure is given by a linear model of coregionalization. It is based on the decomposition of the vector random field to simulate into a set of mutually independent vector Gaussian random fields with coregionalization models containing one or two nested structures, and a factorization of the components into minimum/maximum autocorrelation factors. With respect to traditional coregionalization analysis, the proposed approach theoretically gives identical results but reduces the number of independent factors by one-half; thus it is less demanding in terms of CPU time and memory requirements. It allows accurately reproducing the linear model of coregionalization, irrespective of the number of basic nested structures contained in this model, and avoids the main drawbacks of PCA and MAF factorizations: The factors do not have any spatial cross-correlation, a property that is not guaranteed with PCA and MAF unless the coregionalization model is composed of only one or two nested structures. Because only nonconditional simulation of the factors is needed and conditioning to data is realized through cokriging in a subsequent step, no information is lost if some vector components are undersampled (heterotopic data sets). Also, it is possible to use ordinary cokriging for conditioning the realizations to the data, improving the robustness of the result against local variations in the mean values of the vector components. This research was funded by the Supplementary data associated with this article can be found in the online version at           