In reservoir simulation, compositional modeling is one of the most commonly used approaches for enhanced oil recovery processes. The methods used to solve the equations arising from the modeling of fluid flow in the reservoirs involve the degree of implicitness and the selection of the primary and secondary equations; primary and secondary variables have a great impact on the computational time. In this work, we implement and compare two fully implicit methods based on volume balance approach. The two methods share the same set of primary variables: pressure and total number of moles of each component. The total number of moles of each component is solved with use its material balance equation, whereas the pressure is solved with use of a volume balance equation. The difference between the two methods is in the nature of the volume balance equation. Whereas for one of the formulations the volume balance equation is the volume constraint and hence the only terms that appear in the Jacobian matrix are those from the volume in which the volume balance is evaluated, the second formulation considers an expanded form of the volume constraint. The main advantage of this expanded equation is that the Jacobian matrix involves information from the volume in which the balance is performed and from all neighboring volumes. The element-based finite-volume method in conjunction with unstructured grids for 2D and 3D reservoirs is used to discretize the material and volume balance equations. For two dimensions, quadrilateral and triangular elements are considered, whereas for three dimensions, hexahedral, prismatic, tetrahedral, and pyramidal elements are considered. The implementations were performed with the UTCOMP simulator developed at the University of Texas at Austin. We compare the performance of the two above-mentioned fully implicit formulations with the implicit pressure explicit composition (IMPEC) formulation of the UTCOMP simulator. The results of several case studies are compared in terms of volumetric oil and gas rates and the total CPU time. The results show good agreement between the production rates and saturation fields for all formulations. Additionally, the performance of the fully implicit methods was superior to that of the IMPEC method as a larger number of grid blocks were used in the simulations.Petroleum reservoir simulation is an important tool used to forecast the oil and gas production rates as well as the amount of fluid that resides in the reservoir. In general, the modeling of the oil recovery processes consists of mass, volume, and energy balances that can reproduce the fluid dynamics inside the reservoir with the desired degree of realism and accuracy. These material balances form a nonlinear differential set of equations that cannot be solved without the use of numerical approaches unless several simplifications are made. The reservoir simulation has evolved greatly since its introduction, not only in the physical modeling equations used but also in many other features, such as numerical formulations, gridding, flux approximation schemes, phase behavior calculations, geomechanics models, fractures and fault models, and linear solvers. Fussel and Fussel Most of the formulations presented previously used Cartesian grids in conjunction with the finite-volume method (FVM). However, all the formulations can be implemented for any spatial discretization since their derivations are independent of the grid discretization. However, as the Cartesian grid is the simplest way to discretize the domain, the complexity of the implementation of a given formulation for other types of grids will increase sharply. The unstructured grids are more general in terms of modeling important features of the reservoirs. The unstructured grids are usually related to the concept of elements. However, for many years this concept was used only in the finite-element method (FEM) until the pioneer work of Baliga and Patankar The first use of unstructured grids in reservoir simulation was by Heinemann and Brand In this work, the FI formulation of Collins et al. The flow equations of all formulations implemented here consist of material balance equations and one volume balance equation. Additionally, all formulations considered here share the same set of primary variables: oil pressure and total number of moles of each component. The volume balance equation used to compute pressure for the formulation of Ács et al. The volume balance equation used to compute pressure for the formulation of Collins et al. The formulations of Ács et al. The Peng–Robinson equation of state The phase appearance and disappearance is treated by means of a stability test calculation. Two phase stability test algorithms are implemented in the UTCOMP simulator: the stationary point location method After the phase stability calculation to evaluate the mole fractions and amount of each hydrocarbon phase is performed. The flash calculation used in the UTCOMP simulator is a combination of the accelerated successive substitution method In the EbFVM the domain is divided into elements. The elements used to discretize 2D reservoirs are triangular and quadrilateral, and hexahedral, tetrahedra, prismatic, and pyramidal elements are used to discretize 3D reservoirs, as shown in The physical properties are easily approximated inside each element with use of shape functions. The shape functions for each element are not shown in this work but can be found in the literature The gradient inside any element is evaluated with use of the shape functions as follows: The derivatives of the shape functions with respect to For 2D elements, a similar expression is obtained: The interface areas for 3D elements are computed as follows: Each element is divided into subelements according to the number of vertices. Next, the conservative equations are integrated for each of these subelements. These subelements are called “sub–control volumes” (SCVs). After the conservative equations have been integrated for each of these SCVs, we assemble the control volume equations by obtaining the contributions of all SCVs that share the same vertex of the grid. This feature is called “dual mesh” and gives rise to a cell-vertex approach. The great advantage of this approach is that all calculations are based on only the elements of the grid. The dual mesh is illustrated in As previously mentioned, for the EbFVM each term of the conservation equation is integrated for each SCV. Then, the contribution of each SCV is summed to obtain the closure of each control volume associated with each vertex of the grid. These calculations are computed at an element level. For the mole balance equations, for instance, the integration in space and time, for the SCVs of each element of the grid, can be written as follows: For the formulation of Ács et al. For the formulation of Collins et al. From The discretized equations for both FI-0 and FI-1 are strongly nonlinear in the primary variables. Hence, an exact Newton method is used to solve the set of nonlinear equations for both FI approaches. The linear system of equations that arises for each Newton linearization is solved with use of the default options in the PETSC library Three case studies for testing and verification of the FI formulations implemented in this work in conjunction with Cartesian and unstructured grids are presented. The results will be compared in terms of oil and gas production rates, time-step profiles, phase saturation fields, and overall CPU time. We validate all the new formulations with the original IMPEC formulation of the UTCOMP simulator, since it was severely tested and compared with several commercial simulators In contrast to the IMPEC formulation, FI formulations can theoretically use large time steps. However, the use of large time steps can lead to loss of accuracy. Therefore, a time refinement needs to be performed to ensure that a time-independent solution is obtained. For this reason, all results presented in this section were obtained after a time refinement had been performed. Furthermore, all runs used a time-step control based on variations in pressure, saturations, and rate of change in the number of moles of each component as described in All fluid properties used in the equation of state and the relative permeability parameters of the modified Stone II model Case study 1 consists of production, in a quarter-of-a five-spot configuration, of a heavy oil characterized by three components: CO Two-dimensional and three-dimensional reservoirs with unstructured grids are considered for this case study. When one is using unstructured grids, it is important to see if the grid distortion has any impact on the performance of the formulations. Therefore, for this case study, the formulations are first run for regular grids of quadrilateral elements, and are then run for nonuniform grids of quadrilateral and triangular elements. The oil and gas production rates obtained with the FI approaches and the IMPEC formulation for the grid shown in The gas saturation field at 500 days obtained with all the grids presented in The CPU times for all formulations, the total number of Newton iterations, and the total number of time steps for the FI approaches using regular quadrilateral grids are presented in In case 2, the same fluid and reservoir configuration used in case 1 is used. The main difference here is that now the reservoir domain is discretized with use of 3D elements and gravity is now considered. In this analysis, four sets of 3D unstructured grids composed only of hexahedrons, tetrahedrons, prisms, and pyramids, respectively, were used. The finest grid of each set is presented in A comparison of the production rates between the IMPEC and FI formulations is presented in The CPU times, number of Newton iterations, and number of time steps for each formulation for the hexahedral, tetrahedral, prismatic, and pyramidal grids are presented in Case study 3 refers to a gas flooding in a 2D irregular reservoir characterized by the following hydrocarbon components: C The grid used for this case is shown in  The The CPU times for all formulations are presented in In this work, two FI formulations were implemented in the UTCOMP simulator in conjunction with unstructured grids with use of the EbFVM. The new formulations were validated and compared with the IMPEC formulation originally implemented in the UTCOMP simulator. The FI formulations have better performance when refined grids are used. However, it could not be determined which FI formulation is faster, since for some cases FI-0 was faster and for others FI-1 was faster, although we confirmed that FI-1 always required a slightly higher total number of Newton iterations. However, FI-1 has a better configuration for the UTCOMP simulator, since it shares the same set of equations as the original IMPEC formulation, which makes it easier to combine the IMPEC and FI approaches. Bruno Ramon Batista Fernandes thanks CAPES for partial financing of this work. Also, we thank ESSS for providing Kraken 