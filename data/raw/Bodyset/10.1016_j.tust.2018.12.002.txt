The use of an underground transportation network to solve urban traffic problems is a practical solution. Shiraz, one of the most famous touristic cities of Iran, is developing its own urban railway network using mechanized twin tunnels. It is almost inevitable for tunnels to pass nearby an existing pile foundations. In this study, a three-dimensional numerical model was developed to investigate the pile-tunnel interaction. All the mechanized excavation phases of an EPB-TBM (Earth pressure balance, Tunnel boring machine) and the segmental lining were modeled using a finite difference code. The role of the Constitutive soil’s model is also investigated by using both a linear elastic-perfectly plastic one (failure criteria of Mohr-Coulomb type) named as MC and a nonlinear perfectly plastic one the Cap-Yield (CYsoil) constitutive model. Two different scenarios were considered: the influence of tunneling on existing piles and the impact of installing bridge piles nearby existing twin tunnels. The influence of the soil/structure interaction is presented in terms of surface settlements, forces induced in the tunnel lining and forces along the piles. It should be noted that on the base of the obtained results, the MC model cannot accurately estimate the ground settlements and the forces in tunnel and piles, therefore it is necessary to use advanced constitutive models like CYsoil for design purposes.Shiraz is known as an attractive touristic city. Like many metropolitan cities in Iran, this city also needs a wide subway network and highways to avoid urban congestion. The second line of Shiraz subway project has been adopted in this study as a case study. It is likely that shallow tunnels meet piles of existing bridges. In such cases, it is very important to ensure the safety of both infrastructures in the long term. One of the investigative tools is the use of 3D numerical modelling with proper constitutive models which can define the risk of potential hazards in the tunnel construction phase. In order to understand the pile–soil–tunnel interaction mechanisms, many researchers have carried out field monitoring studies ( A three-dimensional numerical model has been developed and is capable to consider the main TBM excavation processes such as the face pressure, the jacking forces, the conical shape of the shield, the tail void grouting pressure and its consolidation, the TBM self-weight and the back-up train. In addition, the prefabricated concrete lining of the tunnels was simulated by structural elements, called embedded liners which are very efficient to model the segmental lining as well as segment and ring joints ( The interaction of the pile-soil-tunnel is a complex phenomenon that should be taken into account accurately. To obtain better results, it is necessary to use an advanced constitutive model and proper physical parameters which can predict realistically the structural forces induced in a pile, in the tunnel lining and the soil mass. The importance of using a proper constitutive model for numerical modelling of soil has been studied by many researchers in the past. Nevertheless, few works have been performed to investigate its influence on the underground structure’s behavior. In most cases, a simple constitutive model is used to estimate the settlement trough and compare it with experimental observations ( The main route of the subway line 2 of Shiraz, between the “Shekoofeh” station in the south and the “Kolbehsa’di” station in the Northern part of the city consists of two tubes of 6.88 m (external diameter) and 15 km long with 13 stations. Two EPB-TBMs are working to excavate the twin tunnels. The tunnel crosses mainly Marly lean clays with Gypsum and the most part of the tunnel alignment is located under the water table ( Each circular ring of the tunnel lining consists of 4 trapezoidal segments, one counter-key and one key segments. All are prefabricated segments with reinforced concrete of 1.4 m length and 0.3 m thickness. Three rows of five piles with a distance of 20 m from each other have been installed to a depth of 32 m from the surface to build the ring road overpass. The segmental lining and pile foundation characteristics of this project are summarized in The elastic linear perfectly plastic Mohr-Coulomb constitutive model (MC) is the most common model used in geotechnical engineering. It needs a few parameters to model the behavior of soils and rocks. Using this constitutive model, a constant stiffness is assumed for each soil layer. Due to this assumption, calculations are relatively fast. In the present paper, the computation has been done using the MC constitutive model to gain an initial insight of the ground movements and the forces induced in piles and tunnel lining. The properties of soil layers corresponding to the MC model are shown in The Cap-Yield (CYsoil) model is shear and volumetric hardening/softening model that provides a comprehensive exhibition of the nonlinear behavior of soils. This double-yield model can present a more realistic representation of the loading/unloading response of soils ( For the second line of the Shiraz subway, the input parameters corresponding to CYsoil model are summarized in In order to determine the parameters used for soils on numerical modelling, the deviatoric stress-axial strain diagrams obtained from experimental data of Consolidated Drained (CD) tests are used. These data are presented in Numerical simulations of these triaxial compression tests are done using Flac3D with both the MC and CYsoil constitutive models. The parameters for the constitutive models were back analyzed by comparison with the data from the experimental triaxial tests. In In numerical simulations, the model boundaries were set at an optimal distance from the underground structures to avoid boundary effects. For this purpose, the model dimensions were selected a bit larger than the suggested values by (H + 4D), for the model height, (H + 3D), for the model length, 3H, for the model width (for half of the model). A full 3D model of the twin tunnels of the Shiraz urban railway line 2 (height of 52 m, width of 120 m, and length of 70 m) was generated using the finite difference code Flac In order to set the fixity conditions at boundaries, all the nodes on the sides of the model were fixed in the normal directions, while the bottom of the model was fixed in the vertical direction (Z). In addition, the grid density decreases by getting away from the tunnel walls to the model boundaries to increase the accuracy and speed of calculations. Also, in order to increase the results accuracy around the piles, the mesh density around the pile foundations are enhanced locally. Bored piles are considered and as the concrete is fastly set after the pile excavation, the pile installation effect is not considered in the following calculations ( Due to the rapid dissipation of the observed in situ pore pressures ( To correctly simulate EPB-TBM tunneling, there are several important factors that must be taken into account. In this paper, in order to model the different phases of the mechanized tunneling, the following aspects were considered. TBM face pressure was simulated by applying a trapezoidal distribution of the horizontal stress at the tunnel face ( In former works, a tapered shield has been simulated numerically by a “fictive” shield which was introduced by In a first step, the model has been run without any shield elements to investigate the natural behavior of the soil. The vertical movement of the tunnel crown was monitored at the same time ( In order to simulate using a simplified method this conical shield, Young's modulus of the front shield (SH1) was chosen equal to 2e7 Pa which is lower than the soil Elastic’s modulus. Then getting away from the face, Young's modulus values of the other shields parts increase with the distance to the tunnel face. The assigned parameters to the shield parts of this simulation are shown in The TBMs advance is assured by several thrust jacks which apply forces on the last installed ring. These forces permit to push forward the machine. In previous studies, the nodes located at the edge of the segment were exposed to the concentrated forces to simulate the jacking forces. Furthermore, the applied jacking force increased linearly from the crown to the tunnel invert ( One of the most important parameters of mechanized tunneling simulation is the tail void grouting and its hardening procedure. In previous works, the tail void grouting was modeled by applying a normal stress distribution on the tunnel boundary ( The hardened grout was simulated by a linear elastic model in the works of In order to simulate the self-weight of the EPB-TBM, a vertical load distribution acting on the tunnel invert over the shield length with a direction of 90 degrees was considered (  The segmental lining and the joints are extremely important in mechanized EPB-TBM tunneling model. In order to simulate the segmental joints, node to node links with six degrees of freedom was implemented and are represented by six springs. Each spring can receive four different attachment conditions: (1) free; (2) rigid; (3) linear and (4) bi-linear. Three springs have been considered such as an axial spring (K On the basis of All the other springs were assumed to be rigid. The joints between two successive rings (circumferential joints) were simulated like the segmental joints with three springs (axial spring (K In In order to investigate the influence of the twin tunnels excavation and the piles installation, the following scenarios were considered: Twin tunnel excavation after installation of pile foundations. Twin tunnel excavation before the piles installation. In the first scenario, after installation and applying the bridge load on pile foundations, the excavation of the twin tunnels have been performed. It should be noted that this scenario represents the real condition in the Shiraz subway. While in the second scenario, the twin tunnels have been excavated through the entire model simultaneously. Afterward, the 15 piles have been installed and the bridge load has been applied. A typical view of the twin tunnels location and the overpass piles is shown in In this section, the results of the numerical simulation are divided into three parts. In the first section, the influence of using different constitutive models on soil behavior and the structural forces induced in the lining and pile foundations are investigated for the second scenario. Afterward, the pile-tunnel interaction is highlighted and the numerical results of the two scenarios are studied. In order to calibrate the numerical model, the right tunnel has been excavated as in the real condition. Consequently, the surface settlement trough obtained by the CYsoil and MC models were compared with the surface monitoring data in The The optimization of the Peck’s formula on the five monitored points gives S To determine the influence of the constitutive model, calculations using the MC and the CYsoil constitutive models were done on the excavation of the two tunnels. Unfortunately, due to electronic problems, no monitoring data is available to compare with the numerical modelling at the end of the twin tunnels excavation. It can be seen in To understand the influence of using an advanced constitutive model like CYsoil on the tunnel lining, the displacements and the forces induced in the 25th ring of the right tunnel lining are presented ( In the same way as for surface settlement, due to the lower movements of the soil surrounding the twin tunnels in case of using the MC model, the axial forces and bending moments induced in the tunnel lining are lower of respectively 30.7% and 20% than the ones obtained by the CYsoil model. The bending moments induced in the segmental joints location by the CYsoil model are higher of about 47.9% than the corresponding values obtained with the MC model. This result is similar to those obtained in the work of The axial and normal displacements of the right tunnel lining are also shown in In order to investigate the influence of using different constitutive models on the pile foundations, the axial displacements and axial forces induced in a pile located between two tunnels (Pile C3) are investigated. The goal of this section is to highlight the influence of twin tunnels construction on existing pile foundations and ground displacement. Looking at the surface settlement profile presented in  In order to understand the lateral displacement of the loaded pile foundations due to the tunnel excavation, As can be seen in  When the excavation of the tunnels is finished, the upper portion of the pile is subjected to soil’s lateral movements which lead to a reduction of the pile’s skin friction capacity. It induces a load transfer to the middle part of the pile foundation (  A positive bending moment means that tensile stresses were induced along the pile. It can be observed in In order to investigate the effect of constructing the pile foundations on the soil behavior and existing tunnels lining, the results of the numerical simulation with CYsoil model before and after pile installation were studied in detail. For this purpose, before installation the pile foundations and applying load on them, the twin tunnels have been excavated simultaneously to the end. As the pile installation affects the surface settlement, this can also affect the adjacent structures like tunnels. In The axial force and bending moment induced in the right tunnel lining are shown in  A three-dimensional numerical simulation of EPB-TBM tunneling has been developed by a finite difference code to investigate the pile-soil-tunnel interaction. Two constitutive models were used (MC and CYsoil). To understand the interaction of the pile-tunnel on each other, two scenarios have been considered. Based on the numerical results, the following conclusions can be drawn: A great influence of the constitutive model is highlighted on the tunnel lining and pile foundations behavior and ground settlements. The CYsoil model predicts higher structural forces and ground settlements induced in tunnel lining and higher axial displacements and axial forces along the pile foundation than the MC model. This implies that it is necessary to use an advanced constitutive model for design purposes. In the scenario of twin tunnels excavation nearby pile foundations, it can be observed that an additional surface subsidence occurs after tunneling and particularly the ground settlement above the piles increases. As a result, the axial displacement along the pile length is approximately doubled due to the tunnel construction. Using the CYsoil model, the pile experiences considerable axial forces around the tunnel centerline and in their lower portion. The MC model underestimates the initial pile axial forces and overestimates the axial forces after tunneling. In the case of constructing a pile foundations adjacent to existing twin tunnels, the numerical simulation results achieved by CYsoil indicate that the surface settlement trough becomes deeper when applying work load on piles. In addition, the loaded pile installation increases the axial displacements, normal forces and bending moments induced in the tunnel lining. The MC model is not able to show the pile installation influence on the axial displacements of the tunnel lining.