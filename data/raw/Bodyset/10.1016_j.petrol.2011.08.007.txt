Waterflooding is an important oil recovery method, which is used to maintain reservoir pressure and to increase oil productivity. One of the most common problems caused by waterflooding is inorganic scales formation especially barium sulfate scale, which occurs due to incompatibility of injected seawater and formation water, and causes formation permeability decline.
                  Artificial neural networks (ANNs) are new tools, which application of them in petroleum industry has been extended. Since many factors have influence on permeability reduction due to barium sulfate scaling and relation of them with one another is complicated, in this research a model was presented for prediction of permeability damage due to formation of barium sulfate scale using MATLAB software, artificial neural network and waterflooding experimental data in Malaysian and Berea sandstone cores. To design the optimum ANN model, number of neurons, number of hidden layers and training function were studied. Finally, efficiency of the model was evaluated using new data. The proposed artificial neural network predicted permeability and its reduction during water injection with error about 2 percent.Waterflooding is one of the enhanced oil recovery (EOR) methods, which is executed for reservoir pressure maintenance and increasing of oil recovery. Scale formation is an important problem of petroleum industry during water injection. The principal mechanisms of scale deposition are pressure drop or temperature variations and mixing of incompatible waters, which cause carbonate and sulfate scales precipitation, respectively. Sulfate scales mainly result from incompatibility between injected water and formation water. When two or more incompatible waters are mixed, they interact chemically and precipitate minerals. Usually seawater is used as injected water in waterflooding operation. Since seawater contains high concentration of sulfate anion and formation water contains high concentration of calcium, strontium and barium cations, mixing of them causes formation of sulfate scales such as calcium sulfate, strontium sulfate and barium sulfate ( Barium sulfate is a kind of sulfate scales, which may precipitate in porous media of oil bearing formation, and causes permeability reduction and formation damage. Precipitation of barium sulfate scale was reported in some oilfields such as Forties and Brae ( One of the major tests is core flooding test, which is performed to investigate incompatibility of injected and formation waters before performing waterflooding operation. The test demonstrates scale formation effects on porous media and permeability decline by measuring pressure or flow rate reduction based on test method ( Preparation of core for coreflooding test is expensive. In addition, accomplishment of the test needs special experimental equipments. Therefore, presentation a model, which can be replaced of such tests and its results, conforms to test results, is more economic and needs less time. In recent years, applications of artificial neural networks especially multilayer neural networks in petroleum industry have been extended. Artificial neural networks (ANNs) are parallel distributed information processing models. The most important advantage of ANN rather than other methods is learning without requirement of given formula and generalization capability for solving new problems, so it can predict nonlinear complex systems ( The main objective of this study is the designing of ANN model for prediction of permeability decline due to formation of barium sulfate scale in porous media with high accuracy during coreflooding. At first, the paper gives a summary about ANN and multilayer neural networks. Then, the methodology for determination of optimum ANN structure has been presented. Finally, the performance of ANN model in prediction of permeability after water injection has been evaluated using new data of Malaysian and Berea sandstone cores. Artificial neural network is an information processing system which mimics the biological neural network of a human brain and is developed based on mathematical model of biological neural networks ( Hyperbolic tangent, logistic sigmoid and linear functions are the most common activation (transfer) functions in artificial neural networks. Hyperbolic tangent and logistic sigmoid functions are used in hidden layer of ANN, whereas linear function is used in output layer of ANN for function estimation. Eqs. As shown in There are different classifications of neural networks based on various properties. One of the usual classifications is based on training algorithms so that neural networks can be divided into two main groups of supervised and unsupervised. Unsupervised neural networks, which are also known as self-organizing maps, are called unsupervised because no feedback is produced during training. In the supervised training algorithm, both inputs and outputs are presented to the network and the network learns based on feedback ( Back propagation is one of supervised training algorithms wherein initially all weights are adjusted randomly in this algorithm, then the neural output is compared with the target in the training dataset and error (difference between target and neuron output) is propagated backward to the network. During this back propagation, the weights are changed to decrease the error. This procedure is continued frequently until the produced outputs are acceptably close to target ( There are two stages in preparing neural networks: the training stage and the test stage. In training stage, connection weights are adjusted to supply the desired outputs whereas in test stage, accuracy of the trained neural network in predicting the outputs is assessed by examples which have not been seen by the neural network in training stage. Training is done by adjusting the weights until convergence between produced outputs and desired outputs (target) is acquired. Changing weights allows the network to improve its behavior in response to the inputs ( Neural networks basis of the supervised training algorithm have the most applications in petroleum industry. Although there are various kinds of neural networks, but networks with feed forward back propagation learning algorithm are the most popular and heavily applied ( The data used for this study are obtained from case studies. These studies were conducted to investigate the permeability reduction due to deposition of barium sulfate in Malaysian and Berea sandstone cores. During this study, various processes including preprocessing of data, using various training and verification sets, investigation of training functions, determination of optimum hidden neural number and evaluation of hidden layer number were performed for designing ANN with excellent performance. The following paragraphs give short descriptions on the mentioned processes. According to results of previous tests temperature ( When a randomized sample is utilized for ANN training, ANN applies information which is more representative of the population. In addition, selection of random test and performance datasets causes better evaluation of ANN efficiency ( In this research, 264 data from 18 Malaysian and 4 Berea sandstone cores are used for prediction of permeability decline due to formation of barium sulfate scale. Initially, 228 data from 19 cores is selected for training and testing of ANN. Among 228 data, 188 data for training and 40 data for testing of ANN were utilized randomly. In the process of ANN, sometimes raw data may not be suitable to be utilized, thus raw data needs to undergo preprocessing. When values of input and output parameters are extremely low or high, therefore scaling of data should be performed ( Where Another approach for scaling of data, which is used for normalization of data in this study, is done using mean and standard deviation of training set (Eq. where Two of the parameters which have influence on ANN performance are the number of hidden neurons and the number of hidden layers. In order to determinethe optimum hidden neural number, ANN with one hidden layer and feed forward back propagation algorithm were considered and the number of neurons in first hidden layer was assigned from 1 to 15. Since ANN with one hidden layer may not extract total information from input parameters, ANN with two hidden layers and optimum neural number in the first hidden layer was considered and neural number for second hidden layer was evaluated from 1 to 8. Another parameter which is very important for ANN training is training function. Therefore, after determination of optimum hidden neural number and evaluation of hidden layer number, ANN with various training functions was run and the best training function was determined. Another effective factor on ANN is activation function in hidden layer. In this part, hyperbolic tangent and logistic sigmoid were investigated as activation functions for hidden layer of ANN. In order to evaluatethe ANN model in all stages, total average absolute deviation (TAAD) was performed which is defined as: Where To design ANN model with maximum performance, ANN with one hidden layer was considered in the first step and optimum number of neurons was determined as mentioned already ( In the second step, ANN with two hidden layers was considered so that there were 9 neurons in first hidden layer. Then, the number of neurons in second hidden layer was evaluated ( In the third step, efficiency of various training functions was evaluated ( According to the presented investigations, the ANN with two hidden layers was chosen as optimal. The first and second hidden layers include 9 and 3 neurons in their own structures, correspondingly. Also, the ANN training algorithm was Levenberg–Marquardt algorithm with Bayesian regularization (BR) and activation function of hidden layers was hyperbolic tangent. The main ANN model results in training stage is shown in  Using actual core flooding data, a neural network model was developed to predict permeability after waterflooding and its reduction due to barium sulfate scaling. A feed forward back propagation algorithm was utilized to design the neural networks. Permeability decline data due to deposition of barium sulfate in 18 sandstone cores of Malaysia and 4 Berea sandstone cores were used to train, test and evaluation the neural networks. Although various parameters have influence on permeability reduction caused by barium sulfate scaling, in this research the more important parameters such as temperature, differential pressure, volume of injected water, initial permeability, barium concentration of formation water and sulfate concentration of injected seawater were considered as input parameter for designing of the model. Based on the studies, which were done in this research, the ANN model with 9 neurons in first hidden layer and 3 neurons in second hidden layer was defined as the best ANN model, whereas training algorithm of the ANN model was Levenberg–Marquardt algorithm with Bayesian regularization and activation function was hyperbolic tangent. The main ANN model predicted permeability with a total average absolute deviation (TAAD) of 1.06% in test stage. In addition, efficiency of the designed ANN was investigated with new data of Malaysian and Berea sandstone cores. The ANN model predicted permeability with TAAD of 2.03% in performance stage. Using this model, permeability and its reduction due to formation of barium sulfate scale can be determined without doing any core flooding test.  bias concentration of barium in formation water concentration of sulfate in injected seawater activation function input vector of neuron damaged permeability initial permeability measured permeability after waterflooding predicted permeability by ANN number of data output of neuron pressure regression constant temperature volume of injected water connection weight original parameter maximum value of original parameter minimum value of original parameter normalized value of original parameter  difference mean value of original parameter standard deviation of original parameter  Artificial Neural Network Average Absolute Deviation (%) Total Average Absolute Deviation (%) Pore Volume absolute inch (in.) pounds/square inch (psi) darcy (d) The authors would like to thank