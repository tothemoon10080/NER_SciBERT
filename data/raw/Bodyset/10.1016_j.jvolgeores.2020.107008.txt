Shape analysis is of paramount importance in sedimentology. Particle morphology is a very useful texture parameter that provides information about particle history and is used to characterize and classify sedimentary material. Particle shape description has been both an important and a controversial subject. The most convincing description of shape defines particle shape by three hierarchical parameters: form, roundness, and surface texture (Barrett, 1980). Many different methods have been proposed to measure these parameters. Among them, Fourier shape analysis is particularly notable. Fourier analysis separates the three parameters into frequency ranges. The low frequency range is related to form, the middle frequency range to roundness and the high frequency to surface texture. However, determining where the boundaries lie between the different morphological classes is not an easy task and has been an unsolvable problem since the FSA method was first proposed. The same is true for the signal-to-noise limit. To date, this information has been obtained empirically and with great uncertainty. One of the most important contributions of this work has been to quantitatively constrain the harmonic ranges corresponding to the morphological ranges proposed by Barrett, and to determine the best possible approximation for the upper limit of the signal and the onset of noise. To estimate these ranges, we propose here two original methodologies based on analysis of the cumulative amplitude spectrum (CAS), and on simulating the effect of artificial noise acting on a well-known geometric figure. The CAS of 3664 volcaniclastic particles and of 106 artificially silhouette charts have been quadrisected into form, roundness, roughness and noise using an optimization process. The analysis indicates overall that the limits are well constrained into a narrow range of harmonics with a small variance. The results obtained are reliable and allow the range of harmonics that contains a useful signal to be extended up to harmonic 256. The method has been successfully applied to the standard figures of Krumbein (1941a) and of Powers (1953), efficiently separating the different classes of roundness. As an example, the methodology has been applied to a real-life case where there was doubt about the pristine nature of the materials from some outcrops related to the block-and-ash flow deposit of the July 17, 1999 eruption of the Colima volcano. The results obtained applying the method show promising results, indicating the potential of FSA information to solve this ambiguity. The powerful, user-friendly FSA software that we distribute freely (open code) can be very useful for characterizing volcano-sedimentary and sedimentary deposits. To date, there is no other software for FSA studies. Moreover, FSA can be useful in other fields of science and engineering where quantitative particle shape analysis is needed.Particle morphology (PM) is of great interest in earth science and several other scientific fields and engineering disciplines. PM in sedimentology is a very useful shape parameter that contains information about the processes that the particle has undergone since its formation and during transport and deposition ( PM provides very useful data for volcanologists. The field of application spans several areas of explosive volcanism; for example, the study of ash particles in the atmosphere, in which the aerodynamic behavior of the particles also depends on particle shape ( The concept of particle shape is complex. Shape can have different meanings in relation to the external morphology of a body ( The study of particle shape in volcanology dates back to the pioneering studies of In the 1990s, the spread of personal computers and the emergence of image analysis programs generated a new interest in particle morphology analysis ( A wide set of morphological coefficients have been used in volcanology through the years. Initially, given the limitations of computers for image analysis in the 1990s, the morphological parameters used were based mainly on simple geometric characteristics extracted from 2D features, such as area, perimeter and axis lengths. Combined, these metrics provided dimensionless parameters able to describe different shapes. Among these, the parameters of convexity, circularity, solidity, compactness, elongation and aspect ratio were particularly useful ( Recently the possibility of obtaining 3D particle morphology parameters by means of different methodologies has been explored, although this is a field where more development is needed. Pseudo-3D analysis of particle morphology based on matter–light interactions ( The method of analyzing particle perimeters using Fourier transform analysis is based on the universally used mathematical tool developed by Jean Baptiste Fourier in the nineteenth century ( The FSA method provides a spectrum where the harmonics are related to different types of irregularities ( Despite the potential of the FSA method for quantitative study of pyroclastic and epiclastic clast morphology, there are no commercial programs, and even less freeware, that enable this type of study to be carried out. Researchers who have worked with this methodology to date ( Among the most important objectives of our study is solving the long-standing problem of which harmonics provide information for specific ranges of shape (e.g., form, roundness, roughness) and up to which harmonica useful signal is available. The other important contribution of this work is to provide the scientific community with friendly, powerful, versatile and freely distributed software to undertake FSA clast morphology analysis. Both problems have been solved and are explained in the following sections. The code used for the optimization procedure has been developed in Matlab 2014b and can be downloaded and edited in the repository The FSA technique basically consists in converting the particle's perimeter (2D) into a signal (1D) by using the intersection between a straight line segment l The perimeter of the particle is obtained from a digital image. The perimeter corresponds to the pixels of the particle's contour, which are obtained by segmentation. The image is segmented using Otsu's method ( The NNI method assigns the nearest The NNI method assigns the nearest It is well known that the Fourier transform can be expressed by its phase ∠ In this section, we introduce the procedures developed to determine the harmonic thresholds that separate different shape components and to identify where the signal vanishes, and noise begins. The thresholds in the Fourier spectrum amplitude delimit ranges corresponding to different types of irregularities ( To determine the harmonic at which the order of magnitude changes, we propose an optimization function based on the L-method ( The objective function proposed for this calculation is the following: The form is determined by the first harmonics. We have found that to estimate the form threshold it is enough to analyze the first 12 harmonics. Using more than 12 coefficients will only slow down the processing. The range to calculate the form threshold is then a The only constraint on the objective function is that the linear fitting must have at least 3 points. This constraint is based on the fact that the form must include at least 3 harmonics. The optimization problem is solved by an exhaustive search. In cases where there is more than one minimum, the lowest harmonic is chosen, because the form is defined by the lowest frequencies. An example of threshold estimation using this procedure is shown in As we mentioned in the previous section, surface texture (roughness) is the third-order shape class and corresponds to the highest frequency range. However, digital noise related to the image quantization process is present in the same frequency range. The maximum observable frequency (MOF), related to the highest harmonic containing useful information, is calculated according to Nyquist's theorem ( In order to evaluate the effect of image resolution on noise and to understand at which frequencies noise overcomes the signal related to particle irregularities, a computer simulation was carried out. A sinusoidal signal simulating irregularity was superimposed on a simple shape, a circle. Several images were produced with different irregularities, simulating the three morphological orders: form, roundness and roughness. The sinusoidal signal produces a well-defined peak in the Fourier spectra (see The results of the simulation are summarized in The curves shown in The result of the optimization process and the statistical study was carried out using a sample of more than three thousand volcanic clasts distributed among the categories pumice pyroclastic fall (30%), block and ash flow (22%), debris avalanche (15%), lahars (15%), lithic pyroclastic fall (11%), and artificially fractured basaltic rocks (7%). This study shows that all the thresholds, despite certain variability, are concentrated in specific harmonic ranges ( As a cross-test, the same analysis by optimization was performed using the 81 artificial reference figures constructed by In In this section, the results obtained from applying the FSA algorithm to Krumbein's and Pettijohn's reference figures are shown, as well as an example of a practical application of FSA parameters to a real geological case study. In order to demonstrate the usefulness of the proposed algorithm, a “roundness” classification test was carried out, applying FSA to the silhouettes of the artificial clasts ( The graphs in The FSA morphological coefficients (described in In a study of the July 17, 1999 block-and-ash flows (BAF) in the Colima volcano ( The morphological coefficients provided by the FSA software were used to measure the morphological characteristics (form, roundness and roughness) of the clasts in these outcrops of uncertain origin. These deposits were compared with other deposits whose origin is well known (from eyewitnesses and studies carried out immediately after the eruption); namely, primary deposits (BAF) and lahars, which are surely reworked (LHR). In order to make this study consistent with the work of In the scatter plot in Although the usefulness of FSA methods for detecting even slight morphology variations in clasts has been demonstrated, they have not often been applied to volcanology. The reason probably lies in the lack of available user-friendly software. To date, researchers who used FSA in volcanology have had to develop their own software ( Some authors ( FSA has great potential in volcanology. The possibility of quantitatively and accurately measuring different morphological characteristics of the clasts may provide longitudinal and vertical variations in the sampling position along a deposit. This enables inferences to be made about rheological conditions in pyroclastic density currents and debris flows during the transport and deposition processes. Most of the studies carried out to date in volcanology have been oriented only towards measuring changes in particle morphology and relating them to inter-particle interactions and flow conditions. Because of the lack of literature on these methods in volcanology, there are broad areas open for further research. For example, the previous section shows how the FSA morphological coefficients can be a practical way to distinguish primary and reworked deposits, a very common problem for researchers studying PDC deposits. A field that still has to be well explored, and that is very promising, is the classification of volcanic activity involved in pyroclastic deposit formation. It has been seen that the shape of pyroclastic particles (considering particles of the same lithology and size) depends considerably on the type of fragmentation and the style of volcanic activity. A clast morphology study performed on several deposits whose origin is known could help to construct very effective classification diagrams. We are confident that the software developed here, which is user-friendly, free and open source, as well as the proposed advanced methodology, can encourage many pyroclastic deposit researchers to use and disseminate this powerful tool in volcanology. The FSA software provides a user-friendly tool for rigorous, quantitative textural analysis. It is the first freeware of this type available to the scientific community. The algorithm used in the code in most cases solves the classic FSA problem of multiple intersections (bijectivity) between the perimeter and the radius used for its sampling. The software is suitable for analyzing complex perimeters with narrow edges and notches, such as pumice or scoria clasts. The most important contribution of this work is to have found, through a study on more than 3600 natural volcanic particles related to different volcano-sedimentary processes, the harmonic thresholds between different morphological orders (form, roundness, roughness) as proposed by All the calculated thresholds fall in the same range of variability ( The limit between roughness and noise has been calculated through the same optimization process and is located at harmonic 82 but with a wide range of variability (±33). Parallel to this value, by means of a specifically designed experiment, another value has been calculated which, for images of good quality (clast perimeters with more than 1000 pixels), places this limit at the 256th harmonic, which is probably closer to reality. The optimization process that has led to calculation of the boundaries between shape classes is in itself an important, original contribution of this work, as is the code used to superimpose variable irregularity on a simple clast (circle), which can be useful for many studies on particle morphology. Both software and codes are freeware and available here. The FSA software, freely distributed and available to any sedimentary petrology laboratory, can be very useful for carrying out quantitative texture studies, which in the near future will become increasingly important for characterizing and discriminating volcano-sedimentary and sedimentary deposits in general. Moreover, FSA can be useful in several other fields of science and engineering (astronomy, biology, food engineering, pharmaceutical industry) where quantitative particle shape analysis is needed.  The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper. This work has been partially funded by The Fourier Shape Analysis (FSA) is a stand-alone Windows program developed on the MATLAB graphical user interface (GUI). The software is open source and the executable version is freely distributed. It can be downloaded and modified from the public repository at The FSA software flow diagram is presented in A morphological analysis can be carried out using the FSA software using four different sets of harmonics, which can be chosen by the user. The first three sets (a, b and c) use the LA method, and the last (d) uses the EN method. For Method a), users can specify their own set of harmonics. The morphological coefficient (MC) is labeled according to the range of harmonics where it is calculated; e.g., MC The results are presented graphically and numerically, including statistical analysis for an easy interpretation of the results. The design of the FSA software makes the code reusable and easy to develop and modify. Visual elements such as buttons, text, and axes are declared in the FSA_OpeningFcn function. The visual elements are assigned to a handle so that they can be easy to manipulate, add or remove. The interface has six menu tabs: Open, Setup, Fourier, Graph, Export and Help. Each menu tab has options that call functions found in the FSA.m. The relationship between menu options and functions is very intuitive. It is easy to remove or add a menu option together with its function in the code. The functions contained in the menu options can call other functions external to the FSA.m. For example, the load_images function calls the external function binarize_image.m based on the Otsu segmentation algorithm. RTmethod.m, insertInImage.m and Lmethod.m are external functions. The purpose of having external functions is so that they can be modified without reprogramming the graphical interface. As mentioned above, the interface has six menu tabs. Each menu tab has functions which we will denote as “function/menu tab.” The function “load Images/Open” loads single or multiple images in jpg, tiff, bmp or png format. If the loaded images are not binary, the Otsu segmentation method can be applied in order to segment them. The “complement color/setup” function produces the binary image complement. In order for the image to be analyzed correctly, the background must be 0 (black) and the foreground 1 (white). The “Untouched edges/setup” function removes objects that touch the image's edges. The “ROI/setup” function enables a region of interest in the image to be selected. The “optimization/Fourier” function applies the functions and methods proposed in the paper. The “mean of image/graph plots” function provides the mean of the sum of spectra of the particles in each image. The “spectrums/export” function saves a spreadsheet with all the particle spectrum data of all the images. The “range stats/export” function saves a spreadsheet with the mean, median, variance and sum of the general form, roundness and roughness ranges. The “labels images/export” function saves an image with the particles labeled and listed. The “documentation/help” function opens the user guide. The user guide, also available separately and downloadable from our webpage ( In this work, the figures of These comparison charts have been widely used in the past and can be considered a reference standard (