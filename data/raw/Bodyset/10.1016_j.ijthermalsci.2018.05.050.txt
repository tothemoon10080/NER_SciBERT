View factor plays an important role in evaluation of radiative heat transfer. This paper gives a detailed account of setting up the Monte Carlo calculation models of view factors between some complex surfaces. Main purpose is to calculate view factor between cold-rolled strip and W-shaped radiant tube in continuous annealing furnace. Given advantages of Monte Carlo method, it has been used to calculate view factor between the strip and radiant tube. Firstly, the Monte Carlo calculation models for view factor between rectangular plane and parallel cylinder and for view factor between rectangular plane and torus are established and verified, respectively. Then, according to reciprocity and superposition rules of view factors, the Monte Carlo calculation model for view factor between the strip and radiant tube is established by the above models. By comparing with analytical expression, or checking reciprocity after performing the Monte Carlo analysis in each direction between surface pairs, the calculation errors of above Monte Carlo models are analyzed and the results show that the Monte Carlo method is effective and reliable in calculating view factors between some complex surfaces.The main objective of the present work is to develop an effective model to precisely calculate the view factors between cold-rolled strip and W-shaped radiant tube in continuous annealing furnace. The continuous annealing furnace is widely used for recrystallization annealing and surface treatment in cold-rolled strip manufacturing. In the annealing furnace, strip temperature control is the heart of the heat treatment process. Such a furnace is a distributed parameter system, where the temperature can only be measured on few discrete points. It is difficult to obtain continuous and accurate temperature of steel strip inside the furnace, which could rely on accurate strip heat transfer model. The annealing furnace considered in this paper consists of the jet preheating furnace, radiant tube furnace, soaking furnace, slow cooling section, rapid cooling section, over aging section and final cooling section. In the most important radiant tube furnace and soaking furnace, the dominant heat transfer is radiation due to the high temperatures and many W-shaped radiant tubes are used to indirectly heat the strip. The calculation of view factors between the strip and radiant tube is crucial for establishing heat transfer model of the strip heated by the radiant tubes [ View factor represents the proportion of the energy of radiation leaving the surface of a black body with uniform temperature (or a gray diffusing surface) and strikes the surface of another black body with uniform temperature (or a gray diffusing surface). The view factor is also known as configuration factor, shape factor, form factor or angle factor, etc. It is a geometrical parameter that only related to the shape, volume, distance and relative position of the two surfaces. Meanwhile, view factors obey the important algebra rules: the reciprocity relation, the superposition rule and the summation rule [ For direct integration method, view factor is calculated by its definition expression. It must use quadruple integral (namely double area integral) in calculating view factor between two finite surfaces, which is often a heavy computation work, especially for complex geometric shapes. In contour integral method, the double area integral in the definition expression of the view factor is converted to double contour integral by Stokes' theorem [ Unit sphere method is a hemispherical method which is proposed by Nusselt [ Cross-string method was proposed by Hottel [ Algebraic analytical method is to take full advantage of the reciprocity, superposition and summation rules of view factors and determine the view factors of other geometry systems based on geometry systems whose view factors are known. Algebraic analytical method solves view factors conveniently in most relatively simple geometry systems but face great difficulty in complex geometry systems especially those with multi-surfaces, shadowing between surfaces and a limited number of surfaces that cannot see itself. Monte Carlo method is a kind of numerical approach based on statistical simulation. Since the 1960s, it has been widely used in radiative heat transfer problems [ The basic idea in this paper of calculating radiation view factors using Monte Carlo method is: Firstly, consider the radiation energy of the surface of the 1st black body (namely the 1st surface) as composed of a large amount of rays, each ray contains a certain amount of energy, and the energy emitted from the surface is related to the number of rays According to the basic idea of Monte Carlo method, there are six key steps in calculating view factors: establishing the mathematical description of radiation rays and surfaces, determining the emitting position of rays, determining the emitting direction of rays, coordinate transformation, tracking and solving of rays, absorption and reflection of rays. Mathematical description of radiation rays and surfaces Radiation energy packet is modeled by geometric ray which is expressed as parameter equation. In the global Cartesian coordinate system, let the coordinate of the origin of the ray be The standard quadratic equation can be used to describe the vast majority of surfaces in a heat transfer system. Specific complex high degree surfaces can be decomposed into several parts, each of which is considered as a certain quadric surface. In Cartesian coordinates, the standard form of the surface equation is as follows: In order to distinguish the orientation of the surface, it is also necessary to determine the positive normal direction of the surface. For opaque surfaces, the positive normal direction of the surface is usually defined as the direction pointing towards space that the radiation ray travels to. For standard surfaces described in In addition, if the surface of an object is only part of the surface that equation Thus, the complete mathematical description of the surface of a real object is established by three parts: surface equation, positive normal direction, and boundary constraint. Determination of the emitting position of rays The emission point of the ray is determined by the corresponding probability model. The emission points of the surface with uniform temperature and emissivity are uniformly distributed. It is important to select the appropriate coordinate system of the emission points and construct the probability model of the emission point distribution according to the specific shape of the surface, which ensures uniform and random distribution of the sampling points of the emission points in the simulation. For planes, it is more appropriate to use a point on the plane as the origin of the local coordinate system of emission points, and its normal direction to be a coordinate axis such as or the For other plane shapes such as triangle and trapezium, the random sampling of the emission points can be carried out according to the rectangular plane, and then the points outside the boundary can be eliminated according to the boundary constraints. For a typical rotating surface such as a cylindrical surface, it is convenient to establish a probability model for the distribution of emission points in cylindrical coordinates. As the cylindrical surface shown in For some complex rotating surfaces, such as a space curved surface is generated by a plane curve rotating around the The coordinate Determination of the emitting direction of rays The direction distribution of ray of the diffuse surface agrees with the Lambert law. In the local spherical coordinate system where the ray emission point is the coordinate origin and the normal direction of the surface in the current point is radial direction, the probability model of the latitude angle Where, Coordinate transformation For each of the surfaces in a heat transfer system, complete the mathematical description using the local coordinate system according to its geometrical features, perform the sampling of emission points and directions, and then transform it into the form of the global coordinate system. Thus, when calculating the view factors using Monte Carlo method, it is necessary to convert the coordinates of the ray emission point, the direction vector and the surface equation between coordinate systems at different levels. Suppose the coordinate origin of a local coordinate system Where, Suppose that the coordinates of a point Suppose that a direction vector in the local coordinate system Tracking and solving of rays When tracking the propagation process of sampling rays between surfaces of objects, an important step is to determine the next surface and the specific position which the sampling ray is to reach after leaving a previous surface, that is, to solve the intersection points of rays and various surfaces in the heat transfer system. The paper determines these intersections with the following steps: Step 1: Solve simultaneously the parameter equation of a ray and all the surface equations of the heat transfer system, obtaining the Step 2: For an opaque surface, whether the ray is forward incidence is determined according to the vector Step 3: Determine whether or not the intersection points calculated by the parameter Step 4: Compare the distance between the origin of the ray and the intersection point corresponding to each parameter Absorption and reflection of rays When a ray (namely, a “packet” of radiation energy) is projected onto a surface, whether the ray is absorbed or reflected is depended on the surface absorption rate (equal to the emittance Experiment repetitively with the six steps above, and the number of tests depends on the number of rays taken. Error of calculation can be reduced by increasing the number of rays, thus the number of rays are usually more than 10 To validate the method developed in Section In the global coordinate system The emitting position and direction of rays on the cylinder surface can be determined by formulas (10) and (13). Thus we can obtain the direction vector of the rays in local Cartesian coordinate system, as follows: As for the cylinder, the transformation coefficient matrix in Finally, the parameter equation of each ray and the rectangular plane's equation are solved simultaneously and intersection points can be obtained. The number of all valid intersection point divided by the total number of random trials is the view factor for the cylinder to the rectangular plane. Similarly, the view factor for the rectangular plane to the cylinder can also be calculated by using the above Monte Carlo method or directly through the reciprocity relation of view factors. As for the system which consists of cylinder and rectangular plane with two edges paralleled to cylinder axis and of arbitrary length, there is no analytical expression for the view factor between the plane and the cylinder. But the view factor can be easily calculated by the above Monte Carlo model. To verify the model, the view factor for finite-length cylinder to rectangle with two edges paralleled to cylinder axis and of length equal to cylinder is calculated by analytical expression [  In general, the Monte Carlo model is reliable and could be used to calculate accurately view factor between rectangular plane and parallel cylinder. Because surface equation of torus is more complex, there is no analytical expression and graph of view factor between torus and rectangular plane. In this paper, the Monte Carlo method is used to establish the calculation model of view factor between torus and rectangular plane for the first time. The Monte Carlo calculation models of the view factor The configuration of torus and rectangular plane is shown in In this paper, to facilitate the calculation of the view factor, the 3D torus is seen as a combination of outer semi-torus (see The surface area The positive normal vector for exterior of torus is expressed as At the same time, from According to At the same time, the torus of Let The emitting direction of rays on exterior of the torus can be determined by formulas (13). And thus, the direction vector of rays in local coordinate system can be obtained. For the torus, the transformation coefficient matrix in The parameter equation of each ray and the rectangular plane's equation are solved simultaneously and intersection points are obtained. The number of all valid intersection point divided by the total number of random trials is the view factor Similar to Section Because view factor between torus and rectangular plane has not been reported at home and abroad, this paper puts forward to verify the above Monte Carlo calculation model by reciprocity relation of view factors. According to the reciprocity relation, view factors As described in In radiant tube heating section of continuous annealing furnace, the key to establishing the strip heat transfer model is to obtain the exact the view factors between W-shaped radiant tube and strip for calculate the amount of radiative heat transfer. So far, there is no literature on the calculation of the view factors between the W-shaped radiant tube and strip considering the complex geometric structure. In a variety of strip heat transfer models that have been published, the heat transfer systems between radiant tubes and strip have been simplified. For example, Dou [ In continuous annealing furnace, the configuration of cold-rolled strip and W-shaped radiant tube is shown in Using the Monte Carlo calculation model, the view factors between cold-rolled strip and W-shaped radiant tube can be calculated for different geometric configurations, as show in  According to the actual conditions, the calculated view factors between cold-rolled strip with different width and W-shaped radiant tube by this Monte Carlo model are shown in Nos. 1–25 of The view factor for W-shaped radiant tube to whole cold-rolled strip has been obtained above. However, the gross heater-to-strip view factor does not see whether the heating in the width direction of the strip is uniform. Whether center overheating, or edge cooling were also important factors that have to be considered in strip mill design. Therefore, the view factors This paper gives a detailed account of setting up the Monte Carlo calculation models of view factors between some complex surfaces. The main purpose is to calculate precisely the view factors between cold-rolled strip and W-shaped radiant tube in continuous annealing furnace. Given the advantages of Monte Carlo method in calculating view factors of complex geometry systems, it is used to establish calculation model of view factor between the strip and radiant tube. In this model, the W-shaped radiant tube is divided into cylinders and semi-torus, and thus the view factor of cold-rolled strip (namely rectangular plane) to W-shaped radiant tube could be calculated by view factors for cold-rolled strip to cylinder and for cold-rolled strip to semi-torus according to the superposition rule of view factors. And the view factor of W-shaped radiant tube to cold-rolled strip could also be obtained according to the reciprocity relation of view factors. Therefore, this paper firstly develops the Monte Carlo calculation model for view factor between rectangular plane and parallel cylinder. The verification result of analytical expression shows that the view factors calculated by the Monte Carlo model are very close to the analytical solutions, and when the view factors exceed to 0.01, the relative errors of the analytical solutions and Monte Carlo results are stable in the small range of ±2%. Meanwhile, the Monte Carlo calculation models of the view factor for torus to rectangular plane and the view factor for rectangular plane to torus are established separately and verified by reciprocity relation of view factors. The result reveals that the two view factors can meet the reciprocity relation, and so it is concluded that this model is reliable. Then, based on the above models and actual stucture, we establish the Monte Carlo calculation model for view factor between the strip and W-shaped radiant rube for the first time. And by using the model, the view factors between the whole strip and W-shaped radiant tube could be calculated precisely for different geometric configurations, and local view factor varied with position across the strip plane could also be obtained. In summary, the Monte Carlo method is effective in calculating view factors between the complex surfaces: rectangular plane and parallel cylinder, rectangular plane and torus, cold-rolled strip and W-shaped radiant tube in continuous annealing furnace. The following is the supplementary data related to this article: Supplementary data related to this article can be found at