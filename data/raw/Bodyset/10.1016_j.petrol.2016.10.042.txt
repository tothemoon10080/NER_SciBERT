Cyclic steam stimulation (CSS) is one of the more popular EOR techniques due to the existence of giant heavy oil reserves existing in different parts of the world. Numerical reservoir simulation plays a critical role in investigating the mechanisms and optimizing field development strategies of CSS processes. An artificial neural network (ANN) based model is considered to be a powerful subsidiary tool of high fidelity models for its fast computational speed and reliable prediction capability. This work focuses on the development of a robust surrogate model as a screening/design tool for cyclic steam injection processes using artificial neural network technology.
                  The major contribution of this work includes training of the ANN model using a network topology optimization workflow to help the ANN better understand the complex data structures that are encountered in such processes. The developed ANN model successfully incorporates rock-fluid properties such as relative permeability and temperature dependent viscosity as input parameters together with the other relevant data. Last but not least, the network model utilizes a hybrid structure to adapt to the automatic cycle switching scheme that can be encountered in cyclic steam injection processes. The paper shows that the ANN model can be employed both as a classification tool and a nonlinear regression tool. The model is validated via extensive blind tests against high fidelity simulation models and can be used as a powerful screening and process design tool in global optimization of the process.Artificial neural network Viscosity coefficient A in Andrade's correlation Viscosity coefficient B in Andrade's correlation Cyclic steam stimulation ANN error function Gradient of the error function Hessian matrix Gaseous phase relative permeability at residual oil saturation, fraction Oleic phase relative permeability at irreducible water saturation, fraction Aqueous phase relative permeability at residual oil saturation, fraction The number of testing cases The number of output neurons Exponential coefficient for gas phase relative permeability curve in gas-liquid table Exponential coefficient for oil phase relative permeability curve in gas-liquid table Exponential coefficient for oil phase relative permeability curve in oil-water table Exponential coefficient for water phase relative permeability curve in oil-water table ANN prediction in backpropagation training Critical gas saturation, fraction Residual oil saturation in gas-liquid table, fraction Residual oil saturation in oil-water table, fraction Training target in backpropagation training Temperature, °F Weight matrices of the ANN model Viscosity, cp Thermal EOR plays a significant role in world's energy supply as significantly large heavy oil reserves have been discovered around the world ( The principal objective of this work is to develop ANN-based proxy models to study CSS process implementation in conventional oil sands. A commercial, high fidelity thermal simulation software, Computer Modeling Group® (CMG) STARS, is employed to model the cyclic steam injection procedures and generate synthetic production histories as the knowledgebase to train the proxy models. The reservoir model of this work focuses on a drainage-area-based reservoir with a vertical CSS well as the minimum simulation unit. The model inputs include spatial reservoir properties, initial conditions, rock and fluid properties and engineering design parameters used in the process implementation. In order to include the relative permeability tables and temperature dependent crude oil viscosity tables as variables; Corey's three-phase relative permeability and Andrade's oil viscosity correlations are employed to generate libraries of relative permeability and temperature-viscosity tables, respectively. The model predicts the oil flow rate and cumulative production profiles. An in-house ANN training module is developed employing scaled conjugate gradient algorithm and is implemented to train the ANN models. In order to solve the sophisticated steam injection problems implementing ANN, a workflow is designed to train and test a large number of ANN models with various architectures (number of hidden layers, number of hidden neurons, transfer function, etc.). The ANN architecture yielding the best blind test performance is selected as the optimized ANN model. A parallel computation technique is employed to train and test multiple ANN architectures synchronically to boost the executing speed of the workflow. In line with the work flow discussed above, this work focuses on exploring the application of ANN to study cyclic steam injection problems. The CSS procedure in this work is designed in such a way that the CSS cycle will automatically switch when the oil flow rate in the production phase drops below a certain threshold value ( The developed ANN models are tested via extensive blind tests. The inputs of the blind testing cases are isolated from the training datasets for the proxy model. In the blind testing cases, the predictions of the proxy models show promising agreement with the results generated from a high fidelity numerical model. Thus, the developed ANN model could be considered as an expert system to study CSS procedures. From the results of this work, it can be observed that ANN is a powerful data mining tool to handle the sophisticated data structures such as presented in cyclic steam injection processes. The proxy models discussed in this paper are incorporated into a comprehensive ANN-based EOR screening toolbox. An easy-to-use graphical-user-interface (GUI) is developed to assemble all the proxy models and provide the users with a straightforward and visualized access to all the models developed in this work. The knowledgebase used to train the proxy models is generated with the help of a high fidelity numerical simulation model. Therefore, the singular importance of establishing an accurate base reservoir model for CSS processes cannot be overemphasized. The grid block dimensions of the simulation models are determined through a grid block sensitivity analysis. The input parameters of the simulation models include spatial reservoir properties, initial reservoir conditions, fluid properties, relative permeability coefficients and engineering design parameters. The reservoir models included in this work assume homogeneous characteristics in terms of permeability, porosity and thickness. A two-dimensional cylindrical grid system is employed to model a drainage-area-based reservoir with a CSS well ( As displayed in To validate the simulation model, the cyclic steam injection simulation model is implemented to match the production history of Well-804 of a cyclic steam injection pilot project in Los Perales Field, Argentina ( During the development phase, this work employs a thermal simulation software (Computer Modeling Group In order to consider the relative permeability tables as variables, this work employs generalized Corey's three-phase relative permeability correlation to generate a library of relative permeability curves as shown in Eqs. Water-oil curve: Gas-liquid curve: Following this approach, the relative permeability characteristics can be captured by 11 variables: k The variation of oil viscosity with temperature table is also considered as a non-linear function. In order to capture the temperature-dependent crude oil viscosity characteristics, this work employs the Andrade's correlation to generate a library of viscosity versus temperature tables (Eq. The oil viscosity -temperature tables could be developed by two parameters: AVIS and BVIS, which will be considered as two input neurons of the neural networks. The reference pressure and temperature values of oil viscosity table is assumed to be 14.7 An in-house ANN training model is developed employing scaled conjugate gradient method ( In Eq. Therefore, the essential of training of a neural network is nothing more than solving the system of equations represented as Eq. In order to eliminate the impact of the random weight initialization and early stopping on the evaluation of an ANN architecture, the training will be repeated for multiple times by shuffling the separation rule for training, validation and testing sets. The prediction performance of a certain ANN architecture will be evaluated by the average testing error of all the shuffled cases. For a certain training trial, the absolute average testing error % can be calculated from Eq. The prediction performance of the ANN strongly depends on the architecture which includes the number of hidden layers, the number of hidden neurons within each hidden layers and the transfer function applied to each layer. Finding the optimum combinations of the three key parameters via a manually implemented trial and error process could be extremely cumbersome. In order to address these issues, a workflow is designed to implement the parallel processing during the artificial neural network training ( In this work, for each of the ANN trainings, 500 random architectures are generated within the aforementioned design ranges and the data separation rule shuffles for five times for each architecture. In other words, 2500 training jobs need to be conducted in order to train each ANN tool. Conservatively estimating, if we assume that each training takes one minute, 2500 runs would take more than 41 As discussed in the previous section, the CSS process is designed in such a way that the cycles will automatically switch when the oil flow rate of the production phase drops to a threshold value. In this case, the number of CSS cycles is an unknown. This feature of the problem introduces strong nonlinearities, which make it challenging for an expert system to learn. In order to address this issue, a supervisory ANN model is developed as a classification tool based on the number of CSS cycles. Meanwhile, the entire dataset is clustered into sub-datasets based on the number of cycles as well. In this work, 2921 simulation runs are utilized to train the ANN models. All of these runs are utilized to train the supervisory ANN, and the number of data patterns included in training each sub ANN models are summarized in Once the expert system is developed, a certain set of input parameters is introduced to the supervisory ANN to predict the number of CSS cycles. Based on the predicted number of CSS cycles, the same set of input will be used with one of the sub-ANN models to predict the oil production profile. Ten sub-ANN models are developed to predict the oil flow rate profiles for CSS projects with 1, 2, 3, …, 10 cycles. Uniformly distributed pseudo random numbers are generated within the ranges summarized in Number of hidden layers: 1–4. Number of hidden neurons of each layer: 20–80. Transfer functions: tangent sigmoid function, logistic sigmoid function. For the CSS model applicable to conventional oil sands, the supervisory ANN model is tested using 71 blind testing cases. As is illustrated in The sub ANN models are trained and tested individually. It is worth to emphasize that the disparities between the oil production profiles predicted by sub ANN models and high fidelity model become increasingly large as the corresponding number of cycles increases. This observation can be explained by the nature of artificial neural network when adapting to a certain data structure. The sub ANN models predict the durations of the production period of each cycle and the oil production rates simultaneously. Therefore, the weights of the sub ANN models are justified to learn the data structure presented between the input and output in a generalized manner during the training stage. As the number of cycles increases in training various sub ANN models, the increments of the number of output neurons representing the oil flow rates become much larger than that of the output neurons representing the durations of the production periods, which indicates that the date structure becomes more and more dominated by the oil production rates. Therefore, the weights of the ANN models are updated more extensively relying on the generalization capability of the oil flow rates for sub ANN models with larger cycle numbers. As displayed in Hinton diagrams as displayed in Case Study I-A illustrates the utilization of the expert system as a CSS project screening tool. Suppose a reservoir engineer would like to implement a cyclic steam stimulation project to develop a conventional heavy oil field with reservoir properties summarized in The inputs of the desired case will be utilized by the supervisory ANN to predict the number of cycles and then one of the sub-ANNs will be used to predict the flow rate profile. Case Study I-B employs the expert system to calculate the production incremental of the CSS project. As displayed in The expert system can be implemented to conduct a Monte Carlo study to consider uncertainties associated with any of the input parameters. Suppose a CSS project is to be operated in a heavy oil reservoir. It is observed from the reservoir characterization report that the porosity values measured from well logs follow a Gaussian distribution with a mean value of 25% and a standard deviation of 3%. The permeability of the field follows a uniform distribution within the range of 800–1500 Altogether, 10,000 sets of input vectors are structured and used in the supervisory ANN to predict the number of steam injection cycles. In this article, we describe an ANN-based expert system which is successfully developed to study the cyclic steam stimulation process. In order to handle the high level nonlinearities introduced by the cycle switching operation of the process, a supervisory ANN is employed to act as a clustering tool to predict the number of CSS cycles. Sub-ANN models are individually developed to predict the oil production rate for number of cycles varying from one to ten. Blind tests are carried to test the performance of individual ANN models and expert systems in a hybrid manner. The promising error margins confirm the validity of the expert systems as powerful surrogate models to study CSS projects. The following conclusions are drawn from this study: The parallel ANN training workflow played an important role in developing all of the ANN models described in this work. The automatic ANN architecture sampling and synchronic training and testing workflow save extensive manpower and computational overheads. In a CSS implementation, extensive cyclic switching operations will take place. It turns out to be a successful protocol to address this issue by classifying the datasets based on the number of cycles and developing sub-ANNs to predict the production rate profiles. The supervisory ANNs in the CSS proxy models play a significant role which is related to the prediction accuracy of the oil flow rate profiles.