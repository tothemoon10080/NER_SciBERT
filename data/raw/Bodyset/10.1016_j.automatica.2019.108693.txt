In this paper, a novel hybrid control method is proposed to enhance the tracking performance of the Proportional–Integral (PI) based control system for a class of nonlinear and non-Gaussian stochastic dynamic processes with unmeasurable states. The system performance is presented by tracking error entropy as the system is nonlinear and subjected to non-Gaussian noises. The well-known kernel density estimation (KDE) technique is employed to estimate the entropy because the precise statistical property of noises is not available for many industrial processes. Since in many industrial cases gains of PI controllers are fixed, a compensative controller is designed without changing the existing closed loop PI controller. Moreover, the compensative signal is formed using the estimated states from the extended Kalman filter (EKF) and a nonlinear compensation realized by the radial basis function (RBF) neural network. The weights of RBF are trained to minimize the entropy of the closed loop tracking error. The convergence of RBF network is discussed and the stability of the resulting closed-loop control system is analysed in mean square sense. Finally, two numerical examples and a practical system simulation are given to illustrate the effectiveness of the proposed control method.Stochastic system control has attracted extensive attention in the last few decades. This is simply because most practical systems are generally subjected to random noises or disturbances ( Given the fact that PI controller is widely used in various industrial processes for its simple structure and strong robustness, recent studies of control performance improvement have mostly focused on the PI based control systems ( Since the conventional PI controller only uses direct output feedback, it is expected that the estimated state information can be used to enhance the tracking performance of the PI control system. In this respect, based upon the estimated states from extended Kalman filter (EKF) a variance-based performance improvement was proposed for a class of linear Gaussian stochastic systems in  The effectiveness of linear compensation would have limited use for nonlinear stochastic systems; Both process noises and measurement noises have been simply added onto the system equations. However, for practical processes, the noises could be involved in a more complex way; The noises are assumed to have known PDFs, which does not fully represent most practical systems. To address the above issues, this paper proposes a novel method to enhance the control performance of PI based control for a class of nonlinear and non-Gaussian stochastic systems without changing the existing PI controller. To address (1), in this paper a generic nonlinear compensator is proposed which uses an RBF neural network to realize the mapping between the estimated state from the EKF and the compensative signal to be added to the PI control output. To solve (2), the system considered is a class of general nonlinear systems where the noises terms are embedded in the nonlinear dynamics of the system. To overcome (3), the PDFs of the noise are assumed unknown here. In this context, the structure of the proposed control system is shown in Compared with our previous work in  The system considered is much general, which is a class of nonlinear and non-Gaussian stochastic dynamic systems with unknown PDFs of the noises. Unlike the linear compensative controller in There are less constraints of the noise part as the PDFs of noises in this paper are unknown, which is in line with industrial reality. The entropy of the closed-loop tracking error is estimated directly via KDE technique. The performance index has been improved by using information potential (IP) rather than entropy to reduce the computational load and by taking the mean value of tracking error into consideration for the shift-invariant property of IP.  Consider the following nonlinear stochastic system:  The reason that the noises are assumed with known covariance and zero means is only for the use of EKF. Therefore, the EKF will affect the closed loop system performance. As for the other part of the proposed algorithm, these assumptions are not necessary so long as noises are bounded and mutually independent. They can be either Gaussian or non-Gaussian. Their distributions are not necessarily known as the tracking errors entropy can be estimated by KDE technique. As shown in Different from our previous work  Use an EKF to estimate the state vector of the system, such an estimate will be used as the input to the RBF neural network compensator Find the weights Perform the relevant analysis in terms of convergence of the RBF neural network training and the closed-loop stability in the mean squared sense. Developed from the standard Kalman filter (KF), extended Kalman filter is regarded as a widely applied estimation algorithm for nonlinear systems. The procedure of EKF can be divided into two stages: prediction and update. Firstly, the prediction step is described as: It is clear that, compared with As shown in  The control objective is to choose an appropriate set of weight From Eqs. In order to calculate the information potential, the PDF With     There are various kinds of kernel function that can be chosen such as uniform, Gaussian, triangular, tri-weight and bi-weight ( The quality of estimation is usually determined by the bias and variance which are respectively defined as follows Therefore, the information potential of tracking error can be estimated using the Parezon window method. Since the entropy and information potential are shift-invariant, the mean value of the tracking error should also be a part of the performance index. By taking constraint to the input into consideration, the performance index is given by  If the system has more than one output, which means that In this case, the performance index can be formed as follows. In order to obtain joint information potential, joint PDF should be obtained first. Instead of using the normal KDE technique as we did for SISO systems, multi-dimensional kernel density function(MKDE) algorithm will be applied. Denote random vector In order to obtain the optimal weight Due to the strong non-linearity of the performance index, the above equation is hard to solve. Therefore the gradient descent based optimization algorithm is employed here to obtain the optimal weights. The optimization procedure is given as follows.  Initialize Obtain the gradient from If Weights Set  Note that the values of The procedure of the proposed algorithm has been summarized as follows:  Initialize the system parameters; Linearize the original non-linear stochastic system to design the EKF to estimate the state; Use estimated states to form nonlinear compensation function Estimate PDF of tracking errors using KDE technique; Calculate the performance index as Eq. Obtain the optimal set of weight Formulate compensative signal Calculate control input Set The performance index can be expanded as the following form around its optimal weight vector   The proof of The stability of the closed-loop system will be analysed in mean-square sense in this section. For this purpose, some assumptions and lemmas are given as follows.  The original system as Eqs.  The un-modelled dynamic of system  Notice that the only constraint of  Based on the convergence analysis on Section  System function  The following condition holds with a real positive constant Denote   Therefore, Eq. Similarly, to use Eq.   The proofs of The stability analysis can be divided into two parts. Firstly, the stability of closed-loop system will be discussed. Recall the newly defined vector Eq. Similarly, the representation of Therefore, the state space function can be expressed as   The proof of  The conditions in this theorem are related to the compensation signal, noises and set-point. They are all bounded and therefore these conditions can be satisfied in general. The states estimation stability in mean-square sense will be analysed in this subsection. Under   The proof of  This theorem uses two conditions that are related to the EKF in terms of its gain In this section, the proposed algorithm is tested on two numerical simulations and one practically related simulation to illuminate the effectiveness of the proposed control method. A MIMO system is also included. To demonstrate the effectiveness of the proposed algorithm, a numerical simulation is given firstly. For this purpose, consider the following nonlinear stochastic system: In addition, covariances of noises are selected as For this nonlinear system, the representation in Eq. The values of The simulation results are given in   The system can be represented as follows with Based on the twin-tank level process in practice, other parameters are identified as: In Eq. In order to show the different performance between the PI controller only and the proposed control strategy, the compensative signal is added after sampling instant reaches From these figures, one can see that the randomness of output has been reduced after the compensative signal is added. It can also be observed that the shape of tracking errors PDF becomes taller and sharper. Therefore, the proposed algorithm can achieve a better tracking performance compared with the PI only control. Compared with our previous results from  The following nonlinear stochastic MIMO system is employed to further demonstrate the performance of our proposed algorithm. The values of first group The simulation results are given in  A novel performance enhancement algorithm has been proposed in this paper for a class of nonlinear and non-Gaussian stochastic systems with unmeasurable states. Without changing the existing closed-loop PI controller, the compensative controller is designed using the EKF-estimated state and driven by the RBF neural network. Using entropy concept as a criterion, the optimal weights in RBF have been tuned and the randomness of the closed-loop tracking error has been attenuated. Besides, the compensative controller is proven to be convergent and the local stability of closed-loop system is analysed in mean-square sense. To verify the proposed control algorithm, some simulation results have been produced via two numerical examples and a practically related simulation case study.  Based on Eqs. Note that the Hessian matrix can be represented as Set The control algorithm can be considered as convergent as long as the following inequality is satisfied.  Based on Eqs.  Recall It can be further expressed as End of proof.  Under According to the above inequality, it can be seen that there exists a constant Also, it can be seen that there exists a constant  Firstly, we have Based the above inequalities, it can be concluded that