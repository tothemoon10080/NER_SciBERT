Bayesian inference has tremendous potential for thermal response test analysis, as it provides uncertainty metrics that are useful for the design of ground-coupled heat pump systems. The inference process is computationally heavy and has so far been limited to a few thermal parameters and under the unrealistic assumption of residuals’ independence. In this work, a new closed-form expression of the likelihood and an improved artificial neural network are used to speed up Bayesian inference and consider the strong temporal correlation of the residuals. This efficient strategy allowed the robust inference of the joint distribution of five parameters. Using data measured during a real test of 168 h, this work shows that it is possible to robustly identify the volumetric heat capacity of the ground and grout with an uncertainty of 16.3 and 13.8%, a significant improvement. For the specific data used, it is shown that with independence assumption, some parameters are clearly unrealistic, a problem not encountered when the correlation of the residuals is considered. The impact of the interpretation model, of the test duration and of the sampling frequency was also assessed and illustrated by the sizing of a ground heat exchanger. Results reveal that joint identification of some thermal parameters cannot be achieved reliably by the finite line source model, that duration of thermal response tests should be at least 72 h to avoid large uncertainties on the parameters, and that recording temperature every 2 min degrades the identification of the volumetric heat capacity.correlation range parameter [s] volumetric heat capacity [Jm covariance function [units distance between a pipe and the borehole center [m] pipe thickness [m] incremental short-term transfer function evaluated at the borehole outlet [–] mean short-term transfer function evaluated at the borehole outlet [–] distance or time difference between two points [units] borehole length [m] thermal conductivity [Wm number of residuals [–] Artificial neural network operator [–] vector of weights and bias of the ANN [–] probability density function [–] heating power [ radius [m] time [s] temperature [K] circulation flow rate in a pipe [m fluid velocity vector [m slice sampler width parameter [units] neuron input [–] vector of temperature residuals [K] transpose of the vector of temperature residuals [K] vector of observed temperatures [K] vector of simulated temperatures [K] neuron output [–] constants variogram function [units difference [–] model parameters [units] location of temperature probe [m] density [kg/m variance [K temperature covariance matrix [K temperature precision matrix [K activation function [–] model hyperparameters additional variables for ANN training location borehole current deterministic fluid grout pipe soil inner inlet infimum maximum minimum outer outlet initial condition supremum artificial neural network American Society of Heating, Refrigerating and Air-Conditioning Engineers finite line source model ground-coupled heat pump ground heat exchanger mean absolute error Monte-Carlo Markov chain probability density function thermal response test The need to decrease global greenhouse gas emissions and energy consumption had led to growing interest in efficient ground-coupled heat pump (GCHP) systems. Between 2010 and 2015, the worldwide annual energy use of GCHP systems increased at a compound rate of 10.3% per year, to reach 326,848 TJ in 2015 A TRT is usually analyzed by linearizing the infinite line source model To allow for the identification of a larger number of parameters and benefit from greater modeling flexibility than first-order methods, TRT interpretation can be treated as a multidimensional inverse problem. The approach consists of using an optimization algorithm chosen to minimize the residuals obtained when mimicking the TRT using an interpretation model. The various contributions differ in the number of parameters estimated (for example two As different combinations of the parameters near the optimum can lead to a similar fit Although the robust identification of ground and grout thermal conductivity is no longer a challenge, obtaining robust values for volumetric heat capacity and assessing its uncertainty remain an open problem. Several authors have reported unrealistic Choi et al. In addition to residuals’ autocorrelation, other factors impact the analysis of a TRT like the interpretation model used, the duration of the TRT and the measurement frequency. Impact of the interpretation model and of the measurement frequency on the robust identification of the parameters have not yet been reported in the literature. With a focus on the identification of the volumetric heat capacity, this work assesses the impact of these factors using a real TRT of 168 h with temperatures recorded every 30 s. A base case is first constructed that accounts for residuals’ autocorrelation, uses all temperature measurements and uses an accurate thermal resistance and capacity model (TRCM) for the analysis. Alternative scenarios are then obtained by relaxing one element of the base case at a time. The performances of the alternative scenario are then compared to the base case. The paper is structured as follows. First we review in Section The concept of Bayesian inference, that is, inference of the joint distribution of parameters given observed data, has been widely used in the fields of machine learning, engineering and geosciences. When applied to TRT analysis, Bayesian inference consists of inferring the joint probability distribution of thermal parameters (thermal conductivity, volumetric heat capacity, etc.) given a collection of observations and a set of fixed and error-free hyperparameters (borehole length, pipe radius, circulation flow rate, etc.). According to Bayes’ theorem: For a TRT, the evidence is a function of the thermal parameters, the heating power signal used during the TRT, the initial ground temperature and the circulation flow rate, among other parameters. It then becomes clear that evaluating the evidence is rather difficult, if not impossible. For a given TRT, The prior is the probability distribution that expresses our beliefs about the parameters The likelihood measures the compatibility of a set of observations and a given interpretation model. It is the joint probability evaluated at data values conditional to the model considered. In practice, both the model and the observations are prone to random and systematic errors, which must be taken into account to establish parameter uncertainty. If One of the most frequently adopted simplifications is to assume, as Choi et al. To improve uncertainty assessment and account for residual autocorrelation, we instead assume the residuals Markov chain Monte Carlo (MCMC) methods are used to sample directly from the posterior distribution The posterior probability A uniform value The interval A value The above algorithm can be extended to a multivariate case in various ways. When the posterior is multimodal with widely separated modes, the slice sampler can remain stuck around one mode if the width parameter The samples provided by the slice sampler are taken from the desired posterior distribution. They can be used to define joint confidence intervals for subsets of parameters and to compute a variety of useful statistics. Comparing the posterior distribution with the prior distribution reveals how useful the TRT data can be in determining the different parameters and helps identify parameters that cannot be reliably estimated by the TRT. It is also a good tool to test if new information (like temperature derivative or additional temperature probes) can contribute to identifying the parameters. Note that the samples obtained by slice sampling are by construction autocorrelated. For large A common practice to facilitate the computation of Eq. One model of interest is the exponential model. It has a nice Markovian property in 1D TRT temperature data are usually taken at regular time interval We derive the closed-form expression of the likelihood accounting for the particular form of the covariance matrix. To obtain the precision matrix From the previous equation, the determinant of the precision matrix can be found algebraically and expressed as: It is common in geostatistics The exponential variogram model has slope at the origin equal to Evaluating the likelihood The physical model used to assemble the training database is based on the heat transfer equation: To rapidly assemble an accurate database of g-functions, the simulation domain is discretized with thermal nodes using the thermal resistance and capacity model (TRCM) we previously developed A total of 53,000 GHEs were simulated with the TRCM. For each simulation, the g-functions were extracted at 17 locations (8 in each pipe and 1 at the base of the U-Bent), making it possible to assemble a database of 901,000 g-functions. The thermal parameters ( A few recent works have used ANNs to construct the short-term g-function of a single GHE The original ANN proposed in To linearize the input-output relationship and facilitate ANN training, a transformation is applied to the original g-function database. This transformation is expressed as: The original ANN we used was composed of two hidden layers of 100 neurons each. The new ANN uses a deeper architecture and is composed of an input layer of 19 neurons, 10 hidden layers of 50 neurons each and an output layer of 95 neurons. The hyperbolic tangent function is used as the activation function for the hidden layers, while the identify function is used for the output layer. Following standard practice in machine learning, the input and output databases were normalized between −1 and  + 1 to prevent saturation of the neurons and thus facilitate network training. To obtain the mean fluid temperature Using the approach we described previously To sample the parameters’ joint distribution, the methodology described in Sections A real TRT conducted in 2009 near Quebec City, Canada, was used for this research. The test was 168 h (7 days) long and was chosen specifically to assess the impact of TRT duration on parameter identification. During the TRT, fluid temperatures were recorded every 30 s by 11 probes having an accuracy of To specify the exponential covariance model that completely describes the autocorrelation of the residuals, the correlation range Note in Convergence of a Markov chain to a stationary distribution is problem-dependent and sensitive to the MCMC algorithm used to sample the posterior distribution. We tried some popular samplers, such as the Metropolis-Hastings and Hamiltonian Monte Carlo algorithms, but found that slice sampling was the most stable for our problem. Despite this choice, it was difficult to select the correct burn-in period and thinning factor. Some values worked well for the complete 168-h TRT but led to highly autocorrelated chains when applied to shorter 12- to 36-h TRTs. We performed several tests and found that a burn-in period of 10,000 samples and a thinning factor of 50 provided reliable chains with correlation ranges of just a few samples. Stable and reproducible Markov chains of 5,000 samples were obtained using those parameters and an initial draw The mean absolute errors ( We mention that to generate a distribution of only 5,000 samples, the posterior in Eq. The results of Bayesian inference for a 168-h TRT are illustrated in The joint probability density of ground thermal conductivity The distribution of the ground volumetric heat capacity The median of the thermal conductivity of the saturated quartz sand that filled the borehole ( The distribution of the volumetric heat capacity The marginal distribution of the pipe spacing For a 168-h TRT, the dispersion of the thermal conductivities To evaluate the impact of TRT duration on parameter identification, the duration of the initial TRT was reduced sequentially by 12-h increments. For each subsequent reduced TRT, a new correlation range  The thermal diffusivities The results presented so far were obtained assuming the residuals were autocorrelated. The common practice is, however, to assume independent residuals through a covariance matrix Comparing Volumetric heat capacity is tightly linked with short-term temperature variations, and it is likely that a low time resolution of the temperature is detrimental to its identification. To demonstrate the improvement achieved by using a high sampling rate, we decimated the original data set recorded at a time step of 30 s and we kept only the data recorded every 2 min. The decimated series mimics a temperature probe linked to a low frequency data sampler. The variance of the reduced residuals vector was the same at One can see in The results presented so far used the TRCM we developed as the interpretation model. Simpler analytical models, such as the infinite or finite line source models, are often used to analyze TRTs. However, such models neglect the GHE’s capacity and fluid advection, and assume a thermal steady state in the GHE that artificially accelerates borehole response. We used the finite line source model (FLSM) The results of inference with the FLSM are illustrated in It should be noted that we tried several strategies to improve these results and to obtain robust values for One of the goals of a TRT is to provide inputs to sizing software to reassure a designer about the validity of their design. The input parameters obtained in a Bayesian framework are uncertain by nature since they are described by statistical distributions. To illustrate the impact of parameter uncertainty on GHE design, we wrap up this paper by using the joint distributions obtained so far to size a GHE. This is achieved with the American Society of Heating, Refrigerating and Air-Conditioning Engineers (ASHRAE) sizing equation recently modified by Ahmadfard and Bernier The joint distributions shown in Uncertainty assessment in a Bayesian framework has tremendous potential for thermal response test analysis. Inference of the joint statistical distributions is computationally heavy, however, and usually accomplished using a simple analytical model and based on the assumption of residual independence. In this work, we used a detailed interpretation model and relaxed the independence assumption, as our data displayed strong temporal correlation of the residuals. The computational burden of the thermal resistance and capacity model was resolved using an artificial neural network. This strategy made it possible to accurately take into account the thermal capacity of the ground heat exchanger and the fluid residence time. The residuals correlation was modeled using the exponential covariance model, for which we derived a new closed-form expression of the likelihood that sped up computation by three orders of magnitude compared to the usual formula. We demonstrated that considering residuals’ autocorrelation has a substantial effect on estimates of all thermal parameters. The parameters’ estimates obtained considering the autocorrelation were pairwise less correlated (except for pair To assess the influence of thermal response test duration on inference, we varied the test duration from 12 to 168 h by 12-h increments. Our results indicate that parameter accuracy (measured by the median) is insensitive to test duration. On the contrary, parameter precision (measured by the confidence interval) increases with longer tests of up to 72 to 84 h, after which no additional improvement occurs. Whether or not these duration results are general enough to be extended to other thermal response tests remains to be verified. Since volumetric heat capacity is linked to short-term variations in fluid temperature, we investigated the effect of measurement frequency and of using the finite line source model, a simpler model that neglects the thermal capacity of the borehole and fluid residence time. Our results indicate that low measurement frequency and simple analytical models biased volumetric heat capacity estimations. Therefore, it is recommended to perform thermal response tests with a minimum sampling rate of one measurement every 30 s and to avoid using simple analytical models if an accurate estimate of the volumetric heat capacity is required. We noted, however, that even in the best scenario investigated, the thermal parameters To assess the uncertainty affecting the sizing of a ground heat exchanger and the improvement achieved in each case, we conducted a sizing exercise using the inferred distributions instead of a single deterministic set of parameters. Unsurprisingly, the uncertainty of the inferred parameters also results in appreciable uncertainty for the sizing. The resulting histograms are, however, instructive and provide an appreciation of design risk that is useful for real applications. For example, the simpler interpretation model resulted in a significantly longer ground heat exchanger, indicating that accurate interpretation models should be preferred for analysis of thermal response tests. The independence assumption provided a significantly smaller sizing than when considering autocorrelation. A smaller sampling frequency resulted also in a smaller sizing whereas short TRT duration resulted in more uncertainty about the size of the ground heat exchanger to adopt. To conclude, we proposed a new closed-form expression allowing fast computation of likelihood required in the Bayesian framework. An artificial neural network was also developped to compute extremely rapidly and accurately the g-functions of a sophisticated interpretation model. We showed that all the elements considered in our tests (duration of the test, residuals’ autocorrelation, sampling frequency and interpretation model) have an obvious effect on the robust identification of the parameters. For the first time, it is shown that considering residuals’ autocorrelation in Bayesian inference allows robust identification of the parameters and of their confidence intervals. Although based on a single thermal response test, our results suggest strongly that the independence assumption usually assumed is questionable and can have undesired effects on estimated parameters with possible consequences on the ensuing ground heat exchanger design.  The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper. The authors wish to thank the anonymous referees who reviewed this work and provided helpful and constructive comments and suggestions. This appendix briefly presents the modified ASHRAE sizing equation and the additional parameters that were used for the application presented in Section The g-functions were computed using a matrix approach