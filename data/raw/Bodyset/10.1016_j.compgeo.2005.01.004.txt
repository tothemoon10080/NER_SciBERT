Key block methods based on ubiquitous approaches have been widely used over the past 30 years to perform rapid analyses of rock mass stability. Although these methods have meant a great step forward, they only consider pyramidal key blocks.
                  This paper provides a new geometrical method for identifying both pyramidal and non-pyramidal key blocks in discontinuous rock masses for tunnel excavation. Using a ubiquitous approach, the non-pyramidal key blocks are determined by geometrical dislocation in relation to the advance in the direction of the tunnel axis. The blocks are parameterized with the advance and the block with the maximum volume is calculated.
                  We point out that non-pyramidal pentahedral blocks larger than the pyramidal tetrahedral may be found depending on discontinuity planes. These pentahedral blocks will never be obtained by truncation of a tetrahedral block.
                  The concepts introduced in this study have been implemented in the ASTUR computer program. Using this program, we select the orientation in which a tunnel must be excavated so as to generate the minimum number of large volume key blocks.
                  We conclude that identification of pyramidal and non-pyramidal key block are necessary when studying tunnel stability. It is not enough to analyze pyramidal blocks as is proposed in most of the ubiquitous approaches used nowadays.The mutual intersection of discontinuities in a rock mass divides the rock into fully and partially formed blocks of rock. If an excavation cuts through this assembly of blocks, new blocks may be formed at the excavation surface. Some of these “surface” blocks will have a shape that will allow then to fall or rotate into the excavation. These critical blocks determine excavation stability. Let us name these critical blocks as “ In order to understand how such an excavation may best be excavated, reinforced or supported, the assembly of blocks and key blocks must be investigated. The main aim of the key block method (KBM) is to geometrically analyze the distribution of different types of blocks in relation to discontinuity surfaces and to determine under which conditions these blocks may lose stability (from a The default KBM is based upon the assumption that key blocks are subjected to gravitational loading only. This means that the stresses on the joint planes are primarily a result of the self-weight of each block (as well as support forces, water pressure, seismic forces, etc). The actual stress field in the rock mass surrounding the excavation is not taken into account. While this assumption leads to a certain degree of inaccuracy in the analysis, it does provide a first estimating to structural stability without involving stress analysis. The KBM considers three modes of failure of rock excavations: block toppling, block sliding and block rotation. It does not consider rock mass deformability or any of the modes of failure of rock excavations such as squeezing or buckling. Blocks defined by the system of joint faces are assumed to be rigid. It is possible to identify key blocks by considering the direction of sliding and falling tendencies as well as the direction of resultant driving forces. A limit equilibrium analysis, involving friction and cohesion on the block faces, is performed in order to allow assessment of the corresponding mechanical status and determination of the safety factor. The mechanical status is related to the removability However, this limit equilibrium analysis lies beyond the scope of this paper. We shall only focus here on the geometric problems of key block identification. The KBM has been widely used over the past 30 years to conduct rapid analyses of rock mass stability. Three methods have been proposed by Warburton To determine the capacity of each method, it is important to see how the position of discontinuity planes is taken into account. These methods may be classified in two main groups   The differences between SA and UA have important consequences. In general, SA will not, without a large number of analyses, provide the complete range of possible block shapes. However, they do provide the sizes of the specific block generated within each specific analysis. SA methods are more suitable to numerical modeling (finite element or finite difference methods) with a particular block assembly studied in detail. UA can provide a large range of possible key block shapes but provide little information on the sizes of the possible block and shapes. UA methods are more suitable in design, since they allow for the estimation of the different types of blocks on the basis of the orientation of the excavation. These approaches are more useful for determining the key blocks of maximum volume, since these may mobilize a larger gravitational force and hence become critical when designing the excavation. Finally, probabilistic block analyses have been studied by many researchers SA have the same limitations for practical problems in the preliminary design of a tunnel excavation. Unfortunately, all the input data are not available until after the excavation has been created. All this suggested that UA might be useful in providing at least a partial solution for the pre-design of the excavation. In spite of the great step forward due to the use of UA, only key blocks defined from pyramidal polyhedral blocks have been studied (see However, non-pyramidal key blocks (NPBs) have not been analyzed in current UA. These NPBs are composed of different planes of discontinuity not intersecting at the same point and placed in such a way that at least two of the planes define a top edge.  These NPBs may be very large in volume, and they may be decisive in the stability analyses of the rock mass for a tunnel excavation. The aim of this paper is to generalize the current UA so as to take into account these non-pyramidal key blocks. The aims of the study are: To develop a method for identifying possible NPBs of the rock mass along a tunnel excavation. To work out the NPBs of the greatest volume. To study the orientation in which the tunnel must be excavated so as to generate the minimum number of large volume key blocks. This problem is sufficiently difficult that a series of simplifying assumptions must be adopted in order to obtain workable solutions. The principal assumptions are listed below: All the joint surfaces are assumed to be perfectly planar. Joint surfaces will be assumed to extend entirely through the rock mass under study. Required input parameters as fixed: The orientations and spacing of the joint surfaces. The orientation of the tunnel axis. The cross-section of the tunnel surface. The exact position of joint surfaces is not known in advance. Blocks defined by the system of joint faces are assumed to be rigid. A limit equilibrium analysis is assumed for single key blocks. We focus our study on NPBs formed by four sets of fractures (Section This study will be of importance for tunnel excavations, although a similar methodology could be applied to other kinds of excavations (slopes, rooms, etc.). All this will be illustrated with the results obtained from the computer program ASTUR ( Before starting to develop the present study, let us first synthesize the notation used to define the tunnel, rock mass and key blocks (see The tunnel is considered to be defined by its cross-section and its tunnel axis We define A local coordinate reference system ( Each A joint pyramid (JP) is defined as the polyhedral angle centered at the origin of the intersection of the half-spaces delimited by a set of discontinuity planes. To identify the different types of JP, Shi’s notation Characteristic pyramidal blocks (CPBs) are those defined by a Two edges of the JP surface must be tangent to the tunnel surface (see points T1 and T2). The rest of the edges of the JP surface must intersect with the tunnel surface (see points S1 and S2). The The base of the CPB is the intersection of the specific JP with the tunnel surface (see A NPB surface has two edges tangent to the tunnel surface and the rest of the edges of the NPB (except its dislocation top edge) intersect the tunnel surface (see A dihedral is the JP of two planes. The dihedral delimited by the two planes on the V-T1 edge may be named the fixed dislocation dihedron (FDD), whereas the one defined by the two planes on the V-T2 edge will be named the movable dislocation dihedral (MDD). This denomination is justified by the fact that due to the MDD moving in the tunnel’s longitudinal direction, maintaining the FDD in its fixed position, the NPB will appear due to both MDD and FDD dihedral intersection. Let us name this geometric tool (of dihedral displacement and intersection) Both the FDD and the MDD may be determined for a CPB ( We define the We define We define forward movement as the distance on the tunnel axis between the two tangent points T1 (FDD fixed point) and point T2d. Obviously, For non-pyramidal blocks, similar expressions to the JP notations will be used and preceded by the initials NPB, also adding the advance value at the end. Therefore, for an advance value The CPB will be generated by both fixed and movable dihedral intersections when the JPs are dependent on the discontinuity planes and independent of the shape of the tunnel. However, CPBs NPBs are dependent on both the discontinuity planes and the shape of the tunnel. In this section, we present our methodology for key-block analysis. We shall always refer to pentahedral blocks composed of four discontinuity sets. It should be pointed out that although the JPs are tetrahedral, each corresponding CPB and NPB will be pentahedral, since the four discontinuity planes have to be added to another surface: the JP and tunnel surface intersection. Basically, the process of key block identification and the safety factor calculation is carried out in five successive steps: The different blocks are determined by their JP and their edges are calculated (see Section The CPB is calculated for every JP determining its vertex and its CPB edges (see Section The NPBs are generated for every CPB in relation to the advance using dislocations (see Section A safety factor for the block of maximum volume of each JP is calculated considering the frictions and cohesion on the faces of the discontinuities. In those kinematically unstable key blocks, a bolted and/or shotcreted support is imposed in order to guarantee their stability. We then recalculate the new safety factor. In Step 3, we relate each NPB with its JP and with the dislocations of its CPB. This simplifies the study of the key blocks generated, and we name this process Finally, calculations of steps 4 and 5 are performed over the block of maximum volume of every JP, and a specific support is designed for each key block. The support will be able to stabilize smaller blocks as well. As previously mentioned, the limit equilibrium analysis with steps 4 and 5 lies beyond the scope of this paper; we shall only focus on the geometric problems of key block identification. For the present study, it is crucial to know the edges that compose every JP. This was done using Shi’s method The JP edges were obtained for four sets of joints. Let The next step is to compute the matrix For a selected JP (Eq. Then, for every JP we define the matrix T If Given a tunnel surface and a JP, there is a pyramidal block with the maximum volume that may fall into the gallery. We call this block CPB. The CPB will be formed by a This tangential condition will allow us to obtain the larger pyramidal block to be formed over the tunnel, since the Let us next see how the CPB vertex, edges and base are calculated. First, the projected vertex The vertex is obtained by projecting the four edges of every JP orthogonally over the reference plane Δ (see The block with the largest volume will be the one with its vertex The vertex Once the The tunnel surface is defined by a ruled surface of base composed of the point list The method for determining NPBs is based on considering two dihedrals, one fixed (FDD) and one movable (MDD), that may get dislocated (moved and intersected), thus generating blocks. We first present how such dislocation is brought about, and then how the number of NPBs is noted for a range of parameterized advance values. Finally, we indicate how the maximum volume NPB is determined, along with its corresponding critical advance, The CPB edges define the dislocation dihedrals as indicated in Section The concept of advance is introduced to generate the NPBs associated with each CPB. The MDD is displaced from T2 to T2d along the tunnel axis, a distance known as the advance (see The advance is the parameter used to identify the non-pyramidal key blocks. For an advance value of zero, a pyramidal block is generated and for intermediate advances, successive NPBs are generated. As can be seen, as the advance increases, the two dihedral intersections will form a non-pyramidal polyhedral shape characterized by a top edge If the advance value is negative, we thus obtain another series of NPBs associated with the CPB illustrated in Not all advance values can form a valid NPB. When the FDD and MDD intersection is null, there is no NBP. This defines a valid range of values for the advance magnitude. As can be seen in If we assign an advance Not all these blocks are equally important with respect to tunnel stability. In general, those with larger volumes produce more critical results. We study which value of advance ( The JPs of three or four planes usually generate larger keyblocks. The JPs made up of more planes (5, 6, 7, etc.) always generate smaller blocks. This is because it is always possible to obtain the derived blocks of a JP of more than four planes by truncating a block composed of a JP formed by three or four planes. Let us illustrate this for several hexahedral blocks. We define the CPB gap between points T1 and T2, but in order to also consider the new plane, point T3 in the figure has to be taken into account. Point T3 is the point where the fifth plane of the set, passing through A new gap is defined between T1 and T3, as well as a movable dislocation half-space (MDH) associated with the fifth plane of the joints set. This half-space (MDH) is initially located at point T3 and will keep changing its position along to the ruling line of the tunnel surface taking T3d positions. In The hexahedral NPB formed will usually have more than two dislocation top edges (  This reasoning may be extended to more than six planes ( Finally, it should be pointed out that non-pyramidal pentahedral blocks larger than the pyramidal tetrahedral may be found depending on the discontinuity planes and the tunnel surface. These pentahedral blocks will never be obtained by truncation of a tetrahedral block. That is why both kinds of pentahedral blocks analysis (pyramidal and non-pyramidal) are always necessary when studying rock mass stability. We shall see an example of this in Section All the concepts introduced in this study were implemented in the computer program ASTUR developed by the Ground Engineering Group at Oviedo University. Underground rock excavation design is currently being analyzed using this program to assess rock mass stability and establish the optimum tunnel advance criteria. We shall present an application of the program ASTUR in this section. The structural data correspond to a marble mine called ‘Can Sala’ situated 28 As previously mentioned, we shall only focus on the geometric aspect of the problem: To select the orientation in which the tunnel must be excavated in order to generate the minimum number of key blocks with a large volumes. The cross-section of the tunnel excavation is defined by the point list (units in meters): We consider a tunnel length of 20 The four joint sets that characterize the rock mass of the marble mine in the area under study are given in For this particular case, the vectors normal to each joint set are: Thus, the NPBs for these CPBs are calculated in relation to their respective advance. Considering a roof block (CPB   The above key blocks were obtained considering a tunnel direction of 35°, it is worth analyzing how the NPBs would change when the tunnel orientation   Pentahedral NPBs are not formed for values of 43° These limit angles of Similarly, another “ These curves are useful to select the tunnel orientation that generates blocks that are as small as possible. They also allow us to know which tunnel directions pentahedral NPBs are formed, and in which zones only tetrahedral blocks (shadow zones) are formed. It is also possible to determine for which As shown in We thus conclude that non-pyramidal pentahedral blocks need to be analyzed, since it is not enough to simply analyze the pyramidal tetrahedral blocks as is proposed in the majority of computer programs used nowadays (for instance, UNWEDGE Although we have only analyzed the geometric foundation of the ASTUR software in this study, it should also be added that safety factors with respect to every sliding block may also be calculated once bolting and/or grouting has been carried out, when necessary. In We should now address the limitations of ASTUR derived from joint spacing. Spacing between fractures is one of the most important geometrical parameters, besides orientation, size and shape, for determining block geometry. Using the UA, it is difficult to introduce the conditioning imposed by spacing since the exact position of the joint surfaces is not known in advance. The program ASTUR presents this shortcoming, and the effects of spacing are not taken into account in the previous steps of the process of maximum key block identification (see the steps 1, 2, and 3 of Section Various cases must be studied. If the spacing of all the joint sets is large, ASTUR provides the right solution (see In the case of a small spacing in the joint sets, the “ If the mode of failure is the one shown in If the mode of failure is the one shown in The program ASTUR only calculates the safety factor of these types of single key blocks (“real”, “virtual” or “truncated by one plane”), and is useful in providing at least a partial solution for the pre-design of the excavation. However, other cases of groups of blocks can be found which, considered as a whole, might in fact be unstable (see failure modes shown in Few authors have actually attempted to consider this problem. Wibowo A novel methodology has been developed to identify non-pyramidal blocks (NPBs) of a rock mass, introducing several geometric concepts, such as the characteristic pyramidal block and (fixed and movable) dislocation dihedral. Subject to the assumed simplifitions in this study, each NPB is identified in relation to the advance or geometric dislocation distances of both fixed and movable dihedrals. It is worth noting that, in general, the larger blocks generated for a JP are not pyramidal (NPB). In this study, such maximum volume blocks are determined by calculating the critical advance Although this study was developed for pentahedral blocks, we may conclude here that the blocks of several planes (hexahedral, heptahedral, etc.) will always be formed by introducing truncations over pentahedral or tetrahedral blocks, not allowing blocks that are larger than these to be formed. Therefore, safety is achieved if these blocks are studied and analyzed when designing the excavation and type of support. All these concepts make up the algorithmic base of the computer program ASTUR developed by the Ground Engineering Group at the Oviedo University. Underground rock excavation design is currently being analyzed with this program in order to assess rock mass stability and establish optimum tunnel advance criteria. The authors gratefully acknowledge the assistance of María Álvarez Rodríguez and Paul Barnes in the preparation of this paper in English. Thanks are due to the anonymous referees for their valuable suggestions.