Solution purification holds a critical position in hydrometallurgy. With its inherent complexity and the mixed raw material supply, solution purification process exhibits various working conditions, and has nonlinear, time-varying dynamics. At current stage, a comprehensive and precise model of a solution purification process is still costly to obtain. More specifically, the model structure could be derived by applying physical and chemical principles, while the accurate model parameters cannot be obtained under certain working conditions due to reasons like insufficient data samples. This, in turn, introduces obstacles in achieving the optimal operation. In order to circumvent the modeling difficulty, this paper proposes a ‘Process State Space’ descriptive system to re-describe the optimal control problem of solution purification process, accordingly establishes a two-layer receding horizon framework for developing a data-driven optimal control of solution purification process. In the optimal control scheme, on the ‘optimization’ layer, by utilizing the ‘multiple-reactors’ characteristic of solution purification process, a ‘gradient’ optimization strategy is proposed to transform the dosage minimization problem into obtaining the optimal variation gradient of the outlet impurity concentrations along the reactors. On the ‘control’ layer, a model-free input constrained adaptive dynamic programming algorithm is devised and applied to calculate the optimal dosages for each reactor by learning from the real-time production data. Case studies are performed to illustrate the effectiveness and efficiency of the proposed approach. The results and problems need future research are also discussed.Solution purification is a critical step in hydrometallurgical production of high-purity metals. As a widely used industrial technology, hydrometallurgy is referred to extracting pure valuable metals from their concentrate ores by liquid processes which typically include leaching (or roasting and leaching), solution purification and electrowinning ( The control objective of a solution purification process is to decide the optimal combination of additive dosages to each reactor such that the technical index is met in an economical manner, i.e., the outlet impurity ion concentration is lower than a predefined value, while the additive consumption is minimal. Model is a widely used reference to support the process operations and optimal control In order to realize the optimal control when the model parameters are unknown, this work is conducted to design a model-free optimal control framework for solution purification process. The optimal control problem of solution purification is first formulated. The difficulties in the modeling and control of solution purification process are analyzed. Based on the analysis, a ‘Process state space’ descriptive system is proposed to re-describe the optimal control problem of solution purification process. The equivalence between the conventional ‘state space model’+‘model based control’ and ‘process state space description’+‘model-free control’ is discussed. The model-free feature of adaptive dynamic programming (ADP) is utilized to circumvent the modeling obstacle. ADP updates the controller iteratively, through excitation and reinforcement learning, to obtain an admissible controller sequence which starting from an initial admissible controller and gradually converges to the optimal controller with guaranteed stability The rest of this paper proceeds as follows. Section This section gives further technical description of the solution purification process to provide a basis for formulating the optimal control. A solution purification process consists of several impurity removal processes or units connected in serial, each of which is designed to remove a particular type of impurity. As shown in Assume the solution in the reactor is perfectly mixed, the reaction rate and the solution temperature are uniform throughout the reactor. Then, the nominal kinetic model of the impurity removal process is The control of an impurity removal process is to determine the best combination of the additive dosages of each reactor according to the current inlet conditions and reaction conditions such that the technical index (the effluent impurity ion concentration of the  Fluctuant inlet conditions: As shown in Partially unknown process dynamics: The composition of the raw material is complex. Therefore, inside the impurity removal process, there are not only the controlled main reactions between the impurity and the additive, but also other side or parallel reactions introduced by other elements in the raw material. The side reactions can interact with the main reaction by competition or promotion. The kinetics of the main reactions is usually known. However, the dynamics of the side reactions and their interaction mechanisms with the main reactions are not thoroughly known ( In order to handle the uncertainties in Problem 1, this section proposes a ‘Process state space’ descriptive system to re-describe and transform the optimal control problem. Then proposes a data-driven two-layer receding horizon optimal control approach to decompose and approximate Problem 1 on two layers: pre-setting and control. On the upper pre-setting layer, by taking advantage of the ‘multi-reactor’ feature of impurity removal process, a gradient optimization strategy is designed to approximate the best variation gradient of impurity concentrations along the reactors. The pre-setting runs periodically to cope with the fluctuant inlet conditions. On the lower control layer, in order to circumvent the modeling uncertainty, the adaptive dynamic programming approach is adopted to approximate the optimal additive dosages of each reactor by learning from the online operation data. A widely used approach in process modeling is to describe the process dynamics using a set of differential equations, which is derived based on the chemical and physical principles indicating the relation between the ‘system state’ and ‘input variables’. However, in practice, the reaction conditions are not always the same with the conditions under which these principles were obtained. Moreover, these models are usually simplified and cannot cover all the influence factors existed in practical production. Therefore, the dynamics of an impurity removal process could be expressed as a combination of an unknown part and a nominal part (kinetic model of the main reactions) whose parameters change with the working conditions ( In order to cover more influence factors, the traditional ‘State space’ concept is extended to ‘Process state space’ in which the inlet conditions and the reaction conditions are taken into account.  The dynamics of a practical impurity removal process is a synthesis outcome of the interactions among the main reactions, side reactions, auxiliary system, as well as the preceding and subsequent processes ( Compared with the traditional state-space description approach Due to the slow time-varying nature of solution purification process, the system dynamics within a subspace, which is small enough, of the entire ‘process state space’ could be regarded as invariant. The ‘Physical space’ of impurity removal process could be coded and mapped into the ‘Process state space’. It can serve as a container for various sources of information, and a digital twin of the physical process. Meanwhile, it facilitates the interactions among modeling, observation and control, which increases the information utilization rate and gradually improves the control performance as well as the understanding of process dynamics. Taken together, this descriptive system is appropriate to deal with the complex and uncertain nature of industrial processes and provides a potential solution for process digitalization and visualization. Under the concept of ‘Process state space’, the original optimal control problem of the impurity removal process could be conducted in a moving-horizon manner. Inside each optimization interval, the system dynamics is considered to be invariant. Thus, Problem 1 equals to finding an optimal operation point P In the rest of this section, by taking advantage of the ‘multiple-reactors’ characteristic of solution purification process and the ‘model-free’ feature of ADP, the optimal operation point P The additive dosages of each reactor are of great importance to the production cost and purification performance. An excessive amount of additive is a waste of costly material, while an insufficient amount fails to remove the impurity adequately However, in practical conditions, not all the additive participated in reaction In order to formulate the total additive dosage of an impurity removal process, firstly consider a special case. Assume the impurity ion concentration of the inlet solution is Then under Assumption 1, for a single reactor: While the total additive dosage of an impurity removal process in unit time is: Denote As the reaction conditions inside each reactor are different, the AUEs of each reactor take different values. A feasible approach to decrease the additive consumption is to allocate more impurity removal task to the reactors with higher AUE, while assign less impurity removal task to the reactors with lower AUE. In addition, IRR is an external reflect of the reaction conditions inside the reactor. A stable IRR indicates the reaction inside the reactor is stable. So keep the IRR of each reactor in rational ranges is beneficial to maintain the stability of impurity removal process. Consider the economical benefits, the technical requirement and the stability request, if Assumption 1 holds, the optimal operation point P  Suppose at current optimization interval, the solution of Problem 2 is In this sense, solving of Problem 2 equals to find the optimal setting values of the outlet impurity ion concentrations of each reactor ( Solving of Problem 2 serves as an estimated economical optimization or a presetting of the optimal effluent impurity ion concentrations of each reactor. To realize the closed-loop control, the optimal controller should be derived by solving  Thus, a two-layer approximated optimal control strategy is proposed ( Radial Basis Function Neural Network (RBFNN) was selected to estimated the AUEs for its ability in approximate nonlinear relations The transformation from Problem 1 to Problem 2 is under Assumption 1 which is an ideal condition. However, in practical production, the system dynamics is slow time-varying. So Problem 2 need to be solved periodically in a receding horizon manner ( For Denote At each running period, the objective is to find a control law The control policy that minimizes the cost If the solution Existence and uniqueness of the solution of Choose an initial stabilizing admissible controller For Update the control law  0 ≤   See proof of Lemma 1and Theorem 1 in In the PI, it is assumed that The basic idea of the model-free PI technique is to improve the controller Thus for each Integrate In this design, The control policy In (25) and (28), As there are If Note that   This follows the same lines of reasoning of Theorem 3.1 in  According to Theorem 1, there exist There exist The closed loop system composed of The feasibility and performance of the proposed optimal control approach were tested through a computational experimental study — simulations. A cobalt removal process was simulated using the kinetic model The simulation interval was divided into four optimization intervals. It was assumed that the inlet conditions and AUEs are constant in each optimization interval: [0h, 8h), [8h, 16h), [16h, 24h), [24h, 32h). The switch of working conditions happens at 8h, 16h and 24h. In each optimization interval, the optimal control problem is This problem is then decomposed on two layers. On the upper layer, the optimal IRRs of each reactor were calculated first according to their AUEs. Then, the optimal IRRs were transformed into the optimal outlet impurity ion concentrations of each reactor. On the lower layer, ADP was utilized to derive the optimal control law by learning from the input-state data. When the learning period finished, the initial admissible control law was updated to the approximated optimal control law. The inputs of RBFNN were first determined according to the reaction mechanism and operators’ experiences. The process parameters that have an influence effect on AUE such as After the estimation of AUEs, the IRRs of each reactor are optimized by solving following problem The estimated AUEs The overall flowchart of the ADP algorithm is shown in In the initialization stage, the control algorithm is configured at first. The control objective was to find the optimal zinc dust dosages of each reactor thus to minimize the following performance index: The initial value of [1.50, − 0.530, 0.50, − 0.570, 0.25, − 0.630, 0.15, − 0.670] For the The learning interval was set as [0, 0.5h]. The sampling rate was every 30s. The iteration threshold was The simulation results are shown in Further, this study has found the following problems requiring attention in future research: Standard procedure to select basis functions and excitation noise: The selection of basis functions is a compromise between precision of the algorithm and simplicity of the controller. Generally, increase the number of the basis functions would improve the accuracy. However, too many redundant basis functions would increase the complexity of the controller and bring extra couplings into the system. Another problem found in this study is that the frequency and amplitude of the excitation noise affects the convergence speed. If ADP based on both historical and online data: Due to the slow time-varying characteristics of impurity removal process, the learning stage is much longer compared with fast processes. In order to account for the possible dynamic change during the optimization interval caused by external disturbance, a shorter learning time is required. Use the online data in combination with the historical data is an option to obtain enough ‘input-state’ information in limited time. Observer-based ADP: State information is required in ADP. However, in some industrial processes, the state information is not available online. Integrate ADP with observer to devise observer-based ADP is a topic to be studied in process control. ADP based model identification: ADP combines the features of both optimal control, reinforcement learning and adaptive control. Indirect adaptive controllers identify first the system model, which is then used to obtain the optimal control law In the main, the aims and objectives outlined in the abstract have been well explained with the insight of cross boundary understandings and analytically formulated and proved. The algorithms applied to the case studies are also demonstrated with a series of simulation tests — a type of computational experiments, the first level of tests from theory to applications. The data-driven two-layer approximated receding horizon optimal control approach, for solution purification process, is solely data-based while the controller still has a rigorous convergence proof. The proposed data-driven optimal control strategy is based on the model-free feature of ADP and the ‘multiple-reactors’ characteristic of solution purification process. The simulation results indicate that the approach could serve as a capable candidate when the process model is not available due to reasons such as lack of production data or large modeling cost. As the gradient optimization strategy is designed based on the ‘multi-reactor’ feature of solution purification process, the proposed approach could be extended as a standard option for a class of processes composed of multiple reactors. Secondly the ‘Process state space’ could be an open framework to contain various sources of information, including expert experience, system dynamics, online measurements, etc. Although in this study, the process model is not used in the optimal control design. The open nature of ‘Process state space’ could facilitate the interactions among modeling, control and estimation, which would incrementally improve the model quality and control performance. Furthermore, in the context of the 4th industrial revolution, a physical asset/process could be projected into the ‘Process state space’ which can then serve as a digital twin and play the role of a ‘cyber-physical’ interface in an Industrial Cyber-Physical System. However, at current stage, the concept of ‘Process state space’ is relatively rough. Many questions were found in this study, e.g., how to design the exploration noise, how to use the ‘input-state’ information to obtain online model identification, etc. Thus, further research is required to make the ‘Process state space’ based control approach more systematically and user-friendly. This would, in turn, enrich the control theory development in solution purification process and facilitate the construction of smart hydrometallurgy factories. This work was supported by the National Natural Science Foundation of China(Grant No. 61603418), the 111 Project(B17048), the Foundation for Innovative Research Groups of the National Natural Science Foundation of China(Grant No. 61621062), the State Key Program of National Natural Science of China(Grant No. 61533021) and the Major Program of the National Natural Science Foundation of China(Grant No. 61590921).