Over the last decade, major technological advances in X-ray computed tomography (CT) have allowed for the investigation and reconstruction of three-dimensional (3D) natural porous media architectures at very fine scales. Soil scientists can use the internal structure information to develop predictive models for a range of physical, chemical and biological processes in soil. Image segmentation and thresholding are crucial steps when applying these methods to extract complex pore space geometry information from images. Traditional thresholding algorithms face challenges related to the heterogeneity of soil samples, noise and artefacts introduced during the image acquisition process.
                  This study proposes a new segmentation method using local greyscale value (GV) concentration variabilities based on fractal concepts. Singularity maps were created to measure the GV concentration at each point. The C-V method was combined with the singularity map approach (Singularity-CV method) to define thresholds that can be applied to binarize CT images.
                  This study also introduces a new method for creating 3D synthetic soil images based on truncated multifractals that simulate low-contrast and non-bimodal GV histograms. A synthetic soil image was created with the objective to compare traditional segmentation methods (Otsu and maximum entropy) with the Singularity-CV method. We obtained better results in porosity and more amount of pores at all scales than traditional methods, although some small pores were incorrectly identified due to the ability to amplify every anomalous GVs. Misclassification error (ME) was low and similar to Otsu.
                  Two different 3D CT soil images were also used in this analysis, corresponding to samples of the same soil with 1.2 and 1.6gcm−3 bulk densities. After applying the Singularity-CV method to the GV images, the results were compared with the aforementioned traditional segmentation methods. The image comparison was based on the porosity, pore size distribution (PSD) and cumulative pore size distribution (CPSD). The Otsu method achieves a higher porosity than the Singularity-CV method because it defines the largest pores. However, the Singularity-CV method detected more pores at all sizes. The maximum entropy method always yielded the lowest porosity.In soil science, it is very important to characterize the spatial distribution of soil pore structures. The parameters obtained from this distribution provide the essential variables required as inputs in water flow models ( The first step in pore structure characterization is obtaining soil images that best approximate reality. Early studies used soil thin sections where 2D greyscale images were taken using different types of cameras. The main disadvantage of this method is that it is destructive in nature because soil samples must be mechanically sliced. More recent scanning techniques are based on 3D computed tomography (CT) images, which combine numerous X-ray images taken from different angles. CT-based methods have been applied to study soil structures ( The subsequent step in pore structure characterization involves delimiting the pore structure (pore space) from the CT soil images. Different delimitation methods can result in different spatial distributions of pores, which can result in substantial variation in the estimation of important parameters, such as total porosity or pore connectivity. Binarization methods are generally used to delimit the air-filled pore space in 2D and 3D CT soil images. A binarization method is a segmentation technique in which only two classes of pixels/voxels are distinguished. These classes include the foreground class of interest (in this case, the pore space) and the background class. To separate the pore space (object) from the solid space (background), the binarization relies mainly on thresholding methods ( A review of different threshold calculation strategies is provided by When we attempt to compare the performance of different segmentation methods, we can follow different strategies. One of them may be making independent measurements of porosity and pore size distribution. Independent methods for measuring porosity are: (i) calculation from bulk density, (ii) water saturation, and (iii) gas pycnometry. Independent methods for measuring pore size distribution are: (i) water desorption and (ii) mercury porosimetry ( Recently, some studies analysed the internal soil structure from a fractal point of view. Multifractal analysis (MFA) has been applied to greyscale soil images to determine parameters such as generalized fractal dimensions, singularity exponents and multifractal spectra ( In the context of detecting certain geochemical elements in mineral deposits, some studies applied a fractal approach to delimit the mineralized areas. The first studies to use such an approach were The goal of this paper is to utilize the geochemical anomaly detection methodology, based on the singularity 3D maps and the C-V method, to extrapolate the air-filled pore spaces in 3D CT soil images. This study can be considered an extension of the previous work by This paper also introduces an alternative method to create 3D synthetic soil images: the “Truncated Multifractal Method” (TMM). This new method is mainly based on enhancing the scaling nature of the pore space in the 3D synthetic images. This method was previously introduced by An arable sandy loam soil from a field in Scotland was packed into polypropylene cylinders with diameters of 6 The soil samples were imaged using a Metris X-Tek X-ray micro-tomography system at 160 Two image stacks of 260 In this section, we briefly describe two well-known global segmentation methods that are widely used in image segmentation: the Otsu method ( The Otsu method is a clustering-based thresholding method that assumes the existence of two clusters of pixels (bimodal histogram). These clusters are generally called foreground, or object, and background. The objective of this method is to establish an optimal threshold that minimizes the intra-class variance The maximum-entropy method is an entropy-based thresholding method that utilizes the entropy information of a greyscale distribution to calculate an optimal threshold. The maximum-entropy method does not specifically rely on a bimodal histogram; thus, it can be used with any distribution. In this case, we want to segment the histogram into two classes. This method maximizes the sum of the two class entropies (foreground and background). This total entropy A criterion that is used to compare segmentation methods when ground-truth information is available is the misclassification error (ME) ( The aim of the TMM is to construct a 3D synthetic soil image that is composed of a known amount of air-filled pores (hereinafter named pore space) and a background space, which includes, as a novelty, a pebble space. The pebble space simulates the pebbles or granules of high intensity that typically appear in 3D CT soil images. The steps used in the TMM are detailed as follows: i) A 3D randomized Sierpinski multifractal is used to construct both the pore space and the pebble space. Both spaces are built by truncating a Sierpinski multifractal. Before truncating, a low-pass filter is applied to the multifractal measure, with the aim of transforming the measure into a smooth function. The pore space is created by truncating the multifractal using a threshold or level of 1 ( ii) We define the average GVs of the pore, the background and the pebble space. Therefore, the skeleton of the final greyscale histogram is defined at this stage. When these GVs are close to each other, unimodal and low-contrast histograms, which are characteristic of 3D CT images, are produced. iii) Gaussian white (GW) noise is added with the aim of simulating the variability of the soil. Different signal-to-noise ratios (SNRs) may simulate different levels of variability. At this stage of the method, we simulate a 3D synthetic soil image with high resolution. iv) The previous image is filtered using a simple low-pass filter. In this manner, a spatial noise correlation is induced. The effect is a reduction in the image resolution, which is a characteristic of the 3D CT images. Singularity maps are often used by multifractal measures. A multifractal measure The singularity map is the graphical representation of singularity exponents We can distinguish positive singularities when α( If the spatial variability of the exponent α( We can also define the “concentration” or “density” of a measure When a statistical variable follows a fractal model, power-law relationships can be identified due to the intrinsic properties of self-similarity. These power-law relations are illustrated by the linear segments in log-log plots. The appearance of several linear segments suggests the existence of different sets with fractal properties. The C-A method ( The concentration is related to singularity exponents through Eq. The C-A method determines the concentration or singularity exponent values (slope-change points in the log-log plot) that can be used to define thresholds within a spatial-dependent concentration variable. The C-V method is an extension of the C-A method that can be applied when concentration is defined in a 3-dimensional space, The Singularity-CV method is mainly based on the application of a fractal model to the morphogenesis process of soil. The spatial variability of matter concentrations (solid and pore parts) are complex and irregular enough to justify this approach. Therefore, we expect that matter concentration variables exhibit self-similar properties. The implementation of this method was performed using Matlab® R2013a as follows. 1) First, the greyscale image stack is transformed into a local concentration 3D map. To do so, 3D singularity maps are calculated. Singularity exponents reflect the concentration strength of each point of the image stack. We start by defining a measure μ over the image stack. The most straightforward definition of a measure for a cube set V( We use the 3D windows-based method ( The side The 3D singularity map provides information about two well-differentiated volumes. The first is the volume with voxels that satisfy α 2) Next, we apply the concentration-volume (C-V) method. We calculate cumulative distributions of α( We define the volume as the number of voxels. When we obtain log-log plots, linear segments (power-law relationships) appear with the respective slope-change points. At this point, we cannot accurately locate the positions of these points. Therefore, we solve this problem in the following step. 3) In this step, we locate the slope-change points using the wavelet transform modulus maxima (WTMM) method (see appendix A). We take advantage of its ability to detect characteristic points in a function. We use a null second-moment wavelet called the “Mexican hat”. This type of wavelet detects points with local maxima curvatures. The WTMM method accurately locates all slope-change points that were obtained using the C-V method. 4) Finally, we choose the first slope-change point in the log-log C-V cumulative distribution that satisfies α We used one 3D synthetic soil image to test the Singularity-CV segmentation method. We also applied the new method to two real 3D CT soil images with different compaction levels and compared the results with the traditional Otsu and maximum entropy segmentation methods. We show an example of a 3D synthetic soil image using the TMM with a GV range from 0 to 255. A 3D randomized Sierpinski multifractal was obtained using a multiplicative cascade process (see First, a statistical analysis was performed using the GVs of the synthetic and two real soil samples; 3D images and their respective GV histograms are displayed in We can see two main differences between the synthetic and the real soil GV histograms: i) the GV histogram for the synthetic sample is more pointed and ii) the GV histogram has more values close to 0 than the real ones. The appearance of the histogram of the synthetic soil can be modified by changing the initial probabilities in the Sierpinski multifractal, including changing the SNR or selecting new low-pass filters. Comparing the two real GV histograms, we find that sample 1 contains a significant amount of GV equal to 0, a mean value much lower than that of sample 2 and a variance greater than that of sample 2. These significant differences, and the large kurtosis in sample 2, confirm that sample 2 has a more unimodal histogram than sample 1 with a smaller spread of values due to higher sample compaction. 3D singularity maps obtained for all samples are shown at the top of SV histograms are shown at the bottom of In the singularity 3D map of sample 1, a large greenish zone ( The top of Fractal models generally show power-law relationships in the analysed variables. Such relations are visualized by linear segments in log-log plots. The model will be considered monofractal if a unique linear segment appears ( As was explained in the methods section, we are interested in the first slope-change point of the depleted volume ( The thresholds obtained by the Singularity-CV method were We compared the Otsu, maximum entropy and Singularity-CV segmentation methods with respect to a 3D synthetic soil image. In The Otsu's threshold obtained for the synthetic soil image was The porosity was calculated based on the binarized images shown in PSDs and CPSDs were obtained from the binarized images of Regarding the shape of the graphs shown in The Otsu and maximum entropy methods have very similar CPSDs (bottom of The Singularity-CV method also underestimates the total number of real pores, as seen in the CPSD (bottom of The criterion used to assess the quality of segmentation was the ME parameter. This section presents the results obtained by comparing the Singularity-CV method with the Otsu and maximum entropy methods. The Otsu's thresholds obtained for sample 1 and sample 2 were  Porosity and various parameters of the PSD, such as the maximum, median and mean pore sizes, were obtained to compare the performances of the analysed segmentation methods ( In sample 1, porosities of 15.76%, 11.03% and 15.35% were obtained for the Otsu, maximum entropy method and Singularity-CV methods, respectively. The most notable statistic is the maximum pore size (max-pore), which has values of ≅ In sample 2, porosities of 64.26%, 2.67% and 5.03% were obtained for the Otsu, maximum entropy and Singularity-CV methods, respectively. The max-pore values are ≅ The PSD plot of sample 1 (top-left graph of The PSD plot of sample 2 (top-right graph of The higher the accuracy when defining the pore space, the larger the computational demand required to binarize the image. In general, local thresholding methods use more computational time than global methods because they must perform calculations locally. In this study, the analysed samples contain 246 The use of CT images has proven to be an excellent approach for conducting pore structure analyses in soils. However, low contrast at the pore-solid interface hinders the use of CT images. This disadvantage, together with the existence of unimodal greyscale histograms, can inhibit traditional segmentation methods. The Singularity-CV method addresses these two difficulties using two approaches. First, the image contrast is improved by transforming a concentration map (greyscale values) into a singularity map (singularity exponents). The singularity map amplifies the local concentration behaviour, which increases the contrast of every voxel. Second, issues associated with unimodal histograms are overcome by using a model that assumes the existence of fractal properties in the spatial concentration distribution. This approach is known as the C-V method, which has been previously demonstrated as an effective method for mineral detection using geochemical concentration maps. Based on our results, some concentration areas were distinguished in the singularity maps that were not visible in the greyscale maps. Consequently, the contrast of the CT images was substantially improved. The C-V method also demonstrated that the spatial distribution of the singularity maps follows a fractal model. We identified linear segments in the log-log plots of both samples, demonstrating the existence of self-similar properties in the SV variable. The slope-change points allowed us to define the threshold between the pore space and the solid space. This paper also proposes a new method for creating 3D synthetic soil images, which is referred to as the Truncated Multifractal Method. This method is able to replicate the scaling nature of the pore space and can simulate low-contrast images with non-bimodal histograms, which is characteristic of 3D CT soil images. In the case of the 3D synthetic soil image, the Singularity-CV method obtained the porosity closest to the ground-truth porosity. It extracted fewer pores compared with the real values but detected more pores at all scales than the analysed traditional methods due to its ability to amplify anomalous concentrations. Regarding the ME parameter, the Singularity-CV method offered the same level of quality as the Otsu and maximum entropy methods. In the case of the two 3D CT soil images, the Singularity-CV method detected more pores at all sizes. In the low-density soil sample, Otsu's method obtained the largest max-pore value; however, the Singularity-CV method was able to detect more borders based on the amplification of details, which was due to a singularity transformation. In the second soil sample, which had a much higher density, we observed that the C-V method was able to determine an effective segmentation threshold despite the unimodal GV histogram. By contrast, Otsu's method failed to calculate a global threshold. Further work is now required to study the air-filled and water-filled pore space of the analysed images. It is also necessary to improve TTM for a better approximation of real the GV histograms of 3D CT soil images. We observed that the Singularity-CV method can detect more pores than conventional methods, mainly due to its ability to amplify anomalous concentrations. In future works, it will be necessary to discriminate between previously correctly and incorrectly detected small pores to improve the method as small pores could influence some physicochemical properties of the pore network in several simulation models. The Singularity-CV method is mainly based on the fractal properties of soils; therefore, it will be necessary to check if the assumption of self-similarity holds true for other soil types. Authors thank to SIMBIOS team, University of Aberday, for the soil image given for this study. We are grateful to the reviewers and the editor's comments that improved the quality of this manuscript. This research has been partially funded by the The continuous wavelet transform (CWT) of a function To study the local regularity of a function with the goal of finding singular points, it is necessary to use a wavelet with vanishing moments, i.e., In this case, we can interpret the CWT as a multiscale differential operator of order n. Mallat's theory ( The WTMM method has proven to be an effective method for locating singular points in a function (