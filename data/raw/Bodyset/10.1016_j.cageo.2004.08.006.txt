A probabilistic solution to the problem of spatial interpolation of a variable at an unsampled location consists of estimating the local cumulative distribution function (cdf) of the variable at that location from values measured at neighbouring locations. As this distribution is conditional to the data available at neighbouring locations it incorporates the uncertainty of the value of the variable at the unsampled location. Geostatistics provides a non-parametric solution to such problems via the various forms of indicator kriging. In a least squares sense indicator cokriging is theoretically the best estimator but in practice its use has been inhibited by problems such as an increased number of violations of order relations constraints when compared with simpler forms of indicator kriging. In this paper, we describe a methodology and an accompanying computer program for estimating a vector of indicators by simple indicator cokriging, i.e. simultaneous estimation of the cdf for K different thresholds, 
                        
                           {
                           F
                           (
                           u
                           ,
                           
                              
                                 z
                              
                              
                                 k
                              
                           
                           )
                           ,
                           
                           k
                           =
                           1
                           ,
                           …
                           ,
                           K
                           }
                        
                     , by solving a unique cokriging system for each location at which an estimate is required. This approach produces a variance–covariance matrix of the estimated vector of indicators which is used to fit a model to the estimated local cdf by logistic regression. This model is used to correct any violations of order relations and automatically ensures that all order relations are satisfied, i.e. the estimated cumulative distribution function, 
                        
                           
                              
                                 
                                    
                                       F
                                    
                                    ^
                                 
                              
                           
                           (
                           u
                           ,
                           
                              
                                 z
                              
                              
                                 k
                              
                           
                           )
                        
                     , is such that:
                        
                           
                              
                                 
                                    
                                       
                                          
                                             F
                                          
                                          ^
                                       
                                    
                                 
                                 (
                                 u
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 ∈
                                 [
                                 0
                                 ,
                                 1
                                 ]
                                 ,
                                 
                                 ∀
                                 
                                    
                                       z
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                 
                                    and
                                 
                                 
                                    
                                       
                                          
                                             F
                                          
                                          ^
                                       
                                    
                                 
                                 (
                                 u
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 
                                    ⩽
                                 
                                 
                                    
                                       
                                          
                                             F
                                          
                                          ^
                                       
                                    
                                 
                                 (
                                 u
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       ℓ
                                    
                                 
                                 )
                                 
                                 
                                    for
                                 
                                 
                                 
                                    
                                       z
                                    
                                    
                                       k
                                    
                                 
                                 <
                                 
                                    
                                       z
                                    
                                    
                                       ℓ
                                    
                                 
                                 .
                              
                           
                        
                     
                  
                  A case study, in which an optimal spatial sampling strategy is required for environmental monitoring, is used to demonstrate the methodology and the use of the program. The purpose of the sampling is to determine the spatial extent of a specified phase (e.g. areal distribution of a pollutant or contaminant). The sampling is sequential with a new sample being added to an existing network at each step of the procedure. The optimal locations for additional samples are determined from two maps (provided by the indicator cokriging program): a map of the probability of belonging to the specified phase and a map of the associated estimation variances. Optimality is achieved by minimising simultaneously the uncertainty of belonging to the phase and the variance of the error of estimating the uncertainty, thus guaranteeing that maximum information is gained from additional samples.As pointed out by It makes no distributional assumptions: the procedure is non-parametric and distribution-free. The procedure is resistant to outliers. It provides a complete solution to the problem of estimating the value of a variable at an unsampled location. The indicator approach provides an estimate of the cumulative distribution function (cdf) (actually a discrete representation for a finite number of key values known as thresholds) as opposed to the traditional kriging approach which gives just two values (the estimate and its estimation variance), The procedure can accommodate high connectivity of extreme (low or high) values. The correlation of high values may differ significantly from the correlation of low values, which cannot be accounted for by Gaussian-type techniques. The indicator approach for a continuous random function, Selection of For each threshold All the indicators are assumed to be spatial, second-order stationary random functions and thus the expectation of the indicator random function for a given threshold is the cdf for that threshold: The values of the indicator variables are known at all locations at which a realization of the random function, The indicator semi-variogram, A theoretical model is fitted to each experimental indicator semi-variogram and cross-semi-variogram. The linear coregionalization model ( Indicator kriging provides an estimate of the cdf at an unsampled location for a given threshold Although indicator cokriging is theoretically the best estimator in the least squares sense, There are several indicator kriging algorithms available including: simple (ordinary) indicator kriging ( indicator principal component kriging ( median indicator kriging ( indicator cokriging ( adjacent cut-off indicator kriging ( In brief, indicator cokriging is the best estimator of the cdf that can be found in the vector space generated by the experimental data ( By using vector indicator cokriging, the vector of the A description of indicator cokriging can be found, From a theoretical point of view, In our practical applications we have found no significant differences between cdf estimates generated from indicator cokriging and indicator kriging. Using our methodology, however, we have found that the number of order relation violations is less with indicator cokriging than with univariate forms of indicator kriging and there is an efficiency gain in generating an estimated local cdf that satisfies all order relations in a single solution of a system. In addition, vector indicator cokriging produces a variance–covariance matrix that can be used to fit a parametric model to the estimated vector of indicators by weighted least squares, i.e. taking into account the variances of the estimates and the correlation among them. At a given unsampled location    Note that The matrix of weights  The matrix The variance–covariance estimation matrix is given by: The estimates of the local cdf at In applying It should be noted that the preferred estimates are the non-parametric solutions to the indicator simple cokriging system in Eq. The procedure is outlined in The computer program COIK2DVE is written in ANSI Fortran-77 and has nine external subroutines as shown in sorts a vector of data in increasing order. calculates the product of two matrices. calculates the inverse of a matrix. It uses the subroutines LUDCMP and LUBKSB of calculates the LU decomposition of a symmetric matrix, the upper triangular matrix being equal to the transpose of the lower triangular matrix. calculates the inverse matrix by back substitution from the lower triangular matrix (from calculates the covariance value between two experimental locations in the plane. calculates the mean covariance value between a given location and a rectangular support. calculates the mean value of the covariance function inside a rectangular support. generates a pseudorandom number from the uniform distribution on [0,1], according to The input to COIK2DVE is a parameter file containing all information required by the program. The parameter file contains 18 records and an example is shown in The text entries in the right-hand side of The second record contains the number of thresholds. For the current dimensions specified in the program the number of thresholds is limited to 9. For The next record specifies the maximum number of data values to be selected within a given neighbourhood. In the kriging procedure a moving neighbourhood is defined for each estimation location and only data inside that neighbourhood are considered. The closest neighbours to the estimation location are chosen. The following record contains the minimum number of neighbours and the next record specifies the radius of the circular search neighbourhood. Any location with fewer neighbours than the specified minimum number is not estimated and the warning number The estimation grid is defined in the next three records of the parameter file. The first of these contains the coordinates of the first point of the estimation grid (location of the lower left corner, i.e. the most south-western location) for the The following record (line number 14 in The last four records contain names of data files. The first of these is the file that contains the models for the indicator covariances and cross-indicator covariances. An example (incomplete) of a covariance model file is given in The next record contains the name of the first output file in which the estimated cdf (coordinates of the location and estimates of the For the covariance models given in A simulation study is used to demonstrate the methodology as it allows an assessment of the complete realization of a random function (at a set of discrete locations) in a given domain and various sampling strategies can be tested against a known reality. A realization of a non-Gaussian random function was generated using the program sisim ( A plot of a simulated realization is shown in The simple indicator kriging estimate is equal to the indicator maximum likelihood estimate ( In this application the interest is in delineating the areal extent of a contaminant or, in more general terms, the delineation of the area in which a variable may have a value greater than a given tolerance level. Examples include chemical concentrations in groundwater or heavy metal concentrations in soils. In the simulated example the interest is in delineating the outline of values larger than the 0.9 quantile, which has a value of 10 units of the variable Assume that initially 60 locations are available, i.e. experimental points at which the variable has been measured. These locations are selected at random from the 6400 locations at which values have been simulated. The 60 locations are shown in It is assumed that the contaminated area can be broadly identified from this first randomly located sampling. The problem now is to design an optimal sequential sampling strategy with the purpose of delineating, as accurately as possible, the extent of the contaminated area. Sequential sampling means that the optimal location (in the sense defined below) is determined for one additional sample at each step of the procedure. The value of the variable at the new location is then measured and the newly acquired data value is incorporated into the original data file and the procedure is repeated to determine the optimal position for the next sample. A perfect sampling strategy is one that allows the exact boundaries of the contaminated area to be determined from only the sample information. In general, this is unattainable and there will be two types of error: non-contaminated zones that are classified as contaminated. contaminated zones that are classified as non-contaminated. Each of these errors incurs a cost (e.g. cost of unnecessary remediation for the first type of error and the cost of the consequences of not identifying the total contaminated area for the second type of error). These costs are not considered here and the objective is to identify as much of the contaminated area as possible (i.e. minimization of the second error) whilst minimising the first type of error (i.e. incorrect identification of the target). The sequential sampling procedure comprises the following steps (assuming that from the original sample the indicator variograms and cross-variograms have been estimated and that the Estimation by indicator cokriging of the local cdf at each experimental location of an estimation grid. (The location of the additional sample will be one of the estimation grid points.) Each local cdf is estimated at each of the The estimated probability density function is obtained from the estimated cdf by:  Assume that the class of interest is the The values of An alternative rationale is to note that the entropy of the local cdf will be maximum if all Obviously the estimated probability does not need to be exactly 0.5 at any particular location and optimal locations will comprise those that have an estimated probability within a given range, say, [0.47,0.53]. When there is more than one location inside the range the choice is made on the basis of the estimation variance. The program COIK2DVE also provides a map of estimation variances for the different thresholds, from which the estimation variance of the probability of belonging to the contaminated class can be extracted. From all locations for which the estimated probability is within the specified interval, in this example [0.47,0.53], the final optimal location for the additional sample is the one for which the estimation variance is maximum. This location maximizes the reduction in uncertainty in the classification and maximizes the reduction in the estimation variance conditional to being a location of maximum uncertainty. The variable is measured at the new location and its value is incorporated into the file of experimental data. The procedure is then repeated with the augmented data set. (The modelling inference could be repeated if desired, although it is unlikely to change significantly with just one sample. It could, however, be repeated after a given number of additional locations, say five, have been selected.) The estimated map shown The sequential sampling procedure was repeated until the sample size reached 80. With 80 samples the percentage of the actual contaminated area correctly identified as contaminated is 89% and 26% of the area designated as contaminated (2.6% of the total area) is incorrectly classified.  The sampling procedure described in The authors have described a coherent and efficient approach to the estimation of the local cdf by simple indicator cokriging and provided a programme, COIK2DVE, which implements the methodology. The program provides an efficient solution to the problem of local estimation by vector indicator cokriging. The estimation of the cdf provides a complete solution to the estimation problem, as non-parametric point estimates, interval estimates, measures of uncertainty and estimates of the probability that the variable is greater than or less than a given threshold can be read from the estimated cdf. The program estimates the cdf as a vector by solving a single system of indicator cokriging equations (at each estimation location), which, in tests, generates far fewer order relation problems than indicator kriging or scalar estimation in indicator cokriging. Nevertheless, order relation violations still occur and an automatic procedure of correcting these problems by logistic regression has been included in the program so that the corrections are made on the basis of a statistical criterion. The final estimated cdf, given by the program, is free of order relations problems. The estimation variance at each threshold is also provided. Although a Bayesian approach to indicator cokriging was considered (and the equivalent programs are available on request), no significant advantage was found in using otherwise appealing estimates such as the maximum entropy indicator estimate (median of posterior distribution) and the cdf estimated by the mode of the posterior distribution (i.e. simple indicator cokriging). An application to, and methodology for, optimal sampling in delineating the spatial extent of a phase of interest (e.g. contamination) has been described. The procedure is a sequential sampling that is optimal in the sense of simultaneously reducing the uncertainty of phase identification and the estimation variance of the indicator for the corresponding threshold(s). The program is written in ANSI Fortran-77 and can be readily adapted to particular needs. The work reported in this paper was funded by EPSRC (Engineering and Physical Sciences Research Council) Grant number GR/M72944.