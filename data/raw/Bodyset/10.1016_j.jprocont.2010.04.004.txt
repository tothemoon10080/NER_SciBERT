Control performance assessment or CPA is a useful tool to establish the quality of industrial feedback control loops, but in practice its usefulness is hampered by nonlinearities in the feedback loop. The Harris index is a popular and easily automated metric used to quantify performance of the loop. However, computing the Harris index simply ignoring common process nonlinearities such as valve stiction will lead to an over-estimate of the index, and consequently a false sense of security. In this paper, we propose two complimentary strategies for accurately assessing the quality of the control performance for loops suffering from modest valve stiction thus avoiding the bias inherent in the standard CPA calculations.It is perhaps not surprising that instrument and control engineers are overwhelmed by the sheer number of loops that need attention on any typical industrial processing plant. Many loops are mis-tuned, if tuned at all, as noted by audits Clearly this suboptimal state of affairs persists partly because the sheer number of loops makes it a substantial task to monitor and retune, and the fact that there are a number of possible reasons for a control loop to under-perform. CPA is applied in the refining, petrochemicals, pulp and paper, and the mineral processing industries as noted by In this paper, we will extend one of the more important techniques used to quantify performance indices to a common practical nonlinear problem—control valve stiction. It is now widely recognised that valve stiction is a common industrial problem In this work, we are not overly concerned with The danger is that under moderate valve stiction where perhaps the tell-tale limit cycle oscillation is buried under the process noise, and one performs a regular performance index calculation using the linear CPA techniques, one overestimates the quality of the performance. Consequently, the neglect of the nonlinear valve stiction phenomena causes a bias which leads the control engineers into a false sense of security. In the case of nonlinear systems, In The layout of the paper is as follows. In Section We assume the plant can be adequately modelled by Including the nonlinear function The common process nonlinearity afflicting control valves known as ‘stiction’ exhibits a range of nonlinear behaviours including hysteresis, backslash and deadzones. Excessive valve stiction is immediately recognisable by its limit-cycle signature as illustrated in the lower trends in To model the stiction behaviour, we have adapted the two-parameter model proposed by  If a process follows the form of Eq. Therefore, under minimum variance control, the terms The minimum variance performance lower bound (MVLPB), as measured in the mean square sense, can be written as While it depends somewhat on the specific plant and application, typically well-tuned loops operate with a Harris index between 0.5 and 0.7. Harris indices too low are of course a cause for concern indicating that the loop exhibits excessive variance and could stand retuning, or at least an inspection. Conversely Harris indices too high (i.e. close to 1) despite the fact that they indicate the loop is operating near minimum variance, are probably economically suboptimal when considering the service life of the actuator. As an aside, If the process in Eq. An obvious CPA strategy is simply to ignore the presence of the nonlinearity, and compute the MVPLB in standard manner assuming a purely linear system. Unfortunately if we do this, we incur a bias. To show this, let If we use a linear ARMA model in Eq. While one could identify the NAR model, the nonlinearity of interest, stiction, is non-differentiable, so strategies involving polynomial-ARX models as described in A semi-parametric approach is to remove the nonlinearity, The linear system with valve stiction described in Eq. A heuristic way to remove the nonlinearity caused by the valve stiction for the purposes of subsequently establishing the performance of the controller is by using some sort of local smoother such as a spline or a LOESS For this application we have employed a smoothing B-spline A potentially useful by-product of this methodology is that if we can separate the output into nonlinear and residual components, A statistical test for determining whether an observed stationary time series is linear was proposed by Hinich in If the series is Gaussian, its skewness is zero and its squared bicoherence is also zero. If however, the series is linear, its skewness and the squared bicoherence are constant, but not necessarily zero. These two properties are the basis for the Hinich Gaussianity and linearity tests. Due to the intractable nature of the nonlinearity, a Monte Carlo method is used to assess the reliability and robustness of the proposed method to estimate the minimum variance, If the spline fails to remove all the nonlinearity, then the estimate of the minimum performance lower bound will be larger than the true value. Conversely if the spline not only removes the nonlinear components, but also part of the linear dynamics, then the estimate will be smaller. An alternative strategy to compute the CPA for loops with poor valves is to exploit a unique characteristic of valve stiction thereby deftly bypassing the effects of the nonlinearity. Due to the stick/slip friction, the times when the valve is stuck fast gives the (stable) plant a chance to reach steady state and during these periods, we can use linear ARMA techniques to estimate the lower performance bound. The success of this strategy depends on how well we can establish that the system is behaving essentially as a linear system as introduced in The key problem is how to identify the steady state periods from the closed loop output data. Our approach includes two steps. First we use a heuristic pattern method to select the periods of steady state in the observable time series In many instances, the presence of valve stiction induces a limit cycle with a characteristic triangular shape in the controller output as is shown in the lower trends of Under the cycling conditions due to stiction, the scaled difference between Given that most industrial plants have a stable low-pass frequency response that attenuates high frequency noise, and that the plant measurement is disturbed by Once the periods of steady state are identified, an initial segment in each period is discarded so that the previous input effects will be removed. Then subsequently we can derive a minimum variance controller performance lower bound using these periods of data. The proposed strategy works best when the valve is stuck for relatively long periods allowing the (stable) plant to reach steady state. That is, periods larger than about 10 dominant time constants since we discard the first 3–4 to allow the system to reach steady-state, and then use the remaining data for the ARMAX model identification. Consequently we desire that the period of oscillation due to the valve nonlinearity is long compared to the settling time of the compensated loop and therefore we need to From the literature, and our simulation experience detailed further in Section Notwithstanding the expectation that the valve stiction nonlinearity exhibits little memory, we need to be assured that the selected period is in fact linear. As a final check, we can again apply the statistical test of linearity described in Section An automated procedure to establish the stuck periods relies on reliably identifying the maxima and minima of the sawtooth shaped An automated procedure to extract the steady-state periods first scans the sequence from the start time to the end time. If the process value at the start time is less than the mean value of  for the data given in Based on the zero crossing indicators, the local maximum or minimum points during each zero crossing period are identified. Between the two zero crossing indicators 0 and 1, the local maximum point will be found between the two times corresponding to two zero crossing indicators. The local minimum point will be found between two zero crossing indicators 1 and 0. Of course using such a heuristic approach, this simple algorithm is suspectable to false positives and correspondingly produces estimates of the steady-state periods shorter than the actual period. In cases of excessive suspected false crossings, standard techniques such as data smoothing or a Fourier identification of the dominant period could be applied to the noisy data series. However, since these erroneous short periods will not be used for the minimum variance calculation anyway, they do not overly deteriorate the quality of the computed result. They do however, lower the efficiency of the data use. To illustrate the two proposed methods to reliably quantify the Harris index in situations of modest plant stiction, we have chosen a simple single-input, single-output (SISO) plant with time constants 10 and 2, and steady-state gain of 3, sampled at Several output realizations from the process in Eq. This section illustrates the semi-parametric spline smoothing method proposed in Section The following development illustrates the specific case with a stiction model using From Given a suitable tolerance value, an ARMA model is identified to fit the residuals between the output and the spline curve. Finally To assess the reliability and robustness of the proposed strategy, a Monte Carlo method is used. The procedure is to: (i) obtain 1000 observations from the process; (ii) find the suitable spline curve to eliminate the nonlinearity, (iii) identify an ARMA model to fit the residual between the spline curve and observations and subsequently compute the estimate of Using the above procedures, the estimates of Harris indices with the above semi-parametric method for 6 different slip/jump stiction models are compared to the true values in The results from In this section, we will use the same plant and noise as in Section In all cases we are most interested in the ‘islands’ of high periods apparent in all three examples given in As expected the ‘islands’ of large periods occur when both the noise, Six different slip/jump parameter combinations are selected to illustrate the proposed stuck-valve strategy described in Section The results from the numerical experiments show that both strategies establish the minimum variance performance lower bound given loops suffering from moderate valve stiction. While both methods on average deliver values for the Harris index closer (and lower) to the true value, by comparing the uncertainty ranges in While the stuck-valve method is specific to nonlinearities where the feedback loop is broken such as valve stiction, this also includes nonlinearities such as valve saturation, and other stiction-like nonlinearities such as dead-zones and excessive quantisation. Together these four types of nonlinearities probably account for the majority of the nonlinearities in industrial control loops, and certainly the majority of the loops with hard non-differentiable nonlinearities. Therefore, we would argue that it is worthwhile devising a specific scheme to handle this common type of nonlinearity, especially since it does a better job in the ‘middle zone’ than the more generic smoothing method. For the case of the stuck-valve strategy, the quality of the estimate is best for the jump parameter Similarly, if the zero-crossings are too frequent (and therefore the period available for steady-state consideration is too short compared to the anticipated dominant time constant), then the spline-smoothing strategy is more appropriate. This strategy has the advantage that it always works, albeit not quite as accurate as the stuck-valve method. One useful exercise in a processing plant is to compare the nonlinear and linear Harris indices. If they are numerically close, this indicates that the nonlinearities are mild, conversely if they are substantially different, then this indicates that the, presumably stiction, nonlinearity is significant. Hence the comparison gives an approximate diagnosis and quantification of valve stiction. The proposed strategies have some limitations. First, we assume that the plant is stable, and reasonably well-damped which is not unreasonable for process type applications. For type 1 plants with integrators, it is of course possible to differentiate the output. Furthermore, in the case of the stuck-valve strategy, we assume that the dominant time constant is approximately known in order to discard the appropriate amount of data while waiting for steady-state, although again this is unlikely to be an overly onerous requirement for any processing plant. We also assume that the plant data is available at the sampling frequency for subsequent processing. For older installations where for example the DCS data historian may compress the data for space saving reasons, clearly then the statistical inferences will be compromised, and the results suspect. Finally we restrict our attention to those cases with moderate extent of stiction, since of course excessive stiction The strategies proposed in this paper reliably establish the minimum variance performance lower bound in the case of moderate valve stiction using only observable signals and crude estimates of the plant dominant time constants and plant delay. The importance of this work is that one can estimate the achievable controlled performance for an industrial control loop despite the valve suffering from poor maintenance causing valve stiction. Furthermore if one were to simply ignore the valve stiction nonlinearity, one over-estimates the loop performance, and hence is in a false sense of security. Note that explicitly quantifying stiction model, is neither required in the proposed methods, nor does it in fact help in quantifying the loop performance. Likewise since the strategies also work in the cases of no stiction, then we are less motivated to explicitly diagnose the stiction phenomena. In fact, the spline smoothing case can be equally applied to any nonlinearity of the form Of the two strategies proposed in this paper, the one that identifies the periods where the feedback loop is broken due to the stuck valve is the most reliable but in cases where the plant dynamics are excessively long, or where the limit cycle exhibits a short period, then the spline smoothing technique is more appropriate. Financial support for this project from the Industrial Information and Control Centre, Faculty of Engineering, The University of Auckland, New Zealand is gratefully acknowledged.