Rock masses are often conceptualized as dual-permeability media containing fractures or fracture networks with high permeability and porous matrix that is less permeable. In order to overcome the difficulties in simulating fluid flow in a highly discontinuous dual-permeability medium, an effective unified pipe network method is developed, which discretizes the dual-permeability rock mass into a virtual pipe network system. It includes fracture pipe networks and matrix pipe networks. They are constructed separately based on equivalent flow models in a representative area or volume by taking the advantage of the orthogonality of the mesh partition. Numerical examples of fluid flow in 2-D and 3-D domain including porous media and fractured porous media are presented to demonstrate the accuracy, robustness, and effectiveness of the proposed unified pipe network method. Results show that the developed method has good performance even with highly distorted mesh. Water recharge into the fractured rock mass with complex fracture network is studied. It has been found in this case that the effect of aperture change on the water recharge rate is more significant in the early stage compared to the fracture density change.Fractures are important geological structures that affect both mechanical and hydraulic behavior of rock mass. A number of numerical methods have been proposed to reflect the influences of fractures on fluid flow in natural rock mass, among which dual continuum models and their variations ( For accurately catching the complex geometry of fractures and their spatial connectivity, discrete models are more suitable. Because of the relative low permeability of the matrix block of hard rock, only the permeability of the intricate fracture network is considered in many cases. For rocks with significant porosity and permeability, consideration of the interaction between the fractures and the rock matrix is necessary. The difficulties of implementation of discrete models mainly lie in the complexity of the geometry of fracture networks and the interaction between the two media, the fractures, and the rock matrix, which have drastically different material properties. Furthermore, the computational cost is another important issue when the number of the fractures increases. Most discrete models implement relatively sophisticated mathematical models to achieve accurate results. The FEM ( One of the main aims of this paper is to develop a relatively simple yet accurate and robust numerical method to simulate fluid flow in discrete dual-permeability media. In order to overcome the difficulties encountered in the discrete models, researchers have proposed some simplified models to conduct simulations. One of the simplified methods is to treat disk-like 2-D fractures as mono-dimensional pipes connecting fracture centers with connected fractures ( The fracture continuum method (  In this paper, a unified pipe network model (UPM) is proposed to simulate fluid flow in discrete fracture network and porous medium. The UPM is conceptually simple, which treats fractures and porous medium as virtual connected pipes in domain space. The flow properties of pipes are not stochastically assigned but are derived based on geometrical and hydraulic properties of the corresponding fractures and rock matrices, which are the conceptualizations of the fractures and the porous media. Thus, the selection of the preferential channels on a fracture plane is not required. The fractured porous medium can be reconstructed by the systematic assembly of the fracture pipes and the matrix pipes. The interaction between rock matrix and fractures is achieved by applying the continuity condition at the interface. No interchange terms are introduced. The straightforward model building process well balances the accuracy and the simplicity in flow simulation. Numerical cases are presented to demonstrate the feasibility, robustness, and effectiveness of the UPM. The effects of fracture density and fracture aperture size on the water recharge into fractured rock formation are studied. Natural fractured rock mass contains a large number of fractures in different sizes. The fractures containing relatively large voids compared to pores in the matrix rock, link each other to form main flow conduits in the rock mass. The rock block is treated as a kind of porous medium, which contains interconnected small pores for fluid flow. These spatial interconnected pores and voids are conceptualized as interconnected pipes with different equivalent hydraulic parameters. Thus the fractured rock mass is treated as a pipe lattice system or a pipe network system, which is shown in This conceptualization is based on the exact information of fracture network as well as the permeability of the rock matrix rather than the simplified flow channels. Dead-end fractures, which can be important in fluid flow and mass transfer are not trimmed in the model, because they are integral parts of the detailed geometry of the fracture networks. They increase contact areas between fracture networks and matrix thus affecting fluid flow. Admittedly, it is not always possible to obtain the exact information of the fractures in rock under current survey technology. However, some detailed statistical information of the fractures such as the distributions of the dip, dip direction, size and aperture, can be collected by current technology, based on which the statistical equivalent UPM models can be built to conduct Monte Carlo simulations if necessary. In a unified pipe network system, which includes fracture pipe network and matrix pipe network, fluid flow occurs through the connected pipes. Fluid flow in each pipe follows certain flow law that is termed virtual pipe flow law. Studies have shown that when Reynolds number is less than 1 (maximum to 10) ( In each node, fluid flow obeys a nodal law, which represents the mass conservation condition. For a steady saturated incompressible fluid flow, the nodal law is expressed as, Here, subscript By instituting Eq. The governing equation can be written in a matrix equation form, For a Node The value of an off-diagonal entry is the negative conductance coefficient of the corresponding pipe. For example, if there exists a pipe There are two kinds of boundary conditions for the unified pipe network, the Dirichlet boundary condition and the Neumann boundary condition. The Dirichlet boundary condition is stated as The Neumann boundary condition is as follows Complemented by boundary conditions, the governing equation can be solved numerically without much effort. The numerical cases in this paper are solved by a direct solver named GSS (Grus Sparse Solver) ( For saturated flow problems, nodal pressure is the only unknown in the model. The flow rate in a pipe can be readily obtained by using the pipe flow law after knowing the flow potentials of its two end nodes. As seen from the derivation, all pipes are undirected. The flow direction in a pipe is depended on the difference of flow potentials at its two ends. Neither reference node nor pipe flow rate is required in constructing the governing equations compared to the graph-theoretic pipe network method ( Discrete fractures in 2-D fluid flow problem are commonly treated as 1-D segments ( The 2-D fracture segment can further be simplified as 1-D line called fracture pipe, denoted with Eq. In microscopic level, fluid flow in porous medium can be modeled by the network models ( For effective simulation of fluid flow in a macroscopic porous medium, the macroscopic porous medium is reconstructed by using an equivalent pipe network graph, in which the volume of the porous medium is discretized and represented by nodes. Besides, the fluid flow in the porous medium is modeled by equivalent pipe flow, which transports fluid between connected nodes. Macroscopically, porous medium is a homogenized material; the macroscopic reconstruction of the medium is more feasible in fields of large scale modelling than the microscopic reconstruction of the porous medium, which is influenced by the detailed geometry and topology of the connected pores. A porous medium can be reconstructed by using either structured or unstructured pipe networks. Unit thickness is assumed for the 2-D domain. Flow in the porous medium can be discretized into flow in the pipe network graph. All unknowns are assigned on the discrete nodes. The unstructured mesh, which usually has irregular shapes and explicitly stored connectivity, is more flexible to discretize domains with complex geometry. By contrast, structured mesh is more difficult to match complex physical boundaries with regular geometric shapes. Therefore, it is preferable to use the unstructured triangular mesh in fractured porous models. For the derivation of the parameters of pipes forming a triangular mesh, different geometric centers such as the circumcenter or the incenter of the triangle can be used. As an example, the circumcenter Any link between two nodes constructs a flow pipe, namely pipes Now, three equivalent pipes for the unstructured triangle mesh have been derived. In the domain boundary, one equivalent pipe associates with one triangle only. However, inside the domain, one equivalent pipe associates with two adjacent triangles. Therefore, the equivalent conductance coefficient of this pipe is the summation of contributions of the equivalent conductance coefficients from these two triangles. Fractures in 3-D domain are represented by 2-D disks (either elliptic or polygonal). Therefore, the equivalence of fracture pipe networks in 3-D domain is similar as the equivalence of the 2-D matrix pipe networks. The difference is that a 2-D fracture has equivalent hydraulic aperture Conductance coefficients for fracture pipes 3-D porous media can also be reconstructed by the pipe network models. The simplest case to reconstruct a 3-D domain is to use tetrahedrons, each of which has six edges corresponding to six flow pipes. For deriving the equivalent flow pipes of a tetrahedron, the center of the circumscribed sphere of the tetrahedron Detailed derivation can be found at As noticed from the derivation, the equivalent conductance coefficient of a pipe can be expressed uniformly as In the above derivation, the circumcenter of a triangle (or the center of the circumscribed sphere of a tetrahedron) is adopted to take the advantage of the orthogonality of the Voronoi diagram as that in the PEBI grid in two-point flux approximation method ( The 2-D and 3-D porous media have been reconstructed by using discrete 1-D flow pipes, which have the same form as that used in 2-D DFN models. Actually, in 3-D problems fractures are modeled as 2-D planes, which can also be reconstructed by using the 1-D flow pipes. Thus, the fractured porous media in both 2-D and 3-D can be modeled by the unified pipe network model (UPM). In this subsection, the coupling of the fractures and the matrix using the UPM for the saturated steady flow is expressed. For a 2-D fractured porous medium as shown in For a 3-D fractured porous medium, the coupling process of the fracture pipes and the matrix pipes is the same as that in a 2-D problem. As shown in After the reconstruction and coupling process, the fractured porous medium is uniformly represented by a pipe network graph. The flow, both in the fractures and in the matrix is modeled by flow in the pipes. The law of mass conservation holds at each node. Within the frame of UPM, the governing equation of the saturated-unsaturated transient flow is The nodal flow potential can be obtained by solving the global matrix Eq. Thus, the magnitude of the flow velocity at node The Darcy flow velocity can be evaluated by flow rate of any matrix pipe connecting to the node The coupling of the matrix pipes and the fracture pipes requires the pipe nodes of these two kinds of pipes to be identical in position. Therefore, the domain reconstruction process requires an efficient conforming mesh generator for the fractured porous medium in both 2-D and 3-D. Currently, the generation of high-quality conforming mesh for fractured porous media with complex fracture geometry is still a challenge. Several public domain tetrahedral mesh generators have been tested by A high efficient and high quality adaptive mesh generator has been developed to reconstruct the fractured porous medium for the UPM. For 2-D domain, the fractures are discretized firstly by inserting nodes in the fracture lines to form connected pipes. Then the meshed fracture pipes and nodes are input as constraints for the discretization of the porous medium. The generation of mesh nodes of the porous medium is based on the Analogous Force Equilibrium method ( For a 3-D domain, bottom-up conforming mesh processes are adopted for the tetrahedrization, which is shown in In this section, several cases are studied to verify the feasibility and effectiveness of UPM for fluid flow simulations in fractured porous media. Both 2-D and 3-D cases are demonstrated to show the flexibility of the method. Meshes in the following UPM cases are generated using a self-developed mesh generator. The purpose of this case study is to verify the representation and upscaling of unfractured, porous matrix blocks into pipe elements. The initial conditions of the 2-D and 3-D domains are the uniformly distributed water pressure The top boundary of the 3-D case is as follows, The analytical solution of water pressure evolution at a specific point  The numerical simulation result of the 3-D example at the time of 180 The purpose of this case study is to verify the representation and upscaling of fractured porous matrix media into pipe elements. A vertical fracture is imbedded in the 2-D example in Section The computational efficiency of UPM has also been tested in this case and compared with COMSOL. Models with the same triangular mesh are used. The node number and the triangle number of the models are 1007 and 1903 respectively. In COMSOL, multifrontal massively parallel sparse direct solver (MUMPS) is selected with a constant time step of 0.1 Mesh quality is also important in numerical simulation. Numerical methods may result in inaccurate results on highly distorted meshes. Therefore, the robustness of a numerical method with regard to the mesh quality is of great importance. In order to test the robustness of UPM, models with different mesh qualities are tested as illustrated in When fractures are explicitly considered together with the porous medium in 3-D domain, the situation is much more complex. The drastic difference of material properties makes the flow change abruptly at the interface. The irregular distributions of the fractures further strengthen the complexity. The UPM reconstructs the fractures and porous medium by the assembly of fracture pipes and matrix pipes. The unified treatment makes the medium tractable. A simple model is presented to show the effectiveness of the UPM in representation and upscaling of 3-D fractured porous matrix media into pipe elements, which is demonstrated in This case shows the capability of UPM in simulation of flow problem with more complex fractures imbedded in porous rock using pipe models, seen in In this case, the influences of fracture density and its hydraulic properties on the water recharge in the fractured rock mass are studied. The fracture networks with number of 100, 70 and 30 are generated independently in this study. The fractures are well connected in the models with number of 100 and 70, while the fractures are not well connected in the model with number of 30. The aperture size of these fractures is stochastically generated following a uniform distribution from 0.5 In this paper, a domain-reconstruction method by using the unified pipe networks is proposed for fluid flow simulations in two-dimensional or three-dimensional porous media, discrete fracture networks and fractured porous media. The unified pipe network method treats different flow domains uniformly, which is the assembly of discrete one-dimensional pipes associated with different properties. The flow equivalences of the fracture pipe and the matrix pipe for the fractures and the porous medium are derived respectively. Mass conservation is guaranteed in the UPM. The UPM conceptually simplifies the flow simulations in complex fracture networks and fractured porous media. High quality adaptive conforming mesh method in two dimensions and three dimensions is adopted to discretize the flow domain and construct the flow pipes, which changes neither the topology nor the geology of the fracture network. No interchange term between rock matrix and fractures is required. The case studies demonstrate the accuracy, robustness, and feasibility of the proposed method in simulation of flow in fractured porous medium even with highly distorted mesh. The effects of fracture density and fracture aperture on the water recharge into the fractured rock mass are studied. It is found that both the variations of the fracture density and fracture aperture can significantly change the water recharge rate. However, comparing to the variation of fracture density, the effects of aperture change are more significant in the early stage. The main purpose of this case is to show the capability of the UPM in simulation of porous medium containing complex fracture network, therefore the relatively simple capillary function and relative permeability function are adopted. A more realistic constitutive model is required for a better understanding of the flow in the fractured rock mass. It is noticed that about 20% increase in efficiency was realized for a simple example compared with COMSOL and computation benefit could be explored with more complex applications. The limitation of current UPM is that the fracture in our method is highly permeable and there is no impermeable filling in the fracture. Therefore, there is no flow potential jump transversely across the fracture. In most practical cases, the fractures are thin and open. Thus, the assumption of highly permeable fracture is valid for most cases. The current UPM is suitable for isotropic matrix. Actually, the anisotropy of the fractured porous medium is largely contributed by the fracture network in most cases. The UPM is capable of capturing the overall anisotropy of the fractured porous medium by explicitly representing fracture network. The concept of reconstruction is both applicable in micro scope and macro scope. Therefore, the UPM has the potential to combine the fluid flow in multi-scales. The pipes can naturally model pore scale flow up to tiny fracture flow and finally form to macroscopic flow. The multi-scale computation is the work to be carried out in the future. Furthermore, the advantage of the UPM makes it an attractive method for the coupled hydro-mechanical simulation. The lattice model ( This research was supported by the Assuming unit thickness for the 2D porous medium, the fluid flow through face If the pressures of three nodes are known as The linear shape function The pressure gradient in the triangular domain is calculated as, The fluid flow through the face The right term The fluid flow The fluid flow The equivalent conductance coefficients for pipes Similar to the derivation of the equivalent coefficient of a 2-D triangular porous medium, an FEM-like linear shape function is adopted to approximate the distribution of the pressure. The pressure  Then the pressure gradient in the tetrahedral domain can be estimated as, The fluid flow through pipe By substituting Eqs. Therefore, the equivalent conductance coefficient of pipe The equivalent conductance coefficients for pipes