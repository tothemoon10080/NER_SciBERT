Precise particle size measurements are important in many aspects of engineering geology, e.g. in mineral processing and the study of methane hazard in coal mines. The volume of grains, estimated exclusively on the basis of dimensions of the grains differs tens of percent from the volume obtained from 3D digital measurements. This confirms that full three-dimensional automatic imaging can be used in the measurements of the particles.
                  The paper discusses the technique of three-dimensional imaging performed with the use of three types of devices. Coal particles representing the 0.5–1.0mm grain fraction were chosen as the research material. The measurements were performed by means of: X-ray computed tomography, confocal microscopy and optical profilometry. The last two techniques are less costly and more easily available than computed tomography.
                  For the X-ray CT scanner, full three-dimensional imaging was performed. In the case of the other two techniques, only those parts of the particles that were captured by the heads of the relevant devices in question were measured. The invisible parts of the particle were reconstructed with the assumption that the bottom part of the particle is similar (in some scale) to the top part of the particle. The results obtained by means of X-ray CT scanner were used as the correct volume and size values.
                  The results indicate that measurements carried out carefully and with use of the more easily available and less costly equipment, combined with careful data processing, can be used instead of methods that are expensive and harder to employ. The percentage deviation between the volume calculated with use of the data obtained with the X-ray CT scanner and the volume calculated with use of the data obtained with the other two devices varies from 0.2% to ca. 5%.These days, computers are ubiquitous, and the ways in which they can be used are manifold. One of these applications is 3D imaging, which is very helpful as far as the study of the shape of various types of grains — as well as their spatial description — is concerned (both on the “macro” and the “micro” level). In particular, such studies are important in the context of geology and mineral engineering. In the case of studies involving the analysis of the coal-methane system, and kinetics of methane diffusion through coal substance, the crucial factors are the shape and volume of the particles. Specific grain parameters are used to determine methane release hazards as well as methane and coal outburst in underground coal mines. The unipore diffusion model, employed in the process of identifying methane threats in coal mines, is encumbered with numerous assumptions, such as the one concerning the sphericity of grains — and the shape of the grains is the most significant factor responsible for potential errors in determination of the value of the diffusion coefficient. The study into the impact of changes and inaccuracies in the shape of grains upon potential errors of the unipore model was presented in an article by Three-dimensional imaging can be performed with various methods and different types of devices, developed in recent years. The most common and widely used methods are described in a paper by The above methods do provide information about the size and shape of particles but several of the methods are very expensive and time consuming and some do not provide accurate enough results for accurate modeling of methane diffusion. Presently the models use the size and shape results from the method based on substitute diameters; this is the most commonly used method. However it is very time consuming and erratic. Thus there is a need for developing a fast, inexpensive method that yields accurate enough results of the 3D size and shape of particles; that yields accurate enough results for accurate modeling of the methane diffusion. We will test two new methods and compare the results with those obtained from the X-ray CT based method. To see if these less expensive and quicker methods can give accurately enough results that can motivate their use instead of the X-ray CT which is expensive. Modern techniques of 3D imaging are very helpful when it comes to the process of spatial description of grains, their size, shape, and surface texture. An important factor in selection of the measuring method is their cost and availability and accuracy of the results. In most micro scale cases, the best choice proves to be the X-ray CT scanner, which provides full representation of the shape or structure of the investigated object in three-dimensional space. However, this instrument is very expensive and not available to most researchers, thus we look for an alternative that would still make it possible to perform sufficiently accurate size and shape measurements. Such an alternative may be the confocal microscope or the optical/laser profilometer. Unfortunately, none of these instruments provides us with a comprehensive representation of an object in three-dimensional space, as the devices allow us to scan the grain structure only from above (this is due to the fact that, in both cases, the head of the measuring device cannot access a grain from any other side). An object, thus imaged, can be reconstructed in such a way, that its recreated shape is close to the actual one. As it has already been mentioned, coal grains constituted the research material discussed in the present paper. The coal was first subjected to the process of screening. As a result, particles representing the 0.5–1.0 Each sample consisted of 55 randomly selected coal particles. Due to the particles fragility the same set of particles could not be used for each of the different methods. Instead different particles were measured for each method. Furthermore the results of some of the particles were disregarded; they were clearly erratic results. In the end there were 44, 50 and 53 particle results, respectively for the X-ray CT scan, confocal microscope and optical profilometer. The grains measured by means of the confocal microscope and optical profilometer had not been prepared for measurements in any way. In order to optimize and simplify the measurement procedure, the particles measured by means of the X-ray CT scanner were embedded — before scanning — in a special mass that had been molded into the cylindrical shape. The confocal microscope, due to its specific nature, makes it possible to perform measurements of the grain surface as seen from above. In this research, the measurements were performed separately for every grain. Randomly chosen grains were scattered on the measuring table under the microscope. Then, after setting the scanning head over the grain and selecting the desired parameters of the study, the measurement procedure itself was carried out. Due to the fact that the measurements were performed relatively fast, in order to improve the quality of the results and minimize the number of potential errors, four scans were involved in each grain measurement. The data obtained from the measurements was not pre-filtered — all of the filtering options available in the microscope control software were turned off. The result of the measurement of each particle was a CSV (Comma Separated Values) file containing a header with information about the measurement parameters (the measuring point size, and the data concerning the measured grain) and, in its subsequent lines, the height spatial distribution of the pixels on the grain surface, with a resolution of 1024 The optical profilometer, similarly to the confocal microscope, made it possible to measure grains as viewed from above. Prior to the measurement, randomly selected particles were scattered on the table of the measuring device. Then, the measurement parameters (the width and height of the area to be scanned, as well as the size of the measuring point) were set individually for each grain. After that, the grain was measured. The profilometer head remained stationary during the process, while the table with the scattered samples was moving. Due to the fact that the measuring table was moving relatively rapidly, causing some of the particles to relocate, a special underlay was placed on the measuring table to prevent the movement of the particles. The underlay placed on the measuring table did not affect the results of the measurements. Due to the large amount of time needed to scan a grain, each grain was scanned only once. The obtained data was not pre-filtered. As a result of the measurement process, for each particle, a text file containing a header with information about the measurement (the size of the scanned area, the measuring point size, and the data concerning the measured grain). Each measurement was conducted with a different size of the scan area, matched to the measured grain size in order to speed up the measurement process. After changing the size of the scan area, the software of the profilometer automatically changed the size of the measuring point. Because of that, the size of the measuring point had to be adjusted to 10 The CT scanner, in contrast to the previously mentioned devices, allows full three-dimensional imaging of a single grain or a set of grains. All the particles in the set were scanned at the same time — in contrast to the other two methods, which required each grain to be scanned individually. The chosen grains were embedded in a cylindrical mass, designed specifically for this particular purpose, and placed inside the scanner and measured. The parameters of the measurement, such as the size of the scanning grid, the sampling distance and radiation dose, were set in such a way as to adjust the result to the optimum scanning time without losing the acceptable quality. As a result, a set of images saved in the TIF format was created. Each of the images presented a single layer (a cross-section) of the scanned cylindrical sample with embedded coal grains in it. In total, 1628 files of the size of 1526 The processing of the collected data was carried out with custom software. The software was written in Java without using the external libraries that provide the necessary image processing algorithms in both 2D and 3D. All the algorithms were newly implemented and thoroughly tested ( The processing of the data obtained with the confocal microscope and the optical profilometer was carried out in an almost identical way. The only difference concerned setting the proper resolution of the data set. The measurement data contained information about the grain heights as seen from above. The values included also the height of the measuring table on which the grains were spilled. All the data was saved in the form of the 2D pixel array with the x and y dimensions. The information concerning the bottom shape of the grains was missing. Additionally, during the measurement process, some pixels were not measured due to the limitation of the measuring devices. Such a situation occurs typically in this type of an analysis, where light plays an important role during the measurement. It may be caused by the topography or the reflexive feature of the grain surface. The pixels which were not properly measured were reconstructed by means of the Kriging Method ( The data concerning the missing bottom shape, unavailable for the measuring head, was reconstructed. The reconstruction algorithm was based on the assumption that bottom part of every grain is similar, in some scale, to its top part. The information about the heights measured on the analyzed grain including information about the height of the points on the outer circumference of the grain, were used for calculations. The proposed reconstruction algorithm was used in some previous studies ( Whole algorithm used a two-dimensional array containing information about height of points of grain seen from above. Each element of array was described by the x and y coordinate and was containing value of measured height of single point of the top surface of the grain u(x, y). Value of the u(x, y) was greater than zero. Points (of the two-dimensional array), which were representing foundation on which the grain was resting, had value equal to zero. The result of the algorithm, for every x and y coordinates, was value of bottom surface of the grain b(x, y) which was defined as a scaled mirror reflection of the u(x, y) value. The value of reflection point r(x, y) (point used to create the reflection) was determined in the following way (description refers to a single element of two-dimensional with coordinates x and y with value greater than zero, but it is the same for the whole grain): First part of the algorithm — initial reconstruction in the two-dimensional array of the measured values, the analyzed array element with coordinates x and y u(x, y) was placed at the intersection of exact row and column for that exact row and column there were located points u(x, y) placed on the circumference of the grain — row and column, were containing information of two pieces of circumference (for row: left and right, and for column: top and bottom) so two pairs of points were found. In order to eliminate potential error, the pairs of points were evaluated as median value of group of points on the circumference. based on evaluated pairs of point, two straight-line equations were determined: for the row (f using lines equations, there was established value of point which was used to create the reflection of the top value: Second part of the algorithm — scaling of evaluated values In order to enhance created bottom part of grain, evaluated values b(x, y) were scaled. As a base for scaling there was adopted value of center of the gravity of the grain. for the point of center of gravity with exact coordinates: x based on evaluated r(x  using established scale factor, the b(x, y) value was evaluated in following way:  in case, when evaluated value b(x, y) was less than zero, then the b(x, y) was adopted as zero value. Third part of the algorithm — reconstruction of grain bottom structure. Having the b(x, y) value, the bottom part of the grain saved in 3D XYZ voxel array (mentioned before) was reconstructed. From the perspective of image analysis, the value of the voxels representing the grain were marked as “1”, and the value of the voxels representing the grain surroundings were marked as “0”. To the spatial image obtained in that way, a 3D algorithm of morphological filtering was applied in order to eliminate possible noise ( The data obtained with the CT scanner differed significantly from the data obtained with the microscope and the profilometer. The CT scan data contained complete information about the three-dimensional shape of the studied grains. Therefore, the processing algorithm of the CT data was entirely different. Each of the data files, 1628 tif images, containing 2D data concerning the cross sections, was processed separately so that a coherent picture in three-dimensional space could be obtained. Every two-dimensional image was pre-filtered in order to eliminate the unnecessary noise connected with measurement specification. In this case, the measurement was carried out on the objects embedded in a special mass which generates some noise. The 2D involved employing the median filter, then the opening by reconstruction followed. The algorithm removed all the noise and errors without detriment to the data describing the particles. As a result of the filtering process, the images containing the two-dimensional view of the grains and uniform background allowing unambiguous identification of the tested objects were created. Thus prepared images were used to reproduce the three-dimensional shape of the particles. The algorithm for creating a 3D image (in a loop over all the two-dimensional images) recognized the grains, if necessary, separated them with a watershed algorithm (when it was necessary), labeled them and then created 3D objects. In order to eliminate possible noise, the 3D algorithm of morphological filtering was applied to obtain the three-dimensional image. On the basis of the objects created in 3D space, the dimensions and volume of the grains were calculated. In order to compare the results obtained in the course of the measurements of the data established with the microscope, the profilometer and the X-ray CT scanner, the exact parameters were calculated. For each particle, the following parameters were determined: volume, height, width, and length. ‘Length’ is understood as the x dimension, ‘width’ as the y dimension and “thickness” as the z dimension. The volume was calculated as the sum of three-dimensional voxels and as the product of the calibration factors determining the dimensions of a single voxel, respectively. The single voxel size was the same with respect to all directions, which was essential for the sake of keeping the proportions (e.g. processing filtration in 3D space). For the microscope and profilometer data, the thickness was calculated directly, and no additional transformation was applied. For the CT data, the thickness was calculated in two different ways, without and with extra processing, which is described further in text. The x and y dimensions were calculated by means of the Feret diameter — one of them was determined as the exact Feret diameter and the other — as the shortest perpendicular diameter. A similar method was presented by In order to conform the CT data to the data obtained by means of the other devices, the grains were rotated in three directions so that the orientations similar to the grains from the profilometer and microscope could be established. The grains measured with these two devices were lying freely. To simulate this type of arrangement, the grains were rotated so that the smallest thickness could be determined. Then, using the repositioned grains, width and length were calculated by means of the Ferret diameter. To compare the results obtained due to the application of the 3D image analysis methods and the widely used manual methods for estimating the volume of grains, the volumes of grains were calculated with four different substitute diameters. Usually, with this type of measurements, there is a rough assumption that the grain is spherical, and its volume is calculated according to the standard formula of a sphere ( the diameter of the sphere, which has the same surface area of projection as the analyzed grain (projection diameter); the arithmetic mean of length, width and height of the analyzed grain (arithmetic diameter); the geometric mean of the three dimensions of the analyzed grain (geometric diameter); the harmonic mean of the three dimensions of the analyzed grain (harmonic diameter).   The calculated average dimensions of grains, based on the measurement data, are presented in For the calculations based on grains scanned by means of X-ray CT, the parameters of the rotated grains simulating the free lying arrangement, were adopted. The average volumes calculated with substitute diameters as well as the volumes obtained from the 3D analysis, are presented and compared in Given that the X-ray CT method allows total reconstruction of the particles we assume the results are most accurate and thus they are used as reference values for comparison of the results from the other two methods ( The dimensions calculated on the basis of the data obtained with the microscope and the profilometer ( Analyzing the data from The present paper provided a description of measurements of coal grains performed with the X-ray CT scanner, the confocal microscope and the optical profilometer. The measurements carried out with the X-ray CT scanner were based on the full three-dimensional shape of the measured grains. The other measurements were based on the top view of the grains. The obtained data was processed and prepared for further calculations. In the case of the measurements based only on the top view shape, the bottom parts of the particle that were not visible, were reconstructed with the assumption that the bottom part of the particle is similar to the top part of the particle. This reconstruction algorithm, proposed by the authors, was the most important part of the processing stage. The comparison of the measured data proves that the results obtained on the basis of the data from the microscope and the profilometer differ slightly from the results obtained with tomographic measurements. Therefore the measurements performed with the confocal microscope or profilometer, can be used instead of measurements conducted with the help of the X-ray CT scanner. It is very important, since the tomographic measurements are still poorly accessible and relatively expensive. However, it must be remembered that some X-ray CT measurements cannot be replaced. This concerns instances where obtaining a full spatial image is crucial. This work was supported by the