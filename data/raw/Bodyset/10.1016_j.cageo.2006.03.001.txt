The simulation of spatially correlated Gaussian random fields is widespread in geologic, hydrologic and environmental applications for characterizing the uncertainty about the unsampled values of regionalized attributes. In this respect, the turning bands method has received attention among practitioners, for it allows multidimensional simulations to be generated at the CPU cost of one-dimensional simulations.
                  This work provides and documents a set of computer programs for (i) constructing three-dimensional realizations of stationary and intrinsic Gaussian random fields, (ii) conditioning these realizations to a set of data and (iii) back-transforming the Gaussian values to the original attribute units. Such programs can deal with simulations over large domains and handle anisotropic and nested covariance models.
                  The quality of the proposed programs is examined through an example consisting of a non-conditional simulation of a spherical covariance model. The artifact banding in the simulated maps is shown to be negligible when thousands of lines are used. The main parameters of the univariate and bivariate distributions, as well as their expected ergodic fluctuations, also prove to be accurately reproduced.Geostatistical simulation is increasingly used in earth and environmental sciences for assessing the uncertainty about the unsampled values of a spatial attribute, either at a single location (local uncertainty) or jointly over several locations (spatial uncertainty). For instance, it is helpful to estimate the probability that the average value of the attribute over a given area exceeds a critical level, a problem that arises in ore reserve evaluation, agricultural land management, groundwater contamination or polluted soil management. Continuous attributes are often modeled by nonlinear transforms of Gaussian random fields, for which the spatial distribution is multivariate Gaussian (in short, multigaussian). The simulation algorithms developed in this respect can be classified in two families:   Although it is one of the oldest techniques for simulating multidimensional random fields, the turning bands method is still scarcely used in geostatistical applications and the existing free packages are often limited in their implementation or applicability. As an example, the first A more complete free library is the R package Such limitations have motivated the present work, which aims at supplying and documenting computer programs for simulating three-dimensional Gaussian random fields via the turning bands method. A second objective is to illustrate the efficiency and reliability of this method, through an analysis of the bivariate distributions and statistical fluctuations of the simulated values. The proposed programs are based on a former code published by possibility to handle nested and anisotropic covariance models, possibility to simulate either gridded or scattered locations on large domains, accurate reproduction of the desired covariance model (without approximation), availability of the most commonly used covariance models, conditioning to a set of existing data, definition of either a unique or a moving neighborhood for conditioning kriging, back-transformation from normal values to original units, change of support (upscaling) of the realizations, improvements in the simulation code to quicken calculations. In the following, the simulation of stationary or intrinsic random fields is considered. In the intrinsic case, the traditional covariance function does not exist and one works with a generalized covariance; also, the multivariate Gaussian assumption does not concern the random field itself, but its increments or generalized increments ( The principle of the turning bands method is to simplify the simulation problem in  There exists a wide choice of methods for simulating a one-dimensional random field with prescribed covariance These impediments can be avoided by resorting to continuous simulation algorithms along the line. A common example is the continuous spectral method, which provides an accurate simulation of the target covariance without need for regularly spaced locations. This method has been implemented in program Fifteen models are implemented in program (1) The associated one-dimensional random field choose an offset on the real axis at random (uniformly in [0, within each interval, draw a linear function with an equal probability of being increasing or decreasing; the slope sign is independent from one interval to another one ( (2) The one-dimensional random field can be simulated thanks to a Poisson point process in One recognizes the probability density function of a gamma random variable simulate the random variable simulate a random vector divide the line with orientation (3) This model is simulated as a scale mixture of exponential covariances [Eq. (4) When (5) This model is obtained in a way similar to the spherical covariance, but with a cubic function instead of a linear function on each interval ( (6) This covariance can be simulated by applying the continuous spectral method, which constitutes a particular case of the turning bands method. It consists in putting (7) Again, the continuous spectral method is used for simulating this covariance. Here, the spectral measure in (8) In If (9) This covariance is simulated as a mixture of Gaussian covariances whose scale factors are square-rooted gamma random variables with shape parameter The previous approach is not efficient when the parameter Also note that the case (10) This model is a scale mixture of Gaussian covariances. The scale factors are the reciprocals of square-rooted gamma random variables with shape parameter (11) By truncating a Gaussian random field with such a covariance to the median threshold ( Random variables with density (12) This covariance is simulated along the real axis by drawing a random field that increases or decreases by unit jumps at regularly spaced discontinuity points ( (13) When Note that Eq. (14) This model is a mixture of power covariances whose exponents are random variables uniformly distributed in ]0, (15) The associated one-dimensional random field This expression can be obtained by considering the spline covariance with parameter Formula This constitutes a discrete approximation of Eq. Provided that the simulation algorithm used along the lines is accurate, the turning bands method reproduces the theoretical covariance model without bias, irrespective of the number A Gaussian random field with nested covariance model can be simulated as the sum of independent Gaussian random fields, each of them associated with one basic structure of the nested model. Program So far, the presentation assumed that the lines had a uniform distribution over the sphere The maximal number of regular directions in the three-dimensional space is equal to 15. This number relies on the icosahedron approximation (  Several factors should be considered when choosing the number of lines to use for simulating each structure of the nested model: The distribution of the lines over the sphere (almost regular or purely random, see previous discussion). The relative importance of the basic structure in the covariance model: the greater the contribution of the structure (fraction of the total sill), the more lines. The criterion used to decide whether the multigaussian model is well reproduced or not. The type of covariance and the associated simulation technique along the lines The spectral method is suitable for simulating covariance models whose spectral densities rapidly vanish at infinity (e.g. a Gaussian covariance); few lines are then needed to sample correctly such densities. Concerning the simulation methods based on a division of the lines into intervals (e.g. for simulating the spherical and exponential covariances), more lines should be used if the scale factor increases. Indeed, the average number of discontinuities ( In two dimensions, Actually, the number of lines is not the limiting factor of the turning bands method, as the simulation along the lines is very fast. In general, a greater CPU time is devoted to post-process the realizations, in particular concerning the conditioning to a set of existing data (see next section). To facilitate practical applications, program draw a non-conditional realization at the target location compute the deviations (residuals) between the data values and simulated values at the data locations; perform a simple kriging of the residual from its values at the data locations add the result to the non-conditional realization, in accordance with Eq. Although this approach is less straightforward than the direct conditioning performed by the sequential Gaussian method, its advantages are threefold ( In the intrinsic case (infinite variance models), conditioning is ensured by substituting intrinsic kriging for simple kriging in Eq. The proposed programs are ASCII files written in MATLAB language (version 5.0 or later). The main routine, called Regarding the back-transformation from Gaussian values ( For tail extrapolation, an exponential function is used, which requires the definition of two positive scalars To quicken the algorithm, grid simulation is performed row-wise. At each step, one or several rows of the 3D grid are projected onto the lines and their values are simulated, conditioned to the data, back-transformed and written in the output file; the maximum number of nodes to consider at each step is defined by the user. This way, the 3D grid is not loaded in the Matlab workspace and the program is able to deal with large simulation domains. Two options are available for the conditioning kriging step: if the search radius is set to The reader is referred to the header of the program file for a description of the input parameters of Alternatively, program The generation of random variables requires the availability of the Matlab Statistics Toolbox (routines for simulating uniform, normal, gamma and beta random variables). This section examines the quality of the realizations obtained by program a visual appreciation of the artifact banding due to the use of a finite number of lines; an analysis of the statistics of the simulated univariate and bivariate distributions; an inspection of the fluctuations of the first moments over a set of realizations.  To validate the quality of the algorithm beyond a visual check of the simulated maps, a set of 100 non-conditional realizations is drawn with the same model and same domain as in the previous subsection, by using 1000 lines for each realization. The simulated univariate distributions are then compared to the expected standard Gaussian distribution via a quantile–quantile plot. Also, the bivariate distributions are examined through three parameters: the simulated variograms, madograms and median indicator variograms ( variogram: 1− madogram (first-order variogram): median indicator variogram: In each case, one observes that the average simulated statistics match the theoretical model almost perfectly. These tests are easy to perform and helpful for investigating the quality of a simulation algorithm, see for instance Another way to validate a simulation algorithm is to examine the ergodic fluctuations in the simulated statistics. The amplitude of such fluctuations depends on the size of the simulated domain and on the spatial distribution of the random field (in the present case, a multigaussian distribution). In the following subsections, we focus on the fluctuations of the spatial averages and of the simulated variograms. Let In log–log coordinates, the points plotting the dispersion variance of Let The regional variogram  Thirty years after being developed, the turning bands approach is still scarcely used in geostatistical applications, although it is more efficient than most other methods for simulating Gaussian random fields. The non-conditional simulation step is generally very fast as it achieves the three-dimensional simulation through a series of one-dimensional simulations. Furthermore, a single kriging run is required to make all the realizations conditional to a set of data. By setting adequately the parameters of the algorithm (in particular, by using several hundreds or thousands of lines), the artifact banding is almost imperceptible in the realization maps, whereas the simulated statistics of the univariate and bivariate distributions and the associated statistical fluctuations are consistent with the theoretical multigaussian model. The proposed computer programs allow one to simulate continuous attributes over large domains and can handle nested and anisotropic covariance models. They may also be a basis for the simulation of categorical attributes through the truncated Gaussian and plurigaussian algorithms, or for that of continuous attributes represented by Gaussian-related models ( The authors are grateful to two anonymous reviewers for their valuable comments on an earlier version of this paper. Supplementary data associated with this article can be found in the online version at 