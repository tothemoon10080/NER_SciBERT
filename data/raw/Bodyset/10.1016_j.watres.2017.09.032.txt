The first version of the P-Hydroslag model for numerical simulations of steel slag filters is presented. This model main original feature is the implementation of slag exhaustion behavior, crystal growth and crystal size effect on crystal solubility, and crystal accumulation effect on slag dissolution. The model includes four mineral phases: calcite, monetite, homogeneous hydroxyapatite (constant size and solubility) and heterogeneous hydroxyapatite (increasing size and decreasing solubility). In the proposed model, slag behavior is represented by CaO dissolution kinetic rate and exhaustion equations; while slag dissolution is limited by a diffusion rate through a crystal layer. An experimental test for measurement of exhaustion equations is provided. The model was calibrated with an experimental program made of three phases. Firstly, batch tests with 300 g slag sample in synthetic solutions were conducted for the determination of exhaustion equation. Secondly, a slag filter column test fed with synthetic solution was run for 623 days, divided into 9 cells and sampled at the end of the experiment. Finally, the column was dismantled, sampled and analyzed with XRD, TEM and SEM. Experimental column curves for pH, oPO4, Ca and inorganic carbon were well predicted by the model. Crystal sizes measured by XRD and TEM validated the hypothesis for homogeneous precipitation while SEM observations validated the thin crystal layer hypothesis. A preliminary validation of the model resulted in successful predictions of a steel slag filter longevity fed with real wastewater.Basic oxygen furnace Constructed wetands Electric arc furnace Hydraulic retention time of voids Transformation of MON into HAP Ortho-phosphates Scanning electron microscope Transmission electron microscope Total inorganic carbon Wastewater X-Ray diffraction Calcite CaCO Hydroxyapatite Ca Primary hydroxyapatite via homogeneous precipitation Ca Primary hydroxyapatite via heterogeneous precipitation Ca Secondary hydroxyapatite via monetite transformation Ca Monetite CaHPO HAP crystal size in homogeneous precipitation, [m] Regression coefficients in Dispersivity (transport model), [cm] Exchange factor between effective and immobile porosity (transport model). [s CAL precipitation constant. [mol CAL/s m HAP precipitation constant, [mol HAP/s m MON precipitation constant, [mol MON/s m MONtoHAP precipitation constant, [M HAP2/(M MON s)] Solubility product for CAL, [M Bulk solubility product for HAP ( Solubility product for HAP_HO, [M Solubility product for MON, [M L/D ratio for columnar HAP crystals, [−] Slag mass to water volume ratio in a batch test, [g/mL] HAP Molecular weight, [502 g/mol] Total porosity in the slag filter, [−] Effective porosity in the slag filter, [−] Immobile porosity in the slag filter, [−] Regression coefficients in Ideal gas constant, [8.31 J mol Slag specific surface, [m initial HAP seeds concentration, [seeds/L] Critical saturation index between HAP_HE and HAP_HO, [−] Temperature [K] HAP mean free surface energy ( Crystal concentration in the crystal barrier, [g crystal/m HAP crystal density ( Slag grain density, [3.8 g/mL] Mean HAP crystal size, [m] Moles of an element in immobile porosity (transport model), [mol] Total dissolved concentration for an element (transport model), [mol/kgw] C in effective porosity (transport model), [mol/kgw] C in immobile porosity (transport model), [mol/kgw] Leached CaO in a acid bath, [mol/g] Leached CaO in a batch test, [mol/g] Cumulative leached CaO in a batch test [mol/g] Diffusion coefficient in the crystal barrier, [m Thickness of the crystal barrier, [m] Slag dissolution constant, [mol CaO/m Solubility product for HAP_HE, [M Saturation pH in the slag filter, [−] Concentration in the solid phase for an element (transport model), [mol/kgw] CAL precipitation rate, [M CAL/s] CaO diffusion rate through crystal barrier, [M CaO/s] Slag dissolution rate, [M CaO/s] Primary heterogeneous HAP precipitation rate, [M HAP/s] Primary homogenous HAP precipitation rate, [M HAP/s] MON precipitation rate, [M MON/s] Secondary HAP precipitation rate, [M HAP2/s] HAP molar specific surface, [m HAP seeds concentration, [units/L] Step function in diffusion rate, [−] Step function in dissolution rate, [−] Step function in HAP_HE rate, [−] Step function in HAP_HO rate, [−] Saturation index for HAP_HE, [−] Saturation index for HAP_HO, [−] Time (transport model), [s] Pore water flow velocity (transport model), [m/s] D distance (transport model), [m] Total leached CaO in the slag filter, [M] Steel slag filters are an effective and passive technology for phosphorus removal from wastewater, allowing typical municipal effluent o-PO Sorption isotherms were largely proposed as a design tool for steel slag filters ( Two previous modeling studies were published in the recent years. The first study ( In this paper, the first full version of the P-Hydroslag (standing for Phosphorus-hydroxyapatite-slag) model is presented. The P-Hydroslag model is similar to the 2014 prototype model, with additional features for diffusion barrier and crystal growth, a refined characterization of exhaustion equations, and a complete model equation matrix. The objectives were to calibrate the P-Hydroslag model with experimental data and evaluate the validity and realism of the model. 5-10 mm electric arc furnace steel slag produced by Arcelor Mittal and provided by Minéraux Harsco (Contrecoeur, Canada) was used (33% Fe A vertical filter column filled with slag was fed from its base with a synthetic wastewater in a saturated mode for a total duration of 623 days at approximatively 25 °C. The column size was 159 cm in length and 10 cm in internal diameter. The synthetic wastewater solution consisted of K The column was divided into 11 virtual cells for the filling step, identified #0 to #10, with #0 at bottom (inlet) and #10 at top (outlet). Cells #1 to #9 were 15 cm long and had a sampling hole in the middle. Cells #0 and #10 were 7.5 cm long and had no sampling hole to provide a slag transition zone between the inlet/outlet tubing and sampling zones. While filling the column, two 300 g slag samples were taken from each cell using a standard sampling procedure for aggregate materials ( The feeding barrel, column effluent and cells were sampled and analyzed periodically for pH, o-PO At the end of operation, feeding was stopped and the column was kept saturated for 6 days before dismantling. Upon dismantling, pore water was first sampled and analyzed, then the column was cut into 4 sections to ensure efficient solids sampling. For each cell, three samples were taken: first, several slag particles sampled before doing any major disturbance of the slag media (for scanning electron microscope (SEM) analysis). Second, slag was washed with water in a large pan and precipitates were sampled by sedimentation (for X-ray diffraction (XRD) and transmission electron microscope (TEM) analyses). Finally, a 300 g of washed slag sample was taken for kinetic tests (described in Section The batch kinetic test method is described in another reference ( Each 300-g slag sample from cells 1 to 8 was used for a 5-phase kinetic test, resulting in 16 kinetic tests (2 replicates per cell). One-phase batch tests on dismantled column slag samples were performed for cells 1 to 9. The model's Gujer matrix is presented in Appendix ( Two types of HAP were included to account for two types of precipitation. HAP_HO was HAP formed by homogeneous precipitation (new seeds precipitated in voids, or spontaneous precipitation) while HAP_HE was HAP formed by heterogeneous precipitation (on existing surfaces - crystal growth). HAP_HE occurred below a critical saturation index ( In heterogeneous precipitation, crystal size is a variable following crystal growth on existing seeds, assuming that all crystals have the same size. The number of seeds ( Slag composition was simplified to the chemical formula CaO-0.3CaCl In this model, slag dissolution is assumed to be limited by Fick's law of diffusion ( In continuous flow column simulations, the Advection-Reaction-Dispersion (ARD) equation for 1D flow was used (equation Numerical simulations were performed using the PHREEQC software with its IPHREEQC modules for interfacing with MATLAB ( The initial solution was simulated with KH The model constants were identified by minimizing the misfit between the simulated output and the experimental pH and Exhaustion functions were produced by plotting Exhaustion functions coefficients were determined by linear regression of In the Gujer matrix, exhaustion functions included additional terms involving porosity and slag density to account for the conversion of The simulated influent was prepared according to the procedure described in the batch tests section. The column test was simulated within KINETIC and TRANSPORT blocks, with 50 numerical cells and a tolerance of 1E-6. Kinetic rates were applied to both mobile and immobile cells. Hydraulic parameters In general, batch test calibration was good, except for the period 0–100 min where the model overestimated slightly the o-PO pH An example of tracer test calibration is shown in appendix. Hydraulic parameters Results of numerical simulations are compared to experimental data in Calibrated constants were The column was divided in two zones for the calibration of The implementation of the diffusion equation is considered a major improvement compared to previous prototype versions of the model. Without the diffusion equation, CaO would always be leached at its maximum capacity (pH The appropriateness of the diffusion equation can be assessed by the robustness of the model regarding pH. The model could predict pH at the end of operation, pH after the 6-day rest and pH Cristal size in homogeneous precipitation was confirmed by microscope observations. In cells 1 to 3, where the amount of precipitated HAP was sufficient for measurements, isolated crystals in TEM pictures were measured, resulting in a 35 nm mean value for 505 measurements. A similar value of 24 nm was calculated from XRD diffractograms of cells 1 to 3. No specific increase was observed in crystal size from cells 1 to 3, validating the constant crystal size hypothesis for homogeneous precipitation. HAP composition was confirmed by XRD patterns (provided in supporting information). HAP composition for individual crystals from TEM was confirmed by P and Ca presence with EDS. No monetite was detected by XRD and no monetite precipitation occurred in the column simulations while monetite was precipitated in batch test simulations, suggesting that pH rise in column was too fast for monetite formation. The distribution of mineral phases within the simulated column is shown The relative small amount of formed HAP in heterogeneous precipitation made impossible XRD or TEM crystal size analysis for heterogeneous HAP. It was possible, however, to analyse the progression of calcite crystal size within the column using XRD. Its size was around 200 nm in cells 1 to 3, increased to 900 nm in cell 5, and was over the limit of Scherrer equation in cells 6 and higher. This suggests homogeneous precipitation and constant size in the first cells and heterogeneous precipitation and crystal growth in last cells. Even if homogeneous and heterogeneous precipitation was experimentally observed for calcite, only homogeneous precipitation was included in the model. Assuming homogeneous precipitation at 200 nm (as measured in cells 1 to 3) and spherical crystals, the computed solubility product from equation A preliminary validation of the model was performed using experimental data from a pilot test consisting of steel slag columns fed with a real fish farm effluent ( The main issue regarding the model is the number of batch kinetic tests needed to provide exhaustion equations. The hypothesis of most reactive grains in batch tests conditioning column tests should also be examined, because even if pH Calibration of heterogeneous precipitation was limited by experimental data, as last cells did not reach their longevity. Additional studies involving long-term operation of slag filters and breakthrough of last sections of filters, in which heterogeneous precipitation occurred for a while, would be needed for accurate calibration and in-depth study of seeds concentration and type of precipitation. In this paper, two layers of different seeds concentration were proposed, but other formulations would be possible including step functions for seeds VS saturation index, increasing the number of layers or adding a third type of HAP. Further work should be conducted regarding need for refinement of the model. Additional features such as interaction with atmospheric CO The use of the P-Hydroslag model in practical applications requires some data collection and calibration work. The calibration of the influent should focus on accurate reproduction of alkalinity and of inorganic carbon concentration, as they contribute significantly to the filter exhaustion. In applications in which the influent is a secondary effluent, the alkalinity concentration is influenced mainly by the type of tap water source (e.g. groundwater or surface water) and upstream process control (e.g. addition of bicarbonate). Important seasonal fluctuations in alkalinity may also be caused by fluctuations in upstream wastewater treatment nitrification. The exhaustion functions of the reactive material should be measured. Further work is needed to assess if existing exhaustion functions can be reused in other applications with the same media, as suggested by analyzing results from previous work (Section The main calibration effort in future uses of the P-Hydroslag model should be to assess if heterogeneous precipitation is needed when working with real wastewater applications. In any cases, the diffusion coefficient D The first version of the P-Hydroslag model that can be used for prediction of steel slag filter efficiency and longevity was presented in this paper. The objectives were to calibrate the model with experimental data and evaluate the validity and realism of the model. The main outcomes were as follows: A complete model equation matrix was provided. The model included two main kinetic equation sets: a first set for CaO dissolution and a second set for precipitation. CaO dissolution equations included slag exhaustion and CaO diffusion through a uniform crystal barrier on slag particles. Precipitation equations included calcite precipitation, monetite precipitation, transformation of monetite into hydroxyapatite, homogeneous hydroxyapatite precipitation (constant size) and heterogeneous hydroxyapatite precipitation (increasing size). An equation for hydroxyapatite solubility related to crystal size was included. Standard equilibrium reactions were included in the model via the PHREEQC software. The advection-diffusion-reaction model was used as the hydraulic model (1D porous media transport). The crystal barrier hypothesis was confirmed by SEM observations of used slag grains. Homogeneous and heterogeneous precipitation hypothesis was confirmed by TEM crystal size count and XRD measurements. The model was validated with an independent data set from a pilot test in which real wastewater conditions we used. The model was successful in producing realistic results. A simple and flexible experimental method was presented for the measurement of exhaustion functions, which are parameters suitable for a mechanistic model. This empirical method is interesting because it overcomes the complex task of relating slag composition to filter behavior. Numerical simulations reproduced experimental breakthrough curves (pH, o-PO The authors warmly thank Denis Bouchard, Manon Leduc, Simon Allaire, Simon Amiot and Patricia Bove from Polytechnique Montreal for chemical analyses and technical assistance. They also thank Margit Kõiv-Vainik, from University of Tartu, for providing constructive comments on the manuscript. A special thank is given to Jean-Philippe Massé and Philippe Plamondon, from Polytechnique Montreal CM  Advection-reaction-dispersion (ARD) equation for 1D transport and First-order exchange approximation between effective and immobile porosity: Detailed equations for HAP_HE: Detailed equations for diffusion through crystal barrier: Detailed equations for exhaustion functions: The following are the supplementary data to this article: Supplementary data to this article can be found online at