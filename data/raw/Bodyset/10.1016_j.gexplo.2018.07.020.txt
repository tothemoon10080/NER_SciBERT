Unsupervised and supervised machine learning techniques are used to classify and predict the alteration facies of the Rosemont skarn deposit. The deposit comprises three major geological domains informally named the Lower Plate, Upper Plate, and West Block. Over 1 billion tons of Cu-Mo-Ag mineralization are primarily hosted within the Lower Plate and West Block, concealed under poorly mineralized rocks of the Upper Plate. A training dataset comprising 882 drill core samples analyzed for X-ray powder diffraction (XRD) mineralogy and multi-element geochemistry is used to improve the classification and recognition of the skarn alteration.
                  The XRD-mineralogy is used for unsupervised learning in which hierarchical and K-means cluster analysis is applied to devise a classification of the skarn alteration using a compositional data analysis approach. The complex alteration at the Rosemont deposit is simplified into garnet-pyroxene-wollastonite-vesuvianite (GrtPxWoVes) skarn, serpentine-amphibole (SrpAm) skarn, epidote (Ep) skarn, and least altered (LAlt) rock. These four classes are coded into a categorical variable named Alteration Facies. The supervised learning uses the multi-element geochemical data to predict Alteration Facies. Several predictive models are fitted using different machine learning algorithms including support vector machines with linear (SVM-linear) and radial (SVM-radial) kernels, linear discriminant analysis (LDA), quadratic discriminant analysis (QDA), classification and regression trees (CART), and random forests (RF). Each predictive model is fitted onto three predictor spaces including raw geochemical data, isometric log-ratios (ilr), and centered log-ratios (clr) to evaluate the effect of compositional representations on the performance of the predictive models. The analysis shows that the RF algorithm yields predictive models that outperform all other algorithms using any of the predictor spaces. The RF test set prediction accuracy after 10-fold cross-validation is 79%; which is significantly higher than an accuracy of 45% obtained from visual core logging classification of the skarn alteration. Hypothesis testing, using multilevel linear modeling, suggests that there are no statistically significant differences in the quality of the predictive models fitted onto the raw, ilr, and clr geochemical data. Therefore, compositional representations of the geochemical data do not improve the performance of the predictive models.
                  The best RF model is used to predict Alteration Facies on 33,000 drill core samples in which multi-element geochemistry is available but the skarn alteration is uncertain due to the lack of XRD-mineralogy. The predicted alteration shows that the Ep skarn facies occurs above the economic mineralization within Mesozoic siliciclastic and volcanic rocks of the Upper plate. The GrtPxWoVes skarn and SrpAm skarn occur within Paleozoic carbonate rocks of the Lower Plate and West Block. Accordingly, the Ep skarn facies can be used to target blind Cu-Mo-Ag rich porphyry-skarn mineralization in areas where the Paleozoic carbonate rocks are concealed under the Mesozoic siliciclastic and volcanic rocks.Skarn mineral deposits are sources of economically important metals such as Cu, Mo, Ag, Au, W, Fe, Pb, Zn, U, REE, F, B, In, and Sn ( Machine learning techniques are used in geosciences to extract geological insight from data, improve geological mapping, and to support geological modeling for mine planning ( The Rosemont deposit, Hudbay Minerals Inc., is a Cu-Mo-Ag skarn deposit located in the Laramide porphyry belt of Arizona, 40 km to the southeast of Tucson ( The Lower Plate forms an upright, east-dipping, homoclinal sequence composed dominantly of Paleozoic chemical sedimentary rocks with minor interbedded siliciclastic rocks. The Lower Plate includes limestone, dolostone, mixed chemical-siliciclastic rocks such as marlstone, calcareous siltstone, calcareous sandstone, and minor siliciclastic rocks including mudstone, siltstone, and fine-grained sandstone. The base of the Lower Plate is dominated by limestone of the Escabrosa and Horquilla Formations. Most mixed chemical-sedimentary rocks occur in the Earp Formation and the top of Horquilla Formation. Dolostone occur dominantly towards the top of the Lower Plate in the Epitaph Group and Scherrer Formations. The Upper Plate is composed dominantly of Mesozoic and Cenozoic siliciclastic and volcanic rocks overlying the Lower Plate ( The West Block is bounded to the Lower Plate by the steeply-dipping backbone fault system ( Tertiary quartz-feldspar porphyries intrude the Lower Plate below the low angle fault ( Skarn rocks at the Rosemont deposit are primarily exoskarn hosted in carbonate, siliciclastic, and volcaniclastic rocks ( In this study drill core samples with multi-element geochemical data and XRD-mineralogy are referred as observations, compositions, or compositional vectors. Chemical elements and minerals are referred as variables, parts, components, or features. The whole rock multi-element geochemical dataset comprises 33,000 drill core samples distributed throughout the deposit. These samples were collected from 90 diamond drill holes sampled at 1.5 meter intervals along the entire core length to properly characterize the lithological variability of the deposit. All samples were analyzed at Bureau Veritas laboratories in Vancouver, Canada, for 45 elements by inductively coupled plasma mass spectrometry after a 4-acid digestion (Bureau Veritas method MA200). Trace elements Be, Re, S, Se, and Tl were removed from the data analysis because they contain >50% of values below the lower detection limit (cf. A subset of 882 samples distributed throughout the Rosemont deposit were analyzed for quantitative XRD-mineralogy at SGS laboratories in Canada. Mineral identification and interpretation involve matching the diffraction pattern of a test sample material to patterns of single-phase reference materials. The reference patterns are compiled by the Joint Committee on Powder Diffraction Standards-International Center for Diffraction Data. To characterize skarn metasomatic alteration facies we investigated a 12-part mineralogical composition including quartz, epidote, potassium feldspar (K-feldspar), plagioclase, amphibole (tremolite-actinolite), serpentine, calcite, dolomite, garnet, pyroxene (diopside), wollastonite, and vesuvianite. These components represent the major silicate and carbonate rock-forming minerals of the different rock types present at the Rosemont skarn deposit. Mineral abundances, in weight %, have an analytical precision of ±10%. The analytical limit of detection of the investigated mineral phases is approximately 1%. Left-censored and right-censored data are, respectively, nondetects below and above the laboratory reporting limits ( Geochemical and mineralogical data are compositions. Compositional data are vectors of positive components in which the relevant information is assumed to be contained only in the ratio between the parts ( The variation matrix of Centered tetrahedral and ternary diagrams are used for visualization of the mineralogical data to facilitate visual recognition of the data structure. The vertices of these diagrams represent composite variables, calculated using the geometric mean of the parts to be consistent with the special mathematical properties of compositional data ( Unsupervised machine learning aims at finding structure and patterns intrinsic in the data, without an associated response variable. In geoscience data patterns commonly reflect lithology, alteration, and mineralization. Unsupervised learning techniques such as hierarchical cluster analysis, A major goal of this study is to classify the skarn alteration of the Rosemont skarn deposit. The quantitative XRD-mineralogy is investigated to establish a categorical variable, Alteration Facies, representing the different skarn alteration facies. To accomplish this, we followed the three-stage approach for unsupervised analysis of compositional data of The multi-element geochemical data is also processed through PCA, for feature engineering, to select a number of principal components (PC) to reduce the dimensionality while retaining most of the variability (>80%) contained in the dataset ( Prediction of a categorical or numerical response variable using a set of predictor variables is the major objective of supervised machine learning. The categorical variable Alteration Facies, derived from the unsupervised analysis of the XRD-mineralogy, is used to train several supervised learning algorithms to recognize geochemical patterns associated with skarn alteration. Geochemical elements are used as predictor variables of Alteration Facies. Six different machine learning algorithms are used to fit predictive models of Alteration Facies to evaluate the ability of these models to forecast the skarn alteration at the Rosemont deposit. These algorithms include support vector machines with linear (SVM-linear) and radial (SVM-radial) kernels, linear discriminant analysis (LDA), quadratic discriminant analysis (QDA), classification and regression trees (CART), and random forests (RF). The goal is to select the best performing predictive model to forecast Alteration Facies on approximately 33,000 drill core samples in which alteration is uncertain due to the lack of XRD-mineralogy. The learning algorithms are evaluated using metrics of predictive model performance such as the global prediction accuracy, the class precision, and the class sensitivity. The accuracy is the percentage of correctly classified observations relative to the grand total. The precision measures the success rate, expressed as a percentage, that a given predictive model has at correctly classifying observations into their class membership, whereas the sensitivity measures the percent probability of detecting any given class. All these metrics can be presented in a confusion matrix. The prediction accuracy is used to rank and select the best predictive models. However, most machine learning algorithms minimize the prediction error obtained from the training dataset used to fit the model ( The model variance, the sensitivity of the model to fluctuations in the training dataset, is assessed using the difference between the training and test set accuracies of the 10-folds generated for cross-validation. Accordingly, the model variance is expressed in units of standard deviation (σ) of the differences in accuracy. In some cases the training accuracy can be considerably different from the test accuracy; which is a phenomenon known as overfitting. In practice, it is recommended to choose the model that has both good test set accuracy and low model variance, relative to its counterparts. SVM were originally developed to solve classification problems restricted to two classes, but their application has been extended to multiple classes by combining several two-class SVM ( LDA is commonly used for multiclass classification ( CART and RF are tree-based algorithms ( RF is an ensemble algorithm that combines multiple CART models to produce a consensus prediction representing the mode of all predictive outputs generated by every tree in the ensemble ( The number of predictor variables, known also as features, used to fit a predictive model is a major factor contributing to increase model complexity; which may result in decreased accuracy and increased model variance ( To build predictive models of categorical variables it is ideal to have all classes equally represented in the dataset, given that the metrics of model performance can be negatively impacted when the classes are imbalanced (cf. Up-sampling randomly replicates the data points with replacement to produce a balanced dataset where all classes have the same number of observations as the majority class. Cross-validation of predictive models fitted onto up-sample datasets may overestimate the performance of the model, given that the replicated data points have high probability of being included in both the training and test sets. Therefore, prior to up-sampling, an evaluation set comprising 30% of the data points is held out to investigate the model performance. The evaluation set is generated through stratified random sampling to preserve the original relative class frequencies. Down-sampling randomly reduces the number of data points in the majority classes such that all classes have the same number of observations as the minority class. A drawback of down-sampling is that the models are fitted onto smaller datasets; which may have a negative impact on the overall accuracy. However, down-sampled models are less prone to overfitting when compared to predictive models fitted onto up-sampled datasets. We use ten different test datasets, generated for 10-fold cross-validation, to estimate the average and variability of key metrics of predictive model performance including the accuracy, precision, and sensitivity. This approach enables the application of inferential statistics, hypothesis testing, to compare different predictive models in terms of the differences between the means of a selected metric of model performance. The statistical comparisons in this study are considered a repeated-measures design because the same ten test datasets are used to estimate the performance of different predictive models. Therefore, the same data points contribute to the different means, and the scores of different experimental conditions, such as different predictive models, are correlated because they are derived from the same observations. Multilevel linear modeling is applied for hypothesis testing using the R package ‘nlme’ ( Spatial modeling of categorical variables such as Alteration Facies is performed using the standard implicit 3D-modeling tools of Leapfrog Geo®. The classes representing Alteration Facies are composited at 5 m intervals to smooth contacts. The new composite intervals contain a large density of contact points among classes throughout the deposit. Model surface definition is based on Radial Basis Functions used to build smooth manifold surfaces from the point data ( The variance of the pairwise log-ratios, The variation matrix identifies key mineralogical associations typical of the skarn alteration facies observed in the field and drill core at the Rosemont deposit. Quartz, plagioclase, K-feldspar, calcite, and dolomite are removed to create a 7-part subcomposition consisting only of skarn-related metasomatic minerals to investigate interrelationships. The cluster dendrogram derived from the 7-part mineralogical subcomposition suggests similar associations among skarn-related minerals as those derived from clustering variables of the 12-part composition ( The hierarchical agglomeration of skarn-related minerals indicated by the cluster dendrogram on Balances, ilr-coordinates, are calculated to represent the 4-part and 3-part subcompositions in the Euclidean real space for The following sequential binary partition is used to calculate the ilr-coordinates for the 4-part subcomposition: balance 1 [Gr, PxWoVes | Ep, SrpAm], balance 2 [Gr | PxWoVes], and balance 3 [Ep | SrpAm]. For comparison, the results of The ilr-coordinates for the 3-part subcomposition are calculated using the following sequential binary partition: balance 1 [GrtPxWoVes | Ep, SrpAm], and balance 2 [Ep | SrpAm]. The results from The 4-class categorical variable Alteration Facies is part of a training dataset of 882 drill core samples analyzed for both XRD-mineralogy and geochemistry. Alteration Facies is used as response variable in order to train several predictive modeling algorithms to recognize patterns in the multi-element geochemical data that are associated with skarn alteration. The predictive models developed aim at predicting the GrtPxWoVes skarn, SrpAm skarn, Ep skarn, and LAlt rock. Fourteen predictive models of Alteration Facies are fitted onto three predictor spaces including the entire geochemical dataset comprising 40 chemical elements, raw variables, and two compositional representations of the geochemical data given by 40 clr-coefficients, and 39 ilr-coordinates. The ilr variables represent balances following a sequential binary partition derived from hierarchical clustering of variables using the variation matrix as a metric of similarity ( Within each predictor space the largest model variance is given by those predictive models using the SVM-radial ( The test set accuracies between equivalent predictive models in the three predictor spaces are compared using multilevel linear modeling. Algorithms with several predictive models (RF and CART) are coded in order of decreasing test set accuracy to compare models at the same relative level of accuracy between different predictor spaces (model code, The best random forest model (RF1, The precision and sensitivity of equivalent Alteration Facies classes predicted by the RF1 models are also compared through multilevel linear modeling to evaluate the effects of different predictor spaces in the performance of these parameters ( We conclude that there are no systematic and significant differences in the performance of predictive models fitted onto raw geochemical data and its compositional representations ( For each predictor space RFE is performed to select the optimum number of variables ( Profile plots from RFE are used to graphically evaluate the performance of a given predictive model as variables are added or removed from the predictor space. Only profile plots for the raw variable space are shown on The optimum number of variables selected through RFE is used to re-fit the fourteen predictive models in each predictor space to compare their performance relative to those models fitted onto the full set of variables ( The predictive models fitted onto the best subset, after RFE, and those fitted onto the full raw, ilr, and clr predictor spaces display similar predictive performance ( After complexity reduction through RFE, the RF algorithm also consistently produced predictive models with the best test set accuracy and the lowest model variance ( The best predictive models of Alteration Facies are achieved with the RF algorithm (RF1, The Ep skarn class represents only 8% of the observations, with coincident XRD-mineralogy and geochemistry, used to fit different predictive models of Alteration Facies. In contrast, the relative frequencies of the GrtPxWoVes skarn (29%), SrpAm skarn (25%), and LAlt rock (38%) are relatively more proportional in the dataset. The class imbalance introduced by the Ep skarn class may have a significant negative impact on performance metrics such as prediction accuracy, and the precision and sensitivity of individual classes. Improving the sensitivity of the Ep skarn class is important to build predictive models that are more efficient at detecting this class. Accordingly, we applied two statistical resampling methods, including up-sampling and down-sampling to balance the dataset. Only the raw predictor space was balanced, given that the ilr and clr spaces have no impact on the predictive performance metrics of Alteration Facies. The up-sampled and down-sampled datasets are subjected to RFE to select the best subset of variables to fit RF models onto the class-balanced datasets. The results of the new predictive models are used to evaluate the effects of class imbalance on performance metrics. An evaluation set comprising 292 observations, representing 30% of the dataset, is held out before up-sampling. The remaining 590 observations are up-sampled to balance the Alteration Facies classes. This technique randomly replicates the data points with replacement to produce a balanced dataset where each Alteration Facies class has the same number of observations as the majority class LAlt rock. The resulting up-sampled dataset consists of 936 observations, with a total of 234 data points within each class. The up-sampled dataset is also split into training and test datasets for 10-fold cross-validation. Seven RF models are fitted onto the up-sampled dataset using different number of random variables ( The down-sampled dataset is generated by randomly sampling the majority classes so that all Alteration Facies classes have the same number of observations as the minority Ep skarn class. The resulting balanced dataset consists of 292 observations with 73 data points in each class. The down-sampled dataset is also split into training and test datasets for 10-fold cross-validation of seven RF models fitted with different number of random variables ( Imbalances in geological datasets can result from biased geological sampling including oversampled or undersampled geological attributes. Down-sampling significantly improved the performance metrics of the Ep skarn class at the expense of the prediction accuracy, and a statistically significant decrease in the precision and sensitivity of other Alteration Facies classes. These characteristics suggest that the imbalance in the dataset results from insufficient geological sampling of the Ep skarn class; which cannot be solved by statistical resampling techniques. At the Rosemont skarn deposit visual classification of the alteration is highly uncertain given the fine-grained textural characteristics of the skarn alteration. Approximately 33,000 drill core samples distributed throughout the Rosemont deposit have been analyzed for 4-acid digested multi-element geochemical data, but the majority of these samples lack the corresponding XRD-mineralogy to characterize the skarn alteration. To circumvent the uncertainties arising from visual classification of the alteration, we selected the RFm10 model, fitted onto the raw variable space after RFE ( The predicted Alteration Facies given by the RFm10 model are shown on the vertical section presented on A cross-section derived from a 3D-model of the predicted alteration illustrates the spatial relationships between the Alteration Facies and the mineralized Tertiary quartz-feldspar porphyries that intrude into the Lower Plate of the Rosemont deposit ( This investigation applied several supervised and unsupervised machine learning strategies to classify and predict complex fine-grained metasomatic skarn alteration at the Rosemont skarn deposit through integration of XRD-mineralogy and multi-element geochemistry reaching the following conclusions: Compositional data analysis of the XRD-mineralogy suggests that the metasomatic alteration at the Rosemont deposit can be simplified into four Alteration Facies classes, namely GrPxWoVes skarn, SrpAm skarn, Ep skarn, and LAlt rock ( Alteration Facies was used to train several machine learning algorithms to predict the skarn alteration using geochemical data. Fourteen predictive models were fitted onto three different predictor spaces including the raw geochemical data, ilr-coordinates, and clr-coefficients. There are no statistically significant differences in the performance metrics of models fitted onto the raw geochemical space and those fitted onto compositional representations. Compositional representations of geochemical data do not improve the prediction of Alteration Facies at the Rosemont deposit. Variable selection and model complexity reduction were tested through RFE and a subjective selection of seven PC. The predictive models fitted onto the seven PC underperform those fitted onto the full predictor space ( The RF algorithm yields consistently the best performing predictive models of Alteration Facies for the three predictor spaces. We adopted the raw variable space given that compositional representations do not improve model performance. The test set accuracy of the best RF model is 79% ( The poor sensitivity (49%) of the Ep skarn class is the result of a severe class imbalance in the original dataset, given that the Ep skarn class only represents 8% of the observations. Application of statistical resampling techniques such as down-sampling increased the Ep skarn class sensitivity to 73% ( The spatial distribution of the predicted Alteration Facies given by the RFm10, after RFE, reflects the stratigraphic control of the alteration. The GrtPxWoVes skarn and SrpAm skarn occur within the Lower Plate and West Block; which host the economic Cu-Mo-Ag mineralization. The Ep skarn class occurs up to 200 m above the deposit within the poorly mineralized Upper Plate ( We thank Geologists Jeff Cornoyer and David Young for sharing their knowledge of the Rosemont deposit and for their hard work during two drilling programs conducted by Hudbay. We are very thankful with Hudbay Minerals Inc., for allowing us to publish this scientific contribution. Jorge Oliveira, XPS Chief Geoscientist, is also thanked for his excellent geometallurgical work at the Rosemont deposit. We thank three anonymous reviewers whose insightful comments contributed significantly to improve this manuscript. Thanks to Professor Stefano Albanese, Editor, Journal of Geochemical Exploration, for handling the peer review process of our manuscript. 